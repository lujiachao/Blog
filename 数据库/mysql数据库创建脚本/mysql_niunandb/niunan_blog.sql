-- MySQL dump 10.13  Distrib 5.7.17, for Win64 (x86_64)
--
-- Host: localhost    Database: niunan
-- ------------------------------------------------------
-- Server version	5.5.53

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `blog`
--

DROP TABLE IF EXISTS `blog`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `blog` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `createdate` datetime NOT NULL,
  `title` varchar(128) DEFAULT NULL,
  `body` text,
  `body_md` text,
  `visitnum` int(11) NOT NULL,
  `cabh` varchar(64) DEFAULT NULL,
  `caname` varchar(64) DEFAULT NULL,
  `remark` varchar(2048) DEFAULT NULL,
  `sort` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1189 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `blog`
--

LOCK TABLES `blog` WRITE;
/*!40000 ALTER TABLE `blog` DISABLE KEYS */;
INSERT INTO `blog` VALUES (1184,'2017-02-16 14:25:05','迟到的情人节女友开箱！！！','<p style=\"box-sizing:border-box;margin-top:0px;margin-bottom:25px;word-break:break-word;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\">今天才刚刚送到，唉，本来想着14号那天到了正好可以玩一晚上的，结果现在都把美好的心情磨灭了，开箱开箱！！！</p>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-409692b627b5356a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-409692b627b5356a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-6a4eb6580870cf0a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-6a4eb6580870cf0a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-07c9d2fb07bb71cc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-07c9d2fb07bb71cc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-2ca6f82811ac0c8e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-2ca6f82811ac0c8e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-9b291122ba911dba.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-9b291122ba911dba.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-bc33ae565eeda837.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-bc33ae565eeda837.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<p style=\"box-sizing:border-box;margin-top:0px;margin-bottom:25px;word-break:break-word;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\">说是破损其实也就是箱子边边那里破了，怕有什么小件东西落下了的。。。</p>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-3ed1ec7f2e6d061f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-3ed1ec7f2e6d061f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-8450bd9aef3bcb46.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-8450bd9aef3bcb46.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://niunan.net/images/fc660m/09.jpg\" data-original-src=\"http://niunan.net/images/fc660m/09.jpg\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-fedc0c23575a5789.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-fedc0c23575a5789.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-7f04874bb1c6754b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-7f04874bb1c6754b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-718cfbee657ef7df.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-718cfbee657ef7df.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-d46a734257498913.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-d46a734257498913.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://niunan.net/images/fc660m/14.jpg\" data-original-src=\"http://niunan.net/images/fc660m/14.jpg\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-e70a4d013619f14c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-e70a4d013619f14c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<div class=\"image-package\" style=\"box-sizing:border-box;padding-bottom:25px;width:700px;margin-left:-40px;text-align:center;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\"><img src=\"http://upload-images.jianshu.io/upload_images/4382164-99a1f5551a3c53e3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" data-original-src=\"http://upload-images.jianshu.io/upload_images/4382164-99a1f5551a3c53e3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2\" style=\"box-sizing:border-box;border:0px;vertical-align:middle;max-width:100%;height:auto;cursor:zoom-in;transition:all 0.25s ease-in-out;\" /><br style=\"box-sizing:border-box;\" />\n</div>\n<p style=\"box-sizing:border-box;margin-top:0px;margin-bottom:25px;word-break:break-word;color:#2f2f2f;font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:16px;\">感觉声音是比茶轴的轻些。。。。还好吧。。。。</p>\n	                          ',NULL,129,'0103','随笔',NULL,0),(1185,'2017-02-18 15:26:47','文件批量重命名','<span style=\"font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;Se;e UI&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑,sans-serif;font-size:medium;\">很久以前用过一个软件，界面也大概是这个样子的，前天需要批量重命名的时候找不到以前用的软件的了，自己边学WPF边捉磨着做了一个，只是实现我自己想要的功能...<br />\n<br />\n<br />\n<br />\n</span>	  <img src=\"http://niunan.net/images/niunan_changename.jpg\" />    <div>源码地址：https://coding.net/u/niunan/p/niunan_changename/git</div>\n                    ',NULL,10,'0134','wpf',NULL,0),(1183,'2017-02-13 18:06:39','Nginx做转发','二台服务器，服务器A做域名转外，所有外网的域名都到这台服务器A的80端口上，服务器B内网地址192.168.1.227， 上面IIS搭建了N多网站，以端口来区分，用以前的方式 配置转发<br />\n<img src=\"http://blog.niunan.net/upload/20170213180444.png\" alt=\"\" border=\"0\" /><br />\n结果发现首页能打开，但是首页上的搜索按钮，后台代码用Response.Redirect跳转到其他页面后发现URL又自动带上端口地址，<br />\n<img src=\"http://blog.niunan.net/upload/20170213180540.png\" alt=\"\" border=\"0\" /><br />\n<br />\n经过一下午的问群里的朋友及不停搜索，终于解决！！！！<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20170213180613.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<b><span style=\"font-size:18px;\">特此记录，以备不时之需！！！</span></b><br />\n',NULL,48,'0133','nginx',NULL,0),(1182,'2017-01-17 11:56:00','dotnetcore中出现Missing compiler required member &#039;Microsoft.CSharp.RuntimeBinder.CS','<span style=\"font-size:16px;\">学习用.net core + dapper做个博客，</span><br />\n<span style=\"font-size:16px;\">按 https://gist.github.com/lancscoder/1829462 这个dapper简易教程来做，</span><br />\n<span style=\"font-size:16px;\">相就的WEB,MODEL,DAL层都建立好代码也写好了，但是在编译的时候出现 </span><br />\n<span style=\"font-size:16px;\">&nbsp;</span><span style=\"font-size:16px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Missing compiler required member &#039;Microsoft.CSharp.RuntimeBinder.CS</span><br />\n<span style=\"font-size:16px;\">错误</span><span style=\"font-size:16px;\">&nbsp;&nbsp;&nbsp;&nbsp;，<br />\n上网搜索了好久才发现需要添加相应引用，但是那些引用又不能通过右键→引用→添加来进行，只能修改dal层下的project.json文件：<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170117115238.jpg\" border=\"0\" /><br />\n<br />\n如图，加入下面三行就可以编译成功了，再测试就行了，成功用dapper插入数据库：<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170117115453.jpg\" border=\"0\" /><br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170117115532.png\" border=\"0\" /><br />\n<br />\n<br />\n<br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170117115544.png\" border=\"0\" /><br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170117115557.jpg\" border=\"0\" /><br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>',NULL,192,'0121','.NET',NULL,0),(1181,'2017-01-14 20:24:29','手机端商品列表页的滚动加载','先记下来<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20170114202423.png\" alt=\"\" border=\"0\" />',NULL,63,'0121','.NET',NULL,0),(1180,'2017-01-01 00:18:41','和牛腩学编程路线图','<div>把之前录的视频整理了一下，把其中一些自己觉得满意的抽出来，做成一个学习路线图<br>\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20170101001835.png\" border=\"0\"><br>\n</div>\n<div>没有录制的视频就是2017年的录制计划了，不知道能不能学得进，正在把一些视频逐步传到优酷上，当然是不清晰的，清晰的还是得从网盘下载，自己联系我QQ164423073 索取即可，不过有些是需要淘宝花费购买，赚点肉钱！！！</div>\n<div>以下是视频优酷观看地址：<br>\n牛腩讲HTML<br>\nhttp://v.youku.com/v_show/id_XNjk0Mjk0NTY4.html?f=16993367&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩讲JAVASCRIPT<br>\nhttp://v.youku.com/v_show/id_XNjk0ODM3OTU2.html?f=17077902&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩教你从效果图制作静态HTML页面<br>\nhttp://v.youku.com/v_show/id_XNjk3OTI2NDk2.html?f=19496312&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩教你用C#做网页留言板<br>\nhttp://v.youku.com/v_show/id_XMTg5MjcyNDI1Mg==.html?f=28371240&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩新闻发布系统<br>\nhttp://v.youku.com/v_show/id_XNTk2NTMwMjQw.html?f=17226797&amp;from=y1.7-3&amp;spm=a2hzp.8253876.0.0<br>\n牛腩购物网（动软代码生成器）<br>\nhttp://v.youku.com/v_show/id_XNjkwMTI3MDk2.html?f=17378530&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩代码生成器<br>\nhttp://v.youku.com/v_show/id_XNjAyNDE5MTI4.html?f=17887900&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩论坛<br>\nhttp://v.youku.com/v_show/id_XNjk0MDMxMDY4.html?f=16991550&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩网络工作室<br>\n牛腩驾校预约系统<br>\n牛腩学ASP.NET MVC<br>\nhttp://v.youku.com/v_show/id_XNTk5NzY5NDg4.html?f=19331481&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩进销存<br>\nhttp://v.youku.com/v_show/id_XNTg3NzM2NjA0.html?f=19494122&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩购物网MVCEF<br>\nhttp://v.youku.com/v_show/id_XMTM5NTAzNjEwNA==.html?f=26285759&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩教你用EF做企业网站<br>\nhttp://v.youku.com/v_show/id_XMTg2NjIyMDAwOA==.html?f=28929248&amp;from=y1.7-3&amp;spm=a2hzp.8253876.0.0<br>\n牛腩购物网手机版<br>\n牛腩学CORDOVA做手机APP<br>\nhttp://list.youku.com/albumlist/show?id=25834111&amp;ascending=1&amp;page=1<br>\n牛腩学mono for android <br>\nhttp://v.youku.com/v_show/id_XNTkzNzQ1NzUy.html?f=19539679&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n牛腩学用MUI做手机APP<br>\nhttp://v.youku.com/v_show/id_XMTczODg3MjU0OA==.html?f=28128525&amp;spm=a2hzp.8253876.0.0&amp;from=y1.7-3<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div>\n',NULL,0,'0112','原创视频',NULL,-2),(1179,'2016-12-22 10:57:37','mssql中sp_executesql的用法','上图：<br />\n<img src=\"http://blog.niunan.net/upload/20161222105734.jpg\" alt=\"\" border=\"0\" />	                          ',NULL,104,'0106','SQL',NULL,0),(1178,'2016-12-07 11:29:42','@Html.DropDownList 设置选中值无效','有时候在ASP.NET&nbsp; MVC中用@Html.DropDownList 设置选中值无效，如图：<br />\n<img src=\"http://blog.niunan.net/upload/20161207112833.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161207112842.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161207112850.png\" alt=\"\" border=\"0\" /><br />\n<br />\n具体原因说不清，反正只要改个名字就行了！！！，如图：：：<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161207112923.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161207112933.png\" alt=\"\" border=\"0\" /><br />\n',NULL,162,'0101','ASP.NET',NULL,0),(1177,'2016-11-30 21:36:43','mssql2012以后新增的offset分页，看起来爽死了！！！','<img alt=\"\" src=\"http://blog.niunan.net/upload/20161130213614.png\" border=\"0\" /><br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161130213624.png\" border=\"0\" /><br />\n<br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161130213636.png\" border=\"0\" /><br />\n<br />\n<br />\n2016年12月01日更新<br />\n正式用到项目中的时候才发现大坑，那个排序字段必须形成唯一 ，要不然就分页失败的<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161201153619.jpg\" border=\"0\" /><br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161201153636.jpg\" border=\"0\" /><br />\n<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161201153645.jpg\" border=\"0\" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,260,'0106','SQL',NULL,0),(1176,'2016-11-17 16:04:22','img标签中的图片加载异常时显示默认的图片','<img alt=\"\" src=\"http://blog.niunan.net/upload/20161117160400.jpg\" border=\"0\" />	                          ',NULL,173,'0132','html',NULL,0),(1175,'2016-11-17 11:54:29','ASP.NET中彩票项目中的计算复式投注的注数的方法','从别人做的项目中抽取出的代码：<br />\n<img src=\"http://blog.niunan.net/upload/20161117115425.jpg\" alt=\"\" border=\"0\" />',NULL,111,'0101','ASP.NET',NULL,0),(1174,'2016-11-15 16:00:24','移除http响应中的多余的头（X-AspNet-Version,Server等）','网上搜索出很多方法了，这里记录一下：<br />\n<img src=\"http://blog.niunan.net/upload/20161115155534.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n如果是asp.net mvc的话还得在global.ascx中加入：<br />\n<img src=\"http://blog.niunan.net/upload/20161115155604.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n至于移除Server头，按网上的写法写httpmoudle后发现无效的，最后还是用了微软官方的UrlScan工具，搜索下载安装后在<br />\nC:WindowsSystem32inetsrvurlscan 里有个UrlScan.ini文件，需要用管理员的权限打开，我的方法是进入管理员的cmd, 转到该目录下，运行命令 notepad UrlScan.ini 就用记事本打开可以编辑了，里面有个RemoveServerHeader，设置为1即可，重启IIS后就生效了，再访问网站按F12会发现Server不见了<br />\n',NULL,83,'0101','ASP.NET',NULL,0),(1173,'2016-11-05 15:53:42','获取枚举类型的描述description','c#<br />\n<br />\n<div>using System;</div>\n<div>using System.Collections.Generic;</div>\n<div>using System.ComponentModel;</div>\n<div>using System.Linq;</div>\n<div>using System.Reflection;</div>\n<div>using System.Text;</div>\n<div>using System.Threading.Tasks;</div>\n<div><br />\n</div>\n<div>namespace candel</div>\n<div>{</div>\n<div>&nbsp; &nbsp; class Program</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; static void Main(string args)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int x = (int)OrderType.WaitConfirm;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string str = Util.GetEnumDesc(typeof(OrderType), x);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(str);</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Order o = new Order() { Id = 1, Type = (int)OrderType.Complete };</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string str2 = (typeof(OrderType)).GetEnumDesc(o.Type);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(str2);</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.Read();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; public class Order</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public int Id { set; get; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public int Type { set; get; }</div>\n<div>&nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; public enum OrderType</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 等待用户付款</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Description(\"等待用户付款\")</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; WaitPay = 0,</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 等待商家发货</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Description(\"等待商家发货\")</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; WaitSend = 1,</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 等待用户确认收货</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Description(\"等待用户确认收货\")</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; WaitConfirm = 2,</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 订单完成</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Description(\"订单完成\")</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Complete = 3</div>\n<div>&nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; public static class Util</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 根据值得到中文备注</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=\"e\"&gt;&lt;/param&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=\"value\"&gt;&lt;/param&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public static String GetEnumDesc(this Type e, int? value)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FieldInfo fields = e.GetFields();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int i = 1, count = fields.Length; i &lt; count; i++)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((int)System.Enum.Parse(e, fieldsi.Name) == value)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DescriptionAttribute EnumAttributes = (DescriptionAttribute)fieldsi.</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GetCustomAttributes(typeof(DescriptionAttribute), false);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (EnumAttributes.Length &gt; 0)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return EnumAttributes0.Description;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return \"\";</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; }</div>\n<div>}</div>\n/c#	                          ',NULL,99,'0101','ASP.NET',NULL,0),(1172,'2016-10-27 11:31:49','css3控制文本在一行中显示，过长结尾...','	                          css<br />\n<div>&nbsp; &nbsp; color: #000;</div>\n<div>&nbsp; &nbsp; display: -webkit-box;</div>\n<div>&nbsp; &nbsp; overflow: hidden;</div>\n<div>&nbsp; &nbsp; white-space: normal!important;</div>\n<div>&nbsp; &nbsp; text-overflow: ellipsis;</div>\n<div>&nbsp; &nbsp; word-wrap: break-word;</div>\n<div>&nbsp; &nbsp; -webkit-line-clamp: 1;</div>\n<div>&nbsp; &nbsp; -webkit-box-orient: vertical;</div>\n<div>&nbsp; &nbsp; -webkit-margin-end: 2px;</div>\n/css<br />\n<br />\n那三个-webkit的不能少<br />\n<br />\n',NULL,92,'0131','css',NULL,0),(1171,'2016-10-24 15:05:56','支付宝支付后回调通知中responseTxt=true  isSign=False可能的问题','在做支付宝的二维码扫码支付功能，生成二维码成功，扫描后也能付款，付款后也能回调通知到我的页面，但是验证签名的时候出错，找了好久终于找到是什么原因：<br />\nquote<br />\n1. 用的RSA签名验证，默认密钥纯字符，并不是从pem文件中读取，主要是在Aop.Api.DefaultAopClient中的全局变量keyFromFile=false<br />\n2. 我项目中用的密钥是存在文件中的，所以要改为keyFromFile=true;<br />\n3. 生成二维码的时候生成签名的是用pem文件，同样在回调的时候验证签名是也应该是从pem文件中取密钥，而默认的是纯字符串，具体是在Com.Alipay.Notify类中（F2FPayDll/Alipaynotify.cs文件中）的132行 &nbsp; isSign = AlipaySignature.RSACheckContent(preSignStr, sign, _alipay_public_key, _charset,false); 把那个false改为true即可<br />\n/quote<br />\n',NULL,145,'0101','ASP.NET',NULL,0),(1170,'2016-10-22 17:59:40','ASP.NET MVC部署到IIS7上访问不了，报错：Web 服务器被配置为不列出此目录的内容','经常碰到此问题，，搜索好久才发现web.config中加入以上代码即可<br />\nxml<br />\n&lt;system.webServer&gt;&nbsp;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;modules&nbsp;runAllManagedModulesForAllRequests=\"true\"&nbsp;/&gt;&nbsp;&nbsp;<br />\n&lt;/system.webServer&gt;&nbsp;<br />\n/xml<br />\n<br />\n<br />\n用bing怎么搜索都搜索不出来 ，但是用百度一下子就搜索到了。。郁闷 。。	                          	                          ',NULL,89,'0121','.NET',NULL,0),(1169,'2016-10-22 11:32:06','支付宝微信支付回调地址访问不成功','2016年10月21日<br />\nquote<br />\n今天测试了一天的微信支付和支付宝支付，扫描手机上的条码支付都没问题，可是二个支付的二维码支付都有问题，都是支付成功了，但是回调不执行，日志里根本就没有查到支付宝或者微信访问我的回调地址，可是同样的代码放到我自己的服务器上又是可以成功回调到的，郁闷。二个服务器不同的区别就是我的是单核1G内存，win2008 sp2 32位中文版 ，而公司服务器是 E5，8G，win2008 r2 64位版 ， 还有一个就是我的测试地址是二级域名，而公司的测试地址是三级域名，不知道是不是这个的原因导致回调不了，还有都备案过了！！！ <img class=\"emotion emoji\" src=\"https://coding.net/static/emojis/sob.png\" title=\"sob\" /><br />\n/quote	                          <br />\n2016年10月22日<br />\nquote<br />\n支付的回调总是访问不成功的问题解决了，<br />\n 代码中加了跨域限制访问的，支付宝微信那边通知过来的是跨域POST请求。需要把回调地址的跨域限制放开<br />\n/quote',NULL,68,'0103','随笔',NULL,0),(1168,'2016-10-20 22:19:42','apache做转发','一台WIN服务器，上面主要装了WAMP程序来运行PHP<br />\n的相关东西，现在在机子里的IIS建立了一个ASP.NET站点，访问端口88，服务器上可以：http://127.0.0.1:88来访问.NET网站，<br />\n现在要外面访问某网址后跳到该服务器上的.NET网站，看了一下，需要在wamp的apache中做转发，方法如下：<br />\nquote<br />\n在D:wampinapacheApache2.2.17confextrahttpd-vhosts.conf文件中（在apache目录下的htttpd.conf中文件配置也可）输入：<br />\n&lt;VirtualHost *:80&gt;<br />\nServerName 51qupin.cn<br />\nProxyPass / http://127.0.0.1:88//<br />\nProxyPassReverse / http://127.0.0.1:88/<br />\n&lt;/VirtualHost&gt;<br />\n即可<br />\n/quote<br />\n记得域名管理面板那绑定好域名→服务器<br />\n',NULL,65,'0130','apache',NULL,0),(1167,'2016-10-20 10:47:30','绑定DDL控件方法','刚刚写的，用在项目中，先记下来，备忘：<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161020104639.png\" border=\"0\" /><br />\n下面是调用方式；<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20161020104721.png\" border=\"0\" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,72,'0121','.NET',NULL,0),(1166,'2016-10-13 12:03:42','支付宝接口错误：您使用的私钥格式错误，请检查RSA私钥配置,charset = utf-8 ','调试支付宝条码支付的时候碰到个错误：您使用的私钥格式错误，请检查RSA私钥配置,charset&nbsp;=&nbsp;utf-8，<br />\n原因是我代码里的那私钥是直接复制pem文件里的代码的，可支付宝底层的sdk中默认是以文件的方式来进行，<br />\nquote<br />\n查看一下DefaultAopClient.cs,里面有一个自定义属性keyFromFile改成=false，则是用代码的方式进行，true的话则必须得传入pem的物理路径，如：HttpRuntime.AppDomainAppPath.ToString() + \"App_Data\\ant\\rsa_private_key.pem\"<br />\n/quote	                          ',NULL,329,'0129','开发',NULL,0),(1165,'2016-10-11 10:52:12','微信支付中的刷卡支付和扫码支付测试','<div class=\"content markdown bubble fancy-overflow\" style=\"color:#000000;max-height:100000px;\"><p class=\"ng-scope\">微信支付太坑了。官网下载的SDK，改了商户 ID和APPID等测试 都没用，仔细看了一下，原来首页默认调用的都是网上的页面，真是大坑 。。还有配置里的IP是8.8.8.8 ，用这个有时是会出错的，得改成自己的IP如：180.136.145.94</p>\n <p class=\"ng-scope\"><img src=\"http://blog.niunan.net/upload/20161011105209.jpg\" alt=\"\" border=\"0\" /><br />\n</p>\n <p class=\"ng-scope\">坑啊坑啊坑啊坑。</p>\n</div>\n	                          ',NULL,97,'0119','微信支付',NULL,0),(1164,'2016-10-09 17:45:09','ASP.NET MVC中切换模板页（不同目录的cshtml文件）','不想打字，看图，看来以后建立一个父类控制器还是有必要的。。。<br />\n<img src=\"http://blog.niunan.net/upload/20161009174439.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161009174447.jpg\" alt=\"\" border=\"0\" /><br />\n',NULL,91,'0101','ASP.NET',NULL,0),(1163,'2016-10-06 18:04:51','mono;db在C#中的增删查改','<span style=\"font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, &quot;Hiragino Sans GB&quot;, &quot;Se;e UI&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, sans-serif;font-size:14px;\">一个下午研究mono;db c#的增查改，终于搞出来了，示例代码很多都是从官网文档上找的，好难找到。。一大坨一大坨的E文<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20161006180449.png\" alt=\"\" border=\"0\" /><br />\n<br />\n</span>',NULL,87,'0128','mon;db',NULL,0),(1162,'2016-09-24 10:22:09','ubuntu for win10 里运行net core','花了点时间在ubuntu for win10里运行net core<br />\n<img src=\"http://blog.niunan.net/upload/20160924102132.png\" alt=\"\" border=\"0\" /><br />\n按官网上ubuntun10.14装的net core指令 <br />\n......<br />\n......<br />\n sudo apt-get install dotnet-dev-1.0.0-preview2-003131<br />\n 安装后再弄下面的hello world还是不行的，因为相关的netframework.deb包没有解压到相应的目录，没有权限，需要先提权：<br />\n sudo su<br />\n 再运行<br />\n apt-get -f install<br />\n 这样才能把net framework的相关deb包解压到正确目录<br />\n 然后进到helloworld目录dotnet restore, dotnet run 就运行成功了！！！',NULL,113,'0101','ASP.NET',NULL,0),(1161,'2016-09-22 12:53:28','ubuntu for win10 里运行apache+php','一直想试试ubuntu for win10中运行网站测试一下，弄了好久，今天终于基本弄明白了，	                          ubuntu for win10里的IP就是外面WIN10的IP，在里面建立网站了可以直接在外面WIN10 浏览器里看的，步骤大概如下：<br />\n<br />\n<ol><li>控制面板里安装ubuntu for win10</li>\n<li>WIN+X运行管理员模式下的命令行</li>\n<li>输入bash进入ubuntu</li>\n<li>用apt-get安装apache和php,相关命令自己搜索</li>\n<li>安装后第一次启动apache服务命令：sudo mkdir /run/locksudo service apache2 start</li>\n<li>在外面WIN10浏览器中输入http://localhost即可看到apache的界面</li>\n<li>ubuntun for win10中HTML的路径是在/var/www/html中</li>\n<li>在里面建立test.php, 输入&lt;?php phpinfo(); ?&gt;</li>\n<li>再在外面WIN10浏览器输入http://localhost/test.php即可看到</li>\n<li>注：需要先把外面WIN10的IIS停止掉，防止占用80商品</li>\n</ol>\n<br />\n<br />\n',NULL,118,'0127','win10',NULL,0),(1160,'2016-09-07 10:30:00','SQL删除语句同时向备份表插入数据','从这里摘抄下来的，觉得很不错，http://www.cnblogs.com/ljhdo/p/5792886.html#3503524	，以后就用这种方式删除，再也不用担心删除错数据啦！！！<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20160907102957.jpg\" border=\"0\" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,187,'0115','MSSQL',NULL,0),(1159,'2016-09-01 11:34:41','ASP.NET MVC中的cshtml页面中的下拉框的使用','ASP.NET MVC中的cshtml页面中的下拉框的使用<br />\n用上@Html.DropDownList<br />\n<br />\n<br />\n先记下来。。以做备忘。。。<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160901113432.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160901113439.jpg\" alt=\"\" border=\"0\" /><br />\n	                          ',NULL,111,'0101','ASP.NET',NULL,0),(1158,'2016-08-16 11:27:21','VS2015中运行ASPX老项目出错HTTP Error 500.23 - Internal Server Error错误','&nbsp; &nbsp;今天翻出以前用VS2010做的老项目，在VS2015中运行ASPX页面浏览，出现错误：<br />\n<h3 style=\"font-size:1.4em;margin:10px 0px 0px;color:#cc0000;font-family:verdana, arial, helvetica, sans-serif;line-height:normal;\">HTTP Error 500.23 - Internal Server Error</h3>\n<h4 style=\"font-size:1.2em;margin:10px 0px 5px;font-family:verdana, arial, helvetica, sans-serif;line-height:normal;\">检测到在集成的托管管道模式下不适用的 ASP.NET 设置。</h4>\n<div><br />\n网上搜索了一下解决方法，发现中文的都搜索不到，后来终于在 stackoverflow 中找到了，<br />\n地址：&nbsp;http://stackoverflow.com/questions/14925383/http-error-500-23-internal-server-error-local-iis-web-server<br />\n<br />\n解决方法在web.config中加入&nbsp;<br />\nxml<br />\n<div>&nbsp; &lt;system.webServer&gt;</div>\n<div>&nbsp; &nbsp; &lt;validation validateIntegratedModeConfiguration=\"false\"/&gt;</div>\n<div>&nbsp; &lt;/system.webServer&gt;</div>\n<br />\n /xml<br />\n<br />\n即可，唉。。看来还是得学好英文才行呀。。。<br />\n<br />\n<br />\n<br />\n</div>\n	                          ',NULL,245,'0101','ASP.NET',NULL,0),(1157,'2016-08-04 15:11:17','ASP.NET MVC中全局异常处理','以前不知道从哪里找到的处理全局异常的，觉得蛮好用就记下来了。<br />\n<br />\n1, 建立MyExecptionAttribute.cs类，写入如下代码：<br />\nc#<br />\nusing System;<br />\nusing System.Collections.Generic;<br />\nusing System.Linq;<br />\nusing System.Web;<br />\nusing System.Web.Mvc;<br />\n<br />\nnamespace Niunan.MVCShop.Code<br />\n{<br />\n&nbsp;&nbsp;&nbsp; public class MyExecptionAttribute : HandleErrorAttribute<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static Queue&lt;Exception&gt; ExceptionQueue = new Queue&lt;Exception&gt;();//创建队列.<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override void OnException(ExceptionContext filterContext)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //将异常信息入队.<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExceptionQueue.Enqueue(filterContext.Exception);//将异常信息入队.<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //filterContext.HttpContext.Response.Redirect(\"/error.html\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.OnException(filterContext);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; }<br />\n}<br />\n/c#<br />\n<br />\n2，在Global文件代码如下：<br />\nc#<br />\nusing Niunan.Utility;<br />\nusing System;<br />\nusing System.Collections.Generic;<br />\nusing System.Linq;<br />\nusing System.Threading;<br />\nusing System.Web;<br />\nusing System.Web.Http;<br />\nusing System.Web.Mvc;<br />\nusing System.Web.Routing;<br />\n<br />\nnamespace Niunan.MVCShop<br />\n{<br />\n&nbsp;&nbsp;&nbsp; // 注意: 有关启用 IIS6 或 IIS7 经典模式的说明，<br />\n&nbsp;&nbsp;&nbsp; // 请访问 http://;.microsoft.com/?LinkId=9394801<br />\n&nbsp;&nbsp;&nbsp; public class MvcApplication : System.Web.HttpApplication<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected void Application_Start()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AreaRegistration.RegisterAllAreas();<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebApiConfig.Register(GlobalConfiguration.Configuration); <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RouteConfig.RegisterRoutes(RouteTable.Routes);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GlobalFilters.Filters.Add(new Code.MyExecptionAttribute()); //NET4建立的项目的话则是在APP_Stars/ConfigFilter.cs中<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //通过线程开启一个线程，然后不停的从队列中或数据<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string filePath = Server.MapPath(\"/Log/\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThreadPool.QueueUserWorkItem(o =&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (true)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Code.MyExecptionAttribute.ExceptionQueue.Count &gt; 0)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exception ex = Code.MyExecptionAttribute.ExceptionQueue.Dequeue();//从队列中拿出数据<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ex != null)<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tool.TxtLog(ex.ToString(), filePath + DateTime.Now.ToString(\"yyyyMMdd\")+\".txt\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thread.Sleep(30);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thread.Sleep(30);//避免了CPU空转。<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code.MyExecptionAttribute.ExceptionQueue.Enqueue(ex);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }, filePath);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; }<br />\n}<br />\n/c#<br />\n<br />\n3， 记录日志那用到了牛腩公用类库里的写文本文件的方法，用的时候记得导入就好	                          ',NULL,189,'0101','ASP.NET',NULL,0),(1156,'2016-07-30 09:47:52','浏览器中beforeunload的使用','打开一些慢的网站的时候只见浏览器在不停转圈，但是页面还停留在当前页面的，有些网站的效果是你点击链接要跳到另一个页面的时候，在当前页面弹出一个框提示“正在加载中....”， 用到了浏览器的beforeunload事件，自己试了一下，以下代码可运行<br />\nhtml<br />\n<div>&lt;!DOCTYPE html&gt;</div>\n<div>&lt;html lang=\"en\"&gt;</div>\n<div>&lt;head&gt;</div>\n<div>&nbsp; &nbsp; &lt;meta charset=\"UTF-8\"&gt;</div>\n<div>&nbsp; &nbsp; &lt;title&gt;Document&lt;/title&gt; &nbsp;</div>\n<div>&nbsp; &nbsp; &lt;script src=\"http://cdn.bootcss.com/jquery/1.9.0/jquery.min.js\"&gt;&lt;/script&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;script src=\"layer/layer.js\"&gt;&lt;/script&gt;</div>\n<div>&nbsp; &nbsp; &lt;script language=\"javascript\"&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; $(window).bind(&#039;beforeunload&#039;,function(){&nbsp;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; layer.msg(&#039;正在拼命加载！！！&#039;, {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time: 0 //不自动关闭&nbsp;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }); &nbsp;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; });</div>\n<div>&nbsp; &nbsp; &lt;/script&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp; &nbsp; &lt;a href=&#039;http://niunan.net&#039;&gt;跳到百度&lt;/a&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n',NULL,153,'0126','WEB',NULL,0),(1155,'2016-07-23 18:38:41','sql查询语句中用like中用参数化查询','<div class=\"content markdown bubble fancy-overflow\" style=\"color:#000000;max-height:100000px;\"><p class=\"ng-scope\">今天终于学会怎么在like中用参数化查询啦。。哈哈。。再也不用担心sql注入了。。。</p>\n <p class=\"ng-scope\"><br />\n</p>\n <p class=\"ng-scope\"><img src=\"http://blog.niunan.net/upload/20160723183830.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160723183838.jpg\" alt=\"\" border=\"0\" /><br />\n</p>\n</div>\n	                          ',NULL,173,'0106','SQL',NULL,0),(1154,'2016-05-29 22:25:55','WIN10中运行ASP','一个项目用ASP做的，想在WIN中IIS建立网站部署起来，开始怎么弄都不行，运行总是出现那句英文，后来才知道要在IIS中的网站的ASP选项中的调试属性中把发送错误到到浏览器打开，这样才能发现程序报错，报错发现是ODBC读access的程序没有找到，后来发现只要在IIS中把32位应用 程序 打开就行了。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,244,'0103','随笔',NULL,0),(1153,'2016-05-12 23:56:52','.NET执行SQL插入时间的问题','错误描述：<br />\n　　一个项目，源码是BOSS给的，部署到网上了，运行没有问题，可是在本地运行，就会有问题，问题在于往一些表插入记录的时候，本地不管怎么样都插入不了，而网上就可以插入，都是相同的一份代码<br />\n<br />\n解决：<br />\n　　花了一晚上调试，终于搞清楚 ，如下图：<br />\n<img src=\"http://blog.niunan.net/upload/20160512234838.png\" alt=\"\" border=\"0\" /><br />\n本地程序执行的SQL语句是上面那样的，时间 格式 错误，所以插入失败，整个事务回滚，所以表中没有记录，<br />\n因为我的系统是WIN10，日期格式里默认有星期几的，在源码里他使用的是DateTime.Now.ToString()，所以转出来的格式会有问题了，改为DateTime.Now.ToString(\"yyyy-MM-dd HH:mm:ss\") 即可<br />\n<br />\n结论：<br />\n　　看别人的源码真烦啊。。还没有注释。。。以后别人找我要源码的话我也得把源码中的注释 都删除掉才行了。。。<br />\n	                          ',NULL,237,'0121','.NET',NULL,0),(1152,'2016-05-07 13:39:53','sqlite数据库部署到服务器上的问题','试了一天。。。本地测试是好的（WIN10 64位+VS2015），部署到服务器上（WIN2008 32位+IIS6） 总是不行。。按网上说了什么不要BUNDLE的，加入X86X64目录再放那个SQLite.Interop.dll到不同的目录，还是不行，还是出错，最后修改了应用程序池的标识里的预定义账户为本地系统就好了。。还有我按网上做的IIS6运行32位模式的做了结果是没有任何反应的，可能是我的服务器本来就是32位的原因的吧！！！	                          ',NULL,189,'0125','sqlite',NULL,0),(1151,'2016-05-01 21:06:20','我用Xamarin开发android应用，应用在真机上一打开就退出了 ','在解决方案管理器的项目上右键--属性--Android Options--Packaging将Use Shared Runtime前面的对勾取消即可。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,170,'0124','xamarin',NULL,0),(1150,'2016-04-20 13:50:35','牛腩讨论组上课','心血来潮在讨论组中开共享屏幕上课，详情：http://niunan.net/video_show.aspx?id=62	                          ',NULL,195,'0103','随笔',NULL,0),(1149,'2016-04-13 12:53:39','vs中批量删除注释	','<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/xiexiaokui/archive/2011/05/27/2060339.html\">&nbsp;</a> <div id=\"cnblogs_post_body\"><div><div>批量删除: 按ctrl+H 选上正则表达式</div>\n<div>Find what: //.*\n</div>\n<div>Replace with: (空)</div>\n<div>点replace all就行了</div>\n</div>\n</div>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',NULL,199,'0123','vs',NULL,0),(1148,'2016-03-22 13:28:51','HTML5背景音乐的暂停与播放','HTML代码：<br />\n&nbsp;&nbsp;&nbsp; &lt;audio id=\"myaudio\" loop=\"loop\" preload=\"auto\" autoplay=\"autoplay\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;source src=\"music/纯音乐%20-%20在那遥远的地方%20-%20纯音乐版.mp3\" type=\"audio/ogg\" /&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;source src=\"music/纯音乐%20-%20在那遥远的地方%20-%20纯音乐版.mp3\" type=\"audio/mp3\" /&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/audio&gt;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img onclick=\"swap_music()\" src=\"/images/icon_music.png\" style=\"height:30px; vertical-align:middle;\" /&gt;<br />\n<br />\nJS代码：<br />\n&nbsp;//背景音乐停止与播放<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function swap_music() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var oAudio = document.getElementById(&#039;myaudio&#039;);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oAudio.paused) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oAudio.play(); <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oAudio.pause(); <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }	                          ',NULL,171,'0122','HTML5',NULL,0),(1147,'2016-03-16 00:12:36','整合百度推送碰到的问题','<span style=\"font-size:16px;\">今天在整合百度推送到我的.NET项目中的时候发现，百度官网上下的.NET DEMO是4.5版本的，但是WIN2003安装不了.NET 4.5的， 然后又从网上搜索到4.0版本的整合进项目中了，结果在测试的时候总是出错，但是用.NET 4.5版本的DEMO测试就不会出错， 仔细看了一下，发现是参数问题。。.NET 4.5里的参数是msg和msg_type，</span><br />\n<span style=\"font-size:16px;\">而.NET 4.0里的参数是message和message_type，</span><span style=\"color:#f10b00;font-size:16px;\"> 我全改为msg和msg_type就好了。。。</span><br />\n<span style=\"font-size:16px;\">然后我上去官网看文档，发现竟然文档里写的又是message， 快晕死了。。。</span>',NULL,160,'0121','.NET',NULL,0),(1146,'2016-03-14 22:34:27','同一个界面内取微信的OPENID和调用微信的分享接口','<span style=\"font-size:18px;\">步骤如下，</span><br />\n<span style=\"font-size:18px;\">1：判断URL是否有CODE参数传入，没有则拼接那个微信跳转连接，然后redirect</span><br />\n<span style=\"font-size:18px;\">2：有CODE传入，调用微信接口，根据code获取openid和access_token，注意这一步取到的token是没用的，这里已经取到openid了，下面开始取微信JS SDK的接口注入配置</span><br />\n<span style=\"font-size:18px;\">3：调用微信接口根据appid和secrect取access_token</span><br />\n<span style=\"font-size:18px;\">4：用上一步得到的access_token再调用微信接口 根据access_token 取得tikect</span><br />\n<span style=\"font-size:18px;\">5：用上一步得到的tikect进行微信 JS SDK接口注入配置的签名，需要签名的URL必须是通过程序自己来获取，如.NET中的Request.Url.Abslute， 自已定死URL的话很容易产生签名失败的错误</span><br />\n<br />\n<span style=\"color:#ff483f;font-size:18px;\">注：以上要注意的就是第4步中的access_token必须由第3步中取得，不要用第2步中得到的token</span><br />\n<br />\n',NULL,162,'0103','随笔',NULL,0),(1145,'2016-03-13 20:09:05','本地CS的导出xls代码段','<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">用到之前发的NPOI的那个工具类库&nbsp;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">//导出</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">private void btnExport_Click(object sender, EventArgs e)</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">{</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">saveFileDialog1.ShowDialog();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">// MessageBox.Show(\"保存路径：\"+saveFileDialog1.FileName);</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">// 填充資料（由讀者自行撰寫）&nbsp;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">System.Data.DataTable dt = new DataTable();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Columns.Add(\"条码\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Columns.Add(\"品名\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Columns.Add(\"库存\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Columns.Add(\"盘点数\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Columns.Add(\"盘点中的销售数\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">foreach (var item in list)</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">{</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">DataRow row = dt.NewRow();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">row\"条码\" = item.tiaoma;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">row\"品名\" = item.proname;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">row\"库存\" = item.kc;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">row\"盘点数\" = item.pds;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">row\"盘点中的销售数\" = 0;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">dt.Rows.Add(row);</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">}</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">// 產生 Excel 資料流。&nbsp;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">MemoryStream ms = DataTableRenderToExcel.RenderDataTableToExcel(dt) as MemoryStream;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">// 輸出檔案。&nbsp;</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">FileStream fs = new FileStream(saveFileDialog1.FileName, FileMode.Create);</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">fs.Write(ms.ToArray(),0,(int)ms.Length);</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">fs.Flush();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">fs.Close();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">fs.Dispose();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">ms.Close();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">ms.Dispose();</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">MessageBox.Show(\"文件保存成功！\");</span><br style=\"box-sizing:content-box;font-family:微软雅黑;color:#333333;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:微软雅黑;font-size:14px;line-height:24px;\">}</span>	                          ',NULL,135,'0120','c#',NULL,0),(1144,'2016-03-11 13:19:36','服务器上装filezilla server后，本地的ftp客户端连接不上去','公司一台服务器，上面装了filezilla server后，按平常配置好了，但是在本地用FTP客户端不管怎么连接都连接不上，本地FTP客户端总提示连接失败，远程filezilla server的界面也没有提示有人连接， 仔细看了一下，原来那台服务器上的IIS中已经建立了FTP站点了，原来如此，把filezilla server关掉，然后 进IIS上的FTP站点新建一个虚拟目录指向网站目录，然后 在本地FTP客户端中用户名和密码就用远程桌面的administrator登录， 登录后显示空白， 在地址栏上加上 /虚拟目录名/ 即可看到<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160311131925.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160311131933.png\" alt=\"\" border=\"0\" /><br />\n<br />\n',NULL,126,'0103','随笔',NULL,0),(1143,'2016-03-10 15:21:16','微信公众号支付安卓和WP支付成功，苹果不能支付！','花了几天时间，终于搞好了，代码是从官网上下的.NET DEMO的代码改的，测试的时候发现安卓和WP手机都能进行支付，但是苹果的怎么支付都支付不了，主要是在下面这个界面<br />\n<img width=\"500\" src=\"http://blog.niunan.net/upload/20160310151741.png\" alt=\"\" border=\"0\" /><br />\n<br />\n点支付按钮就是苹果支付不了，其他手机都能支付。搞了几天，本来应该是昨天应该搞出来的，但昨天不知道怎么回事同事的iphone加上电脑上的finddler 就是抓 不了包。 今天又再设置了一次finddler， 发现又 可以抓 到包了。。。结果在抓包的时候看生成的支付页面的代码，才发现问题：<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160310151958.png\" width=\"500\" alt=\"\" border=\"0\" /><br />\n如图， 那个DEMO生成的支付按钮是sutmit的，导致页面回发了，应该把他改为button就OK了<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160310152052.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20160310152109.jpg\" width=\"500\" alt=\"\" border=\"0\" />',NULL,169,'0119','微信支付',NULL,0),(1142,'2016-03-05 21:47:11','微信H5支付.NET版本备忘','<img src=\"http://blog.niunan.net/upload/20160305214708.png\" alt=\"\" border=\"0\" />	                          ',NULL,154,'0101','ASP.NET',NULL,0),(1141,'2016-03-05 21:44:57','PHP：Fatal error: Class &#039;COM&#039; not found in … 的处理办法  ','把现在的这个PHP博客移到阿里云上。。。<br />\n移上去后打开页面显示&nbsp;Fatal error: Class &#039;COM&#039; not found in 。。。的错误，按网上的解决方法：<br />\n<br />\n<div><span style=\"background-color:#ffffff;\">1、首先在windows的“服务”里面检查COM+服务是否已经启动。如果未启动，请启动它。</span></div>\n<div><span style=\"background-color:#ffffff;\">大概是该服务：Windows Management Instrumentation</span></div>\n<div><br />\n</div>\n<div><span style=\"background-color:#ffffff;\">2、检查php目录ext文件夹下面php_com_dotnet.dll是否存在。（顺便说一下，ext通常作为php程序的扩展目录，在安装php的时候一般已经设置好。否则就应该不仅仅报主题所说的错咯。）</span></div>\n<div><br />\n</div>\n<div><span style=\"background-color:#ffffff;\">3、如果没问题，在php.ini里面加入以下语句：</span></div>\n<div><br />\n</div>\n<div><span style=\"background-color:#ffffff;\">PHP_COM_DOTNET</span></div>\n<div><span style=\"background-color:#ffffff;\">extension=php_com_dotnet.dll</span></div>\n<div><br />\n</div>\n<div><span style=\"background-color:#ffffff;\">4、php.ini中设置</span></div>\n<div><span style=\"background-color:#ffffff;\">com.allow_dcom = true</span></div>\n<wbr><br />\n<div><span style=\"background-color:#ffffff;\">5.PHP版本</span></div>\n<div><span style=\"background-color:#ffffff;\">PHP 5.4.5以前的版本，只需要在php.ini中把com.allow_dcom = true打开就可以了，但是5.4.5版本以后，PHP把com/dotnet 模块集成到了一个单独的扩展中，所以需要在php.ini中加一行扩展extension=php_com_dotnet.dll，是加一行，不是打开，默认配置文件中没有这一行的，然后重启IIS或Apache，再次运行就正常了！<br />\n<br />\n<br />\n<span style=\"font-size:18px;\"><b>按以上方法设置了没有效果，搜索后在&nbsp;</b></span><span style=\"font-size:18px;line-height:27px;\"><b><a href=\"http://stackoverflow.com/questions/18240521/php-fatal-error-class-com-not-found\" target=\"_blank\">http://stackoverflow.com/questions/18240521/php-fatal-error-class-com-not-found</a>&nbsp;找到解决方法，按以上设置以外还得把PHP.ini中的&nbsp;</b></span></span><span style=\"font-family:consolas, menlo, monaco, &#039;lucida console&#039;, &#039;liberation mono&#039;, &#039;dejavu sans mono&#039;, &#039;bitstream vera sans mono&#039;, &#039;courier new&#039;, monospace, sans-serif;white-space:inherit;color:#222426;font-size:13px;line-height:1.5;background-color:#eeeeee;\">extension_dir = \"ext\" 给注释掉，然后&nbsp;</span><span style=\"font-family:consolas, menlo, monaco, &#039;lucida console&#039;, &#039;liberation mono&#039;, &#039;dejavu sans mono&#039;, &#039;bitstream vera sans mono&#039;, &#039;courier new&#039;, monospace, sans-serif;white-space:inherit;color:#222426;font-size:13px;line-height:1.5;background-color:#eeeeee;\">enable_dl = On 设置好，原来是Off的，重启IIS后就OK了，果然是国外的技术比较牛！</span><span style=\"font-family:consolas, menlo, monaco, &#039;lucida console&#039;, &#039;liberation mono&#039;, &#039;dejavu sans mono&#039;, &#039;bitstream vera sans mono&#039;, &#039;courier new&#039;, monospace, sans-serif;white-space:inherit;color:#222426;font-size:13px;line-height:1.5;background-color:#eeeeee;\"><br />\n</span><span style=\"background-color:#ffffff;\"><br />\n<br />\n<br />\n</span></div>\n',NULL,127,'0102','PHP',NULL,0),(1140,'2016-02-15 21:55:10','查询新闻上一条下一条的相关SQL语句','<div>以前记录的那个查询上一条下一条的SQL语句逻辑上有点错误，刚刚分析了一晚上，终于得出如下SQL语句了，这回应该是正确的吧！！！<br />\n<br />\n&nbsp;<img alt=\"\" src=\"http://blog.niunan.net/upload/20160215215505.png\" border=\"0\" /></div>\n<div>&nbsp;&nbsp; </div>\n',NULL,236,'0115','MSSQL',NULL,0),(1139,'2016-02-11 23:59:00','jquery禁止右键和禁止选择文本','$(function(){<br />\n　　&nbsp;//屏蔽鼠标右键<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $(document).bind(\"contextmenu selectstart\",function(event){</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div>\n})<br />\n<br />\n禁止选择文本的话则直接在body标签上写&nbsp;<br />\n&nbsp;&lt;body onselectstart=\"return false;\" style=\"-moz-user-select:none;\"&gt;<br />\n<br />\n<br />\n',NULL,147,'0110','jQuery',NULL,0),(1138,'2016-02-10 12:07:54','“返回顶部”的JQUERY动画效果代码','<div>//返回顶部</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">	</span>$(\"#scroll_to_top\").click(function(){</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">	</span> &nbsp; $(\"html,body\").animate({scrollTop:\"0px\"},500);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">	</span>});<br />\n<br />\n<br />\n以上效果为点击后页面会在500毫秒内滚动到顶部<br />\n<br />\n<br />\n</div>\n	                          ',NULL,165,'0110','jQuery',NULL,0),(1137,'2016-02-01 22:20:06','手机用支付宝付款成功后通知页面isSign=false的问题','今天在做一个项目 。手机APP端用支付宝付款成功了，通知到我的notify.aspx了，但是isSign=false，试了几次都是这样，后来发现手机支付用的是RSA，但是我的页面的验证用的是MD5，所以出错，页面的验证改为用RSA的就行了。相应的代码在支付宝提供的手机端的DEMO中有',NULL,235,'0101','ASP.NET',NULL,0),(1136,'2016-01-25 17:11:04','C#打开收银机的钱箱代码','c#<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //弹出钱箱<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void button4_Click(object sender, EventArgs e)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prnPort = txtport.Text.Trim();&nbsp; //LPT1<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string str = TXT2.Text.Trim();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IntPtr iHandle = CreateFile(prnPort, 0x40000000, 0, 0, OPEN_EXISTING, 0, 0);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (iHandle.ToInt32() == -1)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show( \"打开\"+ prnPort + \"失败\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //27,112,0,128,128<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileStream fs = new FileStream(iHandle, FileAccess.ReadWrite);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StreamWriter sw = new StreamWriter(fs, System.Text.Encoding.Default);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sw.Write(((char)27).ToString() + \"p\" + ((char)0).ToString() + ((char)128).ToString() + ((char)128).ToString());<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; sw.Write(str);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sw.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fs.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(\"执行成功！\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }/c#<br />\n<br />\n这是我的。。测试成功 。。不同品牌的钱箱的打开代码不一样的。。 。我这个是商务通收银机， 字母p的ascii码值正好是112<br />\n<br />\n	                          ',NULL,282,'0101','ASP.NET',NULL,0),(1135,'2016-01-06 23:04:07','android post提交数据','<img src=\"http://blog.niunan.net/upload/20160106230402.png\" alt=\"\" border=\"0\" />	                          ',NULL,249,'0114','android',NULL,0),(1134,'2016-01-05 20:05:26','从某网址get数据显示到edittext控件上换行符的问题！','<img src=\"http://blog.niunan.net/upload/20160105200521.jpg\" alt=\"\" border=\"0\" />	                          ',NULL,198,'0114','android',NULL,0),(1133,'2015-11-28 21:16:37','又发现一个visual studio 2015的坑啊','<ul class=\"list\" id=\"ulcommentlist\"><li class=\"entry\"><p>又发现一个visual studio 2015的坑啊。。。我的后台管理的目录名称叫@duck， 但是在新版VS2015中打开项目后编译，出现错误：	Error opening response file &#039;。。。。。<br />\n晕。。编译的目录名中不能有@符号啊啊啊。。在之前都是可以的。。郁闷死啊。啊啊。。又得全部改名。。</p>\n</li>\n</ul>\n	                          ',NULL,279,'0103','随笔',NULL,0),(1132,'2015-11-22 23:11:10','surface pro4 i5/8g/256g 国行专业版开箱','<span style=\"font-size:18px;\">2015 年 11 月 18 日 上午就下单付款了， 然后不停的刷啊刷物流信息</span><br />\n<span style=\"font-size:18px;\">2015 年 11 月 22 日 下午3点左右到了。。感谢祖宗保佑我的SP4一切顺利。。。。</span><br />\n<img src=\"http://blog.niunan.net/upload/surfacepro4/01.png\" width=\"600\" /><span style=\"font-size:18px;\"> </span><br />\n<span style=\"font-size:18px;\">    </span><img src=\"http://blog.niunan.net/upload/surfacepro4/02.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/03.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">开始泡面时代。。。。起码有5年没吃过了。。。</span><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/04.png\" width=\"600\" /><span style=\"font-size:18px;\"> </span><br />\n<span style=\"font-size:18px;\">    </span><img src=\"http://blog.niunan.net/upload/surfacepro4/05.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/06.png\" width=\"600\" /><br />\n<br />\n<span style=\"font-size:18px;\">查了一下时效，开始以为是周一才到的。。好不伤心。。。</span><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/07.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/08.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/09.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/10.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/11.png\" width=\"600\" /><br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/12.png\" width=\"600\" /><br />\n<br />\n<span style=\"font-size:18px;\">出门前先烧柱香，保佑不出问题！！！</span><br />\n<br />\n<span style=\"font-size:18px;\">     </span><img src=\"http://blog.niunan.net/upload/surfacepro4/13.png\" width=\"600\" /><br />\n<br />\n<span style=\"font-size:18px;\">具体的开箱照没有拍，因为一直都是在录视频的。。已经把视频传到优酷上了，40分钟</span><br />\n<br />\n<a href=\"http://u.youku.com/meilalalian \" target=\"_blank\"><span style=\"font-size:18px;\">http://u.youku.com/meilalalian&nbsp;</span><br />\n<br />\n</a><span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">最后一张图。。。</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">京东买 的绿联MINI转HDMI/SUB/DVI拼接头用上了。。。外接显示器和机械键盘鼠标，显示器液晶是1080P，反正用得很爽。。还没有升级 TH2，检测不到。。先用着先。。先把工作用的软件都装上先。。</span><br />\n<br />\n<span style=\"font-size:18px;\">    </span><img src=\"http://blog.niunan.net/upload/surfacepro4/14.png\" width=\"600\" /><span style=\"font-size:18px;\"> </span><br />\n<br />\n<span style=\"font-size:18px;\">笔头特写，用lumia 640xl拍的。。感觉还是很清楚的。。</span><br />\n<br />\n<span style=\"font-size:18px;\">    </span><img src=\"http://blog.niunan.net/upload/surfacepro4/15.png\" width=\"600\" /><br />\n<br />\n<br />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">总结：</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">1、感谢祖宗保佑我的SP4开机不死机，升级固件不蓝屏，以后出门必须先烧香！！！</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">2、翘屏问题是越看越觉得翘，感觉主要都是个人的心里作用，反正我是能用就好，先烤机几天看看怎么样</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">3、发热问题，还没有下游戏，反正玩玩了摸摸背后只是觉得有一点点暖。</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">4、续航问题，本屌丝.NET撸码员，平时都是插电源工作，不关注续航</span><br style=\"box-sizing:content-box;color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:14px;line-height:24px;\" />\n<span style=\"color:#333333;font-family:&#039;helvetica neue&#039;, helvetica, arial, sans-serif;font-size:18px;line-height:24px;\">5、没有了</span><div><font color=\"#333333\" face=\"Helvetica Neue, Helvetica, Arial, sans-serif\"><span style=\"font-size:14px;line-height:24px;\"><br />\n</span></font><br />\n      </div>\n',NULL,329,'0103','随笔',NULL,0),(1131,'2015-10-10 21:17:24','GIT简记','git init<br />\ngit remote add origin http://xxx.com/xxx.git<br />\ngit pull origin master<br />\ngit status<br />\ngit add .<br />\ngit commit -m &#039;修改日志&#039;<br />\ngit push origin master<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,275,'0103','随笔',NULL,0),(1130,'2015-09-22 22:28:24','ASP.NET写APP接口中的接收二进制图片数据','代码：<br />\n<img src=\"http://blog.niunan.net/upload/20150922222721.png\" alt=\"\" border=\"0\" /><br />\n<br />\n	                          <br />\n测试：<br />\n<img src=\"http://blog.niunan.net/upload/20150922222744.png\" alt=\"\" border=\"0\" />',NULL,481,'0101','ASP.NET',NULL,0),(1129,'2015-09-17 15:39:01','MAC MINI开箱！！！','攒钱买MAC MINI学ios,android,unity3d,node.js,python,;,angularjs,......<br />\n狠下心直接官网全款购买， I5,8G,256G SSD， ￥6460， 10号下单，17号送到，下面是开箱照片。<br />\n<br />\n<img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/01.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/02.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/03.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/04.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/05.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/06.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/07.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/08.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/09.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/10.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/11.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/12.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/13.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/14.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/15.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/16.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/17.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/18.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/19.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/20.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/21.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/22.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/23.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/24.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/25.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/26.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/27.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/28.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/29.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/30.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/31.jpg\" /><img style=\"width:600px;\" src=\"http://niunan.net/images/macmini/32.jpg\" /><br />\n<br />\n没有发现传说中的1080P液晶 上MAC 字体发虚的问题。。字体很清楚。。。<br />\n<br />\n接下来该装软件了，visual studio code, xcode, unity3d, android studion, node.js, ;....自带了python 2.7.1....<br />\n<br />\n<br />\n',NULL,935,'0103','随笔',NULL,0),(1128,'2015-09-09 12:31:53','支付宝接口支付成功，返回验证失败！','问题：支付成功，返回验证失败<br />\n<br />\n日志： responseTxt=错误：The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. isSign=True <br />\n<br />\n支付宝技术客服回复：<br />\nSSL证书升级： 公告https://cshall.alipay.com/enterprise/help_detail.htm?help_id=565553ssl证书升级，如果是mapi系统的遇到问题 ，不确定是否是证书问题，可以按照以下方法排查： 让商户ping mapi.alipay.com， 如果IP地址是 (110.75.146.31) 商户按证书签名升级 公告说明进行测试，如果测试不通过。 公告：https://cshall.alipay.com/enterprise/help_detail.htm?help_id=565553解决方法： .NET 查看版本方法 在浏览器中，输入 javascript:alert(navigator.userAgent); 看.NET CLR 后面带的版本号最高到哪个数字， 最低支持 3.5 SP1 windows服务器，需要另外安装一个补丁（修复数字签名拒绝服务漏洞），微软官方下载地址：https://technet.microsoft.com/en- us/library/security/ms13-095.aspx	                          ',NULL,820,'0118','支付宝',NULL,0),(1127,'2015-08-14 12:13:07','MSSQL中判断一个表是否具体自增标识列','<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">1、判段一个表是否具有标识列</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">可以使用 OBJECTPROPERTY 函数确定一个表是否具有 IDENTITY（标识）列,用法:</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">Select OBJECTPROPERTY(OBJECT_ID(&#039;表名&#039;),&#039;TableHasIdentity&#039;)</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">如果有，则返回1,否则返回0</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">2、判断某列是否是标识列</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">可使用 COLUMNPROPERTY 函数确定 某列是否具有IDENTITY 属性,用法</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">SELECT COLUMNPROPERTY( OBJECT_ID(&#039;表名&#039;),&#039;列名&#039;,&#039;IsIdentity&#039;)</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">如果该列为标识列，则返回1,否则返回0</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">3、查询某表标识列的列名</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">SQL Server中没有现成的函数实现此功能，实现的SQL语句如下</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.columns</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">WHERE TABLE_NAME=&#039;表名&#039; AND COLUMNPROPERTY(&nbsp;</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n<span style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\">OBJECT_ID(&#039;表名&#039;),COLUMN_NAME,&#039;IsIdentity&#039;)=1</span><br style=\"font-family:tahoma, arial, helvetica, sans-serif, simsun;font-size:14px;line-height:26.6000003814697px;\" />\n',NULL,324,'0115','MSSQL',NULL,0),(1126,'2015-07-19 13:29:29','手机网页调试','用cordova做的小程序运行在手机上，<br />\n<div>&nbsp;然后手机连接上usb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />\n然后在Pc chrome 浏览器地址栏输入&nbsp;&nbsp;chrome://inspect/#devices<br />\n然后手机随便打开一个网页<br />\n你会发现可以远程调试了<br />\n包括调试微信&nbsp;</div>\n',NULL,291,'0103','随笔',NULL,0),(1125,'2015-07-13 13:43:05','cordova版《牛腩便签》制作随笔','<br />\n功能：简单的便签，一个文本框，用户输入后保存到数据库中，点刷新按钮即从数据库中取数据显示出来<br />\n<br />\n技术：前端ionic，后端asp.net，数据库mssql<br />\n<br />\n技术要点：<br />\n<div>1. 取数据用$http.jsonp来取</div>\n<div>2. 存数据用$http.post来存</div>\n<div>3. ashx中加入context.Response.AddHeader(\"Access-Control-Allow-Origin\", \"*\");</div>\n<div>4. ashx中取POST提交的数据应该中context. &nbsp;Request.InputStream中取，如果angularjs传过来的是JSON对象，那还得在Ashx中用JSON.NET转为对应的实体类</div>\n<div>5. 提交的时候用encodeURIComponent(body)，ashx中用context.Server.UrlDecode(reqtxt),要不然中文会出现乱码</div>\n<div>6. 以上用于提交大量数据，少量数据的话随便用用URL传参过去就可以了。<br />\n<br />\n</div>\n<div>关键代码：<br />\n<img src=\"http://niunan.net/images/demo/angularjs/a1.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/images/demo/angularjs/a2.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/images/demo/angularjs/a3.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/images/demo/angularjs/a4.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/images/demo/angularjs/a5.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n效果图：<br />\n<img src=\"http://niunan.net/images/demo/angularjs/a6.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/images/demo/angularjs/a7.png\" width=\"700\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n视频：<a href=\"http://www.youku.com/playlist_show/id_25834111.html\" target=\"_blank\">http://www.youku.com/playlist_show/id_25834111.html</a> （未录制，计划中）<br />\n<br />\n广告：<a href=\"http://niunan888.taobao.com\" target=\"_blank\">http://niunan888.taobao.com</a><br />\n<br />\n<br />\n<br />\n</div>\n	                          ',NULL,363,'0103','随笔',NULL,0),(1124,'2015-07-08 14:00:54','IE10、IE11出现“__doPostBack未定义”的解决办法','NUGET中搜索 App_BrowsersUpdate 安装后即可',NULL,260,'0101','ASP.NET',NULL,0),(1123,'2015-05-08 12:35:36','牛腩学mono for android视频录制完毕','牛腩学mono for android视频录制完毕,总得来说录得不尽如人意,免费的xamarin开发限制太大了,破解版又限于人品问题安装不了,唉,<br />\n优酷试看:&nbsp;http://www.youku.com/playlist_show/id_19539679.html<br />\n赞助购买:http://niunan888.taobao.com<br />\n<br />\n<img src=\"http://niunan.net/upload/image/20150507/20150507234549_4920.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n下一部视频录制什么内容的还没有考虑好,可以在下面留言,收费也是在100以内.',NULL,1283,'0103','随笔',NULL,0),(1122,'2015-04-29 21:45:16','自己开发的第一个可用的WP应用程序','买了lumia 640xl，正在学WP开发，不能不说WP应用真的是.....而且最主要的五笔输入法和通话录音没有。。。唉。。等WIN10出来看看怎么样吧。。。<br />\n<b>开发原因</b>：起点WP版不显示小说的最新章节名称，所以想自己开发个小程序随时可以看到关注的小说的最新章节。<br />\n<img width=\"500\" src=\"http://blog.niunan.net/upload/20150429213833.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<b>开发思路</b>: 根据小说介绍页的URL地址直接把整个HTML源码抓下来,然后正则分析出其中的最新章节名称<br />\n<br />\n<b>软件图片:</b><br />\n<br />\n<img width=\"700\" src=\"http://blog.niunan.net/upload/20150429214130.png\" alt=\"\" border=\"0\" /><br />\n<br />\n刚刚开始学...还有很多不会的..这个控制也是网上搜索了一下才找到的用法...	                          ',NULL,394,'0117','WP开发',NULL,0),(1121,'2015-04-24 14:11:12','lumia640xl开箱','	           	21号官网下单，本来想在京东要的，不过搜索不到，后来才发现原来得搜索 LUMIA 才行。。不过京东的只送耳机 。。。<br />\n<img src=\"http://blog.niunan.net/upload/20150423150854.gif\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n顺风变慢啊。。想当年诺记官网 2699元 土豪金E72 ，第二天就给我从北京送到货了<br />\n<br />\n同样是21号在京东上下单的三星64G TF C10卡，22号中午就收到了。。。京东别的不说，速度就是一流<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151028.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151042.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151056.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151116.gif\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151136.png\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150423151153.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n烤了几部电影进去，速度绝对没有鼓吹的48M/秒 这么快，而且我用的还是USB3的读卡器的，只能说是比一般的卡速度快。<br />\n<br />\n先到这，等明天640XL到了再继续完善。。。。<br />\n<br />\n<span style=\"font-size:32px;\">640XL快送来。。。。</span><br />\n<br />\n终于快到了..好激动呀...<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150424085257.jpg\" width=\"500\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n<br />\n<br />\n终于来了..开箱开箱...<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150424134446.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150424134755.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20150424134818.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n耳机是三角形的盒子,我开始还以为是\"铁三角\"...<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/011.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/012.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/013.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/014.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/015.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/016.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/017.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/018.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/019.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/020.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/021.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/022.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/023.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/024.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/025.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/026.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/027.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n 到这里让我一阵担心..等了好久..至少10分钟了.那个进度一直在动.但是按下面的键都没有反馈的..开始以为是死机了的...<br />\n<br />\n进度条走动的时候接了个电话, 感觉通话还是很清楚的..不过可惜啊..找不到通话录音的功能在哪里...还是说没有这个功能?<br />\n<br />\n在接电话的时候按了下音量键,发现好像音量键有什么脱落了..吓死我了...通话完后仔细一看.原来音量键和电源键上都还贴有一张膜的..<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/028.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n通话完了发现进度条没有了.按电源键直接到锁屏界面了,再滑开锁屏,发现已经完成了..嘿嘿...<br />\n<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/029.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/640xl/030.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/640xl/031.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/640xl/032.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/033.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/034.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n对我来说单手操作是不可能滴....一个手我抓都抓不过来...<br />\n<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/035.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n虚拟按键在屏幕里.有时候经常会出现这种情况...下边的文字被虚拟按键盖住了...<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/036.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/640xl/037.jpg\" width=\"600\" alt=\"\" border=\"0\" /><br />\n<br />\n这是我随手拍的..感觉也没什么..反正照相对我来说就是拿起手机咔嚓一下,能看清楚拍的是什么就行了...<br />\n<br />\n<br />\n进入桌面后WP默认给我装的软件: &lt;我叫MT&gt;, 360手机卫士, 爱奇艺视频, 高德地图, 掌阅ireader读书, 去哪儿旅行, UC浏览器, 微信, 英雄之剑OL,..<br />\n<br />\n<br />\n首先进应用商店装上:QQ,网易云音乐,狂野飙车,IT之家,起点,贴吧..<br />\n<br />\n<br />\n然后....还能再做什么.....不知道了....继续撸码攒钱买 MAC MINI去....<br />\n<br />\n<br />\n不知道6月会不会出新的MAC MINI...<img src=\"http://www.coolxap.com/static/image/smiley/green/w_0034.gif\" border=\"0\" smilieid=\"170\" alt=\"{:5_170:}\" /><br />\n<br />\n<br />\n内存是1G的,那些YY是2G的就洗洗睡吧...<br />\n<br />\n<br />\nWP目前我发现的最严重的二个问题:<br />\n1. 不能通话录音,如果能弄个和魅族小米那样的自动通话录音就好了.我到应用商店里搜索通话录音工具也没有发现&#039;<br />\n2. 不能打五笔, 对咱五笔党来说是个悲催的事情啊..现在打字要先在脑海里把字的拼音读一遍了按键盘....语音输入也没有...小娜的语音识别非常棒啊...怎么不把他做成一个语音输入法呢....<br />\n<br />\n<br />\n<br />\n               ',NULL,714,'0103','随笔',NULL,0),(1120,'2015-02-22 13:23:41','MonoForAndroid中Bitmap位图与Base64字符串的相互转换','c#		/// &lt;summary&gt;<br />\n		/// Bitmap转为base6字符串<br />\n		/// &lt;/summary&gt;<br />\n		/// &lt;returns&gt;The string.&lt;/returns&gt;<br />\n		/// &lt;param name=\"bitmap\"&gt;Bitmap.&lt;/param&gt;<br />\n		public String bitmaptoBase64 (Android.Graphics.Bitmap bitmap)<br />\n		{<br />\n<br />\n			String str = null; <br />\n			using (var ms = new MemoryStream ()) {<br />\n				bitmap.Compress (Android.Graphics.Bitmap.CompressFormat.Jpeg, 100, ms);<br />\n				byte bitmapData = ms.ToArray (); <br />\n				str = Base64.EncodeToString (bitmapData, Base64Flags.UrlSafe); //关键 这句，urlsafe能保证通过URL传参数的时候字符是安全的<br />\n				return str;<br />\n			}<br />\n<br />\n			return \"\";<br />\n		} <br />\n<br />\n	/// &lt;summary&gt;<br />\n	/// base64字符串转为bitmap<br />\n	/// &lt;/summary&gt;<br />\n	/// &lt;returns&gt;The to bitmap.&lt;/returns&gt;<br />\n	/// &lt;param name=\"base64Data\"&gt;Base64 data.&lt;/param&gt;<br />\n		public static Bitmap base64ToBitmap(String base64Data) {  <br />\n			byte bytes = Base64.Decode(base64Data, Base64Flags.UrlSafe);  <br />\n			return BitmapFactory.DecodeByteArray(bytes, 0, bytes.Length);  <br />\n		} /c#<br />\n',NULL,411,'0116','mono',NULL,0),(1119,'2015-01-29 15:24:16','ASP.NET中把HTML导出为WORD的关键代码','c#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ActionResult ExportWord(int bodyid) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Model.JHS_UserBody ub = new DAL.JHS_UserBodyDAL().GetModel(bodyid);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ub==null)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Content(\"没有该计划书内容！\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.ContentType = \"application/msword\";<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.ContentEncoding = System.Text.UnicodeEncoding.UTF8;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Charset = \"UTF-8\";<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.AddHeader(\"Content-Disposition\", \"attachment; filename=我的创业计划书.doc\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string str = GetCYJHSBody(bodyid);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;html&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;head&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=UTF-8\"&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;meta name=ProgId content=Word.Document&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;meta name=Generator content=\"Microsoft Word 9\"&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;meta name=Originator content=\"Microsoft Word 9\"&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;style&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"#tab1,#tab2{border-collapse:collapse;min-width:600px}#tab1 td,#tab2 td{border:1px solid #808080}h2{background-color:#a9dfc2;padding:0px 20px;margin-bottom:10px}h3{padding:0px 40px}div{line-height:1.5;margin:10px 0px}\");<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;/style&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;/head&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;body style=\"width:940px; padding:10px; margin:20px auto; border:solid 1px #CCC;\"&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(str);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;/body&gt;\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;/html&gt;\");<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Flush();<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }/c#<br />\n<br />\n<h4><span style=\"color:#fe2419;\">注：HTML中如果有图片的话必须得是完全域名，如：&lt;img src=&#039;http://niunan.net/images/lo;.png&#039;/&gt;	                          </span></h4>\n',NULL,373,'0101','ASP.NET',NULL,0),(1118,'2014-12-23 23:34:46','HTML中禁止复制文本','刚刚看小说时发现的，可以全选后右键复制，但是到notepad中粘贴的时候却是粘贴不出来，看了下代码，主要是：<br />\nhtml<span class=\"html-tag\" style=\"font-family:monospace;font-size:medium;line-height:normal;white-space:pre-wrap;\">&lt;body <span class=\"html-attribute-name\">oncopy</span>=\"<span class=\"html-attribute-value\">return false;</span>\" <span class=\"html-attribute-name\">oncut</span>=\"<span class=\"html-attribute-value\">return false;</span>\"&gt;</span>/html<br />\n在body标签中加上那二个属性即可，我是在chrome浏览器下测试的，其他浏览器不知道行不行。<br />\n<br />\n<br />\n',NULL,421,'0103','随笔',NULL,0),(1117,'2014-12-04 14:14:56','MSSQL批量修改架构名称','sqldeclare @name sysname<div>declare csr1 cursor</div>\n<div>for</div>\n<div>select TABLE_NAME from INFORMATION_SCHEMA.TABLES</div>\n<div>open csr1</div>\n<div>FETCH NEXT FROM csr1 INTO @name</div>\n<div>while (@@FETCH_STATUS=0)</div>\n<div>BEGIN</div>\n<div>SET @name=&#039;旧架构名.&#039; + @name</div>\n<div>print &#039;ALTER SCHEMA 新架构名 TRANSFER &#039; + @name</div>\n<div>fetch next from csr1 into @name</div>\n<div>END</div>\n<div>CLOSE csr1</div>\nDEALLOCATE csr1/sql	                          ',NULL,471,'0115','MSSQL',NULL,0),(1116,'2014-12-03 14:09:08','不用翻墙即可更新Android SDK','群里人发的，按如下设置不用翻墙即可以更新Android SDK<br />\n<img src=\"http://blog.niunan.net/upload/20141203140839.png\" alt=\"\" border=\"0\" /><br />\n<br />\n自己试了一下，还真是可以，不过得用电信线路上才行，我换成广电线路就不能更新了！！！',NULL,512,'0114','android',NULL,0),(1115,'2014-11-17 12:08:36','64位win8.1系统安装intelhaxm','加快安卓模拟器的启动速度，需要装intelhaxm，以前win8时直接双击网上下载的exe文件就安装得了，但是win8.1的时候双击了总提示说是vt-x没有启用的，但是我看任务管理器→性能标签页那里的“虚拟化”是启用着的，奇怪的是我用cpuz检测指令集竟然没有vt-x,用<span style=\"color:#333333;font-family:arial, 宋体, sans-serif, &#039;microsoft yahei&#039;, tahoma;font-size:14px;line-height:24px;\">securable检测最右边也是NO，更郁闷的是我进BIOS里把那个vt给设置为disable以后，再进系统里看，任务管理器→性能标签页那里的“虚拟化”是禁用着的，cpuz检测指令集中竟然有了vt-x，</span><font color=\"#333333\" face=\"arial, 宋体, sans-serif, Microsoft YaHei, tahoma\"><span style=\"font-size:14px;line-height:24px;\">securable检测最右边是YES，然后再双击exe安装也还是提示安装不了，经多方搜索，终于搜索到一贴子（http://www.verydemo.com/cm.jsp?c=26&amp;u=an-zhuang-x86android-mo-ni-qi-yu-dao-de-yi-xie-wen-ti-zong-jie）<br />\nquote<br />\n</span></font><p style=\"font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\">可能是Win8安装了Hyper-V</p>\n<p style=\"font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\">安装了Hyper-V后其他进程就无法使用虚拟化技术了。</p>\n<p style=\"font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\">解决办法：</p>\n<p style=\"font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\">管理员运行cmd,输入如下命令</p>\n<ol style=\"margin:0px;padding:0px;list-style:none;font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\"><li style=\"margin:0px;padding:0px;\"><p>bcdedit /copy {current} /d \"Windows 8 - no hypervisor\"&nbsp;</p>\n</li>\n<li style=\"margin:0px;padding:0px;\"><p>bcdedit /set {这里填上一步得到的一串字符} hypervisorlaunchtype off&nbsp;</p>\n</li>\n</ol>\n<p style=\"font-family:&#039;microsoft yahei&#039;, 微软雅黑, lucida, verdana, &#039;hiragino sans gb&#039;, stheiti, &#039;wenquanyi micro hei&#039;, simsun, sans-serif;font-size:14px;line-height:24px;\">现在重启机器就有两个选项，一个是有Hyper-V的win8,一个是无Hyper-V的win8,选择无Hyper-V，然后安装IntelHaxm.exe</p>\n<font color=\"#333333\" face=\"arial, 宋体, sans-serif, Microsoft YaHei, tahoma\"><span style=\"font-size:14px;line-height:24px;\">/quote<br />\n按如上步骤解决问题！！！<br />\n<br />\n</span></font>',NULL,1197,'0103','随笔',NULL,0),(1114,'2014-11-15 21:47:25','WIN2008中部署网站后样式及JS加载不了','今天在一台刚刚装好的WIN2008上部署一个问题，一切按流程来：<br />\n① 控制面板加IIS，把.NET 3.5打勾<br />\n② 装.NET 4.0框架<br />\n③ 装MSSQL2012<br />\n④ IIS中部署网站<br />\n⑤ 修改web.config中的数据库连接字符串<br />\n⑥ 网站目录加Everyone权限<br />\n<br />\n弄好后直接输入IP浏览网站，发现网站可以运行，但是一切样式及JS都加载不了，网上都搜索不到相应的解决方案，最后自己东搞西搞才弄好，原来是在第一步添加IIS的时候，除了勾上那个.NET 3.5，还得再勾上那个\"静态内容\"，这样才能够读取到相关的样式及JS<br />\n<br />\n<br />\n<br />\n',NULL,304,'0103','随笔',NULL,0),(1113,'2014-11-08 12:21:49','VS2015预览版体验','.NET开源了，JAVA颤抖吧...<br />\n据说VS2015可以开发android,ios,wp应用程序了，还可以开发能运行在mac,linux上的ASP.NET网站，如果真是这样就太爽啦，上微软官网下载了VS2015预览版，ISO压缩包4.4G<br />\n<img src=\"http://blog.niunan.net/upload/20141114024745.png\" alt=\"\" border=\"0\" /><br />\n<br />\n安装的时候至少需要8G空间<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114024812.png\" alt=\"\" border=\"0\" /><br />\n<br />\n全部安装的话需要19G空间，-_-!!!，我的250G的SSD伤不起呀，看了一下，大头在WP8.1的模拟器和WP8.1 SDK上<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114024939.png\" alt=\"\" border=\"0\" /><br />\n<br />\n只是体检，我只选择了WEB TOOL和那个Mobile那个，需要的硬盘空间是9G，点击install后就开始漫长的等待了<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114034429.png\" alt=\"\" border=\"0\" /><br />\n<br />\n安装结束了又弹出窗口提示说如果选择mobile开发的话还得联网下载些东西<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114034542.png\" alt=\"\" border=\"0\" /><br />\n<br />\n重启电脑后自动弹出窗口安装<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114034616.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114034632.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114034655.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114034726.png\" alt=\"\" border=\"0\" /><br />\n<br />\n又是漫长的等待，下面是我的电脑配置，还没联网下载MOBILE开发的相关软件前的安装过程是45分钟<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114034906.png\" alt=\"\" border=\"0\" /><br />\n<br />\n实际上VS2015是已经安装好了的，我们可以在下载MOBILE开发相关的软件同时先看看VS2015的界面，在WIN8.1的侧边栏可以找到VS2015<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114040601.png\" alt=\"\" border=\"0\" /><br />\n<br />\n启动界面和VS2013是一样的，启动后需要登录微软账户，登录后选择常用的环境， 最后就进入VS2015的界面了<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114040815.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114040830.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114040846.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114040911.png\" width=\"550\" alt=\"\" border=\"0\" /><br />\n<br />\n看看新建项目的窗口，可以看到可以建立android和ios的项目了，呵呵，不过相关的开发软件还在下载，我先试试建个web application看看<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114041226.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114041252.png\" alt=\"\" border=\"0\" /><br />\n<br />\n他把MVC和WEBFORM的全集中在里面让你选择了，先创建web application，再选择是使用MVC还是用回WEBFORM<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114041403.png\" alt=\"\" border=\"0\" /><br />\n<br />\n选择MVC，可以看到默认的是MVC5了，好像也没有发现哪里可以更改MVC版本的，随便写个hello world，运行成功，OK，现在时间：2014年11月14日4时16分，睡觉，挂着电脑下MOBILE的开发相关工具，明天再试试创建android玩玩...<br />\n<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141114041740.png\" style=\"width:550px;\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114041821.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114041837.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141114041854.png\" alt=\"\" border=\"0\" /><br />\n&nbsp;装了VS2015后，严重拖慢我的VS2013的启动速度，我的公司项目都是用VS2013开发的，原来VS2013启动是8秒，装上VS2015后启动是30秒左右...<br />\nmobile开发的相关工具终于装完了，但是新建一个C#的Android项目后还是要求用xamarin studio建立的，郁闷，但是我打开以前我用xamarin studio建立的项目又打不开，晕。。。<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141115173439.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173455.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173508.png\" alt=\"\" border=\"0\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141115173520.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173538.png\" alt=\"\" border=\"0\" /><br />\n<br />\n另外发现新建项目的时候可以用javascript来建立android，此外还有python的，不过不会这个，会的朋友感兴趣的可以试试，用javascript来建立android那个建立后直接运行，看不懂是怎么回事。<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141115173753.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173805.png\" width=\"800\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173834.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173854.png\" width=\"800\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115173906.png\" width=\"800\" alt=\"\" border=\"0\" /><br />\n<br />\n结果想试试VS的android模拟器，结果又是启动不了，郁闷啊。。。。<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20141115174204.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115174216.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://blog.niunan.net/upload/20141115174228.png\" alt=\"\" border=\"0\" /><br />\n<br />\n体验至此结束，弄了二天，结果还是没办法运行起来，看来想免费在在VS中用C#写android代码并成功运行的日子还得等待啊，现在想用c#写android的只能将就着用xamarin studio了，<br />\n<span style=\"font-size:18px;\"><b>那么问题来了，哪里才能学xamarin studio？感兴趣的朋友可随时上优酷围观牛腩边学边录的视频《牛腩学Mono for Android》.<br />\n优酷地址：</b></span><font size=\"4\"><span style=\"line-height:27px;\"><b><a href=\"http://www.youku.com/playlist_show/id_19539679.html\" target=\"_blank\">http://www.youku.com/playlist_show/id_19539679.html</a><br />\n牛腩官网：<a href=\"http://niunan.net\" target=\"_blank\">http://niunan.net</a><br />\n牛腩淘宝：<a href=\"http://niunan888.taobao.com\" target=\"_blank\">http://niunan888.taobao.com</a><br />\n　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　<span style=\"font-size:24px;color:#fe2419;\">－－不是每个视频都由牛腩录制</span><br />\n</b></span></font>	                          ',NULL,2562,'0103','随笔',NULL,0),(1112,'2014-10-20 11:46:15','HTML5的VIDEO标签转换对应的软件','软件名称：Freemake Video Converter<br />\n用这个软件可以转成HTML5的VIDEO标签里对应的视频格式，他转换出来的格式有3种（mp4,ogv,webm）,嵌入网页的代码如下：<br />\nhtml&lt;video id=0 controls width=320 height=240&gt;<div>&lt;noscript&gt;&lt;a href=http://www.freemake.com/free_video_converter/&gt;video converter&lt;/a&gt;&lt;/noscript&gt;</div>\n<div>&lt;source src=\"video011.ogv\" type=&#039;video/ogg; codecs=\"theora, vorbis\"&#039;/&gt;</div>\n<div>&lt;source src=\"video011.webm\" type=&#039;video/webm&#039; &gt;</div>\n<div>&lt;source src=\"video011.mp4\" type=&#039;video/mp4&#039;&gt;</div>\n<div>&lt;p&gt;Video is not visible, most likely your browser does not support HTML5 video&lt;/p&gt;</div>\n&lt;/video&gt;/html<br />\n<br />\n之前我用格式工厂和QQ影音转出来的MP4都放不了，郁闷。。看来也只能用这个了。。<br />\n<br />\n<br />\n',NULL,367,'0103','随笔',NULL,0),(1111,'2014-10-12 16:33:49','数据库查询中加入索引和不加索引的时间对比','<img src=\"http://blog.niunan.net/upload/20141012163338.png\" width=\"600\" alt=\"\" border=\"0\" />	                          ',NULL,344,'0106','SQL',NULL,0),(1110,'2014-10-12 16:31:38','GIT忽略中文文件夹','正在学习GIT，蛮好玩的，其中用到了忽略文件 ，要忽略中文文件夹的话直接写中文名进那个忽略文件 即可，但是要先把那忽略文件转为UTF8编码的：<br />\n<img src=\"http://blog.niunan.net/upload/20141012162942.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n另外还有一个问题，我想忽略 文档 文件夹下的所有东西，但是不忽略 文档/SQL 文件夹下的东西，应该按如下的写：<br />\n文档/*<br />\n!文档/SQL/',NULL,298,'0103','随笔',NULL,0),(1109,'2014-10-12 16:22:44','虚拟机的中MAC系统访问外面的WIN8共享文件夹','在虚拟机中装了个苹果系统，虚拟机内存调为4G，不算很卡了，嘿嘿。。用MAC就是高大上。。不过有好多东西搞不懂，今天想把外面的WIN8下的XCODE安装文件搞到虚拟机里的苹果中，结果设置了VMWARE的共享目录了，在苹果中不懂如何访问，上网找了下资料，发现根本用不着设置WMWARE的共享目录 ，直接设置WIN8的共享目录就行了，步骤如下：<br />\n1：WIN8系统中设置共享目录，目录加入everyone的权限<br />\n2：WIN8系统中的账户设置中给主登录账号加上密码。（经测试不加密码则在MAC中访问不了WIN8共享目录）<br />\n3：在虚拟机MAC中打开safari浏览器，输入smb://niunan-home，//后面的是WIN8的名称，也可以是IP，然后输入密码就可以进入WIN8中设置的共享目录了。<br />\n<br />\n<br />\n<br />\n',NULL,377,'0103','随笔',NULL,0),(1108,'2014-07-31 20:12:28','存储过程case when(switch)的用法','sqldeclare @shiduan nvarchar(50)set @shiduan=&#039;12-14点&#039;declare @cls nvarchar(50)select @cls=( case @shiduan  when &#039;08-09点&#039; then &#039;green&#039; when &#039;09-10点&#039; then &#039;yellow&#039; else &#039;other&#039; end)print @cls/sql	                          	                          ',NULL,485,'0106','SQL',NULL,0),(1107,'2014-04-14 10:38:13','取下一个星期几的函数','c#<br />\n<div>&nbsp; &nbsp; &nbsp; /// &lt;summary&gt;取下一个星期几</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 例：今天星期三，传入4，则会取明天星期四的日期</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 传入3，则会返回今天的日期</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// 传入2，则会返回下星期二的日期</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;param name=\"xingqi\"&gt;0表示星期天&lt;/param&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public static DateTime GetNextXingQi(int xingqi) {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateTime outdate;</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateTime now = DateTime.Now;</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (xingqi == 0)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xingqi = 7;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((int)now.DayOfWeek == xingqi)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //今天正好是星期二</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outdate = now;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if ((int)now.DayOfWeek &lt; xingqi)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //今天小于星期二的</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outdate = now.AddDays(xingqi - (int)now.DayOfWeek);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //今天是大于星期二的，应该计算下一周</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outdate = now.AddDays(5 - (xingqi - (int)now.DayOfWeek));</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return outdate;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n/c#	                          ',NULL,780,'0101','ASP.NET',NULL,0),(1106,'2014-04-10 12:05:11','asp.net mvc中的用户登录验证过滤器','c#<br />\n<div>&nbsp;&nbsp; &nbsp; public class LoginFilter : ActionFilterAttribute</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public override void OnActionExecuting(ActionExecutingContext filterContext)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //HttpContext.Current.Response.Write(\"OnActionExecuting:正要准备执行Action的时候但还未执行时执行&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (HttpContext.Current.Session\"admin\" == null)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HttpContext.Current.Response.Write(\"js代码\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HttpContext.Current.Response.End();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public override void OnActionExecuted(ActionExecutedContext filterContext)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //HttpContext.Current.Response.Write(\"OnActionExecuted:Action执行时但还未返回结果时执行&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public override void OnResultExecuting(ResultExecutingContext filterContext)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // HttpContext.Current.Response.Write(\"OnResultExecuting:OnResultExecuting也和OnActionExecuted一样，但前者是在后者执行完后才执行&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public override void OnResultExecuted(ResultExecutedContext filterContext)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // HttpContext.Current.Response.Write(\"OnResultExecuted:是Action执行完后将要返回ActionResult的时候执行&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; }</div>\n/c#	                          	                          ',NULL,717,'0101','ASP.NET',NULL,0),(1105,'2014-03-28 12:10:16','某一列相同则随机取一条数据的SQL语句','sql<br />\n --取启动页，title相同则随机取一条 <div>select *from (</div>\n<div>  select row_number() over(partition by a1.title order by rand()) rcn, *</div>\n<div> from app_ggimg a1 where remark=&#039;启动页&#039; ) a</div>\n where a.rcn=1;<br />\n<br />\n /sql	                          	                          ',NULL,475,'0106','SQL',NULL,0),(1104,'2014-03-15 15:54:57','用ASP.NET MVC中的基本控制器实现全局异常处理','c#using System;<div>using System.Collections.Generic;</div>\n<div>using System.Linq;</div>\n<div>using System.Web;</div>\n<div>using System.Web.Mvc;</div>\n<div>using JiuFen.QiKai.Util;</div>\n<div><br />\n</div>\n<div>namespace JiuFen.QiKai.Web.Controllers</div>\n<div>{</div>\n<div>&nbsp; &nbsp; public class BaseController : Controller</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; //全局异常处理</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; protected override void OnException(ExceptionContext filterContext)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 此处进行异常记录，可以记录到数据库或文本，也可以使用其他日志记录组件。</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 通过filterContext.Exception来获取这个异常。</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tool.TxtLog(\"异常信息：\"+filterContext.Exception.Message+\"\r\n堆栈跟踪：\"+filterContext.Exception.StackTrace);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 执行基类中的OnException</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; base.OnException(filterContext);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp;</div>\n<div>&nbsp; &nbsp; }</div>\n}/c#	                          ',NULL,450,'0101','ASP.NET',NULL,0),(1103,'2014-03-07 13:46:14','MSSQL取星期几','sql<br />\n<div>-- MSSQL取星期几</div>\n select datename(weekday, getdate())  /sql	                          	                          ',NULL,405,'0106','SQL',NULL,0),(1102,'2014-01-25 20:51:43','HTML5文件上传','htmL代码：<br />\nhtml<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;div class=\"row\"&gt; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=\"file\" name=\"fileToUpload\" id=\"fileToUpload\" onchange=\"fileSelected();\"/&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;/div&gt; <br />\n&nbsp;&nbsp;&nbsp; &lt;div id=\"fileSize\"&gt;&lt;/div&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;div id=\"fileType\"&gt;&lt;/div&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;div class=\"row\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=\"button\" onclick=\"uploadFile()\" value=\"上传\" /&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;/div&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;div id=\"progressNumber\"&gt;&lt;/div&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;progress max=\"100\" id=\"progre\" value=\"0\"&gt;&lt;/progress&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;br /&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:Image ID=\"Image1\"&nbsp; Style=\"max-width:130px\" runat=\"server\" /&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:HiddenField ID=\"hfimg\" value=\"\" runat=\"server\" /&gt;<br />\n/html<br />\nJS代码：<br />\njs<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script type=\"text/javascript\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function fileSelected() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var file = document.getElementById(&#039;fileToUpload&#039;).files0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (file) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fileSize = 0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (file.size &gt; 1024 * 1024)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileSize = (Math.round(file.size * 100 / (1024 * 1024)) / 100).toString() + &#039;MB&#039;;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileSize = (Math.round(file.size * 100 / 1024) / 100).toString() + &#039;KB&#039;;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&#039;fileSize&#039;).innerHTML = &#039;文件大小: &#039; + fileSize;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&#039;fileType&#039;).innerHTML = &#039;文件类型: &#039; + file.type;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function uploadFile() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fd = new FormData();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd.append(\"fileToUpload\", document.getElementById(&#039;fileToUpload&#039;).files0);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var xhr = new XMLHttpRequest();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.upload.addEventListener(\"progress\", uploadProgress, false);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.addEventListener(\"load\", uploadComplete, false);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.addEventListener(\"error\", uploadFailed, false);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.addEventListener(\"abort\", uploadCanceled, false);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.open(\"POST\", \"/handler/h5upload.ashx\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xhr.send(fd);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function uploadProgress(evt) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (evt.lengthComputable) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var percentComplete = Math.round(evt.loaded * 100 / evt.total);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&#039;progressNumber&#039;).innerHTML = percentComplete.toString() + &#039;%&#039;;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&#039;progre&#039;).value = percentComplete;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&#039;progressNumber&#039;).innerHTML = &#039;unable to compute&#039;;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function uploadComplete(evt) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* This event is raised when the server send back a response */ <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var json =eval(\"(\"+ evt.target.responseText+\")\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (json.status==\"no\") {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(json.info);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }else{<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(\"&lt;%=Image1.ClientID%&gt;\").src = json.path;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(\"&lt;%=hfimg.ClientID%&gt;\").value = json.path; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function uploadFailed(evt) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(\"There was an error attempting to upload the file.\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function uploadCanceled(evt) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(\"The upload has been canceled by the user or the browser dropped the connection.\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; &lt;/script&gt;<br />\n/js<br />\n<br />\n后台ashx代码：<br />\nc#<br />\n&nbsp;&nbsp;&nbsp; context.Response.ContentType = \"text/plain\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HttpPostedFile&nbsp; file =context. Request.Files\"fileToUpload\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String fileName = file.FileName;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String fileExt = Path.GetExtension(fileName).ToLower();<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //定义允许上传的文件扩展名<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hashtable extTable = new Hashtable();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extTable.Add(\"image\", \"gif,jpg,jpeg,png,bmp\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extTable.Add(\"flash\", \"swf,flv\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extTable.Add(\"media\", \"swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extTable.Add(\"file\", \"doc,docx,xls,xlsx,ppt,htm,html,txt,zip,rar,gz,bz2\");<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (String.IsNullOrEmpty(fileExt) || Array.IndexOf(((String)extTable\"image\").Split(&#039;,&#039;), fileExt.Substring(1).ToLower()) == -1)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.Response.Write(LitJson.JsonMapper.ToJson(new { status=\"no\", info = \"上传文件扩展名是不允许的扩展名。\n只允许\" + ((String)extTable\"image\") + \"格式。\" }));<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string dirpath = \"/upload/\"+DateTime.Now.ToString(\"yyyyMMdd\")+\"/\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!Directory.Exists(context.Server.MapPath( dirpath)))<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Directory.CreateDirectory(context.Server.MapPath(dirpath));<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String newFileName = DateTime.Now.ToString(\"yyyyMMddHHmmss_ffff\", DateTimeFormatInfo.InvariantInfo) + fileExt;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; file.SaveAs(context.Server.MapPath(dirpath) + newFileName);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.Response.Write(LitJson.JsonMapper.ToJson(new { status=\"ok\",path = dirpath+newFileName}));<br />\n/c#<br />\n<a href=\"http://yunpan.cn/Qzi3WkPzBIkWY\" target=\"_blank\"></a>	                          	                          	                          ',NULL,695,'0105','javascript',NULL,0),(1101,'2013-09-28 13:29:57','关于360杀百度地图的个人看法','<img border=\"0\" alt=\"\" src=\"http://blog.niunan.net/upload/20130928132208.jpg\" /><br />\n<br />\n&nbsp;如图，刚刚检测出来的，真实情况是我昨天才刷的从华为官网上下载的4.2 ROM包，内置的程序中根本就没有百度地图，只有内置有图吧地图，不过我的SD卡倒是残留有百度地图的文件，以前装的时候留下的话，也许是这个文件夹被360检测到了吧。<br />\n<img border=\"0\" alt=\"\" src=\"http://blog.niunan.net/upload/20130928132415.png\" /><br />\n<br />\n我是用了360云盘才用上360的, 现在觉得也没什么,倒里360附带的一些功能还是有用的, <br />\n360中的“连我WIFI”有用。。比WIFI共享精灵好。。。<br />\nWIFI共享精灵有时开启了后手机还是连接不上WIFI.<br />\n还有想看看电脑详细配置的。鲁大师也能检测得到。。省得我再自己去下CPU-Z等软件来检测。。<br />\n<br />\n360基本把我想用到的功能都集成一块了。。<br />\n虽然说不一定每个功能都非常准确，，但也还能过得去。。。<br />\n<br />\n至于说拖慢电脑速度的。。我不觉得卸载360后我这台电脑（装了VS2010,VS2012,SQL2012，PS,FLASH,DW,Xamarin Studio,eclipse,unity3d,3dsmax,office2010,虚拟机，虚拟机里装MAC OS,CENT OS,WIN2003）速度会变快, 卸载我也试过,感觉不出变快了.<br />\n<br />\n最后再喷一下华为,万年K3V2不变!!!!!<br />\n再买K3V2的华为就垛手.....',NULL,864,'0103','随笔',NULL,0),(1100,'2013-07-18 22:25:50','删除在线TFS中的项目','<span style=\"font-size:16px;\">开始学习使用VS2012中的那个TFS源码管理器,到</span><br />\n<span style=\"font-size:16px;\">http://tfs.visualstudio.com/申请了个免费的在线TFS,在网页上创建好项目后回到VS2012中的团队管理器可以连接到上面了,感觉还好吧..除了网络慢点....</span><br />\n<span style=\"font-size:16px;\">发现不管是网页上还是VS中的团队管理器都没有删除创建好的项目的按钮,上网搜索了一下,发现原来是用命令行来删除才行的,要到VS2012安装目录Microsoft Visual Studio 11.0Common7IDE下有个tfsdeleteproject.exe,用这个东西在命令行中删除才行的,我的电脑上安装了VS2010奇贱版和VS2012免费版,Microsoft Visual Studio 11.0Common7IDE目录下没有那个Exe,而VS2010的目录Microsoft Visual Studio 10.0Common7IDE下有,我试着在管理员权限下的CMD输入</span><br />\n<span style=\"font-size:16px;\">D:Program FilesMicrosoft Visual Studio 10.0Common7IDE&gt;tfsdeleteproject /collection:https://niunan.visualstudio.com/DefaultCollection \"niunantest\"</span><br />\n<span style=\"font-size:16px;\">结果提示不能删除,版本不符合,而我的VS2012的安装目录下又没有那个exe,上网搜索了一下,原来还得在安装一个vs2012 team explorer(免费的),安装好后在C盘的对应目录下就有那个EXE了,执行下面的代码就可以删除网页TFS上的项目了</span><br />\n<span style=\"font-size:16px;\">C:Program Files (x86)Microsoft Visual Studio 11.0Common7IDE&gt;tfsdeleteproject /collection:https://niunan.visualstudio.com/DefaultCollection \"niunantest\"</span><br />\n<img src=\"http://blog.niunan.net/upload/20130718222547.png\" alt=\"\" border=\"0\" /><br />\n	                          ',NULL,1458,'0111','工具使用',NULL,0),(1099,'2013-06-13 16:00:08','代码中取得某个类的方法注释','<p>	需要在一个刚刚上显示某些类中的方法注释, 查了下资料,像///这种斜线注释在程序中是取不到的,但是可以采用另一种方法,把注释写到方法的Description属性中,然后通过反射可以把Description属性中的文字射出来,代码如下:</p>\n<p>	<br />\n</p>\n<p>	类:</p>\n<p>	&nbsp;&nbsp;&nbsp; class niunan_aaa<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int id;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;用户名<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description(\"用户名属性\")<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string username{set;get;} //没get,set的话就取不出注释 <br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;获取用户名<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description(\"取用户名的方法\")<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string getusername() { return username; }<br />\n&nbsp;&nbsp;&nbsp; }</p>\n<p>	<br />\n</p>\n<p>	<br />\n</p>\n<p>	<br />\n</p>\n<p>	我们可以在程序中取出Description中的文字,代码如下:</p>\n<p>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Reflection.PropertyInfo prop = typeof(niunan_aaa).GetProperty(\"username\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(((DescriptionAttribute)prop.GetCustomAttributes(typeof(DescriptionAttribute), false)0).Description + \"&lt;br /&gt;\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(prop.Name + \"&lt;br /&gt;\");<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Reflection.MethodInfo method = typeof(niunan_aaa).GetMethod(\"getusername\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(((DescriptionAttribute)method.GetCustomAttributes(typeof(DescriptionAttribute), false)0).Description + \"&lt;br /&gt;\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(method.Name + \"&lt;br /&gt;\");</p>\n<p>	<br />\n</p>\n<p>	<br />\n</p>\n<p>	<br />\n</p>\n<p>	截图:</p>\n<p>	<br />\n</p>\n<p>	<img src=\"http://www.niunan.net/upload/image/20130613/20130613155840_9811.jpg\" alt=\"\" /> </p>\n	                          ',NULL,864,'0101','ASP.NET',NULL,0),(1098,'2013-06-12 12:39:20','Unable to load DLL &#039;rasapi32.dll&#039;: 动态链接库(DLL)初始化例程失败。','今天做项目传到服务器上碰到下面的问题<br />\n<img src=\"http://blog.niunan.net/upload/20130612123703.jpg\" alt=\"\" border=\"0\" />	                          <br />\n<br />\n但是在本地VS中运行又没问题<br />\n<br />\n后经上网搜索发现只要在web.config文件中加入如下代码即可解决<br />\n&lt;system.net&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;defaultProxy&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;proxy usesystemdefault=\"False\" /&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;/defaultProxy&gt;<br />\n&lt;/system.net&gt;<br />\n<br />\n如下图:<br />\n<img src=\"http://blog.niunan.net/upload/20130612123913.jpg\" alt=\"\" border=\"0\" /><br />\n',NULL,803,'0101','ASP.NET',NULL,0),(1097,'2013-06-06 14:59:49','JS计算一个整数由几个XXX组成','js<br />\n&nbsp;&nbsp;&nbsp; &lt;script type=\"text/javascript\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function setbing(v) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!parseInt(v)) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&#039;#mes&#039;).html(\"请输入整数!\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //数字有几个xxx组成<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var c1 = 0, c5 = 0, c50 = 0, c100 = 0, c500 = 0, c1000 = 0, c5000 = 0;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var tmp = v;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c5000 = parseInt(tmp / 5000);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c5000 * 5000;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c1000 = parseInt(tmp / 1000);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c1000 * 1000;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c500 = parseInt(tmp / 500);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c500 * 500;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c100 = parseInt(tmp / 100);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c100 * 100;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c50 = parseInt(tmp / 50);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c50 * 50;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c5 = parseInt(tmp / 5);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp -= c5 * 5;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c1 = parseInt(tmp / 1);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\"#mes\").html(\"数字 \" + v + \" 由: \" + c5000 + \" 个 5000, \" + c1000 + \" 个 1000, \" + c500 + \" 个 500, \" + c100 + \" 个 100, \" + c50 + \" 个 50, \" + c5 + \" 个 5, \" + c1 + \" 个1 组成!\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; &lt;/script&gt;<br />\n/js	                          ',NULL,532,'0105','javascript',NULL,0),(1096,'2013-06-01 11:19:58','使用X-UA-Compatible来设置IE浏览器兼容模式','<div id=\"cnblogs_post_body\"><p>文件兼容性用于定义让IE如何编译你的网页。此文件解释文件兼容性，如何指定你网站的文件兼容性模式以及如何判断一个网页该使用的文件模式。</p>\n<p><br />\n<strong><span style=\"font-size:18pt;\"><strong style=\"font-size:14pt;\">前言</strong></span></strong></p>\n<p>为了帮助确保你的网页在所有未来的IE版本都有一致的外观，IE8引入了文件兼容性。在IE6中引入一个增设的兼容性模式，文件兼容性使你能够在IE呈现你的网页时选择特定编译模式。<br />\n新的IE为了确保网页在未来的版本中都有一支的外观，IE8引入了文件兼容性。当你引入一个增设的兼容性模式，<br />\n此文章说明文件兼容性的必要性，列出现有版本IE能使用的文件兼容性模式并示范如何选择特定的兼容性模式。</p>\n<p><br />\n<strong style=\"font-size:14pt;\">了解文件兼容性的必要性</strong></p>\n<p>每个主要版本IE新增的功能都是为了让浏览器更容易使用、增加安全性及更支持业界标准。以这些作为IE的特色，其中一个风险就是旧版本网站无法正确的显示。</p>\n<p>为了将这个风险降到最低，IE6允许网页开发人员选择IE编译和显示他们网页的方式。\"Quirks mode\"为预设，这会使页面以旧版本浏览器的视点显示，\"Standards mode\"(也称为\"strict mode\")特点是支持业界标准最为完善。然而要利用这个增强的支持功能，网页必须包含恰当的<a href=\"http://msdn.microsoft.com/en-us/library/ms533737%28VS.85%29.aspx\" target=\"_blank\"><strong><font color=\"#765f47\">&lt;!DOCTYPE&gt;</font></strong></a>指令。</p>\n<p>若一个网页没有包含<strong>&lt;!DOCTYPE&gt;</strong>指令，IE6会将它以quirks mode显示。若网页包含有效的<strong>&lt;!DOCTYPE&gt;</strong>指令但浏览器无法辨识，IE6会将它以IE6 standards mode显示。因为少数网站已经包含<strong>&lt;!DOCTYPE&gt;</strong>指令，兼容性模式的切换相当成功。这使网页开发人员能选择将他们的网页转移为standards mode的最佳时机。</p>\n<p>随著时间经过，更多网站开始使用standards mode。它们也开始使用IE6的特性和功能来检测IE。举例来说，IE6不支持<a href=\"http://msdn.microsoft.com/en-us/library/aa770077%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">universal selector</font></a>(即css之全局选择器 * {})，一些网站便使用它来针对IE做特定的对应。</p>\n<p>当 IE7增加了对全域选择器的支持，那些依赖IE6特点的网站便无法侦测出这个新版本的浏览器。因此那些针对IE的特定对应无法应用于IE7，造成这些网站便无法如他们预期的显示。由于<strong>&lt;!DOCTYPE&gt;</strong>只支持两种兼容性模式，受到影响的网站拥有者被迫更新他们的网站使其能支持IE7。</p>\n<p>IE8 比之前的任何版本浏览器都更支持业界标准，因此针对旧版本浏览器设计的网页可能无法如预期般呈现。为了帮助减轻所有问题，IE8引入文件兼容性的概念，使你能选择你的网页设计要对应的特定IE版本。文件兼容性在IE8增加了一些新的模式，这些模式能告诉浏览器如何解析和编译一个网页。若你的网页无法在 ie8正确的显示，你可以更新你的网站使它支持最新的网页标准(优先选项)或在你的页面上新增一个<a href=\"http://msdn.microsoft.com/en-us/library/ms535853%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">meta</font></a>元素用于告诉IE8如何依照旧版本浏览器编译你的页面。</p>\n<p>这能让你选择将你的网站更新支持IE8新特点的时机。</p>\n<p><br />\n<strong><span style=\"font-size:14pt;\"><strong>认识文件兼容性模式</strong></span></strong></p>\n<p>IE8支持几种文件兼容性模式，它们具有不同的特性并影响内容显示的方式。</p>\n<p>•Emulate IE8 mode指示IE使用<strong>&lt;!DOCTYPE&gt;</strong>指令来决定如何编译内容。Standards mode指令会显示成IE8 Standards mode而quirks mode会显示成IE5 mode。不同于IE8 mode，Emulate IE8 mode重视<strong>&lt;!DOCTYPE&gt;</strong>指令。<br />\n•Emulate IE7 mode指示IE使用<strong>&lt;!DOCTYPE&gt;</strong>指令来决定如何编译内容。Standards mode指令会显示成IE7 Standards mode而quirks mode会显示成IE5 mode。不同于IE7 mode，Emulate IE7 mode重视<strong>&lt;!DOCTYPE&gt;</strong>指令。<strong style=\"font-size:12pt;\">对于许多网页来说这是最推荐的兼容性模式。</strong><br />\n•IE5 mode 编译内容如同IE7的quirks mode之显示状况，和IE5中显示的非常类似。<br />\n•IE7 mode编译内容如同IE7的standards mode之显示状况，无论网页是否含有<strong>&lt;!DOCTYPE&gt;</strong>指令。<br />\n•IE8 mode提供对业界标准的最高支持，包含 <a href=\"http://www.w3.org/TR/CSS21/\" target=\"_blank\"><font color=\"#765f47\">W3C Cascading Style Sheets Level 2.1 Specification</font></a>和<a href=\"http://www.w3.org/tr/selectors-api\" target=\"_blank\"><font color=\"#765f47\">W3C Selectors API</font></a>，并有限的支持 <a href=\"http://www.w3.org/TR/css3-roadmap/\" target=\"_blank\"><font color=\"#765f47\">W3C Cascading Style Sheets Level 3 Specification (Working Draft)</font></a>。<br />\n•Edge mode指示IE以目前可用的最高模式显示内容。当使用IE8时其等同于IE8 mode。若(假定)未来放出支持更高兼容性模式的IE，使用Edge mode的页面会使用该版本能支持的最高模式来显示内容。同样的那些页面在使用IE8浏览时仍会照常显示。</p>\n<p><em>由于edge mode使用该IE版本所能支持的最高模式来显示所浏览的网页内容，建议仅使用于测试页及其他非商用页面。</em></p>\n<p><br />\n<strong><span style=\"font-size:14pt;\"><strong>指定文件兼容性模式</strong></span></strong></p>\n<p>要为你的网页指定文件模式，需要在你的网页中使用<strong>meta</strong>元素放入X-UA-Compatible <a href=\"http://msdn.microsoft.com/en-us/library/ms533876%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">http-equiv</font></a> 标头。以下是指定为Emulate IE7 mode 兼容性之范例。</p>\n<div><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">html</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">head</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">Mimic Internet Explorer 7</span> <span style=\"color:#008000;\">--&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=EmulateIE7\"</span> <span style=\"color:#0000ff;\">/&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">title</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\">My Web Page</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">title</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">head</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">body</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">p</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\">Content ;es here.</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">p</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">body</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">html</span><span style=\"color:#0000ff;\">&gt;</span></div>\n<p><br />\n其内容随著指定的页面模式而更改，当要模拟IE7时，指定<strong>IE=EmulateIE7</strong>，指定<strong>IE=5</strong>, <strong>IE=7</strong>, 或<strong>IE=8</strong>来选择其中一种兼容性模式。你也可以指定<strong>IE=edge</strong>来指示IE8使用它支持的最高模式。</p>\n<p>X-UA-compatible标头没有大小写之分。然而除了<a href=\"http://msdn.microsoft.com/en-us/library/ms535910%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">title</font></a>元素及其他的<strong>meta</strong>元素之外，它必须出现在网页<a href=\"http://msdn.microsoft.com/en-us/library/ms535252%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">header节</font></a>其它元素之前的位置，</p>\n<p><br />\n<strong style=\"font-size:14pt;\">设定网站服务器以指定预设兼容性模式</strong></p>\n<p>网站管理员可籍着为网站定义一个自订标头来为他们的网站预设一个特定的文件兼容性模式。这个特定的方法取决于你的网站服务器。举例来说，下列的web.config文件使Microsoft Internet Information Services (IIS)能定义一个自订标头以自动使用IE7 mode来编译所有网页。</p>\n<div><span style=\"color:#0000ff;\">&lt;?</span><span style=\"color:#ff00ff;\">xml version=\"1.0\" encoding=\"utf-8\"</span><span style=\"color:#0000ff;\">?&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">configuration</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">system.webServer</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">httpProtocol</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">customHeaders</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">clear</span> <span style=\"color:#0000ff;\">/&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">add</span> <span style=\"color:#ff0000;\">name</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">value</span><span style=\"color:#0000ff;\">=\"IE=EmulateIE7\"</span> <span style=\"color:#0000ff;\">/&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">customHeaders</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">httpProtocol</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n<wbr><wbr></span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">system.webServer</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;/</span><span style=\"color:#800000;\">configuration</span><span style=\"color:#0000ff;\">&gt;</span></div>\n<p><br />\n若你已于网站服务器指定了一个预设的文件兼容性模式，你可以在个别页面上指定不同的文件兼容性模式来盖过它。在网页中指定的模式优先权高于服务器中所指定的模式。</p>\n<p>请查阅你的网站服务器关于指定自订标头的资讯，或看更多资料:</p>\n<p><a href=\"http://msdn.microsoft.com/en-us/library/cc817573.aspx\" target=\"_blank\"><font color=\"#765f47\">Implementing the META Switch on Apache<br />\n</font></a><a href=\"http://msdn.microsoft.com/en-us/library/cc817572.aspx\" target=\"_blank\"><font color=\"#765f47\">Implementing the META Switch on IIS</font></a></p>\n<p><br />\n<strong style=\"font-size:14pt;\">判定文件兼容性模式</strong></p>\n<p>要判定网页使用IE8浏览时的文件兼容性模式，使用<a href=\"http://msdn.microsoft.com/en-us/library/ms531073%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">document</font></a> object(文档对象)的<a href=\"http://msdn.microsoft.com/en-us/library/cc196988%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">documentMode</font></a>功能。例如在IE8的网址列输入下列程式码会显示目前页面的文件模式。</p>\n<div><span style=\"color:#000000;\">javascript:alert(document.documentMode);</span></div>\n<p><strong>documentMode</strong>功能会回传一个数值对应目前页面的文件兼容性模式，举例来说，若网页指定为支持IE8模式，<strong>documentMode</strong>便会回传值\"<strong>8</strong>\"。</p>\n<p>在IE6引入的<a href=\"http://msdn.microsoft.com/en-us/library/ms533687%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">compatMode</font></a>功能不支持在IE8引入的<strong>documentMode</strong>功能。目前使用<strong>compatMode</strong>建立的应用程式还能在IE8中作用，但它们必须更新为使用documentMode。</p>\n<p>若你希望使用JavaScript判定一个文件的兼容性模式，引入下面范例的这段程式码可支持旧版本的IE。</p>\n<div><span style=\"color:#000000;\">engine</span> <span style=\"color:#000000;\">=</span> <span style=\"color:#0000ff;\">null</span><span style=\"color:#000000;\">;<br />\n</span><span style=\"color:#0000ff;\">if</span> <span style=\"color:#000000;\">(window.navigator.appName</span> <span style=\"color:#000000;\">==</span> <span style=\"color:#000000;\">\"</span><span style=\"color:#000000;\">Microsoft Internet Explorer</span><span style=\"color:#000000;\">\"</span><span style=\"color:#000000;\">)<br />\n{<br />\n<wbr><wbr><wbr></span><span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">This is an IE browser. What mode is the engine in?</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\"><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">if</span> <span style=\"color:#000000;\">(document.documentMode)</span> <span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">IE8</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\"><wbr><wbr><wbr><wbr><wbr><wbr>engine</span> <span style=\"color:#000000;\">=</span> <span style=\"color:#000000;\">document.documentMode;<br />\n<wbr><wbr><wbr></span><span style=\"color:#0000ff;\">else</span> <span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">IE 5-7</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\"><wbr><wbr><wbr>{<br />\n<wbr><wbr><wbr><wbr><wbr><wbr>engine</span> <span style=\"color:#000000;\">=</span> <span style=\"color:#000000;\">5</span><span style=\"color:#000000;\">;</span> <span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">Assume quirks mode unless proven otherwise</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\"><wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">if</span> <span style=\"color:#000000;\">(document.compatMode)<br />\n<wbr><wbr><wbr><wbr><wbr><wbr>{<br />\n<wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr></span><span style=\"color:#0000ff;\">if</span> <span style=\"color:#000000;\">(document.compatMode</span> <span style=\"color:#000000;\">==</span> <span style=\"color:#000000;\">\"</span><span style=\"color:#000000;\">CSS1Compat</span><span style=\"color:#000000;\">\"</span><span style=\"color:#000000;\">)<br />\n<wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr><wbr>engine</span> <span style=\"color:#000000;\">=</span> <span style=\"color:#000000;\">7</span><span style=\"color:#000000;\">;</span> <span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">standards mode</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\"><wbr><wbr><wbr><wbr><wbr><wbr>}<br />\n<wbr><wbr><wbr>}<br />\n<wbr><wbr><wbr></span><span style=\"color:#008000;\">//</span> <span style=\"color:#008000;\">the engine variable now contains the document compatibility mode.</span><span style=\"color:#008000;\"><br />\n</span><span style=\"color:#000000;\">}</span></div>\n<p style=\"font-size:14pt;\"><strong>认识内容属性值</strong></p>\n<p>内容属性值在接收到异于先前叙述的数值时是具有弹性的。这能使你对于IE如何显示你的网页更有操控性。举例来说，你可以设定内容属性值为IE=7.5。当你这样做的时候，IE尝试将这个值转换为<a href=\"http://msdn.microsoft.com/en-us/library/ms537512%28VS.85%29.aspx\" target=\"_blank\"><font color=\"#765f47\">version vector</font></a>并选择最接近的结果。在这个例子中，IE会将其设定为IE7 mode。下面的范例显示该模式设定为其他值的状况。</p>\n<div><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=4\"</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"> <wbr><wbr><wbr></span><span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">IE5 mode</span> <span style=\"color:#008000;\">--&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=7.5\"</span><span style=\"color:#0000ff;\">&gt;</span> <span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">IE7 mode</span> <span style=\"color:#008000;\">--&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=100\"</span><span style=\"color:#0000ff;\">&gt;</span> <span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">IE8 mode</span> <span style=\"color:#008000;\">--&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=a\"</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"> <wbr><wbr><wbr></span><span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">IE5 mode</span> <span style=\"color:#008000;\">--&gt;</span> <span style=\"color:#000000;\"><br />\n<br />\n</span><span style=\"color:#008000;\">&lt;!--</span> <span style=\"color:#008000;\">This header mimics Internet Explorer 7 and uses<br />\n<wbr><wbr><wbr><wbr><wbr>&lt;!DOCTYPE&gt; to determine how to display the Web page</span> <span style=\"color:#008000;\">--&gt;</span><span style=\"color:#000000;\"><br />\n</span><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=EmulateIE7\"</span><span style=\"color:#0000ff;\">&gt;</span><span style=\"color:#000000;\"> <wbr><wbr></span></div>\n<p><strong>注意:</strong> 前面的范例显示单独的内容值。实际上IE只会执行网页中第一个X-UA-Compatible标头。</p>\n<p>你也可以使用内容属性来指定复数的文件兼容性模式，这能帮助确保你的网页在未来的浏览器版本都能一致的显示。欲设定复数的文件模式，请设定内容属性以判别你想使用的模式。使用分号来分开各个模式。</p>\n<p>如果一个特定版本的IE支持所要求的兼容性模式多于一种，将採用列于标头内容属性中最高的可用模式。你可以使用这个特性来排除特定的兼容性模式，虽然并不推荐这样做。举例来说，下列标头即会排除IE7 mode。</p>\n<div><span style=\"color:#0000ff;\">&lt;</span><span style=\"color:#800000;\">meta</span> <span style=\"color:#ff0000;\">http-equiv</span><span style=\"color:#0000ff;\">=\"X-UA-Compatible\"</span> <span style=\"color:#ff0000;\">content</span><span style=\"color:#0000ff;\">=\"IE=5; IE=8\"</span> <span style=\"color:#0000ff;\">/&gt;</span></div>\n<p><strong><span style=\"font-size:14pt;\">结论</span></strong></p>\n<p>兼容性对于网页设计师来说是非常重要的顾虑。虽然最好是可以建立一个完全不需依赖任何网页浏览器特性或功能的网站，有时候这是不可能实现的。文件兼容性模式便能将网页限制在某个特定版本的IE中。</p>\n<p>使用X-UA-Compatible标头来指定你的页面支持的IE版本。使用<strong>document.documentMode</strong>判定页面的兼容性模式。</p>\n<p>选择支持某个特定版本的IE，你可以确保你的页面在未来的浏览器版本中也能有显示的一致性。</p>\n</div>\n	                          ',NULL,462,'0103','随笔',NULL,0),(1095,'2013-05-30 00:12:04','excel计算时间总和（超过24小时计算错误解决方法）','<font size=\"5\"><font color=\"purple\">如果时间列的自定义格式为 ： h:mm</font></font><br />\n<font size=\"5\"><font color=\"purple\">将会得到错误的结果，因为他不能计算超过24小时的数值</font></font><br />\n<font size=\"5\"><font color=\"purple\">要得到正确的结果，需要将自定义格式设置为: h:mm</font></font>	                          ',NULL,402,'0103','随笔',NULL,0),(1093,'2013-05-15 19:20:28','JS中数组的写法要按规范','今天做公司项目碰到个脚本的问题，在IE的兼容模式上总是测试不通过，其他浏览器都能通过，查了蛮久，才知道原来是JS是数组的写法错误，<br />\n原本的写法如下：<br />\njs<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _menus = {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menus\": <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menuid\": 1,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menuname\": \"优惠券管理\",<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menus\": <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"新增优惠券 \", \"url\": \"youhui/youhui_add.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"优惠券列表\", \"url\": \"youhui/youhui.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"已删除和已过期的优惠券\", \"url\": \"youhui/youhui_del.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"已使用的优惠券\", \"url\": \"youhui/youhui_use.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"未使用的优惠券\", \"url\": \"youhui/youhui_no.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n　　　　　　<br />\n　　　　}<br />\n/js<br />\n<br />\n在兼容模式下数组中最后一个元素后面不能有逗号，要不然读取出的数据就是null就会出错了，最后把他改为如下代码就测试通过了<br />\n<br />\njs<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _menus = {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menus\": <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menuid\": 1,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menuname\": \"优惠券管理\",<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \"menus\": <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"新增优惠券 \", \"url\": \"youhui/youhui_add.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"优惠券列表\", \"url\": \"youhui/youhui.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"已删除和已过期的优惠券\", \"url\": \"youhui/youhui_del.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"已使用的优惠券\", \"url\": \"youhui/youhui_use.aspx\" },<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { \"menuid\": \"1\", \"menuname\": \"未使用的优惠券\", \"url\": \"youhui/youhui_no.aspx\" }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n　　　　　　<br />\n　　　　}<br />\n/js	                          ',NULL,552,'0105','javascript',NULL,0),(1092,'2013-05-15 10:16:13','使用QQ登录API的注意事项','这几天录那个<a target=\"_blank\" href=\"http://www.niunan.net\">《牛腩网络工作室》</a>的视频，里面用到了QQ登录的API，按QQ文档里的代码写后，有时可以测试成功，有时又不能测试成功，后来发现问题在于那个回调页面的地址问题，回调页面的地址是http://www.niunan.net/test_qqreturn.html的时候，你在地址栏里输入http://www.niunan.net访问网站是可以登录QQ的，而你输入的是http://niunan.net访问网络的时候是不能登录QQ的，所以在做的时候那个回调地址的主机部分必须得由程序自动生成，确保你用http://www.niunan.net登录的时候回调地址是http://www.niunan.net/test_qqreturn.html,而如果用http://niunan.net/登录的时候则回调地址则是http://niunan.net/test_qqreturn.html',NULL,409,'0103','随笔',NULL,0),(1091,'2013-03-23 13:21:02','MSSQL中使用存储过程执行事务并输出错误信息','sql<br />\nUSE JiuFenShop<br />\n;<br />\n/****** Object:&nbsp; StoredProcedure dbo.diaobo&nbsp;&nbsp;&nbsp; Script Date: 2013/3/23 13:10:38 ******/<br />\nSET ANSI_NULLS ON<br />\n;<br />\nSET QUOTED_IDENTIFIER ON<br />\n;<br />\n-- =============================================<br />\n-- Author:&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 牛腩<br />\n-- Create date: 2013年03月23日12时19分<br />\n-- Description:&nbsp;&nbsp;&nbsp; 库存调拨<br />\n-- =============================================<br />\nALTER PROCEDURE dbo.diaobo <br />\n&nbsp;&nbsp;&nbsp; -- Add the parameters for the stored procedure here<br />\n&nbsp;&nbsp;&nbsp; @drid int = 0, --调入仓库ID<br />\n&nbsp;&nbsp;&nbsp; @dcid int = 0, --调出仓库ID<br />\n&nbsp;&nbsp;&nbsp; @proid int =0 --商品ID <br />\nAS<br />\nBEGIN<br />\n&nbsp;&nbsp;&nbsp; -- SET NOCOUNT ON added to prevent extra result sets from<br />\n&nbsp;&nbsp;&nbsp; -- interfering with SELECT statements.<br />\n&nbsp;&nbsp;&nbsp; SET NOCOUNT ON;<br />\n&nbsp;&nbsp;&nbsp; <br />\n<br />\n&nbsp;&nbsp;&nbsp; BEGIN TRY <br />\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BEGIN TRAN<br />\n　　&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; insert into jfs_product(id) values(&#039;test&#039;)<br />\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; COMMIT TRAN<br />\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SELECT ERROR_NUMBER() as 错误代码,ERROR_MESSAGE() as 错误提示 <br />\n　　END TRY <br />\n　　BEGIN CATCH <br />\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ROLLBACK TRAN<br />\n　　&nbsp;&nbsp;&nbsp; SELECT ERROR_NUMBER() as 错误代码,ERROR_MESSAGE() as 错误提示 <br />\n　　END CATCH<br />\nEND<br />\n/sql	                          ',NULL,501,'0106','SQL',NULL,0),(1090,'2013-01-25 19:13:19','支付宝接口验证return_url中验证失败问题','弄了一天,终于发现问题,web.config文件中必须有<br />\nxml<br />\n&nbsp; &lt;system.net&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;defaultProxy&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;proxy usesystemdefault=\"false\" /&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;/defaultProxy&gt;<br />\n&nbsp; &lt;/system.net&gt;<br />\n/xml	                          ',NULL,532,'0103','随笔',NULL,0),(1089,'2013-01-18 20:40:20','WIN8专业版下安装SQL2012','装了WIN8专业版，安装VS2010和SP1一切顺利，但是安装SQL2012的时候怎么都装不了，只在第一步安装更新程序的时候不停的动，可就是不进入下一步，上网搜索发现得安装.NET 3.5才能安装SQL2012，上网下载了231M的.NET3.5框架，结果双击后也是没有反映，试过很多次了，再次上网搜索才找到解决方法：<br />\nhttp://bbs.pcbeta.com/viewthread-1114823-1-1.html<br />\n到上面的网址中找到一个名字叫<a id=\"ed2k_KGT\" href=\"ed2k://%7Cfile%7CWin8&amp;2012_Net3.5_Offline.exe%7C86231040%7C5F59B3656ACF7285B8AE9B1D2396E97C%7Ch=SBHXLNDID7MXQG%20.../\" target=\"_blank\">Win8&amp;amp;2012_Net3.5_Offline.exe (82.24 MB)</a>的东西，下载后就可以直接安装了。安装完后再安装SQL2012就可以安装了。。。	                          ',NULL,917,'0103','随笔',NULL,0),(1088,'2013-01-05 17:18:44','javascript中的parseInt(\"08\")或parseInt(\"09\")转换返回0的解决办法  ','<br />\njavascript parseInt函数使用率非常高，主要功能是将一个string转换为integer。有两个重载：<br />\n<br />\nparseInt(s);<br />\nparseInt(s,radix)<br />\n　　第一个方式不再多说，第二个方式，radix是s所基于的进制。范围为2-36（不在此范围函数将返回NaN）。今天遇到下面的情况：<br />\n<br />\n 　  对于parseInt(\"01\")到parseInt(\"07\");都能得到正确的结果（0-7），但如果是parseInt(\"08\") 或parseInt(\"09\")则返回0；这是为何？<br />\n<br />\n　   经研究发现parseInt当不指定radix时，当以0x开头时，s按照十六进制计算的；如果以0开头且第二位不为x,则s是按照八进制计算的，因为八进制不能有8，9所以报错返回0。<br />\n<br />\n　　parseInt(\"08\",10) 或parseInt(\"09\",10),将分别返回8和9，<br />\n<br />\n　　所以，在我们用时还是明确指定进位制，以防出错。',NULL,535,'0105','javascript',NULL,0),(1087,'2012-12-25 14:57:47','js计算两个日期的天数差','js<br />\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /*求两个时间的天数差 日期格式为 YYYY-MM-dd &nbsp;*/</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function daysBetween(DateOne, DateTwo) {</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var OneMonth = DateOne.substring(5, DateOne.lastIndexOf(&#039;-&#039;));</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var OneDay = DateOne.substring(DateOne.length, DateOne.lastIndexOf(&#039;-&#039;) + 1);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var OneYear = DateOne.substring(0, DateOne.indexOf(&#039;-&#039;));</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var TwoMonth = DateTwo.substring(5, DateTwo.lastIndexOf(&#039;-&#039;));</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var TwoDay = DateTwo.substring(DateTwo.length, DateTwo.lastIndexOf(&#039;-&#039;) + 1);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var TwoYear = DateTwo.substring(0, DateTwo.indexOf(&#039;-&#039;));</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var cha = ((Date.parse(OneMonth + &#039;/&#039; + OneDay + &#039;/&#039; + OneYear) - Date.parse(TwoMonth + &#039;/&#039; + TwoDay + &#039;/&#039; + TwoYear)) / 86400000);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Math.abs(cha);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n/js	                          ',NULL,566,'0105','javascript',NULL,0),(1086,'2012-12-19 17:38:52','OKI MICROLINE 7700F针式打印机打印三联单设置','<div><b>OKI MICROLINE 7700F针式打印机打印三联单设置</b></div>\n<div><br />\n</div>\n<div>客户需要用到三联单的打印,弄了台OKI MICROLINE 7700F针式打印机让我弄,搞了好久才得.</div>\n<div>开始的时候连进纸都不会,不知道是从前面推进去还是从后面进去的,查了蛮久才知道,机子前面托盘的左边有个二档把手的,向上一档是从后进纸,向下一档是从前面进纸,三联单一般是从后面进纸,这样打印出来后从前面直接一撕就撕下来了,</div>\n<div>然后在二档把手的上面有个1-9档的把手,指的是要打印多少层纸的,开始的时候死打印不出来字就是那个在第9档,而那三联单才是3层的,</div>\n<div>把他调到3档后打印就出字了.</div>\n<div>打印的时候打印完了总会伸出蛮多空白的纸,上网查了下,原来是打印的时候默认是打印A4纸的大小的,所以打印完后会伸出蛮多空白的,</div>\n<div>那三联单的规格盒子上写着9\"*11\"的,但是在打印的时候选择这个尺寸,打印出来还是有多余空白的,上网查看才知道9\"*11\"的大小是241mm*280mm的大小的,但是我用尺子量是241mm*93mm,相差太大了,怪不得有多余空白,默认的打印尺寸里没有241*93的,只能自己建立一个:</div>\n<div>控制面板→设备和打印机→打印服务属性 ,新建一个表单是241mm*93mm的,然后设置打印的默认纸张大小是这个就可以了</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>打印的时候觉得打得慢的话是在打印首选项→纸张/质量→高级,打印机功能→打印质量里选择\"超高速(单向)\",打印的速度会快上一点的,</div>\n<div><br />\n</div>\n<div>然后在Web里打印,自己测试了一下,只要表格弄成100%自动适应宽度,直接调用浏览器的打印功能,他会自动的适应纸张大小的...</div>\n	                          ',NULL,920,'0103','随笔',NULL,0),(1085,'2012-12-12 14:52:49','小说分割关键代码','前几天刚刚做好代码生成器生成Access部分的模块，随便做了个小说站测试了一下，还可以。。。。<br />\n<a href=\"http://niunan.net/xiaoshuo\" target=\"_blank\">http://niunan.net/xiaoshuo</a><br />\n<br />\n网站只是实现了Access数据库简单的增删查改功能，整站难点主要在于上传Txt文本后进行小说章节的分割，需要用到Regex.Split方法，经测试发现如果用于分隔的正则表达式中含有分组的时候，则分割出来的数组跟想象中的有区别，以下是关键代码：<br />\n<br />\nc#<br />\n<div>string pat = \"第(.){0,10}(章|卷).+\"; // 小说分隔的正则表达式</div>\n<div>int addsum = 3; // 每次加的值是正则中的分组数+1;<br />\n<br />\n<div>//查看目录及章节</div>\n<div>protected void upload_zj(object sender, EventArgs e)</div>\n<div>{</div>\n<div>&nbsp; &nbsp; try</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; litmes.Text = \"\";</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; string filepath = litfile.Text;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; if (filepath.Length == 0)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Utility.Tool.Alert(\"请先查看目录后再进行本操作。\", this.Page);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; StreamReader sr = new StreamReader(filepath, Encoding.Default);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; string tmp = sr.ReadToEnd();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; string ss = Regex.Split(tmp, pat);</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; StringBuilder sb = new StringBuilder(); //章节名</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Regex r = new Regex(pat, RegexOptions.IgnoreCase);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Match m = r.Match(tmp);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; int matchCount = 0;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; if (ss.Length &gt; 0)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sb.Append(\"&lt;h3&gt;前言&lt;/h3&gt;\" + ss0 + \"&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; while (m.Success)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matchCount += addsum; // 每次加的值是正则中分组数+1</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Group g = m.Groups0;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sb.Append(\"&lt;h3&gt;\" + g + \"&lt;/h3&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (matchCount &lt; ss.Length)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sb.Append(ssmatchCount + \"&lt;br /&gt;\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = m.NextMatch();</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; litmes.Text += \"分隔出来的数组长度：\" + ss.Length + \"&lt;br /&gt;&lt;hr /&gt;\" + sb.ToString();</div>\n<div>&nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; catch (Exception ex)</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; Niunan.Utility.Tool.Alert(ex.Message, this.Page);</div>\n<div>&nbsp; &nbsp; }</div>\n<div>}</div>\n<br />\n</div>\n/c#<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,857,'0101','ASP.NET',NULL,0),(1084,'2012-11-18 12:44:33','神舟官网驱动真坑爹','买了神舟U43 D1本本。开始的时候装SQL2012总是装不上，最后终于查明原因，WIN7家庭版的不能装，最后还是升级为了奇贱版才能装了，装软件的速度还是慢慢的，没有想象中的快，以为会像启动一样刷一下就过去了，郁闷。<br />\n开始的时候开什么软件都卡卡的，鼠标总是处于转圈圈的状态，过几天了又不知道怎么的又好了，可能是因为下载了N多补丁来安装吧。<br />\n<br />\n昨天一时手贱上神舟官网下了个显示卡驱动，结果重启后黑屏，找了好久的原因，开始以为是FN+F9关屏按错了，可是连续按了好几次都不行，甚至按了复位键 了也不行，有几次开机的时候全黑的，都看不到开机时神舟字样的界面，好不容易搞得有次开机显示神舟字样的界面了，进了安全模式，下载了金山重装高手来搜索驱动，结果就搜索出驱动里有显示卡驱动的，点来看详细介绍，结果就有一项介绍是 “修复上一版本中重启后黑屏的问题” ，真是日哦。。。官网真坑爹。。<br />\n	                          ',NULL,639,'0103','随笔',NULL,0),(1083,'2012-11-04 22:40:00','全局搜索MSSQL数据库','sql<br />\n<br />\ndeclare&nbsp; @t&nbsp; varchar(255),@c&nbsp; varchar(255)&nbsp; <br />\n<br />\ndeclare&nbsp; table_cursor&nbsp; cursor&nbsp; for&nbsp; <br />\n<br />\nselect&nbsp; a.name,b.name&nbsp; from&nbsp; sysobjects&nbsp; a,syscolumns&nbsp; b&nbsp; <br />\n<br />\nwhere&nbsp; a.id=b.id&nbsp; and&nbsp; a.xtype=&#039;u&#039; <br />\n<br />\nopen&nbsp; table_cursor&nbsp; fetch&nbsp; next&nbsp; from&nbsp; table_cursor&nbsp; <br />\n<br />\ninto&nbsp; @t,@c&nbsp; <br />\n<br />\nwhile(@@fetch_status=0)&nbsp; <br />\n<br />\nbegin&nbsp; <br />\n<br />\n&nbsp;&nbsp;&nbsp; exec(&#039; if exists(select top 1 * from&nbsp; &#039; + @t + &#039;&nbsp; where&nbsp; &#039; + @c + &#039; like &#039;&#039;%金桥汽贸购车优惠大酬宾%&#039;&#039;) begin select * from &#039; + @t + &#039;&nbsp; where&nbsp; &#039; + @c + &#039; like &#039;&#039;%金桥汽贸购车优惠大酬宾%&#039;&#039; print &#039;&#039;&#039;+@t+&#039;&#039;&#039; end&#039;)<br />\n<br />\n&nbsp;&nbsp;&nbsp; fetch&nbsp; next&nbsp; from&nbsp; table_cursor&nbsp; into&nbsp; @t,@c&nbsp; <br />\n<br />\nend<br />\n<br />\nclose&nbsp; table_cursor&nbsp; deallocate&nbsp; table_cursor;<br />\n/sql	                          ',NULL,715,'0106','SQL',NULL,0),(1082,'2012-11-02 15:35:28','更改表的架构名的SQL语句','sql ALTER SCHEMA 新架构 TRANSFER 旧架构.对象名称 /sql	                          ',NULL,599,'0106','SQL',NULL,0),(1081,'2012-08-23 16:36:29','Windows下后缀为*.zip.001文件的解压方法','<p>后缀为*.zip.001文件用winrar无法解压</p>\n<p>解决办法是在windows下打开命令行界面</p>\n<p>输入：copy /B xx.zip.001+xx.zip.002 xx.zip</p>\n<p>然后用winrar解压xx.zip 即可。</p>\n<p>在Linux终端下：</p>\n<p>cat xx.zip.001 xx.zip.002 xx.zip</p>\n<p>unzip xx.zip</p>\n	                          ',NULL,639,'0111','工具使用',NULL,0),(1080,'2012-08-15 17:03:40','session验证放在继承类中','c#<br />\nusing System;<br />\nusing System.Collections.Generic;<br />\nusing System.Linq;<br />\nusing System.Web;<br />\n<br />\nnamespace NCNEWS.Web<br />\n{<br />\n&nbsp;&nbsp;&nbsp; public class ValidatorPage : System.Web.UI.Page<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //pageunload事件，并不是指浏览器关闭，而是指页面关闭，所以刷新的时候，依然会执行以下事件 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected void Page_Unload(object sender, EventArgs e)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void OnPreInit(EventArgs e)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.OnPreInit(e);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Session\"user\" == null)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {//这里写 跳转到登陆页面：例如： <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; Response.Redirect(string.Format(\"/adminlogin.aspx?page={0}\", Server.UrlEncode(Request.Url.ToString())));<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(\"&lt;script&gt;window.parent.location.href=&#039;\"+Niunan.Utility.Tool.GetApplicationPath()+\"admin/login.aspx&#039;&lt;/script&gt;\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.End();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; }<br />\n}<br />\n/c#	                          ',NULL,796,'0101','ASP.NET',NULL,0),(1079,'2012-08-09 00:11:39','黑马程序员.NET视频推广连接','<p>	                          <a href=\"http://www.wenlele.com:8081/View-6-617.aspx\">http://www.wenlele.com:8081/View-6-617.aspx</a></p>\n<p>要一定的积分才可以得到光盘啊...郁闷哦...</p>\n',NULL,544,'0103','随笔',NULL,0),(1078,'2012-08-03 17:07:55','js让页面不响应回车事件','&lt;body&nbsp;  onkeydown=\"if(event.keyCode==13){window.event.keyCode==0;window.event.returnValue=false}\"&gt;&nbsp;  <br />\n&nbsp; &nbsp; <br />\n&nbsp; 这样,整个网页都不会响应回车了.	                          ',NULL,403,'0105','javascript',NULL,0),(1077,'2012-06-05 22:04:55','华为网盘直链-飞流直下，顺畅体验','<!--if gte mso 9><xml> <w :WordDocument>  <w :View>Normal</w :View>  <w :Zoom>0</w :Zoom>  <w :TrackMoves/>  <w :TrackFormatting/>  <w :PunctuationKerning/>  <w :DrawingGridVerticalSpacing>7.8 磅</w :DrawingGridVerticalSpacing>  <w :DisplayHorizontalDrawingGridEvery>0</w :DisplayHorizontalDrawingGridEvery>  <w :DisplayVerticalDrawingGridEvery>2</w :DisplayVerticalDrawingGridEvery>  <w :ValidateAgainstSchemas/>  <w :SaveIfXMLInvalid>false</w :SaveIfXMLInvalid>  <w :IgnoreMixedContent>false</w :IgnoreMixedContent>  <w :AlwaysShowPlaceholderText>false</w :AlwaysShowPlaceholderText>  <w :DoNotPromoteQF/>  <w :LidThemeOther>EN-US</w :LidThemeOther>  <w :LidThemeAsian>ZH-CN</w :LidThemeAsian>  <w :LidThemeComplexScript>X-NONE</w :LidThemeComplexScript>  <w :Compatibility>   <w :SpaceForUL/>   <w :BalanceSingleByteDoubleByteWidth/>   <w :DoNotLeaveBackslashAlone/>   <w :ULTrailSpace/>   <w :DoNotExpandShiftReturn/>   <w :AdjustLineHeightInTable/>   <w :BreakWrappedTables/>   <w :SnapToGridInCell/>   <w :WrapTextWithPunct/>   <w :UseAsianBreakRules/>   <w :DontGrowAutofit/>   <w :SplitPgBreakAndParaMark/>   <w :DontVertAlignCellWithSp/>   <w :DontBreakConstrainedForcedTables/>   <w :DontVertAlignInTxbx/>   <w :Word11KerningPairs/>   <w :CachedColBalance/>   <w :UseFELayout/>  </w :Compatibility>  <w :BrowserLevel>MicrosoftInternetExplorer4</w :BrowserLevel>  <m :mathPr>   <m :mathFont m:val=\"Cambria Math\"/>   <m :brkBin m:val=\"before\"/>   <m :brkBinSub m:val=\"&#45;-\"/>   <m :smallFrac m:val=\"off\"/>   <m :dispDef/>   <m :lMargin m:val=\"0\"/>   <m :rMargin m:val=\"0\"/>   <m :defJc m:val=\"centerGroup\"/>   <m :wrapIndent m:val=\"1440\"/>   <m :intLim m:val=\"subSup\"/>   <m :naryLim m:val=\"undOvr\"/>  </m :mathPr></w :WordDocument></xml><!endif--><!--if gte mso 9><xml> <w :LatentStyles deflockedstate=\"false\" defunhidewhenused=\"true\" defsemihidden=\"true\" defqformat=\"false\" defpriority=\"99\" latentstylecount=\"267\">  <w :LsdException locked=\"false\" priority=\"0\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Normal\"/>  <w :LsdException locked=\"false\" priority=\"9\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"heading 1\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 2\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 3\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 4\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 5\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 6\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 7\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 8\"/>  <w :LsdException locked=\"false\" priority=\"9\" qformat=\"true\" name=\"heading 9\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 1\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 2\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 3\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 4\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 5\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 6\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 7\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 8\"/>  <w :LsdException locked=\"false\" priority=\"39\" name=\"toc 9\"/>  <w :LsdException locked=\"false\" priority=\"35\" qformat=\"true\" name=\"caption\"/>  <w :LsdException locked=\"false\" priority=\"10\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Title\"/>  <w :LsdException locked=\"false\" priority=\"1\" name=\"Default Paragraph Font\"/>  <w :LsdException locked=\"false\" priority=\"11\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Subtitle\"/>  <w :LsdException locked=\"false\" priority=\"0\" name=\"Hyperlink\"/>  <w :LsdException locked=\"false\" priority=\"22\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Strong\"/>  <w :LsdException locked=\"false\" priority=\"20\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Emphasis\"/>  <w :LsdException locked=\"false\" priority=\"59\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Table Grid\"/>  <w :LsdException locked=\"false\" unhidewhenused=\"false\" name=\"Placeholder Text\"/>  <w :LsdException locked=\"false\" priority=\"1\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"No Spacing\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 1\"/>  <w :LsdException locked=\"false\" unhidewhenused=\"false\" name=\"Revision\"/>  <w :LsdException locked=\"false\" priority=\"34\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"List Paragraph\"/>  <w :LsdException locked=\"false\" priority=\"29\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Quote\"/>  <w :LsdException locked=\"false\" priority=\"30\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Intense Quote\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 1\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 2\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 3\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 4\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 5\"/>  <w :LsdException locked=\"false\" priority=\"60\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Shading Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"61\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light List Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"62\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Light Grid Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"63\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 1 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"64\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Shading 2 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"65\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 1 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"66\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium List 2 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"67\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 1 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"68\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 2 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"69\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Medium Grid 3 Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"70\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Dark List Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"71\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Shading Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"72\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful List Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"73\" semihidden=\"false\" unhidewhenused=\"false\" name=\"Colorful Grid Accent 6\"/>  <w :LsdException locked=\"false\" priority=\"19\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Subtle Emphasis\"/>  <w :LsdException locked=\"false\" priority=\"21\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Intense Emphasis\"/>  <w :LsdException locked=\"false\" priority=\"31\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Subtle Reference\"/>  <w :LsdException locked=\"false\" priority=\"32\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Intense Reference\"/>  <w :LsdException locked=\"false\" priority=\"33\" semihidden=\"false\" unhidewhenused=\"false\" qformat=\"true\" name=\"Book Title\"/>  <w :LsdException locked=\"false\" priority=\"37\" name=\"Bibliography\"/>  <w :LsdException locked=\"false\" priority=\"39\" qformat=\"true\" name=\"TOC Heading\"/> </w :LatentStyles></xml><!endif--><!--if gte mso 10><style> /* Style Definitions */ table.MsoNormalTable	{mso-style-name:普通表格;	mso-tstyle-rowband-size:0;	mso-tstyle-colband-size:0;	mso-style-noshow:yes;	mso-style-priority:99;	mso-style-qformat:yes;	mso-style-parent:\"\";	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;	mso-para-margin:0cm;	mso-para-margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:10.0pt;	font-family:\"Times New Roman\",\"serif\";}</style><!endif--><p class=\"MsoNormal\"><span lang=\"EN-US\"><span style=\"mso-spacerun:yes;\">&nbsp;&nbsp; </span></span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">华为网盘直链即将上线，直链是华为网盘为站长、应用开发者、内容发布者等用户提供的文件分享服务，支持图片展示、音视频文件在线播放和多种格式文件下载。下载地址不会跳转，直接下载。</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><b><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">主要功能：</span></b></p>\n<p class=\"MsoNormal\" style=\"margin-left:0cm;text-indent:0cm;mso-list:l0 level1 lfo1;\"><span style=\"mso-fareast-font-family:&quot;Times New Roman&quot;\" lang=\"EN-US\"><span style=\"mso-list:ignore;\">1. </span></span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">支持图片展示、音视频文件在线播放和文件直接下载；</span></p>\n<p class=\"MsoNormal\" style=\"margin-left:0cm;text-indent:0cm;mso-list:l0 level1 lfo1;\"><span style=\"mso-fareast-font-family:&quot;Times New Roman&quot;\" lang=\"EN-US\"><span style=\"mso-list:ignore;\">2. </span></span><span lang=\"EN-US\">API</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">对接，下载者直接点击该地址链接即启动下载；</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">3. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">页面不会跳转至华为网盘，下载极速，体验感出众。</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><b><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">功能优势：</span></b></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">1. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">网络覆盖全国，</span><span lang=\"EN-US\">40</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">余个服务器节点保障文件传输快速、稳定！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">2. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">按下载流量精准计费，较之传统</span><span lang=\"EN-US\">IDC</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">服务节省成本至</span><span lang=\"EN-US\">50%</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">3. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">支持各类型文件直接下载，以及图片浏览、音视频文件播放！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">4. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">零门槛对接</span><span lang=\"EN-US\">API</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">，嵌入代码不过</span><span lang=\"EN-US\">10</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">行！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">5. </span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">一对一技术支持，专业导购全天候在线帮助！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">华为网盘直链产品将于</span><span lang=\"EN-US\">6</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">月</span><span lang=\"EN-US\">19</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">日正式上线，</span><span lang=\"EN-US\">6</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">月</span><span lang=\"EN-US\">4</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">日</span><span lang=\"EN-US\">-19</span><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">日面向指定用户举行流量预售活动。</span></p>\n<p class=\"MsoNormal\"><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">预售用户可以在正式上线前免费试用！</span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n<p class=\"MsoNormal\"><span style=\"font-family:宋体;mso-ascii-font-family:&quot;Times Newroman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;\">官方地址：</span><span lang=\"EN-US\"><a href=\"http://bbs.dbank.com/thread-61589-1-1.html\">http://bbs.dbank.com/thread-61589-1-1.html</a></span></p>\n<p class=\"MsoNormal\"><span lang=\"EN-US\">&nbsp;</span></p>\n	                          ',NULL,685,'0103','随笔',NULL,0),(1076,'2012-03-28 09:38:10','用于获取分类表编号的一个存储过程','sql<br />\n-- =============================================<br />\n-- Author:&nbsp;&nbsp;牛腩<br />\n-- Create date: 2012年3月28日9时33分<br />\n-- Description:&nbsp;从01循环到99，取出不存在的编号<br />\n-- =============================================<br />\ncreate PROCEDURE dbo.GenCate;ryBH<br />\n&nbsp;@FrontStr varchar(11) --前缀<br />\nAS<br />\nBEGIN<br />\n&nbsp;declare @i int<br />\n&nbsp;declare @var varchar(5)<br />\n&nbsp;set @i=1<br />\n&nbsp;set @var=&#039;01&#039;<br />\n&nbsp;while (select count(1) from t_releasecate;ry where bh=@FrontStr+@var<br />\n&nbsp; begin <br />\n&nbsp; -- print @FrontStr+@var+&#039; 已存在&#039;<br />\n&nbsp;&nbsp; set @i=@i+1 <br />\n&nbsp;&nbsp; SELECT @var= RIGHT&nbsp;&nbsp; (CAST&nbsp;&nbsp; (100&nbsp;&nbsp; +&nbsp; @i&nbsp; AS&nbsp;&nbsp; varchar),&nbsp;&nbsp; 2) <br />\n&nbsp; end<br />\n&nbsp;-- print @FrontStr+@var+&#039; 不存在&#039;<br />\n&nbsp;select @var<br />\nEND<br />\n/sql',NULL,654,'0106','SQL',NULL,0),(1075,'2012-03-19 09:36:10','SQL SERVER PIVOT 使用(SQL列旋转)','网上看到的一篇文章，觉得不错，摘录下来：<br />\n<img src=\"http://blog.niunan.net/upload/20120319093531.jpg\" alt=\"\" border=\"0\" /><br />\n以上SQL语句测试通过，以下是我的测试写的SQL语句：<br />\nsql<br />\n<div><div>create database niunantest</div>\n<div>;</div>\n<div>use niunantest</div>\n<div>;</div>\n<div>create table students(</div>\n<div>编号 int ,</div>\n<div>姓名 nvarchar(20),</div>\n<div>课程 nvarchar(20),</div>\n<div>成绩 float&nbsp;</div>\n<div>)</div>\n<div>;</div>\n<div>insert into students(1,&#039;张健&#039;,&#039;化学&#039;,89)</div>\n<div>insert into students(2,&#039;王剑&#039;,&#039;数学&#039;,70)</div>\n<div>insert into students(1,&#039;张健&#039;,&#039;数学&#039;,100)</div>\n<div>;</div>\n<div>select * from students</div>\n<div>;</div>\n<div>select 编号1,姓名1,化学,数学</div>\n<div>from</div>\n<div>(select 编号 as 编号1,课程,成绩,姓名 as 姓名1</div>\n<div> from students) as p</div>\n<div>pivot</div>\n<div>(</div>\n<div>avg(成绩) for 课程 in (编号,姓名,化学,数学)&nbsp;</div>\n<div>) as p2</div>\n</div>\n/sql<br />\n	                          	                          ',NULL,683,'0106','SQL',NULL,0),(1074,'2012-01-17 15:58:54','在一堆数中查询相加得某个数的组合','如题，一个网友问的，我又去问其他的网友，再网上搜索，发贴问，最后终于解决，不过目前还没有明白为什么要这样写，以下是代码：<br />\nc#<br />\n<div>&nbsp; class Program</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; static void Main(string args)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; double numbers = new double { 258.5, 1229.1, 39.6, 660.3, 660, 660, 165, 165, 3060, 270, 4.8, 440, 279.06, 47.89, 38.02, 600, 286, 63.36, 1530, 1320, 1344, 3954 };</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(\"原数列：258.5,1229.1,39.6,660.3,660,660,165,165,3060,270,4.8,440,279.06,47.89,38.02,600,286,63.36,1530,1320,1344,3954\\n\\n\");</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SumFinder.FindSum(numbers, 7785.52);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // SumFinder.FindSum(new double{1,2,2,3,5}, 10);</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; }</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; static class SumFinder</div>\n<div>&nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public static void FindSum(double numbers, double targetSum)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int elementCount = numbers.Length;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int lastCombination = 2 &lt;&lt; elementCount - 1;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int firstCombination = 1;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; double sum;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int i = firstCombination; i &lt;= lastCombination; i++)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sum = 0;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int pos = 0; pos &lt; elementCount; pos++)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((i &amp; (1 &lt;&lt; pos)) != 0) //当前组合第pos个数是否取中</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sum += numberspos;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (sum == targetSum)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string str = \"\";</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int pos = 0; pos &lt; elementCount; pos++)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((i &amp; (1 &lt;&lt; pos)) != 0)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str += numberspos+\" + \";</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.Write(str.Substring(0,str.Length-3)+\" = \" + targetSum);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.WriteLine(\"结束\");</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Console.ReadLine();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; }</div>\n/c#<br />\n',NULL,602,'0101','ASP.NET',NULL,0),(1073,'2012-01-12 15:42:39','asp.net中使用swfupload上传大文件','<p>花了一天多时间研究出来的，其实也就是网上下别人的代码然后再自己修修改改的，真够花时间的，经测试上传得100MB的文件，效果截图如下：<br />\n<img src=\"http://blog.niunan.net/upload/20120112154046.jpg\" alt=\"\" border=\"0\" /><br />\nquote备忘录：<br />\n<p>·示例中默认最大上传文件大小是100M，如果需要修改的除了要修改JS中定义的值之外别忘记修改web.config文件中的httpRuntime节点定义的值</p>\n<p><br />\n</p>\n<p>·JS的事件定义中隐藏了一些输出提示信息的代码的，要调试的可以自己取消注释，事件里的一些参数是什么意思可自己去搜索;OGLE</p>\n<p><br />\n</p>\n<p>·也可以直接设置定义中的 debug: true打开调试信息，这样可能看得更清楚一点</p>\n<p><br />\n</p>\n<p>·不要从网上下载不同的swfupload版本来覆盖项目中的版本，主要是swfupload.js文件不能动</p>\n<p><br />\n</p>\n<p>·本示例在Chrome 15.0.874.121 m,FireFox 8.0.1，IE9的两种兼容模式下测试通过</p>\n/quote<br />\n<br />\n<span style=\"font-size:18px;color:#f10b00;\">示例下载地址：</span><a href=\"http://niunan.net/download/swfupload.rar\" target=\"_blank\"><span style=\"font-size:18px;color:#f10b00;\">http://niunan.net/download/swfupload.rar</span></a><br />\n<br />\n</p>\n	                          ',NULL,1554,'0101','ASP.NET',NULL,0),(1072,'2011-12-26 20:51:14','repeater控件在绑定的时候添加行号','最好的方法当然就是在提取数据的时候连行号也一起取出来，SQL Server中有row_number()函数，但是最近做的一个项目用的是MYSQL的，上网查了一下，没有现成的函数，网上说要自己写，懒得写了，直接在程序中输出行号就好，在绑定的时候可以用 &lt;%# Container.ItemIndex+1 %&gt;来绑定行号的，但是这种做法如果有分页的话，那么行号又是从1开始了。<br />\n自己想了一下，解决如下：<br />\n用的是anp分页控件，那就可以得到从几开始的数了，这样就可以输出行号了，<br />\n前台绑定代码如下：<br />\nc#&nbsp; &nbsp;&lt;%# GetXH(Container.ItemIndex) %&gt;/c#<br />\n后台代码如下：<br />\nc#<br />\n<div>&nbsp; &nbsp; &nbsp; &nbsp; //获取序号</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; public string GetXH(object index)</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;return (((anp.CurrentPageIndex - 1) * anp.PageSize) + int.Parse(index.ToString())+1).ToString();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (anp.StartRecordIndex + int.Parse(index.ToString())).ToString();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; }</div>\n/c#<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,690,'0101','ASP.NET',NULL,0),(1071,'2011-12-14 10:33:51','asp.net中使用MYSQL参数化的方法','在做一个项目，ASP.NET操作MYSQL数据库的，使用参数化方法，开始的时候用@,发现不成，后来上网查了才知道，原来得用?，代码如下：用到了我自己写的那个MYSQLHELPER类<br />\nc#<br />\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MySqlConnection conn = new MySqlConnection(connstr);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conn.Open();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MySqlCommand cmd = new MySqlCommand(\"select count(1) from qyexam_notice where title=?title\",conn);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmd.Parameters.Add(new MySqlParameter(\"?title\", \"《测试试卷》2011/12/14 10:47:00开始\"));</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; object obj = cmd.ExecuteScalar();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conn.Close();</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Response.Write(\"结果：\"+obj);</div>\n/c#<br />\n',NULL,609,'0101','ASP.NET',NULL,0),(1070,'2011-12-07 10:28:39','一时兴起在115上开的圈子','<div>牛腩编程学习电子书</div>\n<div>http://q.115.com/109559</div>\n<div><br />\n</div>\n<div>牛腩编程学习视频</div>\n<div>http://q.115.com/109559</div>\n<div><br />\n</div>\n	                          ',NULL,546,'0103','随笔',NULL,0),(1069,'2011-11-22 14:28:31','保留N位小数的方法','js<br />\n<div>//保留N位小数</div>\n<div>function formatFloat(src, pos) {</div>\n<div>&nbsp; &nbsp; return Math.round(src * Math.pow(10, pos)) / Math.pow(10, pos);</div>\n<div>}</div>\n/js	                          ',NULL,551,'0105','javascript',NULL,0),(1068,'2011-11-16 14:43:50','去掉数字中多余的0(MSSQL)','有如下需求：<br />\n<img src=\"http://blog.niunan.net/upload/20111116144016.jpg\" alt=\"\" border=\"0\" /><br />\n自己在MSSQL里写了个函数，用于把输入的数字转为对应的格式的，也是从网上抄的，备用。<br />\nsql<br />\n<div><div><div>-- =============================================<br />\n-- Author:		牛腩<br />\n-- Create date: 2011年11月16日14时9分<br />\n-- Description:	格式化浮点数，去掉多余的0<br />\n-- =============================================<br />\nCREATE FUNCTION dbo.formatfloat <br />\n(<br />\n	-- Add the parameters for the function here<br />\n	@numstr nvarchar(50)<br />\n)<br />\nRETURNS nvarchar(50)<br />\nAS<br />\nBEGIN<br />\n	-- Declare the return variable here<br />\n	DECLARE @Result nvarchar(50)<br />\n<br />\n	-- Add the T-SQL statements to compute the return value here<br />\n	select @Result=case when charindex(&#039;.&#039;,@numstr)&gt;0 then <br />\n                left(@numstr,charindex(&#039;.&#039;,@numstr)-1)+ <br />\n                case when convert(int,substring(@numstr,charindex(&#039;.&#039;,@numstr)+1,len(@numstr)))=0 then &#039;&#039;<br />\n                    else &#039;.&#039;+reverse(convert(nvarchar(20),convert(int,reverse(substring(@numstr,charindex(&#039;.&#039;,@numstr)+1,len(@numstr))))))<br />\n                    end<br />\n            else @numstr end<br />\n<br />\n	-- Return the result of the function<br />\n	RETURN @Result<br />\n<br />\nEND<br />\n</div>\n</div>\n</div>\n/sql<br />\n	                          	                          	                          ',NULL,600,'0106','SQL',NULL,0),(1067,'2011-11-16 14:39:45','去掉数字中多余的0(ASP.NET)','有这样一个需求，见下图：<br />\n<img src=\"http://blog.niunan.net/upload/20111116143659.jpg\" alt=\"\" border=\"0\" /><br />\n具体的在ASP.NET中的实现代码如下：<br />\nc#<br />\n<div>double d = 44.12457800;</div>\n<div>Response.Write(d.ToString(\"0.##\"));</div>\n/c#<br />\n不过上面的代码有个问题，他是只保留2位小数，如果数字是2.3405000，则转换出来的只是2.34，而不是2.3405，怎么样可以保留2.3405这我就不懂了，没仔细研究，上面的代码可以在项目中使用即可',NULL,631,'0101','ASP.NET',NULL,0),(1066,'2011-11-03 23:43:54','KindEditor编辑器在ASP.NET中通过后台取值','<p>3.5.5版本中,后台通过TextBox1.Text一般来说可以获取到值,但是有些时候获取出来的值是空的,这时候只要在前台的KE初始化参数中加个参数 syncType: \"auto\" 就行了,具体原因我也不知道,只知道加上这个就可以解决了.下面给出前台的完成的初始化代码<br />\njs<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KE.show({<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id: &#039;&lt;%=txtintro.ClientID %&gt;&#039;,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resizeMode: 1,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allowPreviewEmoticons: false,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allowUpload: false,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; items: <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&#039;fontname&#039;, &#039;fontsize&#039;, &#039;|&#039;, &#039;textcolor&#039;, &#039;bgcolor&#039;, &#039;bold&#039;, &#039;italic&#039;, &#039;underline&#039;, &#039;lineheight&#039;,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&#039;removeformat&#039;, &#039;|&#039;, &#039;justifyleft&#039;, &#039;justifycenter&#039;, &#039;justifyright&#039;, &#039;insertorderedlist&#039;,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&#039;insertunorderedlist&#039;, &#039;|&#039;, &#039;emoticons&#039;, &#039;image&#039;, &#039;link&#039;,<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; syncType: \"auto\"</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br />\n/js<br />\n</p>\n',NULL,987,'0101','ASP.NET',NULL,0),(1065,'2011-10-07 12:47:00','ASP.NET读取二进制文件输出图片','有位朋友问我能不能用程序把淘宝上导出的CVS文件读出来导入到自己的程序，刚刚试了一下，发现只要把cvs文件另存成XLS文件以后，就可以使用我那个NPOI的方法来导入了，在测试的时候发现，淘宝导出的东西里还有一个文件夹，里面是一大堆的*.tbi文件的，看了一下，前面的*名字正好是在cvs文件中图片列的下面出现，由此可知这些*.tbi文件其实就是图片文件（也有可能是视频），随便测试了一下，把其中一个文件的tbi后缀改为jpg后缀以后，真的就可以直接看到图片了，这样我们就可以用程序把这些tbi文件读成文件流，然后再重新保存成JPG图片显示出来了，下面是我用一般处理程序弄的示例代码：<br />\n<br />\nASHX文件核心代码<br />\nc#<br />\n WebService(Namespace = \"http://tempuri.org/\")<br />\n&nbsp;&nbsp;&nbsp; WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)<br />\n&nbsp;&nbsp;&nbsp; public class showimg : IHttpHandler<br />\n&nbsp;&nbsp;&nbsp; {<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void ProcessRequest(HttpContext context)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bitmap bitmap = new Bitmap(context.Server.MapPath(\"a7.tbi\"));<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.Response.ContentType = \"image/jpeg\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmap.Save(context.Response.OutputStream, System.Drawing.Imaging.ImageFormat.Jpeg);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool IsReusable<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; }<br />\n/c#<br />\n<br />\n要查看图片可在default页面中加入一个img标签，src是这个ashx即可<br />\nhtml<br />\n&lt;img src=\"showimg.ashx\" /&gt;<br />\n/html<br />\n<br />\n示例代码下载：<a target=\"_blank\" href=\"http://niunan.net/download/Binary2JPG.rar\">http://niunan.net/download/Binary2JPG.rar</a><br />\n',NULL,1302,'0101','ASP.NET',NULL,0),(1064,'2011-10-06 10:56:04','MSSQL 大量数据时,建立索引或添加字段后保存更改提示超时的解决方法','一般我们都喜欢用数据库管理器的UI来对数据表结构进行更改,然后自然而然地点\"保存\" 按钮进行保存,但数据量比较大的时候,用这招往往会出现\"无法创建索引“IX_索引名”。 超时时间已到。在操作完成之前超时时间已过或服务器未响应。 \"这种错误。一时不知所措，<br />\n<br />\n经搜索，整理一下具体的做法，很简单，但没人教我这么做的时候，就只能干瞪眼： <br />\n<br />\n在更改数据量大的表格数据结构时，不要点“保存”按钮，而是在表结构编辑框左侧点右键===》选择“生成更改脚本”,这时出来了文本对话框，把里面的内容全选并复制，并关闭这个表，选择不保存，右击该表所属的数据库，选“新建查询”，之后Ctrl+V把刚复制的脚本粘进来，并运行。这样就再也不会弹出超时的提示了，如果数据量相当大，我们只需要耐心等待即可了！	                          ',NULL,543,'0106','SQL',NULL,0),(1063,'2011-09-28 18:18:35','OnClientClick的window.confirm无效','quote<br />\n<div id=\"cnblogs_post_body\"><p><font face=\"Verdana\">默认写法:</font></p>\n<p><font face=\"Verdana\">OnClientClick=\"return window.confirm(&#039;确认吗？&#039;)\"</font></p>\n<p>只要改成:</p>\n<p><font face=\"Verdana\">OnClientClick=\"if(!window.confirm(&#039;确认吗？&#039;)){event.returnValue = false;}\"</font></p>\n<p>即可<br />\n</p>\n</div>\n/quote	                          <br />\n<br />\n今日在项目中发现的问题，在某一页面 中默认写法无效，但是其他页面的有效，原因未知，只搜索出解决方法。',NULL,603,'0101','ASP.NET',NULL,0),(1062,'2011-09-20 21:28:54','仿淘宝网首页JS滚动图片','<p>刚刚做项目的时候用到的。先记下来，<br />\n效果图如下：<br />\n<img border=\"0\" alt=\"\" src=\"http://blog.niunan.net/upload/20110920212620.png\" /><br />\nHTML页面代码，也包括了JS代码，使用JQUERY来控制：<br />\nhtml<br />\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"<a href=\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>\"&gt;<br />\n&lt;html xmlns=\"<a href=\"http://www.w3.org/1999/xhtml\">http://www.w3.org/1999/xhtml</a>\" xml:lang=\"en\"&gt;<br />\n&lt;head&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\" /&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;title&gt;仿淘宝网首页滚动图片&lt;/title&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp; &lt;link href=\"css/scroll.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;script src=&#039;js/jquery-1.4.2.min.js&#039; type=\"text/javascript\"&gt;&lt;/script&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;script type=\"text/javascript\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(function() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var len = 5; // 图片的数量<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var index = 0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var adTimer;</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //滑入 停止动画，滑出开始动画.<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&#039;#slide&#039;).hover(function() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clearInterval(adTimer);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }, function() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adTimer = setInterval(function() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index++;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (index == len) { index = 0; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showImg(index);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }, 5000);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }).trigger(\"mouseleave\");</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* 鼠标移到索引数字上时 */<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\".tb-slide-triggers li\").mouseover(function() {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clearInterval(adTimer);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var index = $(this).parent(\"ul\").children(\"li\").index(this);&nbsp; // 当前LI的索引<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showImg(index);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* 滚动图片，传入索引 */<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function showImg(index) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 索引号那里换样式<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\".tb-slide-triggers li\").removeClass(\"ks-active\");<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\".tb-slide-triggers li\").eq(index).addClass(\"ks-active\");</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //图片的滚动<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var divnrimg = $(\"#slide\"); // 图片所在的ul<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var adHeight = 170; // 一张图片的高度<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; divnrimg.stop(true, false).animate({ top: -adHeight * index }, 1000);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp; &lt;/script&gt;<br />\n&nbsp;&nbsp; <br />\n&lt;/head&gt;<br />\n&lt;body&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;div class=\"bd\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;div style=\"position: relative;\" class=\"tb-slide\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ol id=\"slide\" style=\"position: absolute;\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li style=\"display: block;\"&gt;&lt;a href=\"#\" target=\"_blank\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img width=\"490px\" height=\"170px\" border=\"0\" src=\"scrollimg/01.jpg\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/a&gt;&lt;/li&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li style=\"display: block;\"&gt;&lt;a target=\"_blank\" href=\"#\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img width=\"490px\" height=\"170px\" border=\"0\" src=\"scrollimg/02.jpg\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/a&gt;&lt;/li&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li style=\"display: block;\"&gt;&lt;a target=\"_blank\" href=\"#\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img width=\"490px\" height=\"170px\" border=\"0\" src=\"scrollimg/03.jpg\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/a&gt;&lt;/li&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li style=\"display: block;\"&gt;&lt;a target=\"_blank\" href=\"#\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img width=\"490px\" height=\"170px\" border=\"0\" src=\"scrollimg/04.jpg\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/a&gt;&lt;/li&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li style=\"display: block;\"&gt;&lt;a href=\"#\" target=\"_blank\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;img width=\"490px\" height=\"170px\" border=\"0\" src=\"scrollimg/05.jpg\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/a&gt;&lt;/li&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ol&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ul class=\"tb-slide-triggers\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;li class=\"ks-active\"&gt;1&lt;/li&gt;&lt;li class=\"\"&gt;2&lt;/li&gt;&lt;li class=\"\"&gt;3&lt;/li&gt;&lt;li class=\"\"&gt;4&lt;/li&gt;&lt;li<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class=\"\"&gt;5&lt;/li&gt;&lt;/ul&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/div&gt;<br />\n&nbsp;&nbsp;&nbsp; &lt;/div&gt;<br />\n&lt;/body&gt;<br />\n&lt;/html&gt;<br />\n<br />\n/html<br />\n<br />\nCSS页面代码：<br />\ncss<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin: 0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; padding: 0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ul,li<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list-style:none;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .tb-slide, .tb-slide li<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; font-size: 0;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; height: 170px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; overflow: hidden;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; width: 490px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .tb-slide<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; border: 1px solid #D8D8D8;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .tb-slide-triggers<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bottom: 5px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; height: 18px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; padding-top: 2px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; position: absolute;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; right: 5px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; z-index: 10;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .tb-slide-triggers li<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #FFFFFF;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; border-radius: 20px 20px 20px 20px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; color: #DE7D4B;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cursor: pointer;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float: left;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; font-size: 13px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; height: 20px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line-height: 20px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin-left: 3px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin-top: -2px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; opacity: 0.7;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; overflow: visible;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; position: relative;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; text-align: center;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; width: 20px;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .tb-slide-triggers li.ks-active<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #FF6600;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; color: #FFFFFF;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filter: none;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; font-weight: bold;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; opacity: 1;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n/css<br />\n<br />\n代码下载： <a href=\"http://niunan.net/download/taobao_scroll.rar\" target=\"_blank\">点击下载</a></p>\n',NULL,1803,'0105','javascript',NULL,0),(1061,'2011-09-19 12:58:04','牛腩自制－进销存结构框架','看过几个项目，像进销存或者OA的，都是以下的结构框架的：<br />\n<img src=\"http://blog.niunan.net/upload/20110919122343.jpg\" alt=\"\" border=\"0\" /><br />\n上、中、下三部分，中间有一个主桌面，点击桌面上的按钮在上部显示相应的tab标签，点击上部的tab标签，中部的页面对应改变，很多人都使用extjs来弄，不过这个我不会，所以自己用自己会的jquery做了相关的代码，我的页面设计如下：<br />\n<img src=\"http://blog.niunan.net/upload/20110919122639.jpg\" alt=\"\" border=\"0\" />主页default.aspx,里面有个frameset，分三个部分，每一部分又对应一个aspx页面，中间部分因为会有多个页面来切换的，所以每个页面放在一个iframe中，所有的iframe都集中在center.aspx这个页面中。<br />\n<br />\n页面弄好了，下面开始写代码，为了让大家看得更清楚，也为了让大家自己打代码增加熟练度，采用截图的方式，首先是center.aspx中的iframe为桌面的页面中的按钮的点击事件：<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20110919123540.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n下面是点击事件的JS代码：<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20110919123730.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n难点是如何找到topFrame中的tab选择卡的集合, 即是上面的代码&nbsp;<br />\njs<br />\n var tab_container = $(window.parent.parent.parent.parent.frames\"topFrame\".document.getElementById(\"tabs_container\"));<br />\n/js<br />\n这个查询的方法会顺着你的HTML的结构的改变而改变的，具体怎么找的得看个人修为了。<br />\n<br />\n核心代码做好了，接下来是top.aspx页面中的代码了，首先是点击tab后显示内容页面的代码：<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20110919124121.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n前面都是设置tab的样式，把之前的选中样式去掉，再把现在的tab加上选中样式，核心也是后面的代码，如何找到mainFrame中的iframe的集合，找到集合后接下来就是根据title显示和隐藏了。<br />\n<br />\n下面是关闭tab标签的代码：<br />\n<img src=\"http://blog.niunan.net/upload/20110919124433.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n也是根据iframe的title来关闭tab的，所以每个页面得有唯一的一个名称，因为桌面是不能关闭的，所以点击桌面我做了另一个点击事件：<br />\n<img src=\"http://blog.niunan.net/upload/20110919124712.jpg\" alt=\"\" border=\"0\" /><br />\n不过感觉这个事件好像可以和前面的opentab整合起来的吧。<br />\n<br />\n最后就是在某个iframe内容页面中也许有个“退出”按钮，功能就是关闭当前的页面和移走top.aspx页面中的tab，代码如下：<br />\n<img src=\"http://blog.niunan.net/upload/20110919125217.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n难点也是如何中default.aspx → certer.aspx → 某一iframe页面中再一步一步的返回找到topFrame中的tab集合，主要就是那个contentWindow，如何是frames&#039;topFrame&#039;是可以用frame&#039;topFrame&#039;.document.getE....的，但是frames这个在上面用不了，即window.parent.parent.frames&#039;topFrame&#039;这个是错误的，具体也不知道是怎么回事，所以就采用了document.get...了，用了这个要再获取里面的window对象就得加上contentWindow了。<br />\n<br />\n代码使用了jquery，记得先导入jquery.js就行.<br />\n<br />\n整个框架及代码搭建完毕！！！	                          ',NULL,1038,'0110','jQuery',NULL,0),(1060,'2011-09-18 21:38:13','文本框中按回车提交表单','大众方法是设置form的defaultbutton的值，但是如果加入了母版页的话就会有问题了，经;OGLE后找到解决方法，通过调用JS来执行button或者linkbutton的提交事件，方法如下：<br />\n1、在母版页中加入如下JS代码：<br />\njs<br />\n&nbsp;&nbsp;&nbsp; &lt;script type=\"text/javascript\"&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function sub(e, buttonid) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var bt = document.getElementById(buttonid);<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (typeof bt == &#039;object&#039;) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (navigator.appName.indexOf(\"Netscape\") &gt; (-1)) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.keyCode == 13) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bt.click();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (navigator.appName.indexOf(\"Microsoft Internet Explorer\") &gt; (-1)) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (event.keyCode == 13) {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bt.click();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; &lt;/script&gt;<br />\n/js<br />\n<br />\n2、***.aspx.cs页面Page_Load事件中加入如下代码：<br />\nc#<br />\n txtname.Attributes.Add(\"onkeydown\", \"return&nbsp; sub(event,&#039;\" + lbtnLogin.ClientID + \"&#039;)\");<br />\ntxtpwd.Attributes.Add(\"onkeydown\", \"return&nbsp; sub(event,&#039;\" + lbtnLogin.ClientID + \"&#039;)\");<br />\n/c#<br />\n<br />\n这样在页面中的文本框输入文本后直接按回车就会提交事件了。ff和ie8下测试通过<br />\n	                          ',NULL,714,'0101','ASP.NET',NULL,0),(1059,'2011-09-17 15:01:01','牛腩学习资料网盘下载','刚刚发现119G的网盘，看起来容量好大，注册了就得119G，不过不知道是不是真的，看中他的“个人空间”的功能，上传到网盘里的东西自动分享到个人空间中，蛮不错的，打算把本人电脑里的一些学习资料都上传到这个网盘中的，包括以前自己做的那些免费视频，大家感兴趣的可前去下载。大家可点击“我的文档目录”查看我的文档目录分类<br />\n<img border=\"0\" alt=\"\" src=\"http://blog.niunan.net/upload/20110917145708.jpg\" /><br />\n<br />\n目前正一点点的上传我的学习资料，估计可能会有好几十G吧。呵呵，不知道传到什么时候，慢慢来吧，要下载的必须注册他的网盘账号，注册地址在下面。<br />\n<br />\n<span style=\"color:#f10b00;font-size:18px;\">牛腩学习资料：</span><a href=\"http://d.119g.com/space/niunan.html\" target=\"_blank\"><span style=\"color:#f10b00;font-size:18px;\">http://d.119g.com/space/niunan.html</span></a><br />\n<span style=\"color:#f10b00;font-size:18px;\">注册链接：</span><a href=\"http://www.119g.com/reg/niunan.html\" target=\"_blank\"><span style=\"color:#f10b00;font-size:18px;\">http://www.119g.com/reg/niunan.html</span></a><span style=\"color:#f10b00;font-size:18px;\"> </span><br />\n<br />\n<br />\n',NULL,748,'0103','随笔',NULL,0),(1058,'2011-08-31 15:56:24','MSSQL游标简记','现有一需求，如图：<br />\n<img alt=\"\" src=\"http://blog.niunan.net/upload/20110831155005.jpg\" border=\"0\" /><br />\n<br />\n现在我想弄好看点，把sort排序字段的值从1开始递增，本来可以在外面用ASP.NET一条一条数据给取出来再慢慢更新的，今日突然想弄弄在光是用SQL语句怎么弄的，看这样子应该得用到游标了，上网查了一下游标的用法，写了个示例，基本懂弄了，代码如图：<br />\n<img src=\"http://blog.niunan.net/upload/20110831155949.jpg\" alt=\"\" border=\"0\" /><br />\n	                          ',NULL,602,'0106','SQL',NULL,0),(1057,'2011-08-30 11:22:29','ASP.NET时间格式的一些备忘','c#<br />\n<div>IFormatProvider culture = new CultureInfo(\"en-GB\"); //英国 &nbsp;日/月/年 时:分:秒</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime d = DateTime.Parse(\"22/2/86\", culture);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"&lt;br /&gt;英国时间：\"+d.ToString());</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IFormatProvider culture2 = new CultureInfo(\"en-US\");//美国 &nbsp;月/日/年 时:分:秒</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime d2 = DateTime.Parse(\"2/22/86\", culture2);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"&lt;br /&gt;美国时间：\" + d2.ToString());</div>\n<div><br />\n</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IFormatProvider culture3 = new CultureInfo(\"zh-CN\"); //中国 &nbsp;年/月/日 时:分:秒</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateTime d3 = DateTime.Parse(\"86/2/22\", culture3);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Response.Write(\"&lt;br /&gt;中国时间：\"+d3.ToString());</div>\n/c#	                          ',NULL,566,'0101','ASP.NET',NULL,0),(1056,'2011-08-21 16:18:10','JS禁止右键和禁止选择文本','<p>js<br />\n/***********************************************<br />\n* Disable Text Selection script- © Dynamic Drive DHTML code library (<a href=\"http://www.dynamicdrive.com\">www.dynamicdrive.com</a>)<br />\n* This notice MUST stay intact for legal use<br />\n* Visit Dynamic Drive at <a href=\"http://www.dynamicdrive.com/\">http://www.dynamicdrive.com/</a> for full source code<br />\n***********************************************/</p>\n<p>function disableSelection(target){<br />\nif (typeof target.onselectstart!=\"undefined\") //IE route<br />\n&nbsp;target.onselectstart=function(){return false}<br />\nelse if (typeof target.style.MozUserSelect!=\"undefined\") //Firefox route<br />\n&nbsp;target.style.MozUserSelect=\"none\"<br />\nelse //All other route (ie: Opera)<br />\n&nbsp;target.onmousedown=function(){return false}<br />\ntarget.style.cursor = \"default\"<br />\n}</p>\n<p>disableSelection(document.body); //disable text selection on entire body of page</p>\n<p>//Disable right mouse click Script<br />\n//By Maximus (<a href=\"mailto:maximus@nsimail.com\">maximus@nsimail.com</a>) w/ mods by DynamicDrive<br />\n//For full source code, visit <a href=\"http://www.dynamicdrive.com\">http://www.dynamicdrive.com</a></p>\n<p>var message=\"Function Disabled!\";</p>\n<p>///////////////////////////////////<br />\nfunction clickIE4()<br />\n{<br />\n&nbsp;if (event.button==2)<br />\n&nbsp;{<br />\n&nbsp;&nbsp;alert(message);<br />\n&nbsp;&nbsp;return false;<br />\n&nbsp;}<br />\n}</p>\n<p>function clickNS4(e)<br />\n{<br />\n&nbsp;if (document.layers||document.getElementById&amp;&amp;!document.all)<br />\n&nbsp;{<br />\n&nbsp;&nbsp;if (e.which==2||e.which==3)<br />\n&nbsp;&nbsp;{<br />\n&nbsp;&nbsp;&nbsp;alert(message);<br />\n&nbsp;&nbsp;&nbsp;return false;<br />\n&nbsp;&nbsp;}<br />\n&nbsp;}<br />\n}</p>\n<p>if (document.layers)<br />\n{<br />\n&nbsp;document.captureEvents(Event.MOUSEDOWN);<br />\n&nbsp;document.onmousedown=clickNS4;<br />\n}<br />\nelse if (document.all&amp;&amp;!document.getElementById)<br />\n{<br />\n&nbsp;document.onmousedown=clickIE4;<br />\n}</p>\n<p>document.oncontextmenu=new Function(\"return false\")<br />\n<br />\n/js<br />\n<br />\n放在页面底部即可<br />\n</p>\n',NULL,725,'0105','javascript',NULL,0),(1055,'2011-08-19 10:43:33','点击浏览器右上角关闭按钮事件','网上抄的，自己测试过发现只有IE有效果，其他浏览器无效果，先记下来以备不时之需。<br />\njs<br />\n<div>&nbsp; &nbsp; &nbsp; window.onbeforeunload = function() {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //直接关闭窗口，IE有效</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var n = window.event.screenX - window.screenLeft;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var b = n &gt; document.documentElement.scrollWidth - 20;</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (b &amp;&amp; window.event.clientY &lt; 0 || window.event.altKey) {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // alert(&#039;关闭窗口&#039;);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $.get(&#039;handler/loginout.ashx?t=&#039; + new Date().valueOf());</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //alert(&#039;刷新页面&#039;);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div>\n<div>&nbsp; &nbsp; &nbsp; }</div>\n/js<br />\n',NULL,540,'0105','javascript',NULL,0),(1054,'2011-08-13 12:08:34','linq添加XML节点简记','chat/chat.xml：<br />\nxml<br />\n<div>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</div>\n<div>&lt;Messages&gt;</div>\n<div>&nbsp; &lt;Message&gt;</div>\n<div>&nbsp; &nbsp; &lt;users&gt;crazyluo&lt;/users&gt;</div>\n<div>&nbsp; &nbsp; &lt;data&gt;ceshide&lt;/data&gt;</div>\n<div>&nbsp; &nbsp; &lt;sendtime&gt;23:25&lt;/sendtime&gt;</div>\n<div>&nbsp; &nbsp; &lt;sendto&gt;me&lt;/sendto&gt;</div>\n<div>&nbsp; &lt;/Message&gt;</div>\n<div>&lt;/Messages&gt;</div>\n/xml<br />\nASP.NET代码：<br />\nc#<br />\n<div>&nbsp;XElement element = XElement.Load(Server.MapPath(\"chat/chat.xml\"));</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; XElement owner = new XElement(\"Message\", new XElement{</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new XElement(\"users\",\"牛腩\"),</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new XElement(\"data\",\"哈哈哈 \"),</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new XElement(\"settime\",DateTime.Now.ToString(\"HH:mm\")),</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new XElement(\"sendto\",\"me\")</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; element.Add(owner);</div>\n<div>&nbsp; &nbsp; &nbsp; &nbsp; element.Save(Server.MapPath(\"chat/chat.xml\"));</div>\n/c#<br />\n<br />\n<br />\n',NULL,556,'0101','ASP.NET',NULL,0),(1053,'2011-08-10 15:59:33','linq读取xml简记','从网上摘录的，正好要用到。先记到自己的博客里，以免忘记。<br />\n<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial;font-size:14px;line-height:25px;\"><p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">添加应用：using System.Xml.Linq;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">读取xml最重要的要知道xml是那种写法，因为linq已经把读取方式封装的相对傻瓜了，要有问题一定xml的结构问题。</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>第一种写法：</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;feeds&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp;<strong>&lt;feed&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>&nbsp;&nbsp; &nbsp;&lt;image&gt;ddddddddd&lt;/image&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>&nbsp;&nbsp; &nbsp;&lt;link&gt;fffffffff&lt;/link&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>&nbsp;&nbsp; &nbsp;&lt;title&gt;ddddddddddddddddd&lt;/title&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>&nbsp;&nbsp;&lt;/feed&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;/feeds&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">Linq语句：</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;XDocument xdoc= XDocument.Load(Server.MapPath(\"xxx.xml\"));</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var ad = from a in&nbsp;xdo<strong>c.Descendants(\"feed\")</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;select new &nbsp;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;image =&nbsp;<strong>a.Element(\"image\").Value,&nbsp;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link = a.Element(\"link\").Value,</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; title = a.Element(\"title\").Value&nbsp;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (var a in ad)</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(a.image);</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>第二种xml</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;BizADsList&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"><strong>&nbsp;&nbsp;&lt;adData aid=\"1\" image=\"815.jpg\" link=\"http://www.dizhitiao.com\" title=\"测试1\"/&gt;</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp;&lt;adData aid=\"2\" image=\"5815.jpg\" link=\"http://www.dizhitiao.com\" title=\"测试2\"/&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&lt;/BizADsList&gt;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">Linq语句：</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\"></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;XDocument adList = XDocument.Load(Server.MapPath(\"Data.xml\"));</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var ad = from a in adList.<strong>Descendants(\"BizADsList\").Elements(\"adData\")</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; select new &nbsp;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image =&nbsp;<strong>a.Attribute(\"image\").Value,</strong></p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; link = a.Attribute(\"link\").Value,</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; title = a.Attribute(\"title\").Value&nbsp;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string s = \"\";</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (var a in ad)</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;s += a.image;</p>\n<p style=\"margin-top:5px;margin-right:auto;margin-left:auto;margin-bottom:5px;text-indent:0px;\">别告诉我没看出区别来。总之一句话，对xml要先多些了解。</p>\n</span>',NULL,722,'0101','ASP.NET',NULL,0),(1052,'2011-08-10 11:20:11','用ALTER TABLE向表添加字段','已经设计好的数据库，现在想给每个表加上一个createdate字段，上网搜索了以下，可用以下语句对单个表添加字段<br />\nsql<br />\n<div>if not &nbsp;exists &nbsp; (select &nbsp; * &nbsp; from &nbsp; syscolumns &nbsp; where &nbsp; id=object_id( &#039;OldMan&#039;) &nbsp; and &nbsp; name= &#039;createdate&#039;) &nbsp;&nbsp;</div>\n<div>ALTER TABLE OldMan ADD createdate datetime not null DEFAULT getdate()</div>\n/sql<br />\n<br />\n至于怎么给数据库中所有的表加上这个字段，就得配合之前我写的查询表结构的语句和那个正则表达式工具的使用了。<br />\n<br />\n<br />\n	                          ',NULL,575,'0106','SQL',NULL,0),(1051,'2011-08-03 21:00:10','换成双线空间，抛弃org域名','<p>原先用的合租空间，二个域名，负担太大，趁现在空间快到期了。重新开了一个双线空间，只保留niunan.net域名，抛弃niunan.org域名。。。以后大家访问此博客可通过<a href=\"http://blog.niunan.net\">http://blog.niunan.net</a>来访问。</p>\n',NULL,427,'0103','随笔',NULL,0),(1050,'2011-07-30 01:54:49','JS禁止右键','先记下来，免得需要用到的时候东找西找<br />\njs<br />\nfunction click(e) {<br />\n&nbsp;if (document.all) { //ie<br />\n&nbsp; if (event.button==1||event.button==2||event.button==3) {<br />\n&nbsp;&nbsp; oncontextmenu=&#039;return false&#039;;<br />\n&nbsp; }<br />\n&nbsp;}<br />\n&nbsp;if (document.layers) { //ff<br />\n&nbsp; if (e.which == 3) {<br />\n&nbsp;&nbsp; oncontextmenu=&#039;return false&#039;;<br />\n&nbsp; }<br />\n&nbsp;}<br />\n}<br />\nif (document.layers) {//other<br />\n&nbsp;document.captureEvents(Event.MOUSEDOWN);<br />\n}<br />\ndocument.onmousedown=click;<br />\ndocument.oncontextmenu = new Function(\"return false;\")<br />\n/js	                          ',NULL,484,'0105','javascript',NULL,0),(1049,'2011-07-22 10:11:35','解决在外国数据库上MSSQL中文乱码的问题','&nbsp; &nbsp; 帮人做的一网站，客户用的是外国的空间和外国的数据库的，建立好数据库，插入数据后，发现插入的数据中的中文都变成了????符号，经上网查询可知，外国数据库的默认排序规则是SQL_Latin1_General_CP1_CI_AS，所以中文会产生乱码，如果改为Chinese_PRC_CI_AS则不会产生乱码，问题是外国数据库也设置了相关的权限，我是不能更改数据库的排序规则的，再经查询可知，如果数据库中的字段设置为nvarchar,ntext之类的类型的时候，不管排序规则是什么，如果插入的SQL语句是：<br />\nsqlinsert into aaa values(N&#039;新闻公告&#039;)/sql<br />\n这样子形式的，前面有个N的，则是可以插入中文的，同样，查询数据库的时候也必须条件前面有N才能查询，如：<br />\nsqlselect * from cftt_news where fl=N&#039;新闻公告&#039;/sql<br />\n以上语句如果不加N的话则查询不出<br />\n<br />\n<br />\n&nbsp; &nbsp; 特此记录，2011年7月22日10时10分47秒',NULL,543,'0106','SQL',NULL,0),(1048,'2011-06-10 11:44:33','解决 ASP.NET Chart 控件出错 为 ChartImg.axd 执行子请求时出错。','	                <p>1. 修改web.Config</p>\n<p>&lt;add key=\"ChartImageHandler\" value=\"storage=file;timeout=20;url=~/TempImages/;\" /&gt;</p>\n<p>将其中的 dir=c:\\TempImages\\ 的绝对路径 修改外 url=~/TempImages/ 相对路径&nbsp; （前提条件：网站文件中必须包含 TempImages文件夹）</p>\n<p>2. 修改</p>\n<p>&lt;add path=\"ChartImg.axd\" verb=\"GET,HEAD\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" validate=\"false\" /&gt;</p>\n<p>为</p>\n<p>&lt;add path=\"ChartImg.axd\" verb=\"GET,<span style=\"color:#ff0000;\"><strong>POST</strong>,</span>HEAD\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" validate=\"false\" /&gt;</p>\n<p>3. 修改 </p>\n<p>&lt;add name=\"ChartImageHandler\" preCondition=\"integratedMode\" verb=\"GET,HEAD\"<br />\n&nbsp;&nbsp;&nbsp; path=\"ChartImg.axd\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;</p>\n<p>为：</p>\n<p>&lt;add name=\"ChartImageHandler\" preCondition=\"integratedMode\" verb=\"GET,HEAD,<span style=\"color:#ff0000;\"><strong>POST</strong></span>\"<br />\n&nbsp;&nbsp;&nbsp; path=\"ChartImg.axd\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;</p>\n<add key=\"ChartImageHandler\" value=\"storage=file;timeout=20;url=~/TempImages/;\"><add path=\"ChartImg.axd\" verb=\"GET,HEAD\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" validate=\"false\"><add path=\"ChartImg.axd\" verb=\"GET,POST,HEAD\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" validate=\"false\"><add name=\"ChartImageHandler\" precondition=\"integratedMode\" verb=\"GET,HEAD\" path=\"ChartImg.axd\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\"><add name=\"ChartImageHandler\" precondition=\"integratedMode\" verb=\"GET,HEAD,POST\" path=\"ChartImg.axd\" type=\"System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\">          	                          </add></add></add></add></add>',NULL,913,'0101','ASP.NET',NULL,0),(1047,'2011-05-03 13:10:28',' 因为此版本的应用程序不支持其项目类型(.csproj),若要打开它,请使用支持此类型项目的版本','有的时候vs无缘无故的出现如下错误：\"因为此版本的应用程序不支持其项目类型(.csproj),若要打开它,请使用支持此类型项目的版本\"<p>解决办法：如果是这个提示，可能是由于你安装mssql是导致的问题<br />\n　　　　　在vs命令行中请运行： devenv.exe /resetskippkgs 即可恢复</p>\n',NULL,944,'0101','ASP.NET',NULL,0),(1046,'2011-04-26 17:34:31','使用SQL语句修改数据库字段','sql<br />\n修改字段：ALTER TABLE 表名 ALTER COLUMN 字段名 NVARCHAR (50) NULL/sql<br />\n先记下来，以备不时之需',NULL,656,'0106','SQL',NULL,0),(1045,'2011-04-22 16:45:31','word中的表格占用好几页，怎么保持每一页都有表格第一页的第一行的表头项目呢？','&nbsp;&nbsp; 自己试过用页头的方法插入表格，结果不行，不能和正文的表格连在一起，搜索后得到如下解决方法：<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;\"><pre id=\"best-answer-content\" class=\"reply-text mb10\" style=\"margin-top:0px;margin-right:0px;margin-bottom:10px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;font-family:arial;white-space:pre-wrap;word-wrap:break-word;zoom:1;line-height:22px;\">quote先选中表头那行，右键“表格属性”在“行”那栏有个“在各页顶端以标题行形式重复出现”，打上√就可以了。/quote</pre></span>',NULL,843,'0111','工具使用',NULL,0),(1044,'2011-03-25 18:22:07','微软官方WP7开发教程','自己整理了一下，只是把那些中文版的docx文档提取了出来了而已<br />\n<br />\n下载：<a target=\"_blank\" href=\"http://u.115.com/file/f343c366b0\">http://u.115.com/file/f343c366b0</a><br />\n<br />\n<img src=\"http://niunan.org/upload/20110325182153.jpg\" alt=\"\" border=\"0\" />	                          	                          ',NULL,1007,'0104','下载',NULL,0),(1043,'2011-03-14 14:17:35','AutoComplete:iexplore.exe 应用程序错误','今天做的公司项目,发现个问题,在非IE浏览器上随意点击都没有问题,但是在IE浏览器下随意点击了有时候会出现<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;\"><pre id=\"question-content\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;font-family:arial;white-space:pre-wrap;word-wrap:break-word;zoom:1;\"><span style=\"color:#013add;\">AutoComplete:iexplore.exe 应用程序错误 </span></pre></span>的提示,然后浏览器就死掉了,上网搜索了一下,网上说是中毒的原因,自己估计应该不是,可能是代码哪里写得有问题了,于是把页面的JS代码都注释起来,再在IE中随意点击,发现没问题了,仔细检查了一下JS代码,没发现什么问题,用的是JQUERY,怀疑是不是他的问题,无意中看到页面中一句代码:<br />\nhtml&lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\" /&gt;/html<br />\n把这句话注释掉以后再随意点击,发现问题消失,再把之前注释的JS代码都取消注释,再测试页面,一切正常.<br />\n特此记录,以备遗忘.<br />\n<br />\n<br />\n',NULL,893,'0103','随笔',NULL,0),(1042,'2011-03-09 13:35:41','char数组转换string','<span class=\"Apple-style-span\" style=\"font-family:arial, helvetica, simsun, u5b8bu4f53;font-size:14px;line-height:22px;\">char数组要转换成string可没想象的那么容易。需要使用到System.Text.StringBuilder！<br style=\"line-height:22px;\" />\n实例如下：<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;char temp = { &#039;a&#039;, &#039;b&#039;, &#039;c&#039; };</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.Text.StringBuilder sb = new System.Text.StringBuilder();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sb.Append(temp);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string target = sb.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(target);</div>\n/c#<span style=\"line-height:22px;font-style:italic;color:#008000;\"><br style=\"line-height:22px;\" />\n</span><span style=\"line-height:22px;color:#008000;\"><span style=\"line-height:22px;color:#000000;\">反过来就比较容易了，stringValue.ToCharArrary()就可以了。</span></span></span>	                          ',NULL,740,'0101','ASP.NET',NULL,0),(1041,'2011-03-09 09:37:43','QQ在线浮动窗口','&nbsp;&nbsp; QQ在线浮动窗口,有皮肤的,觉得蛮好看的吧.做了两个版本的.纯JS一个,JQUERY一个,其中那个JQUERY的还带有滚动功能,呵呵..先传上来,以备后用.<br />\n<br />\n<br />\n&nbsp;&nbsp; 下载:<a href=\"http://niunan.net/download/qqonline.zip\" target=\"_blank\">http://niunan.net/download/qqonline.zip</a><br />\n<br />\n<br />\n<br />\n',NULL,996,'0104','下载',NULL,0),(1040,'2011-03-02 18:43:32','本地测试可以调用web service，服务器上却不能','&nbsp;&nbsp; &nbsp;做了一个功能，调用的是放在网上的一个web service，该功能放在局域网的服务器上，之前一直运行良好，某天突然不能运行了，提示“不能解析远程地址...”，但是在本地测试运行又是正常，可以调用web service，就是放到服务器上不行， 经多翻查找后解决，原因是服务器的DNS设置错误，导致不能解析到网上的那个Web service，原来前些天路由器更改了一下网关，但是服务器上的网络连接的网关并没有被更改过来，所以才导致上述现象。',NULL,848,'0101','ASP.NET',NULL,0),(1039,'2011-02-18 12:05:41','MSN的在线联系代码','QQ在个在线状态,放在自己的网站上点击直接弹出QQ,今天有个功能需要用到MSN的在线状态,上网找了一下,代码如下:<br />\nhtml<br />\n&lt;a&nbsp; href=\"msnim:chat?contact=164423073@qq.com\"&gt;MSN&lt;/a&gt;<br />\n/html<br />\n其中<a href=\"mailto:164423073@qq.com\">164423073@qq.com</a> 就是我的MSN账号,呵呵.<br />\n',NULL,840,'0103','随笔',NULL,0),(1038,'2011-02-16 10:58:33','javscript 输出当前的日期 星期','很简单的一小段javascript，但是因为经常要用到，所以先记在这里了，到时直接复制就行了，主要是那星期的获取。<br />\njs<br />\n&lt;script language=\"JavaScript\" type=\"text/javascript\"&gt;var isnDay = new<br />\nArray(\"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\",\"星期日\");<br />\nvar today=new Date();<br />\nvar month=today.getMonth()+1;<br />\ndocument.write(\"\"+today.getYear()+\"年\"+month+\"月\"+today.getDate()+\"日\"+\"&nbsp;&nbsp; \"+isnDaytoday.getDay()) <br />\n&lt;/script&gt;<br />\n/js<br />\n',NULL,832,'0105','javascript',NULL,0),(1037,'2011-02-15 17:18:37','ASP.NET获取天气预报','这个是C#版本的，其实就是调用&nbsp;<a href=\"http://www.webxml.com.cn/WebServices/WeatherWebService.asmx\">http://www.webxml.com.cn/WebServices/WeatherWebService.asmx</a>&nbsp;这个服务，里面提供的是VB.NET版本的，今天做项目需要用到这个功能，所以自己把他转为C#版本的了，其中用到了<a href=\"http://www.developerfusion.com/tools/convert/vb-to-csharp/\">http://www.developerfusion.com/tools/convert/vb-to-csharp/</a>&nbsp;这个地址里提供的把VB转成C#代码的工具，蛮好用的，不过也并不是完美转换的，转出来了还得自己再修改一下下的。<br />\n下载地址：<a href=\"http://niunan.net/download/weather.zip\" target=\"_blank\">http://niunan.net/download/weather.zip</a>',NULL,977,'0101','ASP.NET',NULL,0),(1036,'2011-02-12 14:09:03','牛腩购物网','<span style=\"line-height:21px;font-family:tahoma, arial, 宋体, sans-serif;font-size:14px;\" class=\"Apple-style-span\"><p style=\"padding-bottom:0px;line-height:1.4;margin:1.12em 0px;padding-left:0px;padding-right:0px;padding-top:0px;\"><strong style=\"font-weight:700;\"><font size=\"7\">牛腩购物网</font></strong></p>\n<p style=\"padding-bottom:0px;line-height:1.4;margin:1.12em 0px;padding-left:0px;padding-right:0px;padding-top:0px;\">最新出的视频，演示网站 <a style=\"color:#3366cc;text-decoration:none;\" href=\"http://shop.niunan.net/\" target=\"_self\">http://shop.niunan.net/</a></p>\n<p style=\"padding-bottom:0px;line-height:1.4;margin:1.12em 0px;padding-left:0px;padding-right:0px;padding-top:0px;\"><font color=\"#000000\" size=\"6\" face=\"宋体\"><strong><span style=\"color:#ff6600;\">有意购买者可加本人QQ（164423073）或者加入本人建立的QQ群（96951813）咨询，本人为已购买者提供终生免费技术问答服务（通过email或者QQ提问和解答：</span></strong><a href=\"mailto:164423073@qq.com\"><strong><span style=\"color:#ff6600;\">164423073@qq.com</span></strong></a><strong><span style=\"color:#ff6600;\">，只限本人所知道的知识），对，您没有看错，您只需要30元人民币，赶快拿起您手中的支付宝，马上定购吧，您只需要30元，30元，学成后，您就是白领！！！</span><br />\n<span style=\"color:#ff6600;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;－－不是所有视频都出自牛腩</span></strong></font></p>\n<p style=\"padding-bottom:0px;line-height:1.4;margin:1.12em 0px;padding-left:0px;padding-right:0px;padding-top:0px;\"><font color=\"#0033cc\"><span style=\"font-size:24px;\">更多详情请点击：<br />\n</span><a href=\"http://item.taobao.com/item.htm?id=8613150677\" target=\"_blank\"><span style=\"font-size:24px;\">http://item.taobao.com/item.htm?id=8613150677</span></a></font></p>\n</span>',NULL,1910,'0112','原创视频',NULL,0),(1035,'2011-01-29 11:20:34','repeator控件的绑定及判断','以前帮http://tg029.com(众志网)做的一个短小的视频，讲解.NET中的repeator控件的简单使用，<br />\n<br />\n下载地址：<a href=\"http://item.taobao.com/item.htm?id=9183567419\" target=\"_blank\">http://item.taobao.com/item.htm?id=9183567419</a><br />\n',NULL,1136,'0112','原创视频',NULL,0),(1034,'2011-01-15 10:22:51','ASP.NET中发生异常信息后把错误信息发送到指定邮箱中','Global.asax 的Application_Error事件中加入相关代码，调用的方法是我之前发的那个发送Email的方法：<br />\n<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void Application_Error(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//在出现未处理的错误时运行的代码</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Exception objErr = Server.GetLastError().GetBaseException();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string time = DateTime.Now.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string error = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;异常信息： &lt;/strong&gt;\" + objErr.Message + \"&lt;br&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;异常发生时间：&lt;/strong&gt;\" + time + \"&lt;br&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;IP： &lt;/strong&gt;\" + Request.UserHostAddress + \"&lt;br&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;发生异常页： &lt;/strong&gt;\" + Request.Url.ToString() + \"&lt;br&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string url_re = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (Request.UrlReferrer != null)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;url_re = Request.UrlReferrer.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;上次请求的URL： &lt;/strong&gt;\" + url_re + \"&lt;br&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error += \"&lt;strong&gt;堆栈跟踪： &lt;/strong&gt;&lt;br&gt;\" + objErr.StackTrace.Replace(\"\\r\\n\", \"&lt;br&gt;\") + \"&lt;br&gt;\";</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!objErr.Message.Contains(\"不存在\"))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Niunan.ZZ.JKDA.Utility.Tool.SendMail( \"网站出现异常\"+time, error, \"164423073@qq.com\", \"niunan@niunan.net\", \"niunan@niunan.net\", \"123456\", \"smtp.qq.com\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/c#<br />\n<br />\n',NULL,939,'0101','ASP.NET',NULL,0),(1033,'2011-01-08 11:11:57','《网页设计创意书》读后感','<div>&nbsp;&nbsp; <img src=\"http://niunan.org/upload/20110108110942.jpg\" width=\"400\" height=\"533\" alt=\"\" border=\"0\" />&nbsp;<br />\n<br />\n&nbsp;&nbsp; &nbsp;刚刚收到《网页设计创意书》，确实有点惊喜，开始以为是像之前审读的书一样是一叠叠的打印</div>\n<div><br />\n</div>\n<div>纸，没想到是一本成品书，拿到手上沉甸甸的，随便翻看了一下，没想到里面竟然还是全彩页印刷的</div>\n<div><br />\n</div>\n<div>，本书的第一感觉让人觉得：真值。</div>\n<div>&nbsp;&nbsp; &nbsp;《网页设计创意书》从书名上看应该是一本讲如何设计网页的书籍的，开始我对其中的内容还是</div>\n<div><br />\n</div>\n<div>抱有很大的期望的，仔细翻看过后，才发现书中的内容与我预料的还是差别蛮大的，整本书中的内容</div>\n<div><br />\n</div>\n<div>大多数都是由图片构成，只是在每一章的前面有一小段的文字叙述，说直白一点，本书是一本由外国</div>\n<div><br />\n</div>\n<div>精美网页截图组成的《网页设计创意书》。</div>\n<div>&nbsp;&nbsp; &nbsp;之前说过了本书大部分都是由外国的一些精美网页截图组成的，当然每个截图下面都有该网页的</div>\n<div><br />\n</div>\n<div>网址，但是因为众所周知的原因，一些网页是上不去的，另一些是连接上去了但是又是已经改版了的</div>\n<div><br />\n</div>\n<div>，看不到与书上截图一样的效果，所以可能或许该书的时效性还是蛮差的。</div>\n<div>&nbsp;&nbsp; &nbsp;开始以为本书至少会是像《瞬间之美》那样看得还行的，结果没想到文字叙述就只是每一章前面</div>\n<div><br />\n</div>\n<div>的一小段，虽然说精简就是美，不过我总觉得文字叙述的部分少了一点，也许是我语文功底太差了，从那些精简的文字中提取不到我需要的信息。</div>\n<div>&nbsp;&nbsp; &nbsp;本书好的地方我觉得就是网站的分类很清楚，该书包括了大部分的网站分类，每一个分类下都有相应的外国网页的截图显示，这样便于我在以后帮人做网站的时候可以根据制作网站的类别再从本书中找到一些外国网址做相应的网页界面的“参考”，呵呵，这样就省去了自己设计界面的郁闷了，个人觉得这是本书最大的好处，嘿嘿。</div>\n	                          	                          ',NULL,842,'0103','随笔',NULL,0),(1032,'2011-01-07 12:59:37','取消农业银行金e顺短信通的方法','&nbsp;&nbsp;取消农业银行金e顺短信通的方法：<br />\n&nbsp;&nbsp; 发送短信00000到1065730195599<br />\n&nbsp;&nbsp; 过一会了就返回短信提示说“农行金e顺短信通：取消所有账户短信通服务成功”',NULL,1265,'0103','随笔',NULL,0),(1031,'2011-01-06 12:03:03','打开网页自动最大化浏览器的JS代码','js<br />\n<div>self.moveTo(0, 0);</div>\n<div>self.resizeTo(screen.availWidth, screen.availHeight);</div>\n/js<br />\n以上两句代码记得放在onload里面就行了，经测试在IE和firefox中是可以的，但是在chrome下是不行的。',NULL,782,'0105','javascript',NULL,0),(1030,'2010-12-04 11:08:55','VS中“网站”和“WEB应用程序”发布后的区别','二者主要区别在于发布后bin目录下的生成的DLL的文件名不同，如下图：<br />\n<img src=\"http://blog.niunan.net/upload/20101204110431.jpg\" alt=\"\" border=\"0\" /><br />\n上图是我用“网站”发布后BIN目录下生成的DLL文件，文件命名是随机的，没有规律的，视觉感受上不美观。<br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20101204110659.jpg\" alt=\"\" border=\"0\" /><br />\n上图是我用“WEB应用程序”发布后的BIN目录，生成的DLL文件命名规范，视觉感受良好。<img src=\"http://blog.niunan.net/kindeditor/plugins/emoticons/12.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" />	                          ',NULL,1049,'0101','ASP.NET',NULL,0),(1029,'2010-12-01 13:25:10','PS中导入N张图片到一个新的图片中','<span class=\"Apple-style-span\" style=\"font-family:arial, helvetica, sans-serif, simsun;line-height:22px;font-size:14px;\"><p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">二种方法<br />\n1.ps cs2及以前版本，可以切换到ImageReady，导入，作为帧的文件夹</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">2.ps cs3及以后版本，文件，脚本，将文件载入堆栈。选择放图片的文件夹。</p>\n</span>	                          ',NULL,751,'0111','工具使用',NULL,0),(1028,'2010-11-29 17:12:19','根据视频地址生成相应的emabed标签','根据kindeditor中的插入视频来写的，生成相应的emabed标签。<br />\nc#<br />\n<div>/// &lt;summary&gt;根据视频地址生成相应的emabed标签</div>\n<div>///&nbsp;</div>\n<div>/// &lt;/summary&gt;</div>\n<div>/// &lt;param name=\"url\"&gt;&lt;/param&gt;</div>\n<div>/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>public string GenEmabed(string url)</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;string tmp = url.Substring(url.LastIndexOf(\".\") + 1);</div>\n<div>&nbsp;&nbsp; &nbsp;if (tmp == \"swf\" || tmp == \"swf\" || tmp == \"flv\" || tmp == \"mp3\" || tmp == \"wav\" || tmp == \"wma\" || tmp == \"wmv\" || tmp == \"mid\" || tmp == \"avi\" || tmp == \"mpg\" || tmp == \"asf\" || tmp == \"rm\" || tmp == \"rmvb\")</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string str = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;switch (tmp)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case \"flv\":</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case \"mp3\":</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case \"swf\":</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = \"&lt;embed src=&#039;\" + url + \"&#039; type=&#039;application/x-shockwave-flash&#039; width=&#039;550&#039; height=&#039;400&#039; autostart=&#039;false&#039; loop=&#039;true&#039; /&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case \"rm\":</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case \"rmvb\":</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = \"&lt;embed src=&#039;\" + url + \"&#039; type=&#039;audio/x-pn-realaudio-plugin&#039; width=&#039;550&#039; height=&#039;400&#039; autostart=&#039;false&#039; loop=&#039;true&#039; /&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = \"&lt;embed src=&#039;\" + url + \"&#039; type=&#039;video/x-ms-asf-plugin&#039; width=&#039;550&#039; height=&#039;400&#039; autostart=&#039;false&#039; loop=&#039;true&#039; /&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return str;</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return \"视频格式只能是swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb\";</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n/c#<br />\n',NULL,829,'0101','ASP.NET',NULL,0),(1027,'2010-10-30 10:36:44','摘录的一个方法（过滤SQL非法字符串）','<p>c#<br />\n/// &lt;summary&gt;<br />\n&nbsp;&nbsp;&nbsp; /// 过滤SQL非法字符串<br />\n&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp; /// &lt;param name=\"value\"&gt;&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp; public static string Filter(string value)<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (string.IsNullOrEmpty(value))<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return string.Empty;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\";\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"&#039;\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"&amp;\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"%20\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"--\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"==\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"&lt;\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"&gt;\", string.Empty);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = Regex.Replace(value, @\"%\", string.Empty);</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return value;<br />\n&nbsp;&nbsp;&nbsp; }<br />\n/c#</p>\n',NULL,985,'0101','ASP.NET',NULL,0),(1026,'2010-10-22 16:14:22','JS图片滚动特效','&nbsp;&nbsp; 用到了JQUERY，淘宝商城上的图片滚动特效。<br />\n<br />\n&nbsp;&nbsp; 效果演示：<a href=\"http://niunan.net/js_texiao/js_pic_scroll/test.htm\">http://niunan.net/js_texiao/js_pic_scroll/test.htm</a><br />\n<br />\n&nbsp;&nbsp; 源码下载：<a href=\"http://niunan.net/download/js_pic_scroll.rar\">http://niunan.net/download/js_pic_scroll.rar</a>',NULL,1224,'0110','jQuery',NULL,0),(1025,'2010-10-22 13:02:27','FLASH查看图片特效','&nbsp;&nbsp; &nbsp;老板今天才发现的这个特效，想用到我们做的商城项目中，用于查看商品图片时的效果。<br />\n<br />\n&nbsp;&nbsp; &nbsp;效果查看：<a href=\"http://niunan.net/flash_lookpic/test.html\">http://niunan.net/flash_lookpic/test.html<br />\n</a><br />\n&nbsp;&nbsp; &nbsp;源码下载：<span class=\"Apple-style-span\" style=\"font-family:arial, &#039;microsoft yahei&#039;, simsun, sans-serif;line-height:normal;font-size:13px;color:#008800;white-space:nowrap;\"><a href=\"http://niunan.net/download/flash_lookpic.rar\" target=\"_blank\">http://niunan.net/download/flash_lookpic.rar</a></span>',NULL,886,'0101','ASP.NET',NULL,0),(1024,'2010-10-19 09:35:18','http://niunan888.taobao.com/','<a href=\"http://niunan888.taobao.com/\">http://niunan888.taobao.com/</a><br />\n<br />\n终于学会怎么开淘宝店了。。。那个拍拍真郁闷。。竟然还要交1000的保证金。。。',NULL,817,'0103','随笔',NULL,0),(1023,'2010-10-16 09:15:54','牛腩讲HTML','&nbsp;&nbsp; 很久很久以前做的视频了。呵呵。。也是很简单的。。<br />\n&nbsp;&nbsp; 讲的都是基础.<br />\n<br />\n&nbsp;&nbsp; &nbsp;下载地址：<a href=\"http://item.taobao.com/item.htm?id=7924670121\">http://item.taobao.com/item.htm?id=7924670121</a><br />\n',NULL,1020,'0112','原创视频',NULL,0),(1022,'2010-10-16 09:14:40','牛腩讲javascript','&nbsp;&nbsp; &nbsp;很久很久以前无聊的时候做的一个视频，超基础，超简单，只教你怎么用JS来进行表单验证的而已。<br />\n<br />\n&nbsp;&nbsp; &nbsp;下载地址：<a href=\"http://item.taobao.com/item.htm?id=7924853175\">http://item.taobao.com/item.htm?id=7924853175</a><br />\n',NULL,919,'0112','原创视频',NULL,0),(1021,'2010-10-13 10:58:42','AJAX顺序输出','&nbsp;&nbsp; &nbsp;在安装大多数CMS的时候都会在安装界面上看到这样的一个效果：<br />\nquote系统正在配置....<br />\n开始执行SQL.....<br />\n开始插入测试数据....<br />\n测试数据插入完成..../quote<br />\n&nbsp;&nbsp; &nbsp;每一步完成后都会在一个区域里输出相关的信息，自己对照着这个效果做了一下，基本成功，其实也就是通过 AJAX调用后台处理一些代码，处理完后返回给前台，在前台中的回调函数中输出相关信息，然后再在回调函数中再次调用AJAX调用后台处理.....<br />\n&nbsp;&nbsp; &nbsp;我自己做的效果图如下，最后附上自己做的源码的下载：<br />\n<img src=\"http://niunan.org/upload/20101013105805.png\" alt=\"\" border=\"0\" /><br />\n源码下载： <a href=\"http://niunan.net/download/ajaxsync.rar\" target=\"_blank\">http://niunan.net/download/ajaxsync.rar</a>',NULL,798,'0101','ASP.NET',NULL,0),(1020,'2010-09-16 12:59:24','选择access中的所有的表','sql<br />\nSELECT MSysObjects.Name FROM MsysObjects WHERE (Left(Name,1)&lt;&gt;\"~\") AND (Left$(Name,4) &lt;&gt; \"Msys\") AND (MSysObjects.Type)=1 ORDER BY MSysObjects.Name;<br />\n/sql<br />\n以上SQL语句就是选择access所有的表的SQL语句的，本来想直接写SQL语句把每个表的记录数给统计出来的，不过还没有找到办法，只能是先取出所有的表了，然后在外面用程序来计算记录数了',NULL,1115,'0106','SQL',NULL,0),(1019,'2010-08-23 15:37:36','获取本周的周一和周日','c#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 获取本周的周一</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string GetThisWeekMonday()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime date = DateTime.Now;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime first = System.DateTime.Now;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;switch (date.DayOfWeek)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Monday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Tuesday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-1);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Wednesday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-2);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Thursday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-3);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Friday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-4);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Saturday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-5);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Sunday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first = date.AddDays(-6);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return first.ToString(\"yyyy-MM-dd\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 获取本周的周日</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string GetThisWeekSunday()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime date = DateTime.Now;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DateTime last = System.DateTime.Now;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;switch (date.DayOfWeek)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Monday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(6);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Tuesday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(5);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Wednesday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(4);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Thursday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(3);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Friday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(2);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Saturday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date.AddDays(1);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case System.DayOfWeek.Sunday:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;last = date;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return last.ToString(\"yyyy-MM-dd\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/c#	                          ',NULL,847,'0101','ASP.NET',NULL,0),(1018,'2010-08-03 20:26:23','ASP.NET弹出遮罩层示例','从某收费项目中提取出来的，网上一高手写的JQUERY插件，作用不多说，上图：<br />\n<img src=\"http://niunan.org/upload/20100803202433.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.org/upload/20100803202454.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.org/upload/20100803202517.png\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.org/upload/20100803202539.png\" alt=\"\" border=\"0\" /><br />\n<br />\n源码下载：<a href=\"http://niunan.net/download/jquery_popup.rar\" target=\"_blank\">点击下载	                          </a>',NULL,1287,'0101','ASP.NET',NULL,0),(1017,'2010-07-26 12:53:01','WebService简单示例','记录一下，以备后用：<br />\nwebservice:<br />\nc#<br />\n<div>using System;</div>\n<div>using System.Collections.Generic;</div>\n<div>using System.Linq;</div>\n<div>using System.Web;</div>\n<div>using System.Web.Services;</div>\n<div>using System.Web.Services.Protocols;</div>\n<div><br />\n</div>\n<div>namespace Niunan.ZZ.JKDA.Web.webservice</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/// GGService 的摘要说明</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;WebService(Namespace = \"http://gxbest.cn/\")</div>\n<div>&nbsp;&nbsp; &nbsp;WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)</div>\n<div>&nbsp;&nbsp; &nbsp;System.ComponentModel.ToolboxItem(false)</div>\n<div>&nbsp;&nbsp; &nbsp;// 若要允许使用 ASP.NET AJAX 从脚本中调用此 Web 服务，请取消对下行的注释。</div>\n<div>&nbsp;&nbsp; &nbsp;// System.Web.Script.Services.ScriptService</div>\n<div>&nbsp;&nbsp; &nbsp;public class GGService : System.Web.Services.WebService</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public Credentials token;&nbsp;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 获取全部公告</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;WebMethod(Description = \"获取全部公告\")</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SoapHeader(\"token\", Direction = SoapHeaderDirection.In)&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public List&lt;Niunan.ZZ.JKDA.Model.S_;ngGao&gt; Get;ngGao() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (token.AccountID != \"admin\" || token.PIN != \"admin\")</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return new Niunan.ZZ.JKDA.DAL.S_;ngGaoDAO().GetListArray(\"\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 用于web service的安全性</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public class Credentials : System.Web.Services.Protocols.SoapHeader</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;public string AccountID;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;public string PIN;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n/c#<br />\n<br />\n添加了web引用后，下面是提取示例：<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cn.gxbest.GGService ws = new Niunan.ZZ.JKDA.Web.cn.gxbest.GGService();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ws.CredentialsValue = new Niunan.ZZ.JKDA.Web.cn.gxbest.Credentials() { AccountID = \"admin\", PIN = \"admin\" };</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cn.gxbest.S_;ngGao gg = ws.Get;ngGao();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List&lt;cn.gxbest.S_;ngGao&gt; list = new List&lt;cn.gxbest.S_;ngGao&gt;();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (cn.gxbest.S_;ngGao item in gg)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list.Add(item);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GridView1.DataSource = list;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GridView1.DataBind();</div>\n/c#<br />\n<br />\n<br />\n<br />\n',NULL,947,'0101','ASP.NET',NULL,0),(1016,'2010-07-23 17:01:32','统计SQL2005中数据库中的每张表的记录数','刚刚需要用到的，记录一下，SQL05以上管用，2000没试过。。。<br />\nsql<br />\n<div>select b.name 表名,max(a.rowcnt) 记录数</div>\n<div>from sysindexes a</div>\n<div>join sys.objects b on b.object_id=a.id</div>\n<div>where b.type=&#039;U&#039;</div>\n<div>group by b.name</div>\n/sql<br />\n',NULL,964,'0106','SQL',NULL,0),(1015,'2010-07-18 13:34:49','ASP.NET中递归绑定DDL下拉控件','做个记录，省得以后用到的时候都得再找以前写的代码，而且发现以前写的代码还有点错误的，但层级达到3层以上的时候就看得出错误在哪了，下面是更正后的代码：<br />\nc#<br />\n<div>// 绑定行政区域下拉列表</div>\n<div>private void BindAreaDDL()</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;ddl行政区域.Items.Clear();</div>\n<div>&nbsp;&nbsp; &nbsp;ddl行政区域.Items.Insert(0, new ListItem(\"\", \"0\"));</div>\n<div>&nbsp;&nbsp; &nbsp;DataSet ds = new S_Area2DAO().GetList(\"\");</div>\n<div>&nbsp;&nbsp; &nbsp;if (ds.Tables.Count &gt; 0)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;var query1 = ds.Tables0.AsEnumerable().Where(x =&gt; x\"parentid\".ToString() == \"0\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;foreach (var item in query1)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ListItem li = new ListItem(item\"name\".ToString(), item\"id\".ToString());</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ddl行政区域.Items.Add(li);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int index = 1;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AddChildListItem(ds, item\"id\".ToString(), index);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n<div>// 递归添加子项</div>\n<div>private void AddChildListItem(DataSet ds, string pid, int index)</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;int tmp = index; &nbsp;// 保存层级</div>\n<div>&nbsp;&nbsp; &nbsp;// 计算前面的空白</div>\n<div>&nbsp;&nbsp; &nbsp;string space_str = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp;for (int i = 0; i &lt; index; i++)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;space_str += \"...\";</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;var query1 = ds.Tables0.AsEnumerable().Where(x =&gt; x\"parentid\".ToString() == pid);</div>\n<div>&nbsp;&nbsp; &nbsp;foreach (var item in query1)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ListItem li = new ListItem(space_str + item\"name\".ToString(), item\"id\".ToString());</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ddl行政区域.Items.Add(li);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;index++;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;AddChildListItem(ds, item\"id\".ToString(), index);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;index = tmp; &nbsp;// 还原层级</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n/c#<br />\n',NULL,1012,'0101','ASP.NET',NULL,0),(1014,'2010-07-14 12:01:59','JS农历','项目中用到的，记录一下。<br />\n代码如下：<br />\nhtml<br />\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" &gt;</div>\n<div>&lt;head&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;JS农历测试&lt;/title&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp;&lt;script type=\"text/javascript\" src=\"js/date_CTC.js\" language=\"javascript\"&gt;&lt;/script&gt;</div>\n<div>&nbsp;&nbsp;&lt;script type=\"text/javascript\" language=\"javascript\"&gt;CAL();&lt;/script&gt;</div>\n<div>&nbsp;&nbsp;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;var now = new Date();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;var str = now.getFullYear() + \"年\" + (now.getMonth() + 1) + \"月\" + now.getDate() + \"日\"</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;var x = new Array(\"星期日\", \"星期一\", \"星期二\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;var x = x.concat(\"星期三\", \"星期四\", \"星期五\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;var x = x.concat(\"星期六\"); &nbsp; &nbsp; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp;document.write(str+\" &nbsp;\"+xnow.getDay());</div>\n<div>&nbsp;&nbsp;&lt;/script&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n<br />\n源文件下载： <a href=\"http://niunan.net/download/js_nl.rar\" target=\"_blank\">点击下载</a><br />\n<br />\n<br />\n',NULL,962,'0105','javascript',NULL,0),(1013,'2010-06-19 12:21:01','使用javascript通过className来获取元素','&nbsp;&nbsp; &nbsp;开始慢慢从JQUERY再转回到纯JS。。。<br />\njs<br />\n//原理： 用document.getElementsByTagName(&#039;*&#039;);来获取所有元素，然后取得相同Class的元素。<br />\nfunction getElementsByClassName(n) {<br />\n    var classElements = , allElements = document.getElementsByTagName(&#039;*&#039;);<br />\n    for (var i = 0; i &lt; allElements.length; i++) {<br />\n        if (allElementsi.className == n) {<br />\n            classElementsclassElements.length = allElementsi;<br />\n        }<br />\n    }<br />\n    return classElements;<br />\n}<br />\n/js<br />\njs<br />\n    // 原来class为showye的全去掉<br />\n    var XX = getElementsByClassName(&#039;shouye&#039;);<br />\n    for (var i = 0; i &lt; XX.length; i++) {<br />\n        XXi.className = \"\";<br />\n    }<br />\n/js<br />\n<br />\n转自：<a href=\"http://blog.csdn.net/greenerycn/archive/2008/10/07/3030269.aspx\">http://blog.csdn.net/greenerycn/archive/2008/10/07/3030269.aspx</a><br />\n自己测试在ie6,8,firefox,chrome下运行成功<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,895,'0105','javascript',NULL,0),(1012,'2010-06-17 14:51:12','ASP.NET页面中用javascript响应文本框的回车事件','&nbsp;&nbsp; &nbsp; 很多购物网站的搜索功能，都是你在文本框中输入东西后直接回车就跳到搜索页了，但是在文本框外按回车是不会响应的，自己看了一下他们的代码，像中关村商城的是PHP写的，搜索就是一个form，里面一个textbox一个submit按钮，这样在textbox中按下回车后会自动的提交到form中的action，自己是用ASP.NET写的，一个页面就一个form，自己写了一个响应文本框中回车的东西出来，自己测试过，IE6,8，FIREFOX,CHROME中浏览正常，代码：<br />\nhtml<br />\n<div>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"test_mulform.aspx.cs\" Inherits=\"test_mulform\" %&gt;</div>\n<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;&lt;/title&gt;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;function responseEnter(e) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 响应回车</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var key = window.event ? e.keyCode : e.which;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (key == 13) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//alert(\"回车了\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;search();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;function search() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 搜索</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var key = document.getElementById(\"key\").value;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (key.length == 0) { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(\"key\").focus(); // 如果不给表单return false的话这句代码就执行不了，因为表单已经提交的</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert(\"请输入搜索关键字！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var url = \"SearchItem.aspx?key=\" + encodeURI(key) + \"&amp;typeid=0&amp;typename=所有分类\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.open(url);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/script&gt;</div>\n<div><br />\n</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&lt;form id=\"form1\" runat=\"server\" onsubmit=\"return false;\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;input id=\"key\" type=\"text\" onkeypress=\"responseEnter(event);\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;button style=\"cursor: pointer;\" onclick=\"search();\" type=\"button\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;搜索</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/button&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div&gt;&lt;%=DateTime.Now %&gt;&lt;/div&gt;</div>\n<div>&nbsp;&lt;/form&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n<div><br />\n</div>\n/html<br />\n<br />\n',NULL,911,'0101','ASP.NET',NULL,0),(1011,'2010-06-15 15:38:55','刚刚找到的IP地址对应地区数据库','&nbsp;&nbsp; &nbsp; 项目原因，网上下载了&nbsp;We7 CMS安装版，（想下载源码竟然发现要加入什么什么源码小组，还要一年交￥100，晕，这叫什么GP开源啊！！！），下载下来看了下app_data目录，惊奇发现有个ip.db，呵呵，我猜可能是IP地址数据库了，而且是sqlite的，打开一看：<br />\n<img src=\"http://niunan.org/upload/20100615153504.jpg\" alt=\"\" border=\"0\" /><br />\n嘿嘿 ，果然是IP地址数据库，而且都转成长IP格式的了，自己写了个aspx页面来获取IP的：<br />\nhttp://5mdn.com/getip.aspx<br />\n给网上的人测试发现其实这个IP数据库也不是很完全的，算了，不管了，先记下来吧，下面是aspx.cs的代码：<br />\nc#<br />\n<div>using System;</div>\n<div>using System.Collections.Generic;</div>\n<div>using System.Linq;</div>\n<div>using System.Web;</div>\n<div>using System.Web.UI;</div>\n<div>using System.Web.UI.WebControls;</div>\n<div>using System.Text.RegularExpressions;</div>\n<div>using System.Data;</div>\n<div>using System.Data.SQLite;</div>\n<div><br />\n</div>\n<div>public partial class test : System.Web.UI.Page</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;protected void Page_Load(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string ip = Request.UserHostAddress;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string longip = IpToLong(ip).ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;litmes.Text = \"&lt;h3&gt;您的IP：\" + ip + \"&lt;/h3&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;litmes.Text += \"&lt;h3&gt;转换后的IP：\" + longip + \"&lt;/h3&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;litmes.Text += \"&lt;h4&gt;从IP数据库中取出的记录：&lt;/h4&gt;\";</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SQLiteConnection conn = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SQLiteCommand cmd = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SQLiteDataReader sdr = null;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string connStr = \"Data Source=\" + HttpContext.Current.Server.MapPath(\"~/App_Data/ip.db\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;conn = new SQLiteConnection(connStr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string sql = \"SELECT * FROM iptocity where \" + longip + \" between ip_start and ip_end\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;cmd = new SQLiteCommand(sql, conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = new DataTable();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;using (sdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.Load(sdr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;GridView1.DataSource = dt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;GridView1.DataBind();</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;// 把IP地址转成长数字，</div>\n<div>&nbsp;&nbsp; &nbsp;// 算法：128.125.1.24 → (128*256*256*256) + (125*256*256) + (1*256) +24</div>\n<div>&nbsp;&nbsp; &nbsp;public static ulong IpToLong(string ip)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string cip = ip.Trim().Split(&#039;.&#039;);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string aip = new string4;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cip.CopyTo(aip, 0);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (cip.Length &lt; 3)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (int i = 3; i &gt; cip.Length; i--)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;aipi = \"0\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uint iip = new uint4;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Regex reg = new Regex(@\"\\d+\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (int x = 0; x &lt; aip.Length; x++)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (reg.IsMatch(aipx))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iipx = Convert.ToUInt32(aipx);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;iipx = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ulong uip = Convert.ToUInt64(256 * 256 * 256 * iip0 + 256 * 256 * iip1 + 256 * iip2 + iip3);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return uip;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ess)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ess;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>}</div>\n/c#<br />\n相关文件下载：<a href=\"http://niunan.net/download/getip.7z\" target=\"_blank\">点击下载</a>',NULL,1123,'0101','ASP.NET',NULL,0),(1010,'2010-06-15 12:48:06','jquery制作select列表双向选择','&nbsp;&nbsp; &nbsp; &nbsp;做项目的时候要用到的一个小功能，以前做过的，用的纯JS，今天翻出来看发现只能在IE中运行的，自己改成jquery的了，该功能很常见，不过一直不知道他的学名叫什么，所以也就随便起个了，大家看下面的图都应该知道了：<br />\n<img src=\"http://niunan.net/bbspic/sel_jquery.jpg\" alt=\"\" border=\"0\" /><br />\n下面是整个网站的HTML代码，用的时候记得导入jquery就行了。<br />\nhtml<br />\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;select列表双向选择&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;style type=\"text/css\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;select</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 100%; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height: 160px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;div</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float: left;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;#div1, #div3</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 150px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;#div2</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 120px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;.btn</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: block;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;margin: 10px auto;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 80px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/style&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"div1\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;select id=\"dltSource\" name=\"dltSource\" size=\"10\" multiple=\"multiple\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"苹果\"&gt;苹果&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"雪梨\"&gt;雪梨&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"西瓜\"&gt;西瓜&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"荔枝\"&gt;荔枝&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"龙眼\"&gt;龙眼&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;option value=\"香蕉\"&gt;香蕉&lt;/option&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/select&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"div2\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=\"button\" value=\"&amp;gt;\" class=\"btn\" onclick=\"Add($(&#039;#dltSource&#039;),$(&#039;#dltTarget&#039;))\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=\"button\" value=\"&amp;gt;&amp;gt;\" class=\"btn\" onclick=\"AddAll($(&#039;#dltSource&#039;),$(&#039;#dltTarget&#039;))\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=\"button\" value=\"&amp;lt;\" class=\"btn\" onclick=\"Add($(&#039;#dltTarget&#039;),$(&#039;#dltSource&#039;))\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=\"button\" value=\"&amp;lt;&amp;lt;\" class=\"btn\" onclick=\"AddAll($(&#039;#dltTarget&#039;),$(&#039;#dltSource&#039;))\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"div3\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;select id=\"dltTarget\" name=\"dltTarget\" size=\"10\" multiple=\"multiple\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/select&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n<div><br />\n</div>\n<div>&lt;script src=\"js/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div><br />\n</div>\n<div>&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/* 添加选择的项 */</div>\n<div>&nbsp;&nbsp; &nbsp;function Add(ObjSource, ObjTarget) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; if(ObjSource.val() ==null) return; &nbsp; &nbsp;// 如果没有选择则退出函数，无这句话的话IE6会报错</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$.each(ObjSource.val(), function(i, n) { &nbsp; &nbsp;// 循环原列表中选中的值，依次添加到目标列表中</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var html = \"&lt;option value=&#039;\" + n + \"&#039;&gt;\" + n + \"&lt;/option&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ObjTarget.append(html);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;});</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ObjSource.find(\"option:selected\").remove(); &nbsp;// 原列表中选中的值删除</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;/* 添加全部 */</div>\n<div>&nbsp;&nbsp; &nbsp;function AddAll(ObjSource, ObjTarget) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ObjTarget.append(ObjSource.html()); &nbsp;// 目标列表的HTML加上原列表的所有HTML</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ObjSource.empty(); &nbsp;// 原列表清空</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>&lt;/script&gt;</div>\n<div><br />\n</div>\n/html<br />\n',NULL,1134,'0110','jQuery',NULL,0),(1009,'2010-06-14 16:41:05','IIS上启用Gzip压缩(HTTP压缩)详解(PDF)','&nbsp;&nbsp; &nbsp;刚刚从网上找到的文档，跟着里面的方法设置了一遍，不错，终于会开启gzip压缩啦，呵呵，今晚回去就开启公司网站的GZIP...<br />\n<br />\n下载地址：<a href=\"http://niunan.net/download/iis_open_gzip.7z\" target=\"_blank\">点击下载</a><br />\n<br />\n',NULL,898,'0104','下载',NULL,0),(1008,'2010-06-14 15:27:45','纯JS控制textarea的maxLength','&nbsp;&nbsp; &nbsp;不用JQUERY，光是纯JS做的一个控制文本框字数的小功能，代码是用ASP.NET的文本框控件了，自己在chrome,firefox,ie6,8上测试通过了，innerText竟然不能用于firefox。。。郁闷。。。至于网上说的什么粘贴问题之类的那就不管了，那些就留到后台再截取处理就行了。<br />\nhtml<br />\n<div>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"text_area.aspx.cs\" Inherits=\"text_area\" %&gt;</div>\n<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;纯JS限制文本框字数&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;window.onload = function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(\"txtContent\").onkeyup = function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var len = this.value.length;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var tmp = 10 - len;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (tmp &lt;= 0) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.value = this.value.substring(0, 10);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(\"mes\").innerHTML = \"您还可以输入 0 个字符\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(\"mes\").innerHTML = \"您还可以输入 \" + tmp + \" 个字符\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/script&gt;</div>\n<div><br />\n</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;form id=\"form1\" runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;asp:TextBox ID=\"txtContent\" TextMode=\"MultiLine\" runat=\"server\" Height=\"190px\" Width=\"439px\"&gt;&lt;/asp:TextBox&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"mes\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;您还可以输入 10 个字符</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/form&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n',NULL,780,'0105','javascript',NULL,0),(1007,'2010-06-11 16:02:21','KindEditor3.4.4版的ASP.NET版本','&nbsp;&nbsp; &nbsp;虽说这个版本下载的源码中是自带有ASP.NET版本的，但很多人下了不会用的，自己刚刚也下载了那个版本看了一下里面的ASP.NET的上传代码，写得真的蛮变态的，虽然是看不懂那个LitJSON是什么东西，不过部署起来还是会的，自己改了一下，把上传的aspx全弄成了ashx了，LitJSON也抽出来放在一个新的类库中，生成DLL文件供那边调用。。。大家下载了直接双击目录下的那个解决方案打开了预览web项目的default.aspx页面应该就能看得到效果了，上传图片和浏览服务器图片也都可以，上传的图片是保存在根目录的upload文件夹下<br />\n<br />\n项目源码：<a href=\"http://niunan.net/download/ke344_dotnet.7z\" target=\"_blank\">点击下载</a><br />\n<br />\n',NULL,911,'0101','ASP.NET',NULL,0),(1006,'2010-06-09 10:47:04','使用程序代码输出论坛回复第X层楼','&nbsp;&nbsp; &nbsp;论坛回复列表，每一留言都显示为“第X层楼”，如果是MSSQL的话可以直接在SQL语句中用那个<span class=\"Apple-style-span\" style=\"font-family:simsun;line-height:24px;letter-spacing:2px;\">ROW_NUMBER()，但现在程序是用sqlite数据库，没有那个函数的，自己想了一下，想到用程序来解决，因为分页我都是用anp控件的，所以我就可以用anp的那个start....每页开始记录数的属性了，在rep控件的行绑定事件中输入第X层楼即可，关键代码：<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp;int x = 0;</div>\n<div>&nbsp;&nbsp; &nbsp;protected void rep1_ItemDataBound(object sender, RepeaterItemEventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (e.Item.ItemType == ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.Item)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Literal lit = e.Item.FindControl(\"litX\") as Literal;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lit.Text = \"第\" + (anpTextList.StartRecordIndex + x).ToString() + \"楼\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x++;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n/c#<br />\n</span>',NULL,980,'0101','ASP.NET',NULL,0),(1005,'2010-06-06 21:33:03','安装上VS2010中文版了','花了一个晚上的时间卸载了VS2008，再安装上了VS2010了。。呵呵。。感觉不错。。嘿嘿。。。',NULL,876,'0103','随笔',NULL,0),(1004,'2010-06-05 11:51:41','ASP.NET简单投票代码','只是记录一下。。一会做项目要用。。。<br />\nc#<br />\n<div>if (Request.Cookies\"tp\" != null &amp;&amp; Request.Cookies\"tp\".Value == \"true\")</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Alert(\"您已经投票过了！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpCookie cookie = new HttpCookie(\"tp\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;cookie.Value = \"true\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;cookie.Expires = DateTime.Now.AddSeconds(10);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Response.Cookies.Add(cookie);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Alert(\"投票成功！\");</div>\n/c#<br />\n原理就是：<br />\n1、判断cookie中的某个指是否存在，该值表示是否投票过，存在则弹出提示已经投票过，退出执行<br />\n2、不存在，可以投票，建立cookie，上面的代码是设置cookie的过期时间是10秒后<br />\n&nbsp;&nbsp;&nbsp;<br />\n&nbsp;&nbsp; &nbsp;这样就只能是10秒以内才能投票一次<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,1008,'0101','ASP.NET',NULL,0),(1003,'2010-05-20 10:08:00','SQL2000中像SQL2005中的Row_Number一样获取行号','&nbsp;&nbsp; &nbsp;在SQL2005以上可以使用Row_Number()来获取行号，SQL2000中没有这个函数，我们可以用下面的方法来获取行号：<br />\nsql<br />\n<div>select ( select count(*)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from &nbsp; tb_product p1</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;where &nbsp;p1.proid &lt;= p2.proid) &nbsp;as rowNumber,</div>\n<div>* from tb_product p2</div>\n<div>order by rowNumber</div>\n/sql<br />\n',NULL,1339,'0106','SQL',NULL,0),(1002,'2010-05-16 13:11:54','ASP.NET中过滤HTML字符串的两个方法','先记下来，以作备用！<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp; &lt;summary&gt;去除HTML标记</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp; &nbsp; &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp; &lt;/summary&gt; &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp; &lt;param name=\"Htmlstring\"&gt;包括HTML的源码&lt;/param&gt; &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp; &lt;returns&gt;已经去除后的文字&lt;/returns&gt; &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public static string GetNoHTMLString(string Htmlstring)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//删除脚本 &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&lt;script^&gt;*?&gt;.*?&lt;/script&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//删除HTML &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&lt;(.^&gt;*)&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"(\\r\\n)\\s+\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"--&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&lt;!--.*\", \"\", RegexOptions.IgnoreCase);</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(quot|#34);\", \"\\\"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(amp|#38);\", \"&amp;\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(lt|#60);\", \"&lt;\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(gt|#62);\", \"&gt;\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(nbsp|#160);\", \" &nbsp; \", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(iexcl|#161);\", \"\\xa1\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(cent|#162);\", \"\\xa2\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(pound|#163);\", \"\\xa3\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;(copy|#169);\", \"\\xa9\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = Regex.Replace(Htmlstring, @\"&amp;#(\\d+);\", \"\", RegexOptions.IgnoreCase);</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring.Replace(\"&lt;\", \"\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring.Replace(\"&gt;\", \"\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring.Replace(\"\\r\\n\", \"\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Htmlstring = HttpContext.Current.Server.HtmlEncode(Htmlstring).Trim();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return Htmlstring;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;获取显示的字符串，可显示HTML标签，但把危险的HTML标签过滤，如iframe,script等。</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"str\"&gt;未处理的字符串&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public static string GetSafeHTMLString(string str)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;applet^&gt;*?&gt;.*?&lt;/applet&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;body^&gt;*?&gt;.*?&lt;/body&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;embed^&gt;*?&gt;.*?&lt;/embed&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;frame^&gt;*?&gt;.*?&lt;/frame&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;script^&gt;*?&gt;.*?&lt;/script&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;frameset^&gt;*?&gt;.*?&lt;/frameset&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;html^&gt;*?&gt;.*?&lt;/html&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;iframe^&gt;*?&gt;.*?&lt;/iframe&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;style^&gt;*?&gt;.*?&lt;/style&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;layer^&gt;*?&gt;.*?&lt;/layer&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;link^&gt;*?&gt;.*?&lt;/link&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;ilayer^&gt;*?&gt;.*?&lt;/ilayer&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;meta^&gt;*?&gt;.*?&lt;/meta&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str = Regex.Replace(str, @\"&lt;object^&gt;*?&gt;.*?&lt;/object&gt;\", \"\", RegexOptions.IgnoreCase);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return str;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/c#<br />\n',NULL,914,'0101','ASP.NET',NULL,0),(1001,'2010-05-11 10:22:45','靠啊。。谁干这么缺德的事。。恶意留言。。。','&nbsp;&nbsp; 把恶意留言删除了。。忘记记下IP了。。。<br />\n竟然把整个百度的源码全都贴上来了。。看得得限制留言长度了。。。嗯。。就限制为500个字吧。。',NULL,980,'0103','随笔',NULL,0),(1000,'2010-05-10 23:49:48','用WIN7发现的问题（AppHangB1）','&nbsp;&nbsp; &nbsp;正在使用着WIN7 MSDN原版奇贱版 + removeWAT破解版，前几天重启系统后进到桌面后就马上假死，桌面有背景出来，但是桌面上的图标关不出来，鼠标一直程那个转转的状态，把鼠标移到左下角的开始点击后，提示<br />\nquote<br />\n描述:<br />\n  出现了一个问题，该问题导致了此程序停止与 Windows 进行交互。<br />\n<br />\n问题签名:<br />\n  问题事件名称: AppHangB1<br />\n  应用程序名: explorer.exe<br />\n......<br />\n/quote<br />\n<br />\n&nbsp;&nbsp; &nbsp; 然后点击第一个选项”重启应用程序“，再等一下下桌面图标就出来了，开始关没有太在意，结果这几天都是出现这些问题，开机后都会假死，都会出现上面的问题，刚刚上网搜索一下，发现可能是WIN7兼容性的问题，于是到“应用程序删除”中把最近一次安装的应用软件删除掉，安装的是从台湾的网站上下载的Skype，删除以后然后再删除一起随同安装的那个Skype浏览器的插件，删除完后重启，现在进入桌面就不会假死了，直接就出现桌面图片了，欧耶~~~<img src=\"http://niunan.org/kindeditor/plugins/emoticons/82.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" /><br />\n<br />\n<br />\n',NULL,1033,'0103','随笔',NULL,0),(999,'2010-05-07 16:39:45','ASP.NET移动目录下的文件','&nbsp;&nbsp; &nbsp;ASP.NET移动文件，本来想用那个Dir****.Move的方法的，但是不知道怎么回事总是出错，算了，还是自己写个方法遍历文件一个一个移动吧。<br />\nc#<br />\n    /// &lt;summary&gt;<br />\n    /// 移动目录内的文件到另一目录<br />\n    /// &lt;/summary&gt;<br />\n    /// &lt;param name=\"sorDir\"&gt;源目录，如：Server.MapPath(\"~/product_image/44/8813/\")&lt;/param&gt;<br />\n    /// &lt;param name=\"desDir\"&gt;目标目录，如：Server.MapPath(\"~/product_image/141/8813/\")&lt;/param&gt;<br />\n    public static void MoveDirFile(string sorDir, string desDir)<br />\n    {<br />\n        if (!Directory.Exists(sorDir))<br />\n        {<br />\n            return;<br />\n        }<br />\n        if (!Directory.Exists(desDir))<br />\n        {<br />\n            Directory.CreateDirectory(desDir);<br />\n        }<br />\n        foreach (string item in Directory.GetFiles(sorDir))<br />\n        {<br />\n            try<br />\n            {<br />\n                FileInfo fi = new FileInfo(item);<br />\n                string tmp = desDir + fi.Name;<br />\n                if (File.Exists(tmp))<br />\n                {<br />\n                    File.Delete(tmp);<br />\n                }<br />\n                fi.MoveTo(tmp);<br />\n            }<br />\n            catch (Exception)<br />\n            {<br />\n                throw;<br />\n            }<br />\n        }<br />\n        Directory.Delete(sorDir, true);<br />\n    }<br />\n/c#<br />\n',NULL,793,'0101','ASP.NET',NULL,0),(998,'2010-05-07 10:01:02','ASPNET目录权限控制','&nbsp;&nbsp; &nbsp;很久以前由“夜鹰”做的一个ASP.NET的示例，现在把他传上来，以做备份，NND，那家伙搞JAVA的研究.NET弄得比我还深，郁闷啊~~~<br />\n&nbsp;&nbsp; &nbsp;用到了.NET中的“票据”的功能，这个好像应该是membership中用到的，这个示例没有用到membership，也就是没有建立到那11个表。。。呵呵。。。<br />\n&nbsp;&nbsp; &nbsp;源码下载： <a href=\"http://niunan.net/download/aspnetdircontrol.7z\" target=\"_blank\">点击下载</a>',NULL,1140,'0104','下载',NULL,0),(997,'2010-04-30 10:58:05','源码;ogle首页图标JS动画','&nbsp;&nbsp; &nbsp; 今天看到群里的人提到过的，;OGLE首页下的那个图标的动画，记得以前自己提取过源码的，发上来以做备份。<br />\n&nbsp;&nbsp; &nbsp; <a href=\"http://niunan.net/download/;ogle_js.rar\" target=\"_blank\">点击下载</a>',NULL,1103,'0104','下载',NULL,0),(996,'2010-04-29 22:08:57','牛腩新闻发布系统（续）','&nbsp;&nbsp;补充录制的视频，共4集，给以前做的那个《<a href=\"http://niunan.org/show.php?id=124\" target=\"_blank\">牛腩新闻发布系统</a>》加上了分页的功能。<br />\n<br />\n&nbsp;&nbsp; &nbsp;视频下载：<br />\n&nbsp;&nbsp; &nbsp;<a href=\"http://item.taobao.com/item.htm?id=7897929467\">http://item.taobao.com/item.htm?id=7897929467</a><br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;最终完整源码下载：<a href=\"http://niunan.net/download/niunan_newssystem.7z\" target=\"_blank\">点击下载</a>&nbsp;(用的是SQL2008的数据库，在doc目录下有全部的数据库创建脚本)<br />\n<br />\n',NULL,5811,'0112','原创视频',NULL,0),(995,'2010-04-21 10:32:35','非IE浏览器下让界面变灰色','&nbsp;&nbsp; &nbsp;今天哀悼日，大家先默哀一分钟~~~~<br />\n<br />\n&nbsp;&nbsp; &nbsp;按照惯例，网页都得变灰色，IE下可以用下面的CSS解决：<br />\ncsshtml { filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); }&nbsp;/css<br />\n<br />\n&nbsp;&nbsp; &nbsp;但是非IE浏览器无效，群里有个朋友发了个网址，是E文的，上面写着如何在非IE浏览器下页面变灰色，是用JS来解决的，网址如下：<a href=\"http://james.padolsey.com/javascript/grayscaling-in-non-ie-browsers/\">http://james.padolsey.com/javascript/grayscaling-in-non-ie-browsers/<br />\n<br />\n</a>&nbsp;&nbsp; &nbsp;使用如下：<br />\nhtml&nbsp;&nbsp; &nbsp;&lt;script src=\"js/grayscale.js\" type=\"text/javascript\"&gt;&lt;/script&gt;<br />\n<div>&nbsp;&nbsp; &nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;window.onload = function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;grayscale(document.getElementsByTagName(&#039;html&#039;));</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;};</div>\n&nbsp;&nbsp; &nbsp;&lt;/script&gt;/html<br />\n<br />\n经自己测试发现，虽然页面是变灰了，不过蛮灰的反映过程好慢，估计应该是系统资源消耗过大了，还有变灰后有些图片是显示不出来的<br />\n上面那个JS代码下载：<a href=\"http://niunan.net/download/grayscale.js\" target=\"_blank\">http://niunan.net/download/grayscale.js</a><br />\n<br />\n	                          ',NULL,1251,'0105','javascript',NULL,0),(994,'2010-04-20 11:02:44','自己封装的Access数据库的操作类(AccessHelper)','加入了一个分页的方法，有空把其他的MYSQLHelper和SQLiteHelper也加上那个分页的方法，嘿嘿。<br />\nc#<br />\nusing System;<br />\nusing System.Collections.Generic;<br />\nusing System.Linq;<br />\nusing System.Text;<br />\nusing System.Data.OleDb;<br />\nusing System.Data;<br />\n<br />\nnamespace Niunan.Test.DAL<br />\n{<br />\n&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />\n&nbsp;&nbsp;&nbsp; ///Access数据库操作类<br />\n&nbsp;&nbsp;&nbsp; ///创建时间：2010年4月16日17时9分<br />\n&nbsp;&nbsp;&nbsp; ///作者：牛腩<br />\n&nbsp;&nbsp;&nbsp; ///QQ: 164423073<br />\n&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp; public class AccessHelper<br />\n&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private OleDbConnection conn = null;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private OleDbCommand cmd = null;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private OleDbDataReader sdr = null;<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public AccessHelper()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; string connStr = WebConfigurationManager.ConnectionStrings\"connStr\".ToString();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string connStr = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|data.mdb\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn = new OleDbConnection(connStr);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;创建Command对象<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"sql\"&gt;SQL语句&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void CreateCommand(string sql)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Open();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmd = new OleDbCommand(sql, conn);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;添加参数<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"paramName\"&gt;参数名称&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"value\"&gt;值&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void AddParameter(string paramName, object value)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmd.Parameters.Add(new OleDbParameter(paramName, value));<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;执行不带参数的增删改SQL语句<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"cmdText\"&gt;增删改SQL语句&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"ct\"&gt;命令类型&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool ExecuteNonQuery()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int res;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res = cmd.ExecuteNonQuery();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (res &gt; 0)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw ex;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finally<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (conn.State == ConnectionState.Open)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;执行查询SQL语句<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"cmdText\"&gt;查询SQL语句&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public DataTable ExecuteQuery()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt = new DataTable();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (sdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Load(sdr);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;分页<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"tblName\"&gt;表名&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"fldName\"&gt;字段名&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"OrderfldName\"&gt;排序字段名&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"OrderType\"&gt;排序方式：asc或者desc&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"strWhere\"&gt;条件，不用加where&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"PageSize\"&gt;页大小&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name=\"PageIndex\"&gt;页索引&lt;/param&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public DataTable FengYe(string tblName, string fldName, string OrderfldName, string OrderType, string strWhere, int PageSize, int PageIndex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt = new DataTable();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string strSQL = \"\"; // 主语句 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string strTmp = \"\"; // 临时变量 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string strOrder = \"\"; // 排序类型<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (OrderType == \"desc\")<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 降序<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strTmp = \"&lt;(select min\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strOrder = \" order by \" + OrderfldName + \" desc\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 升序<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strTmp = \"&gt;(select max\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strOrder = \" order by \" + OrderfldName + \" asc\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region 第一页<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (PageIndex == 1)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strTmp = string.IsNullOrEmpty(strWhere) ? \"\" : \" where \" + strWhere;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strSQL = \"select top \" + PageSize + \" \" + fldName + \" from \" + tblName + strTmp + \" \" + strOrder;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CreateCommand(strSQL);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt = ExecuteQuery();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region 不是第一页<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (string.IsNullOrEmpty(strWhere))<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 条件为空<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strSQL = string.Format(\"select top {0} {1} from {2} where {3}{4}({5}) from (select top {6} {7} from {8} {9}) as tblTmp) {10}\", PageSize, fldName, tblName, OrderfldName, strTmp, OrderfldName, (PageIndex - 1) * PageSize, OrderfldName, tblName, strOrder, strOrder);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CreateCommand(strSQL);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt = ExecuteQuery();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 条件不为空<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strSQL = string.Format(\"select top {0} {1} from {2} where&nbsp; {3}{4}({5}) from (select top {6} {7} from {8} where {9} {10}) as tblTmp) and {11} {12}\", PageSize, fldName, tblName, OrderfldName, strTmp, OrderfldName, (PageIndex - 1) * PageSize, OrderfldName, tblName, strWhere, strOrder, strWhere, strOrder);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CreateCommand(strSQL);<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt = ExecuteQuery();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;返回查询SQL语句查询出的结果的第一行第一列的值<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string ExecuteScalar()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string res = \"\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object obj = cmd.ExecuteScalar();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (obj != null)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res = obj.ToString();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw ex;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finally<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (conn.State == ConnectionState.Open)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return res;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;返回IDataReader只读数据流<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public IDataReader ExecuteReader()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sdr = cmd.ExecuteReader();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return sdr;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw ex;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;关闭数据库连接<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void CloseConn()<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (conn.State == ConnectionState.Open)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw ex;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finally<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (conn.State == ConnectionState.Open)<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />\n&nbsp;&nbsp;&nbsp; }<br />\n<br />\n}<br />\n<br />\n/c#<br />\n自己做的测试项目下载：<a href=\"http://niunan.net/download/accesshelper.7z\" target=\"_blank\">http://niunan.net/download/accesshelper.7z</a>	                          	                          	                          ',NULL,1110,'0101','ASP.NET',NULL,0),(993,'2010-04-20 09:56:57','安装window 7 续 ~~~','&nbsp;&nbsp; &nbsp;昨晚回去试了下，是可以直接运行winform小程序的，估计之前我运行的那个程序我做的有点问题，所以报错的，呵呵。。看了下错误，是什么filenotfound之类的，估计是数据库路径不对啊什么的吧，昨晚安装vs2008和SP1都一切顺利,但是在双击安装以前下的SQL2008express版的时候出现那个对话框，说什么有兼容性问题吧。。不管他直接点了安装以后又不显示什么了。。。上网搜索了一下，原来安装这个得对那安装程序右键→使用管理员权限打开关进行安装的，虽然还是会出现那个兼容性的提示，不过最后还是可以安装成功了。。。<br />\n<br />\n&nbsp;&nbsp; &nbsp;比较喜欢WIN7的那个桌面背景自动切换的东西。蛮好玩的，呵呵。。。<br />\n<br />\n',NULL,717,'0103','随笔',NULL,0),(992,'2010-04-19 16:05:13','终于又安装上WINDOWS 7了~~~','&nbsp;&nbsp; &nbsp;昨天从17：50分开始重启电脑进BIOS改光盘自启动，到18：08分，终于安装上windows 7了，用的是电驴上下载的 windows 7鲍默尔签名版，应该是原版吧。。2.几G的，呵呵，安装完后又看到那熟悉的界面啦，呵呵。<br />\n&nbsp;&nbsp; 以前RC版出来的时候也安装过，不过后来不知道怎么搞的被我搞到系统启动不了了，又改回XP了，昨天没事干又安装回WIN7了，呵呵，界面上看起来是真的蛮爽的，跟着网上弄了那个天气预报的，桌面上放上时钟，日历和天气预报 ，不知道日历是不是能显示农历的哦，没注意 ，今天下班回去看看，要能显示农历那就更好了。<br />\n&nbsp;&nbsp; 安装了360后直接在360中下载QQ和杀软了，现在觉得360其实也不错的，如果一个流氓可以阻止其他流氓进入，那让那个流氓安装在系统里又何防。。。而且我是喜欢他的那个软件管家的玩意了。之前用的那个迅雷软件管家，虽然也能分类显示电脑上已经安装的软件，但是却没有搜索功能，而且360的那个卸载后还会自动帮我把留下的空目录都删除掉，蛮好的。。。<br />\n&nbsp;&nbsp; &nbsp;用的杀软是avast，呵呵。其实安什么无所谓了，也就图个心里安慰，再一个就是插U盘的时候可以检测出那autorun病毒了。。经常有一些七大姑八大姨的拿U盘来我电脑上烤歌曲的，结果插U盘的时候都是清一色的有autorun....<br />\n&nbsp;&nbsp; &nbsp;唯一奇怪的是我记得网上好像说WIN7已经安装有.net framework3。5了，但是我运行以前我做的一些winform小项目的exe文件的时候却打不开，提示出错，不知道怎么回事的。。。<br />\n&nbsp;&nbsp; &nbsp;总的来说WIN7给我的感觉还是蛮好的，今晚回去安装VS和SQL。。。嘿嘿。。。<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,732,'0103','随笔',NULL,0),(991,'2010-04-08 17:50:51','ASP.NET中对SQLITE数据库进行插入操作后返回自增的ID','&nbsp;&nbsp; &nbsp; 啥也不说了，刚刚研究出来滴~~~贴码：<br />\nc#        /// &lt;summary&gt;插入<br />\n        /// 返回刚刚插入的ID<br />\n        /// &lt;/summary&gt;<br />\n        /// &lt;param name=\"groupname\"&gt;&lt;/param&gt;<br />\n        /// &lt;param name=\"gid\"&gt;&lt;/param&gt;<br />\n        /// &lt;returns&gt;&lt;/returns&gt;<br />\n        public bool Insert(string groupname, out string gid)<br />\n        {<br />\n            string sql = \"insert into groupca(groupname) values(@groupname);select last_insert_rowid();\";<br />\n            helper.CreateCommand(sql);<br />\n            helper.AddParameter(\"@groupname\", groupname as object);<br />\n            string res = helper.ExecuteScalar();<br />\n            if (!string.IsNullOrEmpty(res))<br />\n            {<br />\n                gid = res;<br />\n                return true;<br />\n            }<br />\n            else<br />\n            {<br />\n                gid = \"0\";<br />\n                return false;<br />\n            }<br />\n        }/c#<br />\n<br />\n&nbsp;&nbsp; &nbsp;上面的代码用到了自己之前创建的一个SQLITE数据库的操作类，当然，最主要的就是那一句语句了，其实select last_insert_rowid();也就相当于MSSQL中的select @@identity;<br />\n<br />\n',NULL,896,'0101','ASP.NET',NULL,0),(990,'2010-04-08 17:07:50','DataGridView添加行号','&nbsp;&nbsp; &nbsp;自己在做WINFORM小玩意的时候需要在datagridview上显示行号，上网搜索一下，找到如下代码，不错，先记录下来了。<br />\n&nbsp;&nbsp; &nbsp;在RowPostPaint事件中画出来<br />\n<br />\nc#        // 绘制行号<br />\n        private void gvdata_RowPostPaint(object sender, DataGridViewRowPostPaintEventArgs e)<br />\n        {<br />\n            try<br />\n            {<br />\n<br />\n                Rectangle rectangle = new Rectangle(e.RowBounds.Location.X,<br />\n<br />\n                    Convert.ToInt32(e.RowBounds.Location.Y + (e.RowBounds.Height - gvdata.RowHeadersDefaultCellStyle.Font.Size) / 2),<br />\n<br />\n                    gvdata.RowHeadersWidth - 4, e.RowBounds.Height);<br />\n<br />\n                TextRenderer.DrawText(e.Graphics, (e.RowIndex + 1).ToString(),<br />\n<br />\n                    gvdata.RowHeadersDefaultCellStyle.Font, rectangle, gvdata.RowHeadersDefaultCellStyle.ForeColor,<br />\n<br />\n                    TextFormatFlags.Right);<br />\n<br />\n<br />\n<br />\n            }<br />\n<br />\n            catch (Exception ex)<br />\n            {<br />\n<br />\n                Console.Write(\"dgv1_RowPostPaint：\" + ex.Message);<br />\n<br />\n            }<br />\n        }/c#<br />\n<br />\n效果如图：<br />\n<img src=\"http://niunan.net/bbspic/dgvnum.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<br />\n',NULL,919,'0101','ASP.NET',NULL,0),(989,'2010-04-08 12:29:15','silverlight tool 3 for vs 2008 sp1安装备忘录','<div>&nbsp;&nbsp; &nbsp;今早起来感觉全身酸痛，真不知道自己什么时候就OVER了，得抓紧时间把买来的书籍都“过”一遍了，前天刚刚把图灵的那本新书《深入解析C#》审读完了，昨晚开始看《淫光志：SL3开发详解》，看了第一章，打算今早到公司把昨晚看到的实例练习一下的，结果死活都装不上那个Silverlight3_Tools.exe，折腾了一上午，终于安装成功了，并且也做了个小实例传到网上测试成功了，记录如下：</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;首先得先安装那个4.7M的Silverlight.exe，可以从官网上下载到，相当于flashplayer那样的浏览器插件吧</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;然后就把下载到的那个31.1M的Silverlight3_Tools.exe右键解压到一个文件夹中，按照下图所示按顺序双击安装即可，下面的安装顺序是我自己试的，可能有些步骤是不必要的吧，安装完后重新启动VS就可以看到有silverlight的项目了<br />\n<img src=\"http://niunan.net/bbspic/slsetup.jpg\" alt=\"\" border=\"0\" /><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;这样再安装上blend就可以开始进行SL的开发学习了，做出实例后如果要放到网上让别人能够看得到的，还得在你购买的空间后台那添加自定义的MIME类型，要不然是不能运行SL的，如下：</div>\n<div><br />\n</div>\n<div></div>\nquote<div>扩展名： &nbsp; .xap&nbsp;</div>\n<div>MIME类型：xapapplication/x-silverlight&nbsp;</div>\n<div><br />\n</div>\n<div>扩展名： &nbsp; .xaml&nbsp;</div>\n<div>MIME类型：application/xaml+xml&nbsp;</div>\n/quote<div></div>\n	                          ',NULL,855,'0101','ASP.NET',NULL,0),(988,'2010-04-03 18:16:48','《实战Nginx:取代Apache的高性能Web服务器》PDF电子书','刚刚上网瞎逛的时候发现的，觉得还行吧。。呵呵。。几时无聊的时候学学这玩意。。。先记录下来。。。<br />\n<br />\n下载地址：<a href=\"http://blog.sina.com.cn/s/blog_62b8c29b0100hwsv.html\">http://blog.sina.com.cn/s/blog_62b8c29b0100hwsv.html</a><br />\n<br />\n',NULL,934,'0104','下载',NULL,0),(987,'2010-03-30 17:42:53','ASP.NET 3.5 开发大全DOC版','电驴上的资料，我把他传到我的网站上了，呵呵。。<br />\n不过这个空间好像是不能用做下载站的吧。。<br />\n估计人下一多就下不了了。。。<br />\n<br />\n<img src=\"http://niunan.net/bbspic/net35dev.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n下载地址：<a href=\"http://niunan.net/download/NET35DEVELop.rar\" target=\"_blank\">http://niunan.net/download/NET35DEVELop.rar</a><br />\n<br />\n',NULL,1202,'0104','下载',NULL,0),(986,'2010-03-30 15:58:56','ASP.NET使用NPOI类库导出Excel','c#/*<br />\n * 作者: 牛腩<br />\n * 创建时间: 2010-1-4 15:15:05<br />\n * Email: 164423073@qq.com<br />\n * 说明: 导出EXCEL的类，使用说明见：http://msdn.microsoft.com/zh-tw/ee818993.aspx<br />\n */<br />\n<br />\nusing System;<br />\nusing System.Collections.Generic;<br />\nusing System.Data;<br />\nusing System.IO;<br />\nusing System.Linq;<br />\nusing System.Web;<br />\nusing NPOI;<br />\nusing NPOI.HPSF;<br />\nusing NPOI.HSSF;<br />\nusing NPOI.HSSF.UserModel;<br />\nusing NPOI.POIFS;<br />\nusing NPOI.Util;<br />\n<br />\npublic class DataTableRenderToExcel<br />\n{<br />\n    public static Stream RenderDataTableToExcel(DataTable SourceTable)<br />\n    {<br />\n        HSSFWorkbook workbook = new HSSFWorkbook();<br />\n        MemoryStream ms = new MemoryStream();<br />\n        HSSFSheet sheet = workbook.CreateSheet();<br />\n        HSSFRow headerRow = sheet.CreateRow(0);<br />\n<br />\n        // handling header.<br />\n        foreach (DataColumn column in SourceTable.Columns)<br />\n            headerRow.CreateCell(column.Ordinal).SetCellValue(column.ColumnName);<br />\n<br />\n        // handling value.<br />\n        int rowIndex = 1;<br />\n<br />\n        foreach (DataRow row in SourceTable.Rows)<br />\n        {<br />\n            HSSFRow dataRow = sheet.CreateRow(rowIndex);<br />\n<br />\n            foreach (DataColumn column in SourceTable.Columns)<br />\n            {<br />\n                dataRow.CreateCell(column.Ordinal).SetCellValue(rowcolumn.ToString());<br />\n            }<br />\n<br />\n            rowIndex++;<br />\n        }<br />\n<br />\n        workbook.Write(ms);<br />\n        ms.Flush();<br />\n        ms.Position = 0;<br />\n<br />\n        sheet = null;<br />\n        headerRow = null;<br />\n        workbook = null;<br />\n<br />\n        return ms;<br />\n    }<br />\n<br />\n    public static void RenderDataTableToExcel(DataTable SourceTable, string FileName)<br />\n    {<br />\n        MemoryStream ms = RenderDataTableToExcel(SourceTable) as MemoryStream;<br />\n        FileStream fs = new FileStream(FileName, FileMode.Create, FileAccess.Write);<br />\n        byte data = ms.ToArray();<br />\n<br />\n        fs.Write(data, 0, data.Length);<br />\n        fs.Flush();<br />\n        fs.Close();<br />\n<br />\n        data = null;<br />\n        ms = null;<br />\n        fs = null;<br />\n    }<br />\n<br />\n    public static DataTable RenderDataTableFromExcel(Stream ExcelFileStream, string SheetName, int HeaderRowIndex)<br />\n    {<br />\n        HSSFWorkbook workbook = new HSSFWorkbook(ExcelFileStream);<br />\n        HSSFSheet sheet = workbook.GetSheet(SheetName);<br />\n<br />\n        DataTable table = new DataTable();<br />\n<br />\n        HSSFRow headerRow = sheet.GetRow(HeaderRowIndex);<br />\n        int cellCount = headerRow.LastCellNum;<br />\n<br />\n        for (int i = headerRow.FirstCellNum; i &lt; cellCount; i++)<br />\n        {<br />\n            DataColumn column = new DataColumn(headerRow.GetCell(i).StringCellValue);<br />\n            table.Columns.Add(column);<br />\n        }<br />\n<br />\n        int rowCount = sheet.LastRowNum;<br />\n<br />\n        for (int i = (sheet.FirstRowNum + 1); i &lt; sheet.LastRowNum; i++)<br />\n        {<br />\n            HSSFRow row = sheet.GetRow(i);<br />\n            DataRow dataRow = table.NewRow();<br />\n<br />\n            for (int j = row.FirstCellNum; j &lt; cellCount; j++)<br />\n                dataRowj = row.GetCell(j).ToString();<br />\n        }<br />\n<br />\n        ExcelFileStream.Close();<br />\n        workbook = null;<br />\n        sheet = null;<br />\n        return table;<br />\n    }<br />\n<br />\n    public static DataTable RenderDataTableFromExcel(Stream ExcelFileStream, int SheetIndex, int HeaderRowIndex)<br />\n    {<br />\n        HSSFWorkbook workbook = new HSSFWorkbook(ExcelFileStream);<br />\n        HSSFSheet sheet = workbook.GetSheetAt(SheetIndex);<br />\n<br />\n        DataTable table = new DataTable();<br />\n<br />\n        HSSFRow headerRow = sheet.GetRow(HeaderRowIndex);<br />\n        int cellCount = headerRow.LastCellNum;<br />\n<br />\n        for (int i = headerRow.FirstCellNum; i &lt; cellCount; i++)<br />\n        {<br />\n            DataColumn column = new DataColumn(headerRow.GetCell(i).StringCellValue);<br />\n            table.Columns.Add(column);<br />\n        }<br />\n<br />\n        int rowCount = sheet.LastRowNum;<br />\n<br />\n        for (int i = (sheet.FirstRowNum + 1); i &lt; sheet.LastRowNum; i++)<br />\n        {<br />\n            HSSFRow row = sheet.GetRow(i);<br />\n            DataRow dataRow = table.NewRow();<br />\n<br />\n            for (int j = row.FirstCellNum; j &lt; cellCount; j++)<br />\n            {<br />\n                if (row.GetCell(j) != null)<br />\n                    dataRowj = row.GetCell(j).ToString();<br />\n            }<br />\n<br />\n            table.Rows.Add(dataRow);<br />\n        }<br />\n<br />\n        ExcelFileStream.Close();<br />\n        workbook = null;<br />\n        sheet = null;<br />\n        return table;<br />\n    }<br />\n<br />\n    /// &lt;summary&gt;读取excel<br />\n    /// 默认第一行为标头<br />\n    /// &lt;/summary&gt;<br />\n    /// &lt;param name=\"path\"&gt;excel文档路径&lt;/param&gt;<br />\n    /// &lt;returns&gt;&lt;/returns&gt;<br />\n    public static DataTable RenderDataTableFromExcel(string path) {<br />\n        DataTable dt = new DataTable();<br />\n<br />\n        HSSFWorkbook hssfworkbook;<br />\n        using (FileStream file = new FileStream(path, FileMode.Open, FileAccess.Read))<br />\n        {<br />\n            hssfworkbook = new HSSFWorkbook(file);<br />\n        }<br />\n        HSSFSheet sheet = hssfworkbook.GetSheetAt(0);<br />\n        System.Collections.IEnumerator rows = sheet.GetRowEnumerator();<br />\n<br />\n        HSSFRow headerRow = sheet.GetRow(0);<br />\n        int cellCount = headerRow.LastCellNum;<br />\n<br />\n        for (int j = 0; j &lt; cellCount; j++)<br />\n        {<br />\n            HSSFCell cell = headerRow.GetCell(j);<br />\n            dt.Columns.Add(cell.ToString());<br />\n        }<br />\n<br />\n        for (int i = (sheet.FirstRowNum + 1); i &lt;= sheet.LastRowNum; i++)<br />\n        {<br />\n            HSSFRow row = sheet.GetRow(i);<br />\n            DataRow dataRow = dt.NewRow();<br />\n<br />\n            for (int j = row.FirstCellNum; j &lt; cellCount; j++)<br />\n            {<br />\n                if (row.GetCell(j) != null)<br />\n                    dataRowj = row.GetCell(j).ToString();<br />\n            }<br />\n<br />\n            dt.Rows.Add(dataRow);<br />\n        }<br />\n<br />\n        //while (rows.MoveNext())<br />\n        //{<br />\n        //    HSSFRow row = (HSSFRow)rows.Current;<br />\n        //    DataRow dr = dt.NewRow();<br />\n<br />\n        //    for (int i = 0; i &lt; row.LastCellNum; i++)<br />\n        //    {<br />\n        //        HSSFCell cell = row.GetCell(i);<br />\n<br />\n<br />\n        //        if (cell == null)<br />\n        //        {<br />\n        //            dri = null;<br />\n        //        }<br />\n        //        else<br />\n        //        {<br />\n        //            dri = cell.ToString();<br />\n        //        }<br />\n        //    }<br />\n        //    dt.Rows.Add(dr);<br />\n        //}<br />\n<br />\n        return dt;<br />\n    }<br />\n}/c#	                          	                          <br />\n<br />\n示例项目下载：<span style=\"color:#f10b00;\">(i注：示例项目里用的是新版的NPOI，与上面写的类有些不同，大家仔细看看就懂，也可以直接拿来就用)</span><br />\n<a target=\"_blank\" href=\"http://niunan.net/download/xlsimport.rar\">http://niunan.net/download/xlsimport.rar</a><br />\n<br />\n<br />\n使用示例代码：（导出xls）<br />\nc#<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataSet ds = dal.GetList(\"*\", \"createdate\", \"desc\", anp.PageSize, anp.CurrentPageIndex, GetCond());<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable table = ds.Tables0;<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 填充資料（由讀者自行撰寫）<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 產生 Excel 資料流。<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MemoryStream ms = DataTableRenderToExcel.RenderDataTableToExcel(table) as MemoryStream;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //判断是否是IE，是则编码文件名，防止中文乱码<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HttpBrowserCapabilities bc = Request.Browser;<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string browser = bc.Browser.ToString();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string filename = browser.ToLower().Contains(\"ie\") ? HttpUtility.UrlEncode(System.Text.UTF8Encoding.UTF8.GetBytes(\"学员信息表\")) : \"学员信息表\";<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 設定強制下載標頭。<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.AddHeader(\"Content-Disposition\", string.Format(\"attachment; filename=\" + filename + \".xls\"));<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 輸出檔案。<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.BinaryWrite(ms.ToArray());<br />\n<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ms.Close();<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ms.Dispose();<br />\n/c#	                          ',NULL,2348,'0101','ASP.NET',NULL,0),(985,'2010-03-30 15:11:10','ASP.NET中让图片以二进制的形式存储在数据库中','&nbsp;&nbsp; &nbsp; 今早有个网友问到我这问题，以前我都是直接在数据库中存文件名的，还没有试过存储整张图片到数据库中，上网搜索了一下，自己又测试了一番，代码如下：<br />\n建立保存图片的表的SQL语句：<br />\nsqlUSE niunantest<br />\n;<br />\n/****** 对象:  Table dbo.picdata    脚本日期: 03/30/2010 14:51:58 ******/<br />\nSET ANSI_NULLS ON<br />\n;<br />\nSET QUOTED_IDENTIFIER ON<br />\n;<br />\nCREATE TABLE dbo.picdata(<br />\n	id int IDENTITY(1,1) NOT NULL,<br />\n	content image NULL,<br />\n	createdate datetime NOT NULL CONSTRAINT DF_picdata_createdate  DEFAULT (getdate()),<br />\n CONSTRAINT PK_picdata PRIMARY KEY CLUSTERED <br />\n(<br />\n	id ASC<br />\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON PRIMARY<br />\n) ON PRIMARY TEXTIMAGE_ON PRIMARY<br />\n/sql<br />\n<br />\n下面是保存图片到数据库中的代码片段：<br />\nc#        int len = fu.PostedFile.ContentLength;  // 图片大小<br />\n        byte pic = new bytelen;  // 创建一个字节数组，大小为图片的大小，数据库中就存储这个东西<br />\n        fu.PostedFile.InputStream.Read(pic, 0, len); // 把上传控件中的文件用二进制读取存到pic字节数组中<br />\n        //   插入图片到数据库中     <br />\n        SqlConnection connection = new<br />\n        SqlConnection(@\"server=.\\sqlexpress;database=niunantest;uid=sa;pwd=123456\");<br />\n        try<br />\n        {<br />\n            connection.Open();<br />\n            SqlCommand cmd = new SqlCommand(\"insert   into   picdata   \"<br />\n            + \"(content)   values   (@pic)\", connection);<br />\n            cmd.Parameters.Add(\"@pic\", pic);<br />\n            cmd.ExecuteNonQuery();<br />\n            Label1.Text = \"图片插入数据库成功！\";<br />\n<br />\n            Image1.ImageUrl = \"getpic.ashx?t=\" + DateTime.Now.Ticks;  // 显示刚刚插入数据库的图片<br />\n        }<br />\n        finally<br />\n        {<br />\n            connection.Close();<br />\n        } /c#<br />\n<br />\n下面是从数据库中取出图片的代码片段：<br />\nc#        MemoryStream stream = new MemoryStream();<br />\n        SqlConnection connection = new<br />\n        SqlConnection(@\"server=.\\sqlexpress;database=niunantest;uid=sa;pwd=123456\");<br />\n        try<br />\n        {<br />\n            connection.Open();<br />\n            SqlCommand command = new<br />\n            SqlCommand(\"select top 1  content   from   picdata order by id desc\", connection);<br />\n            byte image = (byte)command.ExecuteScalar();<br />\n            stream.Write(image, 0, image.Length);<br />\n            Bitmap bitmap = new Bitmap(stream);<br />\n            context.Response.ContentType = \"image/jpeg\";<br />\n            bitmap.Save(context.Response.OutputStream, System.Drawing.Imaging.ImageFormat.Jpeg);<br />\n        }<br />\n        finally<br />\n        {<br />\n            connection.Close();<br />\n            stream.Close();<br />\n        } /c#<br />\n<br />\n&nbsp;&nbsp; &nbsp;其实也就是通过流把图片搞成字节数组再存到数据库中，然后再从数据库中读取字节数组出来，再通过字节数组创建流，再通过流把图像输出出来，发现你存到数据库中的是gif图像的话再取出来是可以把他转为jpg的图像的，因为在取出图像的时候我们设置他的ContentType是image/jpeg了。<br />\n<br />\n源码下载：<a href=\"http://niunan.net/download/picsave2db.7z\" target=\"_blank\">http://niunan.net/download/picsave2db.7z</a><br />\n<br />\n<br />\n',NULL,1092,'0101','ASP.NET',NULL,0),(984,'2010-03-26 09:31:30','好像昨天不见了100块钱。','&nbsp;&nbsp; TMD，本命年命还真衰~~~<img src=\"http://niunan.org/kindeditor/plugins/emoticons/5.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" />',NULL,723,'0103','随笔',NULL,0),(983,'2010-03-25 16:45:55','热烈庆祝本人今天终于申请得了;ogle ad','如题，昨天提交申请了，今天再看邮箱有了，嘿嘿，已经放到本博客和我的<a href=\"http://niunan.javaeye.com\" target=\"_blank\">JAVAEYE博客</a>了，在设置JAVAEYE博客的时候发现还有个阿里妈妈的广告，记得以前也申请了一个吧，呵呵，也放上了阿里妈妈的广告了，同时也加在本博客上了。嘿嘿。。。<br />\n进阿里妈妈账户看发现有2.86元了。估计就是以前设置在JAVAEYE博客的时候得来的吧。可惜支付宝没实名认证，不能转账，呵呵。',NULL,806,'0103','随笔',NULL,0),(982,'2010-03-25 16:31:18','“所有记录中均未找到搜索关键字”的解决方法(Access数据库)','&nbsp;&nbsp; &nbsp;昨天在整理博客文章的时候，点击某一篇文章进到详细内容页，出现错误：“所有记录中均未找到搜索关键字”，点其他文章进到详细内容页的时候就没有这个错误，上网搜索了一下，找到如下解释：<br />\nquote我在网上搜了搜，发现原来这个问题是access数据库的一个bug。问题出在，这个表里面有一个备注字段。<br />\n<br />\nbug的具体描述：<br />\n随便找一段字节数超过2K的文字。在备注字段里，通过编写程序方式或只是在access数据库程序里直接贴上这块方字后，第一次保存肯定正常。即第一次添加、保存都是正常的。问题出现在第二次修改时，无论是通过网页还是直接在数据库里，对这个备注型字段修改或者删除，保存时就会提示“所有记录中均未找到搜索关键字”。之后网页在操作这个字段时就会报“Microsoft JET Database Engine 错误 &#039;80040e21&#039;    所有记录中均未找到搜索关键字”的错误。<br />\n<br />\n当access建立备注字段时，默认隐式的给这个备注加了个索引，我们只要把这个索引给删掉就好了。方法如下：<br />\n进入access数据库，<br />\n打开出问题的表，<br />\n视图--&gt;设计视图，<br />\n然后再视图--&gt;索引，<br />\n把出问题的数据项的索引delete掉<br />\n保存/quote<br />\n<br />\n&nbsp;&nbsp; &nbsp;打开我的数据库，发现内容字段并没有建立上索引的，我把除了主键索引以外的其他索引都删除了，再保存就可以访问了<br />\n<br />\n&nbsp;&nbsp; &nbsp;另在网上找到另一解决方法，没试，也先记下来吧：<br />\nquote服务器遇到断电，重新启动后，访问Access，遇到错误<br />\n“所有记录中均未找到搜索关键字”<br />\n然后提示那个页面的哪个逻辑出现问题，查询逻辑，没有变化，察看数据，都正常。<br />\n使用;ogle搜索了一下，<br />\n原来<br />\n是Access 文件损坏。<br />\n解决办法：<br />\n出现此错误是因为Access数据库有错误了数据库损坏，<br />\n使用 Ms Access 压缩修复压缩修复在Access 工具-&gt;数据加实用工具-&gt;压缩和修复数据库<br />\n即可修复完毕~/quote<br />\n<br />\n	                          ',NULL,870,'0106','SQL',NULL,0),(981,'2010-03-24 15:21:08','生成规定大小的图片（缩略图生成）','&nbsp;&nbsp; &nbsp; 做一购物网站，改版N次，每次改版那产品列表图的大小都会变，第一次是90*70，第二次改版又变成160*120，每次改版都得把产品图片文件夹中的2W多张图片一个一个转为对应的大小的图片，以前用的是网上找的一个方法：<br />\nc#    /// &lt;summary&gt;生成缩略图<br />\n    /// <br />\n    /// &lt;/summary&gt;<br />\n    /// &lt;param name=\"originalImagePath\"&gt;源图路径（物理路径）&lt;/param&gt;<br />\n    /// &lt;param name=\"thumbnailPath\"&gt;缩略图路径（物理路径）&lt;/param&gt;<br />\n    /// &lt;param name=\"width\"&gt;缩略图宽度&lt;/param&gt;<br />\n    /// &lt;param name=\"height\"&gt;缩略图高度&lt;/param&gt;<br />\n    /// &lt;param name=\"mode\"&gt;生成缩略图的方式&lt;/param&gt; <br />\n    ///         <br />\n    public static void MakeThumbnail(string originalImagePath, string thumbnailPath, int width, int height, string mode)<br />\n    {<br />\n        System.Drawing.Image originalImage = System.Drawing.Image.FromFile(originalImagePath);<br />\n<br />\n        int towidth = width;<br />\n        int toheight = height;<br />\n<br />\n        int x = 0;<br />\n        int y = 0;<br />\n        int ow = originalImage.Width;<br />\n        int oh = originalImage.Height;<br />\n<br />\n        switch (mode)<br />\n        {<br />\n            case \"HW\"://指定高宽缩放（可能变形）           <br />\n                break;<br />\n            case \"W\"://指定宽，高按比例             <br />\n                toheight = originalImage.Height * width / originalImage.Width;<br />\n                break;<br />\n            case \"H\"://指定高，宽按比例<br />\n                towidth = originalImage.Width * height / originalImage.Height;<br />\n                break;<br />\n            case \"Cut\"://指定高宽裁减（不变形）           <br />\n                if ((double)originalImage.Width / (double)originalImage.Height &gt; (double)towidth / (double)toheight)<br />\n                {<br />\n                    oh = originalImage.Height;<br />\n                    ow = originalImage.Height * towidth / toheight;<br />\n                    y = 0;<br />\n                    x = (originalImage.Width - ow) / 2;<br />\n                }<br />\n                else<br />\n                {<br />\n                    ow = originalImage.Width;<br />\n                    oh = originalImage.Width * height / towidth;<br />\n                    x = 0;<br />\n                    y = (originalImage.Height - oh) / 2;<br />\n                }<br />\n                break;<br />\n            default:<br />\n                break;<br />\n        }<br />\n<br />\n        //新建一个bmp图片<br />\n        System.Drawing.Image bitmap = new System.Drawing.Bitmap(towidth, toheight);<br />\n<br />\n        //新建一个画板<br />\n        System.Drawing.Graphics g = System.Drawing.Graphics.FromImage(bitmap);<br />\n<br />\n        //设置高质量插值法<br />\n        g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.High;<br />\n<br />\n        //设置高质量,低速度呈现平滑程度<br />\n        g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;<br />\n<br />\n        //清空画布并以白色背景色填充<br />\n        g.Clear(System.Drawing.Color.White);<br />\n<br />\n        //在指定位置并且按指定大小绘制原图片的指定部分<br />\n        g.DrawImage(originalImage, new System.Drawing.Rectangle(0, 0, towidth, toheight),<br />\n            new System.Drawing.Rectangle(x, y, ow, oh),<br />\n            System.Drawing.GraphicsUnit.Pixel);<br />\n<br />\n        try<br />\n        {<br />\n            //以jpg格式保存缩略图<br />\n            bitmap.Save(thumbnailPath, System.Drawing.Imaging.ImageFormat.Jpeg);<br />\n        }<br />\n        catch (System.Exception e)<br />\n        {<br />\n            throw e;<br />\n        }<br />\n        finally<br />\n        {<br />\n            originalImage.Dispose();<br />\n            bitmap.Dispose();<br />\n            g.Dispose();<br />\n        }<br />\n    }/c#<br />\n<br />\n结果生成的列表图总不成比例，有点变形，抽出该方法单独测试，发现用哪个模式都不好，用HW肯定会变形，用W或者H的话生成的图片大小并不是需要的大小，比如一张400*200的图片，生成160*120的图片，用W模式，结果生成的图片是160*80，这个虽然看起来是不会变形的，但是在产品列表页上的img标题是固定了大小的，如：<br />\n&lt;img width=\"160\" height=\"120\" &nbsp; /&gt;<br />\n这样最后再配上那160*80的图片生成的HTML代码就为<br />\n&lt;img width=\"160\" height=\"120\" src=\"160_80_aaa.jpg\" &nbsp; /&gt;<br />\n这样从界面上看起来又肯定会变形，因为80的高被拉到了120。用Cut模式，虽然生成的图片会是160*120，但是发现会把图像裁剪掉一部分，这个模式也不符合要求。<br />\n于是上网找生成缩略图的方法，找啊找啊找，在JT的博客的某一篇文章里看到：<a href=\"http://www.cnblogs.com/jeffreyzhao/archive/2009/11/24/problem-of-generating-thumbnail-image.html\">http://www.cnblogs.com/jeffreyzhao/archive/2009/11/24/problem-of-generating-thumbnail-image.html</a>，测试了一下这篇文章中的最后的那个方法，结果还是不能按照我所想的生成缩略图的方法，267*248的图片生成160*120的图片，用博客里的那个方法，生成的等比例的图片大小是129*120，如果放到已经固定了大小的img标签中还是会变形，最终还是得自己来写这个生成缩略图的方法啊，嗯，应该叫生成规定大小的图像的方法吧。<br />\n要求：<br />\n1、不管源图像的大小，最终都要生成预先定义好的大小的图像<br />\n2、如果源图像的宽高比预先定义的大小都要小，如 16*16 的图像生成160*120的图像，那么就相当于把16*16的图像画到160*120图像的中间，图像背景色为白色<br />\n3、如果源图像至少有一边比预先定义好的大小要大，那么就先生成等比例缩放好的图像，然后再画到预先定义大小的图像上，如：400*200的图像生成160*120的图像，则先生成等比例的160*80的图像，然后再把该图像画到160*120图像的中间<br />\n<br />\n有了需求，再结合上面的一些两个示例代码，写出了如下方法：<br />\nc#&nbsp;&nbsp; &nbsp;<br />\n&nbsp;&nbsp; &nbsp;/// &lt;summary&gt;创建规定大小的图像<div>&nbsp;&nbsp; &nbsp;/// 源图像只能是JPG格式</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;param name=\"oPath\"&gt;源图像绝对路径&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;param name=\"tPath\"&gt;生成图像绝对路径&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;param name=\"width\"&gt;生成图像的宽度&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;param name=\"height\"&gt;生成图像的高度&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;public void CreateImage(string oPath, string tPath, int width, int height)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Bitmap originalBmp = new Bitmap(oPath);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 源图像在新图像中的位置</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int left, top;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (originalBmp.Width &lt;= width &amp;&amp; originalBmp.Height &lt;= height)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 原图像的宽度和高度都小于生成的图片大小</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left = (int)Math.Round((decimal)(width - originalBmp.Width) / 2);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top = (int)Math.Round((decimal)(height - originalBmp.Height) / 2);</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 最终生成的图像</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bitmap bmpOut = new Bitmap(width, height);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;using (Graphics graphics = Graphics.FromImage(bmpOut))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 设置高质量插值法</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 清空画布并以白色背景色填充</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.Clear(Color.White);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 把源图画到新的画布上</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.DrawImage(originalBmp, left, top, originalBmp.Width, originalBmp.Height);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmpOut.Save(tPath);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmpOut.Dispose();</div>\n<div>　　　　originalBmp.Dispose();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 新图片的宽度和高度，如400*200的图像，想要生成160*120的图且不变形，</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 那么生成的图像应该是160*80，然后再把160*80的图像画到160*120的画布上</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int newWidth, newHeight;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (width * originalBmp.Height &lt; height * originalBmp.Width)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newWidth = width;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newHeight = (int)Math.Round((decimal)originalBmp.Height * width / originalBmp.Width);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 缩放成宽度跟预定义的宽度相同的，即left=0，计算top</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top = (int)Math.Round((decimal)(height - newHeight) / 2);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newWidth = (int)Math.Round((decimal)originalBmp.Width * height / originalBmp.Height);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newHeight = height; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 缩放成高度跟预定义的高度相同的，即top=0，计算left</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left = (int)Math.Round((decimal)(width - newWidth) / 2);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 生成按比例缩放的图，如：160*80的图</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Bitmap bmpOut2 = new Bitmap(newWidth, newHeight);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;using (Graphics graphics = Graphics.FromImage(bmpOut2))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.FillRectangle(Brushes.White, 0, 0, newWidth, newHeight);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.DrawImage(originalBmp, 0, 0, newWidth, newHeight);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 再把该图画到预先定义的宽高的画布上，如160*120</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Bitmap lastbmp = new Bitmap(width, height);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;using (Graphics graphics = Graphics.FromImage(lastbmp))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 设置高质量插值法</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 清空画布并以白色背景色填充</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.Clear(Color.White);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 把源图画到新的画布上</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;graphics.DrawImage(bmpOut2, left, top);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;lastbmp.Save(tPath);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;lastbmp.Dispose();<br />\n　　 &nbsp;originalBmp.Dispose();</div>\n&nbsp;&nbsp; &nbsp;}/c#<br />\n测试发现好像不支持GIF格式的，我只试过JPG格式的是可以，不知道其他的如PNG,BMP之类的行不行，懒得试了，反正产品图片一般都是jpg格式的<br />\n以上方法使用示例如下：<br />\nc#&nbsp;CreateImage(Server.MapPath(\"~/aaa.jpg\"),Server.MapPath(\"~/aaa_160_120.jpg\"),160,120);/c#<br />\n经测试，这样生成的图片就是160*120了，且不会变形。<br />\n代码下载：<a href=\"http://niunan.net/download/genpic.7z\" target=\"_blank\">http://niunan.net/download/genpic.7z</a><br />\n	                          	                          	                          ',NULL,926,'0101','ASP.NET',NULL,0),(980,'2010-03-22 17:16:55','无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上','最近，多种软件都出现了一个启动时的错误提示 “无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上”。<br />\n<br />\n出现这个提示情况是：Windows Xp 系统； 软件包括：window live writer 2009, windows messenger 2009, firefox 3.5 等非常新的版本。<br />\n<br />\n这个提示出现后，点击确定，并不影响程序的使用。这个问题出现的原因，其实微软自己的问题。可谓是微软的Vista 后遗症吧。<br />\n<br />\n在 Vista 系统里，有个挺酷的功能，就是“程序缩略图”，有点3D效果，这个功能，调用了 dwmapi.dll 这个库，而 dwmapi.dll 又引用了 msvcrt.dll 中的 _except_handler4_common 功能。<br />\n<br />\n然而，在XP系统中，系统自带的 msvcrt.dll  和 Vista 中的 msvcrt.dll 版本不同， 并没有这个 _except_handler4_common ，结果就出现了启动程序时，遇到的 “无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上”的错误提示。<br />\n<br />\n解决方法：<br />\nquote将 c:\\windows\\system32 下的 dwmapi.dll 改名，例如：改为 dwmapi.dll.bak。/quote<br />\n这样就OK了<br />\n',NULL,750,'0103','随笔',NULL,0),(979,'2010-03-21 12:05:26','春季多喝蜂蜜柠檬茶可美白排毒防辐射','　　如果您长期对着电脑工作、娱乐，是否会发现皮肤越来越干燥？小细纹越来越明显？皮肤开始变得暗沉？斑点开始增多？如果是，电脑辐射就是让肌肤越来越糟糕的罪魁祸首了。下面教大家泡制一种非常简单的蜂蜜柠檬茶，长期饮用，祛斑美白的效果非常明显，而且还能排出身体多余的毒素。<br />\n<br />\n　　原料：柠檬1个，蜂蜜适量。<br />\n<br />\n　　做法：柠檬用水打湿，表面抹上一层食盐，轻轻摩擦片刻，用水冲洗干净，并切去柠檬两头；柠檬切成两半，再切成薄片，以一层柠檬，一层蜂蜜的方式放入干净的玻璃瓶或者密封瓶中，拧紧瓶盖，放入冰箱中冷藏5～7天即可用温开水冲调饮用。<br />\n<br />\n　　提示<br />\n<br />\n　　1.早上或下午3～4点，皮肤最需要补水，此时饮用效果最好。<br />\n<br />\n　　2.用食盐摩擦柠檬表面有除菌的作用。切柠檬的时候捏住两边，这样切出来的柠檬片比较完整，柠檬汁也不会溅出来。<br />\n<br />\n　　3.因为柠檬的酸性很强，所以蜂蜜不要放得太少，不然泡出来的蜂蜜水会很酸。<br />\n<br />\n　　4.冲调柠檬蜜的时候不要用开水，因为蜂蜜中含有酵素，遇上开水会释放过量的羟甲基糖酸，使蜂蜜中的营养成分被破坏，用温开水冲调最好。',NULL,670,'0103','随笔',NULL,0),(978,'2010-03-18 21:04:18','无意中找到的一个“通用不间断滚动JS封装类”','具体没有测试过，先记录下来，以做备用！<br />\njs&lt;!--<br />\n/*MSClass (Class Of Marquee Scroll通用不间断滚动JS封装类) Ver 1.65*\\<br />\n<br />\n　制作时间:2006-08-29 (Ver 0.5)<br />\n　发布时间:2006-08-31 (Ver 0.8)<br />\n　更新时间:2007-12-28 (Ver 1.65)<br />\n　更新说明: + 加入功能 * 修正、完善<br />\n	1.65.071228<br />\n		* 横向、纵向滚动格式调整 (解决横向滚动换行的问题，无需特殊设置)<br />\n		* 彻底解决由于IE问题导致上下滚动页面留白的问题 (本次更新主要解决此问题,感谢天上的书生参与测试)<br />\n	1.6.070131<br />\n		+ 禁止鼠标控制暂停或继续 (将第9个参数设置为-1或者动态赋值将ScrollSetp设置为-1)<br />\n		+ 判断是否可以滚动 (若内容区域小于显示区域,则自动取消滚动)<br />\n		+ 跳过初始化错误 (避免引起其它滚动的停止)<br />\n		+ 默认值 (除容器ID必选外，其他参数均可根据情况进行选择设置)<br />\n		+ 参数动态赋值 (方向可用英文表示top|up|bottom|down|left|right,使其更直观、方便)<br />\n		* 文字滚动不准确 (本次更新主要目的解决此Bug,感谢周珺参与测试)<br />\n	1.4.061211<br />\n		+ 鼠标悬停改变滚动方向 (鼠标悬停控制左右滚动)<br />\n		* 由于文档下载过慢而导致获取的高度/宽度不准确<br />\n		* 浏览器兼容问题 (IE、FF、Opera、NS、MYIE)<br />\n	1.2.060922<br />\n		+ 指定范围间歇滚动<br />\n		* 程序调整<br />\n		* 连续间歇滚动停止的错误<br />\n	1.0.060901<br />\n		+ 向下、向右滚动<br />\n		+ 开始等待时间<br />\n		+ 连续滚动<br />\n		* 调整时间单位<br />\n		* 滚动误差<br />\n		* 随机死循环<br />\n		* 加强性能<br />\n		* 程序优化<br />\n	0.8.060829<br />\n		  翻屏不间断向上、向左滚动<br />\n<br />\n　演示地址:http://www.popub.net/script/MSClass.html<br />\n　下载地址:http://www.popub.net/script/MSClass.js<br />\n<br />\n　应用说明:页面包含&lt;script type=\"text/javascript\" src=\"MSClass.js\"&gt;&lt;/script&gt;<br />\n	<br />\n	创建实例:<br />\n		//参数直接赋值法<br />\n		new Marquee(\"marquee\")<br />\n		new Marquee(\"marquee\",\"top\")<br />\n		......<br />\n		new Marquee(\"marquee\",0,1,760,52)<br />\n		new Marquee(\"marquee\",\"top\",1,760,52,50,5000)<br />\n		......<br />\n		new Marquee(\"marquee\",0,1,760,104,50,5000,3000,52)<br />\n		new Marquee(\"marquee\",null,null,760,104,null,5000,null,-1)<br />\n<br />\n		//参数动态赋值法<br />\n		var marquee1 = new Marquee(\"marquee\")	*此参数必选<br />\n		marquee1.Direction = \"top\";	或者	marquee1.Direction = 0;<br />\n		marquee1.Step = 1;<br />\n		marquee1.Width = 760;<br />\n		marquee1.Height = 52;<br />\n		marquee1.Timer = 50;<br />\n		marquee1.DelayTime = 5000;<br />\n		marquee1.WaitTime = 3000;<br />\n		marquee1.ScrollStep = 52;<br />\n		marquee1.Start();<br />\n<br />\n	参数说明:<br />\n		ID		\"marquee\"	容器ID		(必选)<br />\n		Direction	(0)		滚动方向	(可选,默认为0向上滚动) 可设置的值包括:0,1,2,3,\"top\",\"bottom\",\"left\",\"right\" (0向上 1向下 2向左 3向右)<br />\n		Step		(1)		滚动的步长	(可选,默认值为2,数值越大,滚动越快)<br />\n		Width		(760)		容器可视宽度	(可选,默认值为容器初始设置的宽度)<br />\n		Height		(52)		容器可视高度	(可选,默认值为容器初始设置的高度)<br />\n		Timer		(50)		定时器		(可选,默认值为30,数值越小,滚动的速度越快,1000=1秒,建议不小于20)<br />\n		DelayTime	(5000)		间歇停顿延迟时间(可选,默认为0不停顿,1000=1秒)<br />\n		WaitTime	(3000)		开始时的等待时间(可选,默认或0为不等待,1000=1秒)<br />\n		ScrollStep	(52)		间歇滚动间距	(可选,默认为翻屏宽/高度,该数值与延迟均为0则为鼠标悬停控制,-1禁止鼠标控制)<br />\n<br />\n　使用建议:<br />\n		1、建议直接赋予容器的显示区域的宽度和高度，如(&lt;div id=\"marquee\" style=\"width:760px;height:52px;\"&gt;......&lt;/div&gt;)<br />\n		2、建议为容器添加样式overflow = auto，如(&lt;div id=\"marquee\" style=\"width:760px;height:52px;overflow:auto;\"&gt;......&lt;/div&gt;)<br />\n		3、为了更准确的获取滚动区域的宽度和高度，请尽可能将各滚动单位直接赋予正确宽高度<br />\n		4、对于TABLE标记的横向滚动，需要对TABLE添加样式display = inline，如(&lt;div id=\"marquee\" style=\"width:760px;height:52px;overflow:auto;\"&gt;&lt;table style=\"display:inline\"&gt;......&lt;/table&gt;&lt;/div&gt;)<br />\n		5、对于翻屏滚动或间歇滚动，要注意各滚动单位间的间距，同时需要对容器的可视高度和可视宽度做好准确的设置，对于各滚动单位间的间距可以通过设置行间距或者单元格的高宽度来进行调整<br />\n		6、对于LI自动换行的问题暂时没有更好的解决办法，建议将其转换成表格(TABLE)的形式来达到同等的效果<br />\n		7、针对横向滚动的文字段落，如果最末端是以空格\" \"结束的，请将空格\" \"转换成\"&amp;nbsp;\"<br />\n		8、鼠标悬停滚动思想源自Flash，所以有一定的局限性（容器内仅允许用图片&lt;img&gt;或者带链接的图片&lt;a&gt;&lt;img&gt;&lt;/a&gt;的形式，并需要禁止其自动换行）<br />\n<br />\n　感　　谢:<br />\n	天上的书生(QQ:30370740) (IE页面留白的Bug) 2007/12/22<br />\n	周珺 zhoujun#yuchengtech.com (文字滚动跳行的bug) 2007/01/31<br />\n	自本程序发布以来，收到不少朋友的邮件，提出了很多意见和建议，感谢大家的支持！<br />\n<br />\n\\***程序制作/版权所有:崔永祥(333) E-Mail:zhadan007@21cn.com 网址:http://www.popub.net***/<br />\n<br />\n<br />\nfunction Marquee()<br />\n{<br />\n	this.ID = document.getElementById(arguments0);<br />\n	if(!this.ID)<br />\n	{<br />\n		alert(\"您要设置的\\\"\" + arguments0 + \"\\\"初始化错误\\r\\n请检查标签ID设置是否正确!\");<br />\n		this.ID = -1;<br />\n		return;<br />\n	}<br />\n	this.Direction = this.Width = this.Height = this.DelayTime = this.WaitTime = this.CTL = this.StartID = this.Stop = this.MouseOver = 0;<br />\n	this.Step = 1;<br />\n	this.Timer = 30;<br />\n	this.DirectionArray = {\"top\":0 , \"up\":0 , \"bottom\":1 , \"down\":1 , \"left\":2 , \"right\":3};<br />\n	if(typeof arguments1 == \"number\" || typeof arguments1 == \"string\")this.Direction = arguments1;<br />\n	if(typeof arguments2 == \"number\")this.Step = arguments2;<br />\n	if(typeof arguments3 == \"number\")this.Width = arguments3;<br />\n	if(typeof arguments4 == \"number\")this.Height = arguments4;<br />\n	if(typeof arguments5 == \"number\")this.Timer = arguments5;<br />\n	if(typeof arguments6 == \"number\")this.DelayTime = arguments6;<br />\n	if(typeof arguments7 == \"number\")this.WaitTime = arguments7;<br />\n	if(typeof arguments8 == \"number\")this.ScrollStep = arguments8;<br />\n	this.ID.style.overflow = this.ID.style.overflowX = this.ID.style.overflowY = \"hidden\";<br />\n	this.ID.noWrap = true;<br />\n	this.IsNotOpera = (navigator.userAgent.toLowerCase().indexOf(\"opera\") == -1);<br />\n	if(arguments.length &gt;= 7)this.Start();<br />\n}<br />\n<br />\nMarquee.prototype.Start = function()<br />\n{<br />\n	if(this.ID == -1)return;<br />\n	if(this.WaitTime &lt; 800)this.WaitTime = 800;<br />\n	if(this.Timer &lt; 20)this.Timer = 20;<br />\n	if(this.Width == 0)this.Width = parseInt(this.ID.style.width);<br />\n	if(this.Height == 0)this.Height = parseInt(this.ID.style.height);<br />\n	if(typeof this.Direction == \"string\")this.Direction = this.DirectionArraythis.Direction.toString().toLowerCase();<br />\n	this.HalfWidth = Math.round(this.Width / 2);<br />\n	this.HalfHeight = Math.round(this.Height / 2);<br />\n	this.BakStep = this.Step;<br />\n	this.ID.style.width = this.Width + \"px\";<br />\n	this.ID.style.height = this.Height + \"px\";<br />\n	if(typeof this.ScrollStep != \"number\")this.ScrollStep = this.Direction &gt; 1 ? this.Width : this.Height;<br />\n	var templateLeft = \"&lt;table cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; style=&#039;border-collapse:collapse;display:inline;&#039;&gt;&lt;tr&gt;&lt;td noWrap=true style=&#039;white-space: nowrap;word-break:keep-all;&#039;&gt;MSCLASS_TEMP_HTML&lt;/td&gt;&lt;td noWrap=true style=&#039;white-space: nowrap;word-break:keep-all;&#039;&gt;MSCLASS_TEMP_HTML&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\";<br />\n	var templateTop = \"&lt;table cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; style=&#039;border-collapse:collapse;&#039;&gt;&lt;tr&gt;&lt;td&gt;MSCLASS_TEMP_HTML&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;MSCLASS_TEMP_HTML&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\";<br />\n	var msobj = this;<br />\n	msobj.tempHTML = msobj.ID.innerHTML;<br />\n	if(msobj.Direction &lt;= 1)<br />\n	{<br />\n		msobj.ID.innerHTML = templateTop.replace(/MSCLASS_TEMP_HTML/g,msobj.ID.innerHTML);<br />\n	}<br />\n	else<br />\n	{<br />\n		if(msobj.ScrollStep == 0 &amp;&amp; msobj.DelayTime == 0)<br />\n		{<br />\n			msobj.ID.innerHTML += msobj.ID.innerHTML;<br />\n		}<br />\n		else<br />\n		{<br />\n			msobj.ID.innerHTML = templateLeft.replace(/MSCLASS_TEMP_HTML/g,msobj.ID.innerHTML);<br />\n		}<br />\n	}<br />\n	var timer = this.Timer;<br />\n	var delaytime = this.DelayTime;<br />\n	var waittime = this.WaitTime;<br />\n	msobj.StartID = function(){msobj.Scroll()}<br />\n	msobj.Continue = function()<br />\n				{<br />\n					if(msobj.MouseOver == 1)<br />\n					{<br />\n						setTimeout(msobj.Continue,delaytime);<br />\n					}<br />\n					else<br />\n					{	clearInterval(msobj.TimerID);<br />\n						msobj.CTL = msobj.Stop = 0;<br />\n						msobj.TimerID = setInterval(msobj.StartID,timer);<br />\n					}<br />\n				}<br />\n<br />\n	msobj.Pause = function()<br />\n			{<br />\n				msobj.Stop = 1;<br />\n				clearInterval(msobj.TimerID);<br />\n				setTimeout(msobj.Continue,delaytime);<br />\n			}<br />\n<br />\n	msobj.Begin = function()<br />\n		{<br />\n			msobj.ClientScroll = msobj.Direction &gt; 1 ? msobj.ID.scrollWidth / 2 : msobj.ID.scrollHeight / 2;<br />\n			if((msobj.Direction &lt;= 1 &amp;&amp; msobj.ClientScroll &lt;= msobj.Height + msobj.Step) || (msobj.Direction &gt; 1 &amp;&amp; msobj.ClientScroll &lt;= msobj.Width + msobj.Step))			{<br />\n				msobj.ID.innerHTML = msobj.tempHTML;<br />\n				delete(msobj.tempHTML);<br />\n				return;<br />\n			}<br />\n			delete(msobj.tempHTML);<br />\n			msobj.TimerID = setInterval(msobj.StartID,timer);<br />\n			if(msobj.ScrollStep &lt; 0)return;<br />\n			msobj.ID.onmousemove = function(event)<br />\n						{<br />\n							if(msobj.ScrollStep == 0 &amp;&amp; msobj.Direction &gt; 1)<br />\n							{<br />\n								var event = event || window.event;<br />\n								if(window.event)<br />\n								{<br />\n									if(msobj.IsNotOpera)<br />\n									{<br />\n										msobj.EventLeft = event.srcElement.id == msobj.ID.id ? event.offsetX - msobj.ID.scrollLeft : event.srcElement.offsetLeft - msobj.ID.scrollLeft + event.offsetX;<br />\n									}<br />\n									else<br />\n									{<br />\n										msobj.ScrollStep = null;<br />\n										return;<br />\n									}<br />\n								}<br />\n								else<br />\n								{<br />\n									msobj.EventLeft = event.layerX - msobj.ID.scrollLeft;<br />\n								}<br />\n								msobj.Direction = msobj.EventLeft &gt; msobj.HalfWidth ? 3 : 2;<br />\n								msobj.AbsCenter = Math.abs(msobj.HalfWidth - msobj.EventLeft);<br />\n								msobj.Step = Math.round(msobj.AbsCenter * (msobj.BakStep*2) / msobj.HalfWidth);<br />\n							}<br />\n						}<br />\n			msobj.ID.onmouseover = function()<br />\n						{<br />\n							if(msobj.ScrollStep == 0)return;<br />\n							msobj.MouseOver = 1;<br />\n							clearInterval(msobj.TimerID);<br />\n						}<br />\n			msobj.ID.onmouseout = function()<br />\n						{<br />\n							if(msobj.ScrollStep == 0)<br />\n							{<br />\n								if(msobj.Step == 0)msobj.Step = 1;<br />\n								return;<br />\n							}<br />\n							msobj.MouseOver = 0;<br />\n							if(msobj.Stop == 0)<br />\n							{<br />\n								clearInterval(msobj.TimerID);<br />\n								msobj.TimerID = setInterval(msobj.StartID,timer);<br />\n							}<br />\n						}<br />\n		}<br />\n	setTimeout(msobj.Begin,waittime);<br />\n}<br />\n<br />\nMarquee.prototype.Scroll = function()<br />\n{<br />\n	switch(this.Direction)<br />\n	{<br />\n		case 0:<br />\n			this.CTL += this.Step;<br />\n			if(this.CTL &gt;= this.ScrollStep &amp;&amp; this.DelayTime &gt; 0)<br />\n			{<br />\n				this.ID.scrollTop += this.ScrollStep + this.Step - this.CTL;<br />\n				this.Pause();<br />\n				return;<br />\n			}<br />\n			else<br />\n			{<br />\n				if(this.ID.scrollTop &gt;= this.ClientScroll)<br />\n				{<br />\n					this.ID.scrollTop -= this.ClientScroll;<br />\n				}<br />\n				this.ID.scrollTop += this.Step;<br />\n			}<br />\n		break;<br />\n<br />\n		case 1:<br />\n			this.CTL += this.Step;<br />\n			if(this.CTL &gt;= this.ScrollStep &amp;&amp; this.DelayTime &gt; 0)<br />\n			{<br />\n				this.ID.scrollTop -= this.ScrollStep + this.Step - this.CTL;<br />\n				this.Pause();<br />\n				return;<br />\n			}<br />\n			else<br />\n			{<br />\n				if(this.ID.scrollTop &lt;= 0)<br />\n				{<br />\n					this.ID.scrollTop += this.ClientScroll;<br />\n				}<br />\n				this.ID.scrollTop -= this.Step;<br />\n			}<br />\n		break;<br />\n<br />\n		case 2:<br />\n			this.CTL += this.Step;<br />\n			if(this.CTL &gt;= this.ScrollStep &amp;&amp; this.DelayTime &gt; 0)<br />\n			{<br />\n				this.ID.scrollLeft += this.ScrollStep + this.Step - this.CTL;<br />\n				this.Pause();<br />\n				return;<br />\n			}<br />\n			else<br />\n			{<br />\n				if(this.ID.scrollLeft &gt;= this.ClientScroll)<br />\n				{<br />\n					this.ID.scrollLeft -= this.ClientScroll;<br />\n				}<br />\n				this.ID.scrollLeft += this.Step;<br />\n			}<br />\n		break;<br />\n<br />\n		case 3:<br />\n			this.CTL += this.Step;<br />\n			if(this.CTL &gt;= this.ScrollStep &amp;&amp; this.DelayTime &gt; 0)<br />\n			{<br />\n				this.ID.scrollLeft -= this.ScrollStep + this.Step - this.CTL;<br />\n				this.Pause();<br />\n				return;<br />\n			}<br />\n			else<br />\n			{<br />\n				if(this.ID.scrollLeft &lt;= 0)<br />\n				{<br />\n					this.ID.scrollLeft += this.ClientScroll;<br />\n				}<br />\n				this.ID.scrollLeft -= this.Step;<br />\n			}<br />\n		break;<br />\n	}<br />\n}<br />\n//--&gt;/js<br />\n下载JS文件：<a href=\"http://niunan.net/download/msclass.js\">http://niunan.net/download/msclass.js</a><br />\n<br />\n	                          ',NULL,957,'0105','javascript',NULL,0),(977,'2010-03-15 17:58:41','用ADO.NET来使用事务','先把代码段记下来，省得到时候要用的时候再去翻硬盘中的源文件<br />\n		c#string connString = WebConfigurationManager.ConnectionStrings\"NorthwindConnectionString\".ConnectionString;<br />\n		SqlConnection conn = new SqlConnection(connString);<br />\n		conn.Open();<br />\n		SqlTransaction tran = conn.BeginTransaction();	//创建事务Transaction<br />\n<br />\n		string strSQL = \"INSERT INTO Employees(FirstName, LastName, City, Address) values (@paramFirstName,@paramLastName,@paramCity,@paramAddress)\";<br />\n		SqlCommand cmd = new SqlCommand(strSQL, conn,tran);		//创建SqlCommand<br />\n<br />\n		try<br />\n		{<br />\n			cmd.Parameters.Add(\"@paramFirstName\", SqlDbType.NVarChar, 20).Value = txtFirstName.Text;<br />\n			cmd.Parameters.Add(\"@paramLastName\", SqlDbType.NVarChar, 10).Value = txtLastName.Text;<br />\n			cmd.Parameters.Add(\"@paramCity\", SqlDbType.NVarChar, 15).Value = txtCity.Text;<br />\n			cmd.Parameters.Add(\"@paramAddress\", SqlDbType.NVarChar, 60).Value = txtAddress.Text;<br />\n			cmd.ExecuteNonQuery();<br />\n			tran.Commit();		//确认事务<br />\n            txtMsg.Text = \"新增数据成功,事务确认!\";<br />\n		}<br />\n		catch<br />\n		{<br />\n			tran.Rollback();   //事务回滚<br />\n            txtMsg.Text = \"新增数据失败,事务Rollback!\";<br />\n		}<br />\n<br />\n		finally<br />\n		{<br />\n			conn.Close();<br />\n			conn.Dispose();<br />\n			tran.Dispose();<br />\n			cmd.Dispose();<br />\n		}/c#<br />\n	                          ',NULL,787,'0101','ASP.NET',NULL,0),(976,'2010-03-14 15:08:13','sqlite中字符串的连接操作','帮朋友做的一个网站，数据库采用sqlite，写程序的时候没注意，上传文件的时候没有保存到后缀名，导致数据库中图片字段存储的是201002151259这样的字符，实际上应该存储的是201002151259.jpg这样的字符的，<br />\n于是用SQL语句一次性更新没有后缀名的图片，结果用MSSQL的方法更新出错，上网搜索了一下，原来sqlite中连接字符串是用||，好奇怪的符号啊，呵呵，更新语句如下：<br />\nsqlupdate product set proimage=proimage||&#039;.jpg&#039; where proimage not like &#039;%.jpg&#039;/sql<br />\n<br />\n还发现一个蛮好玩的，数据库中存储的是201002151259这样的无后缀的字符时，前台取出显示在img标签中，在chrome中一样可以正常预览图片，如下HTML标签：<br />\nhtml&lt;img src=&#039;upload/201002151259&#039; /&gt;/html<br />\n以上HTML代码在chrome中可以正常看到图片的，在其他的浏览器就看不到了。<br />\n<br />\n',NULL,1131,'0106','SQL',NULL,0),(975,'2010-03-07 17:54:06','自己封装的ASP.NET的MYSQL的数据库操作类','<div></div>\nc#<div>/**</div>\n<div>&nbsp;* 作者：牛腩</div>\n<div>&nbsp;* 创建时间：2010年3月7日17时35分</div>\n<div>&nbsp;* 类说明：对MYSQL数据库的操作类</div>\n<div>&nbsp;*/&nbsp;</div>\n<div>using System;</div>\n<div>using System.Data;</div>\n<div>using MySql.Data.MySqlClient;</div>\n<div><br />\n</div>\n<div>namespace Niunan.BYLW.Utility</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;summary&gt;对MYSQL数据库的操作类</div>\n<div>&nbsp;&nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;public class MYSQLHelper</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private MySqlConnection conn = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private MySqlCommand cmd = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private MySqlDataReader sdr = null;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public MYSQLHelper()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//string connStr = WebConfigurationManager.ConnectionStrings\"connStr\".ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string connStr = \"server=localhost;database=test;uid=root;pwd=123456;charset=utf8\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn = new MySqlConnection(connStr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;创建Command对象</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"sql\"&gt;SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void CreateCommand(string sql)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd = new MySqlCommand(sql, conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;添加参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"paramName\"&gt;参数名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"value\"&gt;值&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void AddParameter(string paramName, object value)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(new MySqlParameter(paramName, value));</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行不带参数的增删改SQL语句</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"cmdText\"&gt;增删改SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"ct\"&gt;命令类型&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public bool ExecuteNonQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = cmd.ExecuteNonQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (res &gt; 0)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return true;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return false;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行查询SQL语句</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"cmdText\"&gt;查询SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public DataTable ExecuteQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = new DataTable();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;using (sdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.Load(sdr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return dt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;返回查询SQL语句查询出的结果的第一行第一列的值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string ExecuteScalar()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string res = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;object obj = cmd.ExecuteScalar();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (obj != null)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = obj.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n<div></div>\n/c#<div>都是把那个SQLITEHelper的操作类搬过来的，改了MySqlConnection等变量名，对MYSQL来说经常会出现中文乱码，经实验，解决方法：<br />\n① 用PHPMYADMIN建立MYSQL数据库的时候记得选择UTF-8的编码<br />\n② 在上面的数据库操作类中的连接字符串中记得加上charset=utf8<br />\n这样用上面的操作类来插入中文就不会出现乱码了。</div>\n	                          ',NULL,901,'0101','ASP.NET',NULL,0),(974,'2010-03-04 10:24:17','使用ROW_NUMBER()的分页存储过程','今天做一个全新的项目的时候用到分页，从以前以前做的项目中找出个分页存储过程，可以直接通过传入表名进行分页的，用到了ROW_NUMBER()函数，所以只适用于MSSQL2005以上，先记下来，以备不时之需。<br />\n<div></div>\nsql<br />\n-- =============================================<br />\n-- Author:		牛腩<br />\n-- Create date: 2009-07-22 12:41<br />\n-- Description:	分页，用到了ROW_NUMBER()<br />\n-- =============================================<br />\ncreate PROCEDURE dbo.proc_SplitPage<br />\n@tblName   varchar(255),       -- 表名<br />\n@strFields varchar(1000) = &#039;*&#039;, -- 需要返回的列，默认*<br />\n@strOrder varchar(255)=&#039;&#039;,      -- 排序的字段名，必填<br />\n@strOrderType varchar(10)=&#039;ASC&#039;, -- 排序的方式,默认ASC<br />\n@PageSize   int = 10,          -- 页尺寸,默认10<br />\n@PageIndex int = 1,           -- 页码,默认1<br />\n@strWhere varchar(1500) = &#039;&#039; -- 查询条件 (注意: 不要加 where)<br />\nAS<br />\n<br />\ndeclare @strSQL   varchar(5000)<br />\n<br />\nif @strWhere !=&#039;&#039;<br />\nset @strWhere=&#039; where &#039;+@strWhere<br />\n<br />\nset @strSQL=<br />\n&#039;SELECT * FROM (&#039;+<br />\n	&#039;SELECT ROW_NUMBER() OVER (ORDER BY &#039;+@strOrder+&#039; &#039;+@strOrderType+&#039;) AS pos,&#039;+@strFields+&#039; &#039;+<br />\n	&#039;FROM &#039;+@tblName+&#039; &#039;+@strWhere+<br />\n&#039;) AS sp WHERE pos BETWEEN &#039;+str((@PageIndex-1)*@PageSize+1)+&#039; AND &#039;+str(@PageIndex*@PageSize)<br />\n<br />\nexec (@strSQL)<br />\n/sql<br />\n<br />\n下面是调用的示例，这里可以采用join连接<br />\n<div></div>\n<div>sqlEXEC	proc_SplitPage<br />\n		@tblName = N&#039;(project p inner join projectca ca on p.caid=ca.id)&#039;,<br />\n		@strFields = N&#039;p.title,ca.caname&#039;,<br />\n		@strOrder = N&#039;p.id&#039;,<br />\n		@strOrderType = N&#039;desc&#039;,<br />\n		@PageSize = 12,<br />\n		@PageIndex = 1,<br />\n		@strWhere = N&#039;&#039;/sql<br />\n</div>\n<div></div>\n	                          	                          	                          	                          ',NULL,1747,'0106','SQL',NULL,0),(973,'2010-02-04 21:35:29','ASP.NET解决Sqlite日期类型问题：该字符串未被识别为有效的 DateTime','<span class=\"Apple-style-span\" style=\"font-family:verdana, 宋体, 新宋体, sans-serif;line-height:25px;font-size:14px;color:#111111;\">最近使用ASP.NET+SQLite数据库开发一个网站程序，结果在日期处理上出现了很头痛的问题:<br />\n<strong style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">说明:&nbsp;</strong>执行当前 Web 请求期间，出现未处理的异常。请检查堆栈跟踪信息，以了解有关该错误以及代码中导致错误的出处的详细信息。&nbsp;<br style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\" />\n<b style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">异常详细信息:&nbsp;</b>System.FormatException: 该字符串未被识别为有效的 DateTime。<br />\n<br />\n<span class=\"Apple-style-span\" style=\"color:#000000;\"><p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\"><strong style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\"><font size=\"4\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">解决方案：</font></strong></p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">在日期保存到Sqlite数据库时转换一个类型，比如：string _now = System.DateTime.Now.ToString(\"s\");</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">也就是说在.ToString()方法中加一个s,即可解决日期读取错误的问题。</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">简单代码示例：</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">string _indate = Request\"indate\";&nbsp; //输入的日期如：2009-2-21<br style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\" />\nDateTime _inTime = Convert.ToDateTime(_indate);</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">//如下是保存数据SQL语句</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">insert into 表(indate) values(‘“ + _inTime.ToString(\"s\") + \"&#039;);&nbsp;&nbsp; //这里转换<br />\n<br />\n<span class=\"Apple-style-span\" style=\"color:#000000;\"><p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">因为iso 8601的描述:(<a href=\"http://msdn.microsoft.com/zh-cn/library/ms187819.aspx\" target=\"_black\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;cursor:pointer;color:#336699;text-decoration:none;\">http://msdn.microsoft.com/zh-cn/library/ms187819.aspx</a>)</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\"><font color=\"#800000\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\"><strong style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">给出了字符串示例:<br style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\" />\n</strong></font><strong style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\"><font color=\"#ff0000\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">* 2004-05-23<font color=\"#008080\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">T</font>14:25:10<br style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\" />\n* 2004-05-23<font color=\"#008080\" style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;\">T</font>14:25:10.487</font></strong></p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">所以Sqlite保存的日期要转为iso 8601标准字符串格式</p>\n<p style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;color:#111111;\">使用 日期.ToString(\"s\");这种方法转换成 iso 8601标准字符串格式了。<br />\n<br />\n<span class=\"Apple-style-span\" style=\"color:#ff0000;\">本文版权归学IT网（www.xueit.com）所有，任何单位与个人转载必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。</span><br />\n<br />\n</p>\n</span><br />\n</p>\n</span><br />\n</span>',NULL,1043,'0101','ASP.NET',NULL,0),(972,'2010-02-03 15:41:15','自己封装的ASP.NET的MSSQL的数据库操作类(MSSQLHelper)','<div></div>\nc#<div>/*</div>\n<div>&nbsp;* 作者: 牛腩</div>\n<div>&nbsp;* 创建时间: 2010-1-20 10:43:14</div>\n<div>&nbsp;* Email: 164423073@qq.com</div>\n<div>&nbsp;* 说明: 对MSSQL数据库的增删查改操作的封装类</div>\n<div>&nbsp;*/</div>\n<div><br />\n</div>\n<div>using System;</div>\n<div>using System.Data;</div>\n<div>using System.Data.SqlClient;</div>\n<div>using System.Web.Configuration;</div>\n<div><br />\n</div>\n<div>namespace Niunan.Tg029.Hr.Utility</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;public class MSSQLHelper</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SqlConnection conn = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SqlCommand cmd = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SqlDataReader sdr = null;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public MSSQLHelper()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string connStr = WebConfigurationManager.ConnectionStrings\"connStr\".ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn = new SqlConnection(connStr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;创建Command对象</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 默认是SQL语句</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"sql\"&gt;SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void CreateCommand(string sql)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd = new SqlCommand(sql, conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;创建存储过程的Command对象</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"procName\"&gt;存储过程名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void CreateStoredCommand(string procName)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd = new SqlCommand(procName, conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.CommandType = CommandType.StoredProcedure;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;添加参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 默认是输入参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"paramName\"&gt;参数名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"value\"&gt;值&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void AddParameter(string paramName, object value)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SqlParameter p = new SqlParameter(paramName, value);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(p);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;添加输出参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 用于存储过程</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"paramName\"&gt;参数名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"value\"&gt;值&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void AddOutputParameter(string paramName) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SqlParameter p = new SqlParameter();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p.ParameterName = paramName;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p.Direction = ParameterDirection.Output;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p.Size = 20;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(p);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;获取输出参数的值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"paramName\"&gt;输出参数名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string GetOutputParameter(string paramName) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return cmd.ParametersparamName.Value.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行增删改SQL语句或存储过程</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public bool ExecuteNonQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = cmd.ExecuteNonQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (res &gt; 0)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return true;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return false;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行查询SQL语句或存储过程</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public DataTable ExecuteQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = new DataTable();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;using (sdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.Load(sdr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return dt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;返回查询SQL语句或存储过程查询出的结果的第一行第一列的值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string ExecuteScalar()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string res = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;object obj = cmd.ExecuteScalar();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (obj != null)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = obj.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n<div></div>\n/c#<div>先记下来，以备不时之需！！！<br />\n</div>\n	                          	                          	                          ',NULL,1198,'0101','ASP.NET',NULL,0),(971,'2010-02-02 20:40:16','自己封装的ASP.NET的SQLITE数据库的操作类(SQLiteHelper)','<div></div>\n<span style=\"color:#fe2419;\"><b>修改于2010年4月20日14时10分，增加了一个分页的方法</b></span><br />\nc#<br />\n<div>/*</div>\n<div>&nbsp;* 作者: 牛腩</div>\n<div>&nbsp;* 创建时间: 2010-1-20 10:43:14</div>\n<div>&nbsp;* Email: 164423073@qq.com</div>\n<div>&nbsp;* 说明: 对SQLite数据库的增删查改操作的封装类</div>\n<div>&nbsp;*/</div>\n<div><br />\n</div>\n<div>using System;</div>\n<div>using System.Data;</div>\n<div>using System.Data.SQLite;</div>\n<div>using System.Web;</div>\n<div>using System.Web.Configuration;</div>\n<div><br />\n</div>\n<div>namespace Niunan.Bozi.Utility</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;public class SQLiteHelper</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SQLiteConnection conn = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SQLiteCommand cmd = null;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private SQLiteDataReader sdr = null;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public SQLiteHelper()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string connStr = WebConfigurationManager.ConnectionStrings\"boziconnstr\".ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//string connStr = \"Data Source=\" + HttpContext.Current.Server.MapPath(\"~/App_Data/fdm.sqlite\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn = new SQLiteConnection(connStr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;创建Command对象</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"sql\"&gt;SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void CreateCommand(string sql)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd = new SQLiteCommand(sql, conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;添加参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"paramName\"&gt;参数名称&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"value\"&gt;值&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public void AddParameter(string paramName, object value)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(new SQLiteParameter(paramName, value));</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行不带参数的增删改SQL语句</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"cmdText\"&gt;增删改SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"ct\"&gt;命令类型&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public bool ExecuteNonQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = cmd.ExecuteNonQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (res &gt; 0)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return true;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return false;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;执行查询SQL语句</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"cmdText\"&gt;查询SQL语句&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public DataTable ExecuteQuery()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = new DataTable();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;using (sdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.Load(sdr);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return dt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;分页 &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &nbsp;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"tblName\"&gt;表名&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"fldName\"&gt;字段名&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"OrderfldName\"&gt;排序字段名&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"OrderType\"&gt;排序方式：asc或者desc&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"strWhere\"&gt;条件，不用加where&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"PageSize\"&gt;页大小&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"PageIndex\"&gt;页索引&lt;/param&gt; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public DataTable FengYe(string tblName, string fldName, string OrderfldName, string OrderType, string strWhere, int PageSize, int PageIndex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = new DataTable();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int start = (PageIndex - 1) * PageSize;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string sql = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!string.IsNullOrEmpty(strWhere))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 条件不为空</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sql = string.Format(\"select {0} from {1} where {2} order by {3} {4} limit {5},{6}\", fldName,</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tblName, strWhere, OrderfldName, OrderType, start, PageSize);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 条件为空</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sql = string.Format(\"select {0} from {1} order by {2} {3} limit {4},{5}\", fldName,</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tblName, OrderfldName, OrderType, start, PageSize);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CreateCommand(sql);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt = ExecuteQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return dt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;返回查询SQL语句查询出的结果的第一行第一列的值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;///&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;returns&gt;&lt;/returns&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public string ExecuteScalar()</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string res = \"\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;object obj = cmd.ExecuteScalar();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (obj != null)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;res = obj.ToString();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw ex;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return res;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n<div><br />\n</div>\n/c#<br />\n使用示例：<br />\n<div>c#using System;</div>\n<div>using Niunan.Tg029.Hr.Utility;</div>\n<div><br />\n</div>\n<div>namespace Niunan.Tg029.Hr.Web.test</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;public partial class test_sqlite : System.Web.UI.Page</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SQLiteHelper helper = new SQLiteHelper();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void Page_Load(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 创建表</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void btnCreate_Click(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string sql = \"CREATE &nbsp;TABLE tba (id INTEGER PRIMARY KEY &nbsp;NOT NULL , content TEXT, createdate DATETIME DEFAULT CURRENT_TIMESTAMP)\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;helper.CreateCommand(sql);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bool b = helper.ExecuteNonQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"创建表成功，\" + DateTime.Now + \"，\" + b);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 插入记录</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void btnInsert_Click(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string content = txtContent.Text.Trim();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (content.Length == 0)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"内容为空！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;helper.CreateCommand(\"INSERT INTO tba(content) VALUES(@name);SELECT LAST_INSERT_ROWID();\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;helper.AddParameter(\"@name\", content);</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string str = helper.ExecuteScalar();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"插入成功，\" + DateTime.Now + \"，返回的ID：\" + str);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 查看</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void btnSelect_Click(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string sql = \"SELECT * FROM tba\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;helper.CreateCommand(sql);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gv.DataSource = helper.ExecuteQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gv.DataBind();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 取最大ID</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected void btnGetMaxID_Click(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 使用LINQ的方法从DATATABLE中获取某一字段的最大值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//string sql = \"SELECT id,content,createdate FROM tba\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//helper.CreateCommand(sql);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//DataTable dt = helper.ExecuteQuery();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//object obj = dt.AsEnumerable().Select(x =&gt; x\"id\").Max();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 使用SQL语句获取最大ID</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string sql = \"SELECT MAX(id) FROM tba\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;helper.CreateCommand(sql);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;object obj = helper.ExecuteScalar();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(\"最大ID：\" + obj.ToString()+\"，\"+DateTime.Now);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n<div>/c#<br />\n蛮简单的一个封装，特此记录，以备不时之需！！！<br />\n附件下载：<a href=\"http://niunan.net/download/sqlitetest.7z\" target=\"_blank\">http://niunan.net/download/sqlitetest.7z</a></div>\n	                          	                          	                          	                          ',NULL,1379,'0101','ASP.NET',NULL,0),(970,'2010-01-20 10:52:55','电脑问题－没有声音','<span class=\"Apple-style-span\" style=\"font-family:simsun;line-height:normal;font-size:medium;\"><div style=\"margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px;background-color:#ffffff;color:#000000;font-size:12px;font-family:&#039;sans serif&#039;, tahoma, verdana, helvetica;line-height:1.5;\">&nbsp;&nbsp; 亲戚打电话过来，说他电脑突然没有声音了，跟别人QQ聊天的时候，别人能听到他的声音，他听不到别人的声音。<br />\n&nbsp;&nbsp; 解决方法：鼠标左键单击桌面右下角托盘的那个小喇叭图标，把滑块向上推，把“静音”前的框框中的小勾勾清除.....<br />\n&nbsp;&nbsp; 还好我没有不远几里的跑去帮他解决...<img src=\"http://niunan.org/kindeditor/plugins/emoticons/17.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" /><img src=\"http://niunan.org/kindeditor/plugins/emoticons/27.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" /><img src=\"http://niunan.org/kindeditor/plugins/emoticons/40.gif\" width=\"24\" height=\"24\" border=\"0\" alt=\"\" /></div>\n</span>	                          ',NULL,746,'0103','随笔',NULL,0),(969,'2010-01-07 16:47:03','文件夹重命名','做了一个“文件夹重命名”的小程序，有什么作用？大家看看下面的图就懂了，嘿嘿！<br />\n<b>没有命名前:</b><br />\n<img src=\"http://blog.niunan.net/upload/20100107164444.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<b>重命名了以后:</b><br />\n<img src=\"http://blog.niunan.net/upload/20100107164503.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n<div>这主要是为了方便我的日常操作吧。嘿嘿。。。</div>\n<div>废话少说，上代码：<br />\n<br />\n<div></div>\nc#<div>using System;</div>\n<div>using System.Collections.Generic;</div>\n<div>using System.Linq;</div>\n<div>using System.Text;</div>\n<div>using System.IO;</div>\n<div>using System.Text.RegularExpressions;</div>\n<div><br />\n</div>\n<div>namespace 文件夹重命名</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;class Program</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;static void Main(string args)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string ss = Directory.GetDirectories(@\"D:\\My Music\"); // 获取文件夹中的所有目录</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (string item in ss)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 取出的示例：g:\\test\\牛腩</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string path = item.Substring(0, item.LastIndexOf(&#039;\\\\&#039;) + 1); // 获取路径</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string dirname = item.Substring(item.LastIndexOf(&#039;\\\\&#039;) + 1); // 获取目录名</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 只重命名以中文开头的目录</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (Regex.IsMatch(dirname, @\"^\\u4e00-\\u9fa5.+\"))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string new_dirname = StrToPinyin.GetChineseSpell(dirname.Substring(0, 1)).ToLower() + dirname; // 新目录名</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Directory.Move(path + dirname, path + new_dirname); // 目录重命名</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine( dirname + \" → \" + new_dirname);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n/c#<div></div>\n<div>项目下载：<a href=\"http://niunan.net/download/rename.7z\" target=\"_blank\">http://niunan.net/download/rename.7z</a></div>\n</div>\n	                          ',NULL,956,'0101','ASP.NET',NULL,0),(968,'2010-01-07 16:42:50','netbeans的自定义代码折叠功能','代码如下:<br />\n<div></div>\nphp<div>//&lt;editor-fold defaultstate=\"collapsed\" desc=\"测试代码折叠\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo &#039;&lt;script type=\"text/javascript\"&gt;&#039;;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo \"alert(&#039;当前类目下有文章，不能删除！&#039;);\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo \"history.;(-1)\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo \"&lt;/script&gt;\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit;</div>\n<div>//&lt;/editor-fold&gt;</div>\n/php<div></div>\n',NULL,1284,'0111','工具使用',NULL,0),(967,'2010-01-07 16:33:19','discuz中的uccenter中的验证码','<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">花了一个上午的时间，终于提取出来了，效果演示：<br />\n<img src=\"http://niunan.org/upload/20100107162940.jpg\" alt=\"\" border=\"0\" /><br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">&nbsp;<span class=\"Apple-style-span\" style=\"font-family:&#039;sans serif&#039;, tahoma, verdana, helvetica;\">&nbsp;完全就是从discuz中复制出来的，然后把一些没必要的代码都删除了的，本地预览和在网上预览的时候注意要更改那个字体路径的就行，路径中可以放多个ttf字体文件，这样就能随机字体也不同了。</span></span></span><div>&nbsp;</div>\n<div>在我要把我提取出来的整合到niunan.org上时，发现在本地预览出错，晕，后来查了下，原来不是验证码的问题，是我本机的WAMP升级了，本机现在是PHP5.3了，但是空间上的还是PHP5.2.9，在判断是否有URL参数的时候我是写&nbsp;<span class=\"Apple-style-span\" style=\"font-family:consolas, &#039;courier new&#039;, courier, mono;\"><span class=\"keyword\" style=\"color:#7f0055;font-weight:bold;\">if</span><span style=\"color:black;\">(</span><span class=\"vars\" style=\"color:black;\">$_GET</span><span style=\"color:black;\">\"caid)...<br />\n这不符合规范,所以会报错,应该叫报警告,NITIFY...<br />\n正确的写法应该是<br />\n<span class=\"keyword\" style=\"color:#7f0055;font-weight:bold;\">if</span><span style=\"color:black;\">(!</span><span class=\"keyword\" style=\"color:#7f0055;font-weight:bold;\">empty</span><span class=\"func\" style=\"color:black;\">empty</span><span style=\"color:black;\">(</span><span class=\"vars\" style=\"color:black;\">$_GET</span><span style=\"color:black;\"></span><span class=\"string\" style=\"color:blue;\">&#039;caid&#039;</span><span style=\"color:black;\">))...<br />\n有时间得改改...<br />\n<br />\n源文件下载:<a href=\"http://niunan.net/download/discuz_vd.7z\" target=\"_blank\">http://niunan.net/download/discuz_vd.7z</a><br />\n<br />\n<br />\n</span><br />\n<br />\n<br />\n<br />\n</span></span></div>\n	                          	                          ',NULL,1057,'0102','PHP',NULL,0),(966,'2010-01-04 21:23:42','又换了个验证码。。。','&nbsp;&nbsp;&nbsp; 唉。。。元旦刚刚搞好其他的，结果博客的回复验证码又不起作用了，刚刚花了一晚上的时间来查，郁闷，不知道怎么回事，<br />\n&nbsp;&nbsp;&nbsp; 原来我是用<br />\nphpimagettftext($im,18,0,20,20,$te,&#039;STLITI.TTF&#039;,$string);/php<br />\n来在图像上画出验证码的，字体文件STLITI.TTF我也是传上去的，但是在网上就怎么样都显示不出来，郁闷，<br />\n后来换了种方式，采用<br />\nphpimagestring($im, 5, 5, 5, $string, $te);/php<br />\n的方式，不用字体文件了，这样子的话是能够显示出来了，郁闷，不知道怎么一用了字体文件了就显示不出来了。。<br />\n但是以前又是可以显示的，晕哦，字体删除了又重新上传过了，而且是采用二进制来上传的。。。<br />\n现在是采用默认的字体了，不过可能太规律了，估计那个留言机器人又快来搞了。。。烦啊。。。	                          ',NULL,846,'0103','随笔',NULL,0),(965,'2010-01-04 11:52:40','晕哦，刚刚改好其他的，结果验证码又出问题了！','晕哦，刚刚改好其他的，结果验证码又出问题了！<br />\n烦啊。。。。郁闷。。。',NULL,734,'0103','随笔',NULL,0),(964,'2010-01-03 20:43:58','元旦计划完成','&nbsp;&nbsp;今天终于把计划中的更改博客的代码搞掂了，嘿嘿，代码高亮采用了那个SyntaxHighlighter,kindeditor编辑器也更新到3.4最新版了，呵呵，编辑器的图片上传功能也可以使用了，<br />\n<img src=\"http://niunan.org/upload/20100103202758.gif\" alt=\"\" border=\"0\" /><img src=\"http://niunan.org/upload/20100103203211.gif\" alt=\"\" border=\"0\" /><br />\n&nbsp;&nbsp;而且在编辑文章的时候原来的代码段也都能相应的显示出来了。。呵呵。。。<br />\n<br />\n&nbsp;&nbsp;接下来的工作就是一篇一篇博客的打开来重新编辑了，原来数据库中保存的是转化后的数据，现在是保存原始的输入数据，所以在每次显示的时候都得转化，可能打开文章的时间上会慢了许多。。。嗯，看来下一步的计划就是把每篇博客都生成HTML静态页了。<br />\n<br />\n&nbsp;&nbsp;博客的源码会随时的更新，下载链接在最底部，另外本人最近找到个放源码的好地方：<br />\n&nbsp;&nbsp;<a href=\"http://www.svnhost.cn/\" target=\"_blank\">http://www.svnhost.cn/<br />\n<br />\n</a>&nbsp;&nbsp;在线源代码托管，全中文界面，网上都说以后多人开发一定会用到源码管理的，自己也一直想学，不过到最后还是不明白是什么意思，上;ogle code上看，全是E文，郁闷，这个网站最近才发现的，嘿嘿，元旦前在公司中玩弄了几天，终于知道源代码管理是什么意思了，网站推荐的<span class=\"Apple-style-span\" style=\"font-family:arial, verdana, tahoma;line-height:21px;font-size:large;color:#cc6600;font-weight:bold;\">TortoiseSVN</span>这个工具很好用，也可以在本机上建立自己的源码库，嘿嘿，官网上也有中文包同步下载，不错不错，玩弄的这几天里我把我做的几个完整的项目都放到上面了，呵呵。感兴趣的朋友可以上去下载，怎么下载的大家可以看看里面的帮助里面的视频教程，呵呵，蛮直观的。	                          	                          ',NULL,780,'0103','随笔',NULL,0),(963,'2009-12-31 16:35:21','元旦计划','	  	  	  <span style=\"font-family:arial,sans-serif,helvetica,tahoma;font-size:12px;\"><div class=\"blog_content\"><p><span style=\"font-family:simsun;font-size:medium;\">&nbsp;&nbsp; 嘿嘿。。。刚刚得到消息。。。元旦123号都可以放假。。哈哈。。好棒。。今晚又可以通宵啦。。呵呵。。可惜没有球看了啊。。。不过虽然得放假了，但还是挻郁闷的，老大叫我做出明年2010年的整个全年的计划，晕。。。唉。。得好好的想想才行了。。。</span></p>\n<div>嗯，先列表一下元旦内打算要做的事情：</div>\n<div><ol style=\"font-size:1em;\"><li style=\"font-size:1em;\">把公司电脑上的“进销存”和美工新做出的网站改版后的静态页放到网上，回家后再下载下来。<span style=\"color:#fe2419;\">（√）</span></li>\n<li style=\"font-size:1em;\">《JavaScript征途》这本书至少要看完三章 <span style=\"color:#d40a00;\">(已看完3章)</span><br />\n</li>\n<li style=\"font-size:1em;\">用正则表达式采集专业分类和职位分类，放到自己建立的数据库中<span style=\"color:#fe2419;\">（√）</span></li>\n<li style=\"font-size:1em;\">改进PHP博客，添加到数据库中的文章中的代码段不转换为pre形式了，直接存到数据库中，取出来的时候才转换。<span style=\"color:#f10b00;\">（√）</span></li>\n<li style=\"font-size:1em;\">把帮网友做的那个水务网站所有代码及源文件放到svnhost.cn上 <span style=\"color:#f10b00;\">(√)</span><br />\n</li>\n</ol>\n</div>\n暂时就这么多了。。。第1点和第5点一会下班回家应该马上就做完了。第3点的正则表达式我也已经弄出来了，剩下的只是在程序中循环添加进数据库而已，麻烦的是第4点，在这里先做一些记录：<div><br />\n</div>\n<div><span style=\"color:#ff0000;\">文章中的代码段原样放入数据库中，显示文章的时候取出把代码段变为对应的pre代码，代码段中的代码要进行HTML转义，在编辑文章的时候取取出把代码段变为对应的pre代码，代码段中的代码要进行HTML二次转义，即第一次转为&nbsp; 二次转义后变为&nbsp; 如果不进行二次转义的话那放到kindeditor中会显示出错。</span></div>\n<div><br />\n</div>\n<div>嗯。。暂时就想到这里。。。</div>\n</div>\n</span>	  	  	  	  	  	  	                          ',NULL,808,'0103','随笔',NULL,0),(962,'2009-12-17 14:20:49','PHP的线程安全与非线程安全版本的区别','<span style=\"font-family:arial, verdana, helvetica;font-size:12px;\">Windows版的PHP从版本5.2.1开始有Thread Safe(线程安全)和None Thread Safe(NTS，非线程安全)之分，这两者不同在于何处？到底应该用哪种？这里做一个简单的介绍。<br /><br />从2000年10月20日发布的第一个Windows版的PHP3.0.17开始的都是线程安全的版本，这是由于与Linux/Unix系统是采用多进程的工作方式不同的是Windows系统是采用多线程的工作方式。如果在IIS下以CGI方式运行PHP会非常慢，这是由于CGI模式是建立在多进程的基础之上的，而非多线程。一般我们会把PHP配置成以ISAPI的方式来运行，ISAPI是多线程的方式，这样就快多了。但存在一个问题，很多常用的PHP扩展是以Linux/Unix的多进程思想来开发的，这些扩展在ISAPI的方式运行时就会出错搞垮IIS。因此在IIS下CGI模式才是PHP运行的最安全方式，但CGI模式对于每个HTTP请求都需要重新加载和卸载整个PHP环境，其消耗是巨大的。<br /><br />为了兼顾IIS下PHP的效率和安全，微软给出了FastCGI的解决方案。FastCGI可以让PHP的进程重复利用而不是每一个新的请求就重开一个进程。同时FastCGI也可以允许几个进程同时执行。这样既解决了CGI进程模式消耗太大的问题，又利用上了CGI进程模式不存在线程安全问题的优势。<br /><br />因此，如果是使用ISAPI的方式来运行PHP就必须用Thread Safe(线程安全)的版本；而用FastCGI模式运行PHP的话就没有必要用线程安全检查了，用None Thread Safe(NTS，非线程安全)的版本能够更好的提高效率。</span>	  	  \n	  <div><span style=\"font-family:arial, verdana, helvetica;font-size:12px;\"><br /></span></div><div><span style=\"font-family:arial, verdana, helvetica;font-size:12px;\">转自：<a href=\"http://iam.ittot.com/post/PHP-nts.php\">http://iam.ittot.com/post/PHP-nts.php</a></span></div>',NULL,888,'0102','PHP',NULL,0),(961,'2009-12-10 13:07:10','js打印控件(PAZU)使用方法（只对IE系列有效）','	  正在搞公司自己的进销存，B/S的，用.NET来做,销售出单和采购入库单都需要打印出来的,打印单输出用的是Star NX-500针式打印机,打印纸是\"<span style=\"font-family:arial, sans-serif;font-size:small;\"><em>三联无碳单据</em></span>\"(找这个学名找了N久),纸的两边有孔的,大小自己测量了一下,A4的三分之一,大概也就是21CM x 10CM,在先用IE打印设置的时候发现那台针式打印机不能自己定义打印的大小的,晕,只能用里面的已经定义的大小,试了好久,终于找到一个比较合理的值了,纸张大小选择: <span style=\"color:#f10b00;\">链式纸 9 x 11/3 英寸,上下边距为5~8 之间,左右的话可以设置为0</span>,这样打印出来的话打印的内容正好在两张\"三联无碳单据\"之间,正好可以撕开,接下来就是找程序来实现打印机的设置了,上网搜索了一下,发现个PAZU的东西,看了一下,觉得还行吧,自己做了个测试的页面,在本机测试成功了,ie6也OK,但是放到公司内网的服务器测试,发现没用,呵呵,估计应该是没有申请那个授权吧,所以对http://192.168.1.100/test_print.html这种地址无效.<div>下面是我自己写的测试网页,只是针对于Star NX-500的打印机的,如果是其他的话就不知道了,其实通过研究<a href=\"http://www.4fang.net/article/tech/pazu_tprinter.html\" target=\"_blank\">http://www.4fang.net/article/tech/pazu_tprinter.html</a>这个示例网页也就基本可以知道这个控件是怎么使用了.</div><div>该页面本人也已传到网上,不过因为没有授权,所以说是用不了的</div><div><br /></div>\n<a target=\"_blank\" href=\"http://niunan.net/test_print.html\">http://niunan.net/test_print.html</a>\n	  <div><br />\n<pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;进销打印 &lt;/title&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gbk\" /&gt;\n    &lt;style media=\"print\"&gt; &lt;!-- 人为控制打印分页，IE系列有效 --&gt;\n        .PageNext\n        {\n            page-break-after: always;\n        }\n    &lt;/style&gt;\n    &lt;style type=\"text/css\"&gt;\n        body\n        {\n            background-color: #000000;\n            margin-left: 0px;\n            margin-top: 0px;\n            margin-right: 0px;\n            margin-bottom: 0px;\n        }\n        body, td, th\n        {\n            font-size: 12px;\n            color: #000000;\n        }\n        Table\n        {\n            padding: 0px;\n            padding-top: 3px;\n            margin: 0px;\n        }\n        td\n        {\n            margin: 0px;\n            padding: 0px;\n        }\n        .allTable\n        {\n            height: 280px;\n            width: 740px;\n            margin-bottom: 1px;\n        }\n        .allTable .alltd\n        {\n            padding: 15px 40px 20px;\n        }\n        .allTable .Table1\n        {\n            width: 100%;\n            margin-bottom: 5px;\n        }\n        .allTable .Table2\n        {\n            width: 100%;\n            margin-right: auto;\n            margin-left: auto;\n            margin-bottom: 5px;\n        }\n        .allTable .alltd .Table1 .pname\n        {\n            font-size: 16px;\n            font-weight: bold;\n        }\n        .allTable .alltd .Table3\n        {\n            border-top: 1px solid #333333;\n            border-left: 1px solid #333333;\n            margin-bottom: 5px;\n        }\n        .allTable .alltd .Table3 td\n        {\n            border-right: 1px solid #333333;\n            border-bottom: 1px dashed #333333;\n            text-align: center;\n            height: 22px;\n        }\n        .allTable .alltd .Table4\n        {\n            margin-bottom: 5px;\n        }\n    &lt;/style&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        //预先选中的纸张\n        var strDefaultPaper = &#039;链式纸 9 x 11/3 英寸&#039;;\n    \n        //1.载入打印机和纸张列表\n        function init() {\n            listPrinters();\n            listPapers();\n        }\n\n        //列出所有的打印机\n        function listPrinters() {\n            var ps = pazu.TPrinter.getPrinters();\n            //获得是一个以回车换行分隔的字符串\n            // alert(ps);\n            var pa = ps.split(\"\\r\\n\");\n            for (var i = 0; i &lt; pa.length; i++) {\n                //alert(pai);\n                var Op = document.createElement(\"option\");\n                Op.text = pai;\n                Op.value = pai;\n                try { printers.add(Op); } catch (ex) { alert(ex.message) }\n            }\n        }\n\n        //根据选择的打印机列出所有支持的纸张大小\n        function listPapers() {\n            //alert(\"列出所有支持的纸张大小\");\n            //清空纸张列表框\n            papers.options.length = 0;\n            //根据选择的打印机获得所支持的纸张列表\n            var ps = pazu.TPrinter.getPaperForms(printers.value);\n            //获得是一个以回车换行分隔的字符串\n            //alert(ps);\n            var pa = ps.split(\"\\r\\n\");\n            for (var i = 0; i &lt; pa.length; i++) {\n                //alert(pai);\n                var Op = document.createElement(\"option\");\n                Op.text = pai;\n                Op.value = pai;\n                if (pai == strDefaultPaper) Op.selected = true;\n                try { papers.add(Op); } catch (ex) { alert(ex.message) }\n            }\n        }\n\n        //创建自定义纸张大小\n        function createPaperForm() {\n            //创建自定义纸张大小，返回该纸张格式的名称\n            strDefaultPaper = pazu.TPrinter.createPaper(PaperW.value, PaperH.value);\n            alert(&#039;成功创建纸张格式：&#039; + strDefaultPaper);\n            listPapers();\n        }\n\n        // 打印按钮\n        function fun() {\n            pazu.TPrinter.marginTop = 5;                    //属性 上边距\n            pazu.TPrinter.marginBottom = 5;                 //属性 下边距\n            pazu.TPrinter.marginLeft = 0;                   //属性  左边距\n            pazu.TPrinter.marginRight = 0;                  //属性  右边距\n            pazu.TPrinter.footer = \"\";                  //属性 页脚\n            pazu.TPrinter.header = \"\";                  //属性  页眉\n            pazu.TPrinter.orientation = 1;                   //属性 整型：纸张方向 1=纵向  2=横向\n            pazu.TPrinter.paperName = papers.value;    //属性   纸张大小名称\n            pazu.TPrinter.printerName = printers.value;            //属性   打印机名称\n            //alert(\"打印机：\" + pazu.TPrinter.printerName + \" , 纸张：\" + pazu.TPrinter.paperName);\n            //pazu.TPrinter.doPrint(); // 不预览直接打印\n            pazu.TPrinter.doPreview(); // 打印预览\n        }\n    &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body onload=\"init()\"&gt;\n    &lt;div style=\"display: none;\"&gt;\n        &lt;object classid=\"clsid:AF33188F-6656-4549-99A6-E394F0CE4EA4\" codebase=\"http://www.4Fang.net/4ff/sc_setup.exe\"\n            id=\"pazu\" name=\"pazu\"&gt;\n            &lt;param name=\"License\" value=\"You Need a License from 4Fang\" /&gt;\n        &lt;/object&gt;\n    &lt;/div&gt;\n    &lt;div style=\"background-color: #FFF8F0; margin-bottom:5px; padding-left:20px;\" class=\"p__\"&gt;\n        打 印 机\n        &lt;select id=\"printers\" style=\"width: 400px\" onchange=\"listPapers()\"&gt;\n        &lt;/select&gt;\n        &lt;br /&gt;\n        纸张大小\n        &lt;select id=\"papers\" style=\"width: 400px\"&gt;\n        &lt;/select&gt;\n        &lt;br /&gt;\n        &lt;!--自定义纸张：宽&lt;input name=\"PaperW\" type=\"text\" style=\"width: 46px\" value=\"18\" /&gt;cm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n        高&lt;input name=\"PaperH\" type=\"text\" style=\"width: 46px\" value=\"20\" /&gt;cm&lt;input name=\"BTNCreatePaper\"\n            type=\"button\" value=\"设置纸张\" onclick=\"createPaperForm();\" style=\"width: 100px\" /&gt;&lt;br /&gt;\n        &lt;br /&gt;--&gt;\n        &lt;input type=\"button\" class=\"p__\" onclick=\"fun()\" value=\"打印\" /&gt;\n    &lt;/div&gt;\n    &lt;table id=&#039;allTable&#039; class=\"allTable\" border=&#039;0&#039; align=&#039;center&#039; cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;\n        bgcolor=&#039;#FFFFFF&#039; style=&#039;border: 0px;&#039;&gt;\n        &lt;tr&gt;\n            &lt;td id=&#039;alltd&#039; class=\"alltd\" valign=&#039;top&#039; style=&#039;border: 0px;&#039;&gt;\n                &lt;table id=&#039;Table1&#039; class=\"Table1\" align=&#039;center&#039; cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                        &lt;td width=&#039;50%&#039; align=&#039;center&#039; class=&#039;pname&#039;&gt;\n                            牛腩自制进销存销售单\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039; style=&#039;border-bottom: 1px solid #0000FF;&#039;&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                www.niunan.org&lt;/div&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table align=&#039;center&#039; id=&#039;Table2&#039; class=\"Table2\" cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            【客户】测试用户(5868843)\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【日期】2009-12-08\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【仓库】仓库一\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【单号】XS20091280000\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table3&#039; class=\"Table3\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;商品名称&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;单价&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;数量&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;金额&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;备注&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 R408-DA0C\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            华硕 Eee PC S101\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 80G 并口\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 R408-DA0C\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            华硕 Eee PC S101\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 80G 并口\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table4&#039; class=\"Table4\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; align=&#039;center&#039;\n                    border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            【大写合计】壹萬叁仟贰佰伍拾陆圆零角零分\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【小写合计】13256.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【支付方式】未结算\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【页码】1/1\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table5&#039; class=\"Table5\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; align=&#039;center&#039;\n                    border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【开单人】牛腩\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【经手人】牛腩\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【仓管】\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【审核人】\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n            &lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;br /&gt;\n    &lt;!--分页--&gt;\n    &lt;div class=\"PageNext\"&gt;\n    &lt;/div&gt;\n    &lt;table id=&#039;Table6&#039; class=\"allTable\" border=&#039;0&#039; align=&#039;center&#039; cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;\n        bgcolor=&#039;#FFFFFF&#039; style=&#039;border: 0px;&#039;&gt;\n        &lt;tr&gt;\n            &lt;td id=&#039;Td1&#039; class=\"alltd\" valign=&#039;top&#039; style=&#039;border: 0px;&#039;&gt;\n                &lt;table id=&#039;Table7&#039; class=\"Table1\" align=&#039;center&#039; cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                        &lt;td width=&#039;50%&#039; align=&#039;center&#039; class=&#039;pname&#039;&gt;\n                            牛腩自制进销存销售单\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039; style=&#039;border-bottom: 1px solid #0000FF;&#039;&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                www.niunan.org&lt;/div&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table align=&#039;center&#039; id=&#039;Table8&#039; class=\"Table2\" cellpadding=&#039;0&#039; cellspacing=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            【客户】测试用户(5868843)\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【日期】2009-12-08\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【仓库】仓库一\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【单号】XS20091280000\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table9&#039; class=\"Table3\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;商品名称&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;单价&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;数量&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;金额&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;div align=&#039;center&#039;&gt;\n                                &lt;strong&gt;备注&lt;/strong&gt;&lt;/div&gt;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 R408-DA0C\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            7288.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            华硕 Eee PC S101\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            5968.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td style=&#039;text-align: left; padding-left: 10px;&#039;&gt;\n                            三星 80G 并口\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            1\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            0.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            &nbsp;\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table10&#039; class=\"Table4\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; align=&#039;center&#039;\n                    border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            【大写合计】壹萬叁仟贰佰伍拾陆圆零角零分\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【小写合计】13256.00\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【支付方式】未结算\n                        &lt;/td&gt;\n                        &lt;td&gt;\n                            【页码】1/1\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n                &lt;table id=&#039;Table11&#039; class=\"Table5\" cellspacing=&#039;0&#039; cellpadding=&#039;0&#039; width=&#039;100%&#039; align=&#039;center&#039;\n                    border=&#039;0&#039;&gt;\n                    &lt;tr&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【开单人】牛腩\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【经手人】牛腩\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【仓管】\n                        &lt;/td&gt;\n                        &lt;td width=&#039;25%&#039;&gt;\n                            【审核人】\n                        &lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n            &lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;    \n&lt;/body&gt;\n&lt;/html&gt;\n\n</pre></div>',NULL,6677,'0105','javascript',NULL,0),(960,'2009-12-07 15:37:30','ASP.NET生成excel','	  只贴重要代码，<div>引入命名空间：</div><div><pre name=\"code\" class=\"c#\">\nusing Excel = Microsoft.Office.Interop.Excel;\nusing System.Reflection;\n\n</pre><br /></div><div>按钮代码：</div><div><pre name=\"code\" class=\"c#\">\nprotected void Button2_Click(object sender, EventArgs e)\n&nbsp;&nbsp; &nbsp;{\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Excel.Workbook xlWorkBook = default(Excel.Workbook);\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Excel.Worksheet xlWorkSheet = default(Excel.Worksheet);\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkBook = new Excel.Application().Workbooks.Add(Missing.Value);\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkBook.Application.Visible = true;\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet = xlWorkBook.ActiveSheet as Excel.Worksheet;\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 获取数据\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;DataTable dt = CreateDataSource();\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int i = 2;\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 输出Excel中的第一行\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cells1, 1 = \"编号\";\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cells1, 2 = \"单价\";\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cells1, 3 = \"数量\";\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cells1, 4 = \"小计\";\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.get_Range(\"$A1\", \"$D1\").Font.Bold = true; &nbsp;// 设置粗体\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.get_Range(\"$A1\", \"$D1\").Font.Color = System.Drawing.ColorTranslator.ToOle(Color.Blue);//设置字体颜色\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.get_Range(\"$B2\", \"$B200\").NumberFormat = \"0.00\"; // 设置列格式，保留2位小数\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.get_Range(\"$A1\", \"$A200\").NumberFormat = \"@\"; // 文本格式\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 输出datatable中的其他数据\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;foreach (DataRow dr in dt.Rows)\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cellsi, 1 = dr0;\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cellsi, 2 = dr1;\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cellsi, 3 = dr2;\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Cellsi, 4 = dr3;\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 下一行\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;i = i + 1;\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}\n\n\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 自动填充\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;xlWorkSheet.Columns.AutoFit();\n&nbsp;&nbsp; &nbsp;}\n\n</pre><br /></div><div>另找到一篇文章，发现蛮全的。</div><div><a href=\"http://huqing80102.blog.sohu.com/133655763.html\">http://huqing80102.blog.sohu.com/133655763.html</a></div>	  \n	  ',NULL,945,'0101','ASP.NET',NULL,0),(959,'2009-12-04 22:33:06','PHP在netbeans中的简单使用','<span style=\"font-family:helvetica, arial, sans-serif;color:#333333;font-size:14px;\"><br />\n视频内容：通过一个简单的PHP留言板来学习netbeans开发工具的使用<br />\n<br />\n<br />\n下载地址（<font color=\"#ff0000\">已录完</font>）：</span><div><br />\n第一讲：软件的安装<br />\n<br />\n第二讲：静态页面的制作<br />\n<br />\n第三讲：数据库的建立<br />\n<br />\n第四讲：用PHP代码对数据库进行插入操作<br />\n<br />\n第五讲：实现添加留言功能<br />\n<br />\n第六讲：在netbeans中进行PHP调试<br />\n<br />\n第七讲：实现显示留言列表<br />\n<br />\n第八讲：在netbeans中建立PHP类<br />\n<br />\n第九讲：实现删除留言的功能<br />\n<br />\n第十讲：分页（上）<br />\n<br />\n第十一讲：分页（下）<br />\n<br />\n第十二讲：上传网站<br />\n<br />\n<span style=\"color:#f10b00;\">下载：<a href=\"http://item.taobao.com/item.htm?id=7910052465\">http://item.taobao.com/item.htm?id=7910052465</a><br />\n<br />\n</span><br />\n</div>\n<div>效果演示：</div>\n<div><img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/phpguestbook/02.jpg\" /><br />\n</div>\n<br />\n源码下载：<br />\n<a href=\"http://niunan.net/download/phpguestbook.7z\" target=\"_blank\">http://niunan.net/download/phpguestbook.7z</a> ',NULL,3248,'0112','原创视频',NULL,0),(958,'2009-11-24 17:00:33','ASP.NET中对数据库采用信任方式连接','	  	  <div>先记下了，免得以后需要的时候再到处翻，</div><div>用了下面的写法后不用在MSSQL中附加数据库了，直接在VS中双击数据库打开就行了！！！</div>\n<pre name=\"code\" class=\"xml\">\n&lt;add name=\"ConnectionString\" connectionString=\"Data Source=.\\SQLEXPRESS;AttachDbFilename=|DataDirectory|\\实例数据库.MDF;  Integrated Security=True;User Instance=True\" providerName=\"System.Data.SqlClient\"/&gt;\n</pre>	  	  \n	  	  \n	  	  \n	  ',NULL,759,'0101','ASP.NET',NULL,0),(957,'2009-11-19 22:27:29','验证码换了种颜色，看看还被不被搞！！！','验证码换了种颜色，看看还被不被搞！！！<br /><br /><div>这回应该难看出来了。。。呵呵。。</div>',NULL,861,'0103','随笔',NULL,0),(956,'2009-11-19 22:10:32','搞掂博客的RSS功能！','<p>呵呵。。。RSS的结构是按照我的那个JAVAEYE博客的RSS结构来搞的，</p>\n<p><a href=\"http://niunan.javaeye.com/rss\" target=\"_blank\">http://niunan.javaeye.com/rss</a></p>\n<p>搞完后用;ogle reader和抓虾试了下。。是能够获取出最新的前20篇博客文章的，不过唯一不足的就是在;ogle reader中如果滚动下拉条的话是不会获取出以前的数据的。。唉。。这个功能一直想做。。但就是做不出来。。郁闷。。</p>\n<p>传到网上后发现昨晚做的那个验证码的好像没有效果，留言本又被留言机器人强奸了。。呵呵。群里人说应该是验证码太好识别了。。。唉。。得找个麻烦的验证码了。。目前暂停了留言功能。。。大家要留言的可去我的网站上留言</p>\n<p><a href=\"http://niunan.net/guestbook/index.html\">http://niunan.net/guestbook/index.html</a></p>\n<p>发现在我的网站上的留言本好像没有被机器人搞哦。呵呵。可能那个验证码还不错吧。。很难被机器识别。。。</p>',NULL,723,'0103','随笔',NULL,0),(955,'2009-11-18 21:35:43','给博客加上了验证码的功能','最近好像发现本博客被人盯上了。。留言本里全是一些垃圾信息。呵呵 。。。<div>以前的时候留言都不需要验证码的。大概是写了个什么机器人的自动留言的吧。。嘿嘿。。。刚刚给留言功能和评论功能加上了验证码的功能了。。验证码是从某网友中弄的。。</div><div>呵呵。。虽然感觉好像也许这个验证码不是很好。。不过应该对一般的机器人留言起点作用吧。。嘿嘿。。</div><div>博客源码也全部都跟着更新了。。。</div><div>有需要的朋友可直接点击页面最下方的<span style=\"color:#f10b00;\">源码下载</span>链接进行下载。</div><div>下一个功能。打算是制作博客RSS了。。</div>',NULL,785,'0103','随笔',NULL,0),(954,'2009-11-17 11:14:04','PHP验证码','效果如图：<br /><img src=\"http://niunan.net/bbspic/phpvd.jpg\" alt=\"\" border=\"0\" /><br />生成验证码的PHP文件源码：<br /><pre name=\"code\" class=\"php\">\n&lt;?php \nsession_start(); \nfunction random($len) \n{ \n$srcstr=\"ABCDEFGHJKLMNPQRSTUVWXYZ23456789\";&nbsp;&nbsp; // 把i和1，o和0去掉，以免发生混淆\nmt_srand();//配置乱数种子 \n$strs=\"\"; \nfor($i=0;$i &lt;$len;$i++){ \n$strs.=$srcstrmt_rand(0,35); \n} \n/* \n&nbsp; 2&nbsp;&nbsp;&nbsp; 名&nbsp; 称：strtoupper \n&nbsp; 3&nbsp;&nbsp;&nbsp; 功&nbsp; 能：字串全转为大写\\r \n&nbsp; 4&nbsp;&nbsp;&nbsp; 传回值：字串 \n&nbsp; 5&nbsp;&nbsp;&nbsp; 语&nbsp; 法：strtoupper(string str); \n&nbsp; 6&nbsp;&nbsp;&nbsp; 说&nbsp; 明：本函式将字串 str 全部变大写字串。\\r \n&nbsp; 7&nbsp;&nbsp;&nbsp; 范&nbsp; 例： \n&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strtoupper(\"ab2cd4efg\");&nbsp;&nbsp;&nbsp; 结果为AB2CD4EFG \n&nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strtoupper(\"ab1cde4fg\");&nbsp;&nbsp;&nbsp; 结果为Ab1CDE4fg \n&nbsp; 10&nbsp;&nbsp;&nbsp; \n&nbsp; 11&nbsp; */ \nreturn strtoupper($strs); \n} \n$str=random(5); //随机生成的字符串 \n$width = 60; //验证码图片的宽度 \n$height = 25; //验证码图片的高度 \n$_SESSION\"code\" = $str;&nbsp; // 存入session\n\n@header(\"Content-Type:image/png\"); \n\n$im=imagecreate($width,$height); \n//背景色 \n$back=imagecolorallocate($im,0xFF,0xFF,0xFF); \n//模糊点颜色 \n$pix=imagecolorallocate($im,187,230,247); \n//字体色 \n$font=imagecolorallocate($im,41,163,238); \n//绘模糊作用的点 \nmt_srand(); \nfor($i=0;$i &lt;1000;$i++) \n{ \nimagesetpixel($im,mt_rand(0,$width),mt_rand(0,$height),$pix); \n} \nimagestring($im, 5, 7, 5,$str, $font); \nimagerectangle($im,0,0,$width-1,$height-1,$font); \nimagepng($im); \nimagedestroy($im); \n?&gt;\n</pre><br />测试文件源码：<br /><pre name=\"code\" class=\"php\">\n&lt;?php session_start();&nbsp;&nbsp;&nbsp; &nbsp;?&gt;\n&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"&gt;\n&lt;HTML&gt;\n&nbsp;&lt;HEAD&gt;\n&nbsp; &lt;TITLE&gt;PHP验证码测试&lt;/TITLE&gt;\n&nbsp; &lt;META NAME=\"Generator\" CONTENT=\"EditPlus\"&gt;\n&nbsp; &lt;META NAME=\"Author\" CONTENT=\"牛腩\"&gt;\n&nbsp; &lt;META NAME=\"Keywords\" CONTENT=\"\"&gt;\n&nbsp; &lt;META NAME=\"Description\" CONTENT=\"\"&gt;\n&nbsp;&lt;/HEAD&gt;\n\n&nbsp;&lt;BODY&gt;\n&nbsp; &lt;form action=\"?\" method=\"post\"&gt;\n&nbsp; 请输入验证码：&lt;input type=\"text\" name=\"txtCode\" /&gt;\n&nbsp; &lt;img src=\"vdimgck.php\" /&gt;\n&nbsp; &lt;input name=\"submit\" type=\"submit\" value=\"提交\" /&gt;\n&nbsp; &lt;/form&gt;\n&nbsp; &lt;?php\n&nbsp;&nbsp;&nbsp; &nbsp; if($_POST\"submit\")\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; \n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $input = $_POST\"txtCode\";\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $right_code = $_SESSION\"code\";\n\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo &#039;您输入的是：&#039;.$input.&#039;&lt;br /&gt;正确的验证码是：&#039;.$right_code;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; \n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }\n&nbsp; ?&gt;\n&nbsp;&lt;/BODY&gt;\n&lt;/HTML&gt;\n</pre><br />源码下载：<a target=\"_blank\" href=\"http://niunan.net/download/phpvd.7z\">http://niunan.net/download/phpvd.7z</a><br /><br /><span style=\"color:#f10b00;\">注：代码是别人给我的。。。我只是看了下觉得 不错，测试也成功，不过在测试的时候发现有时候生成的验证码只有3位或者4位，并没有达到预先设置的5位，我也不清楚是怎么回事！！！</span><br />	  	  \n	  ',NULL,2191,'0102','PHP',NULL,0),(953,'2009-11-15 15:57:37','锋利的jQuery实例－图片滚动','	  效果看图：<br /><img style=\"width:499px;height:189px;\" src=\"http://niunan.net/bbspic/jquery/02.jpg\" alt=\"\" border=\"0\" /><br />点击按钮后的动画思路倒很容易弄懂，主要就是开始的时候CSS的设置，如果想到程序动态生成的话，那必须得先图片列表的长度。。。<br />这里只列出JS的代码：<br /><pre name=\"code\" class=\"js\">\n$(function() {\n&nbsp;&nbsp;&nbsp; var page = 1;&nbsp; // 初始为第一版\n&nbsp;&nbsp;&nbsp; var i = 4;&nbsp; // 每版显示4个li\n&nbsp;&nbsp;&nbsp; // 下一版\n&nbsp;&nbsp;&nbsp; $(\"span.next\").click(function() {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $parent = $(this).parents(\"div.v_show\"); // 根据当前单击的元素获取父元素\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $v_show = $parent.find(\"div.v_content_list\"); // 根据父元素获取展示区\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $v_content = $parent.find(\"div.v_content\"); // 根据父元素获取展示区外围的DIV\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var v_width = $v_content.width(); // 外围DIV的宽度，即有overflow:hidden的那个DIV\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var len = $v_show.find(\"li\").length; // 总的图片数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var page_count = Math.ceil(len / i); // 获取总版数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!$v_show.is(\":animated\")) {&nbsp; // 如果正处于动画中的则不进行动画\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (page == page_count) {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 最后一版，动画跳回第一版\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $v_show.animate({ left: \"0px\" }, 1000);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page = 1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 跳到下一版\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $v_show.animate({ left: \"-=\" + v_width }, 1000);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page++;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 更改版数的样式,高亮当前版数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\".highlight_tip\").find(\"span\").eq(page - 1).addClass(\"current\").siblings().removeClass(\"current\");\n&nbsp;&nbsp;&nbsp; });\n&nbsp;&nbsp;&nbsp; // 上一版\n&nbsp;&nbsp;&nbsp; $(\"span.prev\").click(function() {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $parent = $(this).parents(\"div.v_show\"); // 根据当前单击的元素获取父元素\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $v_show = $parent.find(\"div.v_content_list\"); // 根据父元素获取展示区\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var $v_content = $parent.find(\"div.v_content\"); // 根据父元素获取展示区外围的DIV\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var v_width = $v_content.width(); // 外围DIV的宽度，即有overflow:hidden的那个DIV\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var len = $v_show.find(\"li\").length; // 总的图片数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var page_count = Math.ceil(len / i); // 获取总版数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!$v_show.is(\":animated\")) {&nbsp; // 如果正处于动画中的则不进行动画\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (page == 1) {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 第一个版面，动画跳到最后一版\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $v_show.animate({ left: \"-=\" + v_width * (page_count - 1) }, 1000);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page = page_count;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 跳到下一版\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $v_show.animate({ left: \"+=\" + v_width }, 1000);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page--;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 更改版数的样式,高亮当前版数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(\".highlight_tip\").find(\"span\").eq(page - 1).addClass(\"current\").siblings().removeClass(\"current\");\n&nbsp;&nbsp;&nbsp; });\n});\n</pre><br /><br />源码下载（同时包含我自己制作的示例和书中的示例）：<br /><a target=\"_blank\" href=\"http://niunan.net/download/jquery_scroll.7z\">http://niunan.net/download/jquery_scroll.7z</a><br />	  	  \n	  	  \n	  ',NULL,1149,'0110','jQuery',NULL,0),(952,'2009-11-14 12:36:08','linq使用 － 数组中一次选择两个输出！','经常一些网站的产品分类是二级的，布局通常如下：<br /><img src=\"http://niunan.net/bbspic/zzvodca.jpg\" alt=\"\" border=\"0\" /><br />从上看出，每取出两个分类了就换一次行，在这里我们可以使用linq的skip和take方法来实现上面的效果，下面是示例代码：<br /><pre name=\"code\" class=\"c#\">\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected void Page_Load(object sender, EventArgs e)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!IsPostBack)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string ss = { \"a\", \"b\", \"c\", \"d\", \"e\" };\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int size = 2;&nbsp; // 每次取出的元素个数\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int num = ss.Length % size == 0 ? ss.Length / size : ss.Length / size + 1; // 要循环的次数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; num; i++)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var query = ss.Skip(i * size).Take(2);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Print(query);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void Print(IEnumerable&lt;string&gt; query)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(string.Join(\" | \", query.ToArray()) + \"&lt;br&gt;\");\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n</pre><br />	  	  \n	  ',NULL,809,'0101','ASP.NET',NULL,0),(951,'2009-11-13 12:04:41','使用top语句的分页存储过程','<p>sql<br />\n</p>\n<p>/****** Object:&nbsp; StoredProcedure dbo.proc_SplitPage&nbsp;&nbsp;&nbsp; Script Date: 05/13/2011 14:17:06 ******/<br />\nSET ANSI_NULLS ON<br />\n;</p>\n<p>SET QUOTED_IDENTIFIER ON<br />\n;</p>\n<p>CREATE PROCEDURE dbo.proc_SplitPage<br />\n&nbsp;<br />\n&nbsp;@tblName varchar(255),&nbsp;&nbsp; -- 表名 <br />\n&nbsp;@strFields varchar(255),&nbsp;&nbsp; -- 显示字段名 <br />\n&nbsp;@strOrder varchar(255),&nbsp; -- 排序字段名 <br />\n&nbsp;@strOrderType varchar(50),&nbsp;&nbsp; -- 设置排序类型, asc || desc<br />\n&nbsp;@PageSize int = 10,&nbsp;&nbsp; -- 页尺寸 <br />\n&nbsp;@PageIndex int = 1,&nbsp;&nbsp; -- 页码 <br />\n&nbsp;@strWhere varchar(1000) = &#039;&#039;&nbsp; -- 查询条件 (注意: 不要加 where) <br />\nAS </p>\n<p>&nbsp;declare @strSQL varchar(6000)&nbsp; -- 主语句 <br />\n&nbsp;declare @strTmp varchar(100)&nbsp;&nbsp; -- 临时变量 <br />\n&nbsp;declare @strOrderTemp varchar(400)&nbsp; -- 排序类型 </p>\n<p>if @strOrderType = &#039;desc&#039; <br />\n&nbsp;begin <br />\n&nbsp; set @strTmp = &#039;&lt;(select min&#039; <br />\n&nbsp; set @strOrderTemp = &#039; order by &#039; + @strOrder +&#039; desc&#039; <br />\n&nbsp;end <br />\nelse <br />\n&nbsp;begin <br />\n&nbsp; set @strTmp = &#039;&gt;(select max&#039; <br />\n&nbsp; set @strOrderTemp = &#039; order by &#039; + @strOrder +&#039; asc&#039; <br />\n&nbsp;end </p>\n<p>set @strSQL = &#039;select top &#039; + str(@PageSize) + &#039; &#039; + @strFields + &#039; from &#039; <br />\n&nbsp;+ @tblName + &#039; where &#039; + @strOrder + &#039;&#039; + @strTmp + &#039;(&#039; <br />\n&nbsp;+ @strOrder + &#039;) from (select top &#039; + str((@PageIndex-1)*@PageSize) + &#039; &#039; <br />\n&nbsp;+ @strOrder + &#039; from &#039; + @tblName + &#039;&#039; + @strOrderTemp + &#039;) as tblTmp)&#039; <br />\n&nbsp;+ @strOrderTemp </p>\n<p>if @strWhere != &#039;&#039; <br />\n&nbsp;set @strSQL = &#039;select top &#039; + str(@PageSize) + &#039; &#039; + @strFields + &#039; from &#039; <br />\n&nbsp;+ @tblName + &#039; where &#039; + @strOrder + &#039;&#039; + @strTmp + &#039;(&#039; <br />\n&nbsp;+ @strOrder + &#039;) from (select top &#039; + str((@PageIndex-1)*@PageSize) + &#039; &#039; <br />\n&nbsp;+ @strOrder + &#039; from &#039; + @tblName + &#039; where &#039; + @strWhere + &#039; &#039; <br />\n&nbsp;+ @strOrderTemp + &#039;) as tblTmp) and &#039; + @strWhere + &#039; &#039; + @strOrderTemp </p>\n<p>if @PageIndex = 1 <br />\n&nbsp;begin <br />\n&nbsp; set @strTmp = &#039;&#039; <br />\n&nbsp; if @strWhere != &#039;&#039; <br />\n&nbsp; set @strTmp = &#039; where &#039; + @strWhere </p>\n<p>&nbsp; set @strSQL = &#039;select top &#039; + str(@PageSize) + &#039; &#039; + @strFields + &#039; from &#039; <br />\n&nbsp; + @tblName + &#039;&#039; + @strTmp + &#039; &#039; + @strOrderTemp <br />\n&nbsp;end </p>\n<p>exec (@strSQL) <br />\n;</p>\n<p><br />\n<br />\n/sql<br />\n<br />\n因为是采用了top语句来分页的，所以适用于mssql200,msql2005,mssql2008，<br />\n当然，MYSQL好像不支持top语句，所以不管用，但是MYSQL之类的分页就更简单了，直接limit就搞掂了，嘿嘿~~~<br />\n</p>\n',NULL,1112,'0106','SQL',NULL,0),(950,'2009-11-10 14:08:49','很好看的后台管理界面','无意中找到的。。从CSDN上下载的，。。个人感觉很好看也很专业的后台管理界面，包括了PSD文件和HTML代码，经检测chrome,ff,ie8下显示正常，不过好像脚本提示有点错误，我也没仔细看，呵呵。。等自己需要用到时再看。。<br />\n后台管理图片如下：<br />\n<img src=\"http://niunan.net/bbspic/admin_ui/login.jpg\" alt=\"\" border=\"0\" width=\"500\" /><br />\n<img src=\"http://niunan.net/bbspic/admin_ui/main.jpg\" alt=\"\" border=\"0\" width=\"500\" /><br />\n<br />\n下载地址：<a target=\"_blank\" href=\"http://niunan.net/download/admin_ui.rar\">http://niunan.net/download/admin_ui.rar<br />\n</a><br />\n下面这个界面是一个网友传过来给我的，我看了一下，table布局的，在IE8中显示是正常的，其他非IE浏览器不太正常，不过里面有个JS写的树，蛮好的，在所有浏览器都能够使用，有空我研究下那JS树，呵呵。<img src=\"http://blog.niunan.net/upload/20110211131521.png\" alt=\"\" border=\"0\" width=\"500\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20110211131619.png\" alt=\"\" border=\"0\" width=\"500\" /><br />\n下载地址：<a href=\"http://niunan.net/download/admin_ui_jstree.zip\" target=\"_blank\">http://niunan.net/download/admin_ui_jstree.zip</a><br />\n<br />\n下面这个界面是我自己从shopex的后台那里扣出来的，呵呵，我自己最满意的一个后台界面，现在放出来给大家，呵呵。<br />\n<img src=\"http://blog.niunan.net/upload/20110211131750.png\" alt=\"\" border=\"0\" width=\"500\" /><br />\n<br />\n<img src=\"http://blog.niunan.net/upload/20110211131814.png\" alt=\"\" border=\"0\" width=\"500\" /><br />\n<br />\n下载地址：<a href=\"http://niunan.net/download/admin_ui_shopex.zip\" target=\"_blank\">http://niunan.net/download/admin_ui_shopex.zip</a>	  	  	  	                          	                          	                          ',NULL,7512,'0104','下载',NULL,0),(949,'2009-11-08 20:58:53','牛腩记事本','牛腩记事本（NiunanNotepad）设计说明书<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; －－－－2009年11月5日12时4分<br /><br />设计原因：<br />&nbsp;&nbsp;&nbsp; 原先用的“Collector资料收集管理器”昨天使用的时候发现一个错误，进任务管理器中关掉再打开软件，接着再打开数据库，结果发现原先数据库中已经有好多文章的，但是现在数据库中就只有一篇文章，晕，看了一下数据库的大小，1.68M，只有一篇文章的话数据库不会这么大的，估计应该是有什么问题导致其他文章显示不出来的，于是到该软件的那个QQ空间里问，正好当时又下班了，问完之后就直接关电脑走人了，晚上回家里收到回复，说是用“查找索引”功能或许能够找出来，今天来到公司，首先就是打开软件打开数据库，还是只有一篇文章，使用了查找索引功能后，结果还是只有一篇文章，无意中看到整个数据库的大小，1.8KB，晕，昨天看还是1.68M的，这样看来，可能我的那些数据是真的完蛋了，郁闷，里面可是保存了好多我的密码，电话，A网地址等有用的信息啊。。。于是自己打算用.NET作个小软件，只记录自己有用的日常信息，功能类似于QQ邮箱的记事本，虽说可以记在记事本上，但是有些东西最好还是保存在自己电脑不要放在网络上的好，正好最近看到sqlite这个数据库，自己测试过，跟access一样，放到access空间上也是能够用程序读取的，而且还是开源的，有linux版，嘿嘿，于是就打算用sqlite数据库做为数据源设计一个牛腩记事本的软件，并给他起了个英文名，曰：NiunanNotepad<br /><br />程序功能：<br />&nbsp;&nbsp;&nbsp; 分类(增删改)，记事(增删改)，每个记事有且只有一个分类，也可以没有分类，记事结构有标题和内容，都不可为空<br /><br />界面描述：<br />&nbsp;&nbsp;&nbsp; 左右两个界面，左边树型结构，右边是记事内容，左边树型结构显示分类和分类下的记事的标题<br /><br />开发环境：<br />&nbsp;&nbsp;&nbsp; Visual Stadio 2008 + sqlite(建立数据库采用firefox的sqlite manager插件,sqlite版本：3.6.16)<br /><br />数据库设计：<br />&nbsp;&nbsp;&nbsp; 数据库名称：NiunanNotepad.sqlite<br />&nbsp;&nbsp;&nbsp; 数据表：nn_cate;ry(分类表), nn_note(记事表)<br />&nbsp;&nbsp;&nbsp; 表结构：nn_cate;ry(分类表)：id(主键，自增),caname(分类名称),pid(父id,一级分类则为0),createdate(创建时间)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nn_note(记事表)：id(主键，自增),caid(分类id),title(记事标题),content(记事内容),createdate(创建时间)\n<br />\n<img src=\"http://niunan.net/bbspic/niunannotepad/01.jpg\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/bbspic/niunannotepad/02.jpg\" alt=\"\" border=\"0\" width=\"500\" /><br />	  \n<img src=\"http://niunan.net/bbspic/niunannotepad/03.jpg\" alt=\"\" border=\"0\" width=\"500\" /><br />	\n<img src=\"http://niunan.net/bbspic/niunannotepad/04.jpg\" alt=\"\" border=\"0\" width=\"500\" /><br />	\n<img src=\"http://niunan.net/bbspic/niunannotepad/05.jpg\" alt=\"\" border=\"0\" /><br />\n安装文件下载地址：<a target=\"_blank\" href=\"http://niunan.net/download/niunannotepad_setup.7z\">http://niunan.net/download/niunannotepad_setup.7z</a><br />\n源文件下载地址：<a target=\"_blank\" href=\"http://niunan.net/download/niunannotepad_src.7z\">http://niunan.net/download/niunannotepad_src.7z</a><br />			  \n	  ',NULL,867,'0101','ASP.NET',NULL,0),(948,'2009-11-07 10:28:54','SD卡家族纵览(SD miniSD microSD SDIO)','<span style=\"color:#333333;font-family:arial;font-size:14px;\"><p style=\"text-indent:24pt;text-align:justify;\">SD卡（Secure Digital Memory Card）是一种基于半导体闪存工艺的存储卡, 1999年，由日本松下、东芝及美国SanDisk公司共同研制完成。2000年，这几家公司发起成立了SD协会（Secure Digital Association简称SDA），阵容强大，吸引了大量厂商参加。其中包括IBM，Microsoft，Motorola，NEC、Samsung等。在这些领导厂商的推动下，SD卡已成为目前消费数码设备中应用最广泛的一种存储卡。</p><p style=\"text-indent:24pt;text-align:justify;\">SD卡最初是从MMC（Multimedia Card）卡基础上发展起来的，可以与MMC卡实现兼容；但SD卡数据传输速率更快，此外，还特别增加了CPRM(Content protection for Recordable Media)功能，用于卡内数据的授权访问，实现内容保护。</p><p style=\"text-indent:24pt;text-align:justify;\">SD卡尺寸为32mm x 24mm x 2.1mm，相当于邮票大小，这样尺寸的存储卡用在数码相机、DV机中还算合适，但在记录不断被刷新的轻薄手机面前，SD卡显得过分“庞大”。为了满足数码产品不断缩小存储卡体积的要求，SD卡逐渐演变出了Mini SD，Micro SD两种规格。</p><p style=\"text-indent:24pt;text-align:justify;\">SD卡背面共有9个引脚，包含4根数据线，支持1bit/4bit两种数据传输宽度，</p><p style=\"text-indent:24pt;text-align:justify;\">时钟最高频率为25MHZ，故理论最高数据传输速率为12.5MB/S</p><p style=\"text-indent:24pt;text-align:justify;\">工作电压2.7~3.6V</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015271187574.jpg\" /></p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;<strong>Mini</strong><strong>&nbsp;SD</strong><strong></strong></p><p style=\"text-indent:24pt;text-align:justify;\">顾名思义，Mini SD卡相比标准SD卡，外形上更加小巧，仅有标准SD卡40％左右的大小。尽管Mini SD卡的外形大小及接口形状与原来的SD卡有所不同，但接口规范保持不变，确保了兼容性。若将Mini SD插入特定的转接卡中，可当作标准SD卡来使用。</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015273523265.jpg\" /></p><p style=\"text-indent:24.1pt;text-align:justify;\"><strong>TransFlash</strong><strong>（</strong><strong>Micro SD</strong><strong>）</strong><strong></strong></p><p style=\"text-indent:24pt;text-align:justify;\">Transflash卡，也称T-Flash卡， TF或T卡，最早由SanDisk推出。T卡仅有11mm x 15mm x 1mm 大小，仅相当于标准SD卡的1/4，比Mini SD卡还要小巧。</p><p style=\"text-indent:24pt;text-align:justify;\">同样，T卡是与标准SD卡功能也是兼容的，将T卡插入特定的转接卡中，可以当作标准SD卡或Mini SD卡来使用。</p><p style=\"text-indent:24pt;text-align:justify;\">2005年7月，SDA协会正式发布了Micro SD标准，该标准与TransFlash卡完全兼容，市场上的TransFlash卡和Micro SD卡可以不加区分的使用。这好比TransFlash是卡的小名，等长大了就取了个Micro SD的学名，不过大家还是叫其TransFlash的多！</p><p style=\"text-indent:24pt;text-align:justify;\">Mini SD、Micro SD这种小体积SD卡的出现，大大拓展了SD卡的应用范围，这使得SD卡应用在一些小型手机中成为可能。另一方面，Mini SD、Micro SD功能与SD卡功能兼容，只要将其插入特定转接卡中，即可当作标准SD卡来使用，这样，Mini SD、Micro SD便可用于那些使用标准SD卡的数码设备，这加速了Mini SD、Micro SD的市场普及。</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015275993561.jpg\" /></p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015282923919.jpg\" />&nbsp;&nbsp;</p><p style=\"text-indent:24pt;text-align:justify;\">miniSD相对于标准SD，增加了2个NC引脚</p><p style=\"text-indent:24pt;text-align:justify;\">microSD相对于标准SD，减少了1个VSS引脚<br /></p><p style=\"text-indent:24.1pt;text-align:justify;\"><strong>SDHC</strong></p><p style=\"text-indent:24pt;text-align:justify;\">目前市场上的SD、Mini SD、Micro SD卡遵循的是SD Spec Ver1.0或1.1规范，最大可能容量仅为2GB。2006年，SDA协会发布了SD Spec Ver2.0规范，符合此新规范的SD卡容量可达4GB或更高。</p><p style=\"text-indent:24pt;text-align:justify;\">符合2.0规范的SD卡，称为SDHC（SD high capacity）卡。SDHC卡外形维持与SD卡一致，但是文件系统从FAT12、FAT16改为FAT32型；SDHC卡的最大容量可达32GB。除了SDHC卡外, 还有Mini SDHC，Micro SDHC类型的卡。</p><p style=\"text-indent:24pt;text-align:justify;\">SDHC卡与标准SD卡不再兼容，必须符合SD Spec Ver2.0的设备才能支持SDHC卡，这样的设备都会带有SDHC lo;。而支持SDHC卡的设备可以向下兼容标准SD卡。</p><p style=\"text-indent:24pt;text-align:justify;\">为了充分发挥SDHC卡的性能，保证兼容性，SDA协会为SDHC卡定义了3个速度等级：2，4，6；其含义是各等级分别可以忍受的写速率至少是2MB/S，4MB/S，6MB/S.速度等级定义中使用的是数据写速率，数据读速率要比数据写速率快。</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015305746728.jpg\" /></p><p style=\"text-indent:24pt;text-align:justify;\">容量大于2GB的SDHC卡必须带有SDHC 符号和速度等级标记符号</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015312037318.jpg\" /></p><p style=\"text-indent:24.1pt;text-align:justify;\"><strong>SDIO</strong></p><p style=\"text-indent:24pt;text-align:justify;\">SDIO (Input/Output)是一种IO接口规范。目前，其最主要用途是为带有SD卡槽的设备进行外设功能扩展。SDIO卡是一种IO外设，而不是Memory。SDIO卡外形与SD卡一致，可直接插入SD卡槽中。</p><p style=\"text-indent:24pt;text-align:justify;\">目前市场上有多种SDIO接口的外设，比如SDIO蓝牙，SDIO GPS，SDIO无线网卡，SDIO移动电视卡等。这些卡底部带有和SD卡外形一致的插头，可直接插入SDIO卡槽（即为SD卡槽）的智能手机、PDA中，即可为这些手机、PDA带来丰富的扩展功能。用户可根据实际需要，灵活选择外设扩展的种类、品牌和性能等级。SDIO已为成为数码产品外设功能扩展的标准接口。</p><p style=\"text-indent:24pt;text-align:justify;\">SDIO卡插入带有标准SD卡槽的设备后，如果该设备不支持SDIO，SDIO卡不会对SD卡的命令作出响应，处于非激活状态，不影响设备的正常工作；如果该设备支持SDIO卡，则按照规范的要求激活SDIO卡。</p><p style=\"text-indent:24pt;text-align:justify;\">SDIO卡允许设备按IO的方式直接对寄存器进行访问，无须执行FAT文件结构或数据sector等复杂操作。此外，SDIO卡还能向设备发出中断，这是与SD memory卡的本质区别。</p><p style=\"text-indent:24pt;text-align:justify;\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://www.rd3721.com/UpLoadFiles/Tech/2007-12/2007122015314377775.jpg\" /></p></span>	  	  \n	  ',NULL,850,'0103','随笔',NULL,0),(947,'2009-11-05 10:17:48','《JavaScript征途》读后感','<span style=\"font-family:&#039;lucida grande&#039;, verdana;font-size:14px;\"><div>&nbsp;&nbsp; &nbsp;在写读后感之前，先自我介绍一下，本人，男，24岁，未婚，资浅.NET程序员，在读此书之前已经能够熟练的利用JavaScript进行表单的一般验证（通过document.getElementById获取出文本框的值后再进行if...else...判断）。</div><div>&nbsp;&nbsp; &nbsp;刚刚拿到此书，心情好一番激动，沃~~~新华字典，长约26CM，宽约18CM，高约3.5CM，封面有凹凸感，纸质很好.</div><div>&nbsp;&nbsp; &nbsp;仔细看了目录，共21章，本人对JavaScript也不是掌握得很好，也不知道是不是已经把JavaScript的所有内容包括在里面了，不过应该内容是蛮丰富的。</div><div>&nbsp;&nbsp; &nbsp;看了一个星期，每天晚上看3小时左右，才看了此本的一半，总得来说书还是写得不错的，虽然有些地方难免会千篇一律，比如说在讲JavaScript对象的时候，先是一个表格，左边是属性或者方法的名称，右边是解释...</div><div>&nbsp;&nbsp; &nbsp;个人认为本书最大的特点就是他众多的示例代码，每一个知识点附了一大段解释性的文字之外，都会有一个以上的代码示例来说明，个人认为那些示例代码还是很好懂的，基本上我看书对那些文字都一略而过，而重点是看书中的示例代码，当你代码看懂是怎么回事了这个知识点你也就明白了。</div><div>&nbsp;&nbsp; &nbsp;尾声，本书还没看完，不过总得来说个人感觉还是不错的，至少对本人来说，不知道是因为看了此书的效果还是因为写JS代码写多了的积累，几天前去看kindeditor在线编辑器的源码竟然依稀有点看懂了，嘿嘿，估计仔细看完整本书，再去看jquery的源码应该能看得懂了。。。</div></span>	  	  \n	  ',NULL,838,'0103','随笔',NULL,0),(946,'2009-11-04 17:05:50','博客又改进了一下！','	  	  &nbsp; 之前给kindeditor在线编辑器加上的引用和代码段的功能只是单纯的编辑器中加上quote或者代码标签，但是如果是先选择了编辑器中的内容后再加上引用或者代码段，那样子会把原先的内容覆盖掉的，今幸得一位群里的朋友提供的给编辑器中选中的文本前后加文本的代码，现在再试的话，添加引用也只会在选中的文字的前台加上那个标签了。。嘿嘿。。。<br />&nbsp; 核心代码如下：<br /><pre name=\"code\" class=\"js\">\nKE.util.createBlock=function(id,startText,endText)\n{\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var doc = KE.gid.iframeDoc;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; KE.util.selection(id);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (doc.selection) {\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var r = doc.selection.createRange();\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var c = startText + r.htmlText + endText;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; r.pasteHTML(c);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //r.text = startText + r.htmlText + endText;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var range =&nbsp; KE.gid.range;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var f = range.extractContents();\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; range = KE.gid.range;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; range.collapse(true);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var sNode = doc.createTextNode(startText);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var eNode = doc.createTextNode(endText);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var fs = f.childNodes0;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; f.insertBefore(sNode, fs);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; f.appendChild(eNode);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; range.insertNode(f);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; range.collapse(false);\n}\n</pre><br />&nbsp; 下面是我添加引用的代码：<br /><pre name=\"code\" class=\"js\">\nKE.lang&#039;quote&#039; = \"添加引用\";\nKE.plugin&#039;quote&#039; = {\n&nbsp;&nbsp;&nbsp; click : function(id) {\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /*KE.util.select(id);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var value = \"<div class=\"quote_title\">引用</div><div class=\"quote_div\">/quote\";\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KE.util.insertHtml(id, value);原来的做法*/\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; KE.util.createBlock(id,\"quote\",\"<span class=\"quoteend\"></span></div>\");\n&nbsp;&nbsp;&nbsp; }\n};\n</pre><br />&nbsp; 另还改了工具类中的一个方法，主要是把代码段转为相应的pre标签的那个方法，如下：<br /><pre name=\"code\" class=\"php\">\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // 把....../...格式的代码段转成对应的pre\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; function Code2Pre($content)\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $reg = &#039;%\\((c)|(c#)|(c\\+\\+)|(html)|(java)|(js)|(php)|(python)|(ruby)|(sql)|(xml))\\(.+?)\\/\\1\\%s&#039;;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; preg_match_all ($reg, $content, $regs, PREG_SET_ORDER );\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; foreach($regs as $v)\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $tmp =&nbsp;&nbsp; sprintf(&#039;&#039;,$v1);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $s = str_replace( \"\n\",\"\\r\\n\",$v13);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $s = str_replace( \"\",\"\\r\\n\",$s);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $s = str_replace( \"\n\",\"\\r\\n\",$s);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $s = str_replace( \"\",\"\",$s);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $s = str_replace( \"\",\"\",$s);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $tmp .= $s;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $tmp .= &#039;\n\n&#039;;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $content = str_replace($v0,$tmp,$content);\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return $content;\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }\n</pre><br />&nbsp;&nbsp;&nbsp; 博客源码也同步更新！！！<br />	  \n	  ',NULL,667,'0103','随笔',NULL,0),(945,'2009-11-04 15:13:44','博客新增AJAX更改文章分类的功能','&nbsp;&nbsp; 从JAVAEYE那边导过来的文章没有分类，如果一篇一篇点击文章编辑进去改分类的话太麻烦，于是做了个小功能，直接在文章列表上更改分类，一个简单的AJAX应用！！！<br /><br />\n<img src=\"http://niunan.net/bbspic/niublog/01.jpg\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/bbspic/niublog/02.jpg\" alt=\"\" border=\"0\" /><br />\n<img src=\"http://niunan.net/bbspic/niublog/03.jpg\" alt=\"\" border=\"0\" /><br />\n&nbsp; <br />&nbsp;博客源码也已同步更新，可点击页面最下方的“<span style=\"color:#f10b00;\">源码下载</span>”即可',NULL,722,'0103','随笔',NULL,0),(944,'2009-11-03 13:27:47','IIS多站点部署','&nbsp;&nbsp; &nbsp;老大又开始叫美工做新页面了，看着好像是新的一个网站，说是在我们的服务器上再开另一个网站，然后挑个域名指向他，原先我们的IIS服务器上只挂有我们公司一个网站的，怎么再开个网站同IP不同域名的我也没搞过，上网搜索了一下，得如下方法：<div><br /><div>&nbsp;&nbsp; &nbsp;环境：假设深圳市某某公司用一台win2000服务器提供虚拟主机服务，地址是192.168.1.10。在这台&nbsp;</div><div>服务器已经安装了Internet服务即IIS 5。&nbsp;</div><div>现在公司要求网络管理员在服务器上使用一个IP为ABCD四个公司建立独立的网站，每个网站拥有自己独&nbsp;</div><div>立的域名。四家网站域名分别为:www.a.com，http://www.b.com/，http://www.c.com/和http://www.d.com/。</div><div><br /></div><div>通过使用主机头，站点只</div><div>需一个 IP 地址即可维护多个站点。客户可以使用不同的域名访问各自的站点，&nbsp;</div><div>根本感觉不到这些站点在同一主机上。</div><div><br /></div><div>具体操作如下:&nbsp;</div><div>1、在win2000服务器为四家公司建立文件夹，做为WEB站点主目录。如下: WEB站点主目录 WEB站点&nbsp;</div><div>d:\\web\\a A公司网站&nbsp;</div><div>d:\\web\\b B公司网站&nbsp;</div><div>d:\\web\\c C公司网站&nbsp;</div><div>d:\\web\\d D公司网站</div><div><br /></div><div>&nbsp;&nbsp; &nbsp;使用WEB站点管理向导，分别四家公司建立独立的WEB站点，四者最大的不同是使用了不同的主机头名:</div><div><br /></div></div>\n<table width=\"500\" border=\"1\">\n  <tbody><tr>\n    <td><strong>站点名称</strong></td>\n    <td><div align=\"center\">A公司站点</div></td>\n    <td><div align=\"center\">B公司站点</div></td>\n    <td><div align=\"center\">C公司站点</div></td>\n    <td><div align=\"center\">D公司站点 </div></td>\n  </tr>\n  <tr>\n    <td><strong>IP地址</strong></td>\n    <td colspan=\"4\"><div align=\"center\">192.168.1.10</div></td>\n  </tr>\n  <tr>\n    <td><strong>TCP端口</strong></td>\n    <td colspan=\"4\"><div align=\"center\">80</div></td>\n  </tr>\n  <tr>\n    <td><strong>权限</strong></td>\n    <td colspan=\"4\"><div align=\"center\">读取和运行脚本 </div></td>\n  </tr>\n  <tr>\n    <td><strong>主机头值</strong></td>\n    <td><div align=\"center\">www.a.com</div></td>\n    <td><div align=\"center\">www.b.com</div></td>\n    <td><div align=\"center\">www.c.com</div></td>\n    <td><div align=\"center\">www.d.com</div></td>\n  </tr>\n  <tr>\n    <td><strong>站点主目录</strong></td>\n    <td><div align=\"center\">d:\\web\\a</div></td>\n    <td><div align=\"center\">d:\\web\\b</div></td>\n    <td><div align=\"center\">d:\\web\\c</div></td>\n    <td><div align=\"center\">d:\\web\\d</div></td>\n  </tr>\n</tbody></table><br /><div><div>在DNS中将这四个域名注册上，均指向同一地址:192.168.1.10。这样，客户端就可以通过:</div><div><br /></div><div>http://www.a.com/ 访问A公司站点。&nbsp;</div><div>http://www.b.com/ 访问B公司站点。&nbsp;</div><div>http://www.c.com/ 访问C公司站点。&nbsp;</div><div>http://www.d.com/ 访问D公司站点。</div><div><br /></div><div><span style=\"color:#0021b0;\"></span><span style=\"color:#013add;\">在我测试过程中发现个问题，我的服务器是2003的，磁盘为NTFS格式，建立了目录后如果直接在IIS中设置网站，那么浏览打开的时候是会弹出个对话框叫你输入用户名和密码的，原因是还得在服务器上对我们刚刚建立的目录设置访问权限的，在服务器上直接新建目录他是默认只有administrator和system组的权限，我们还得给该目录加上IIS来宾账户的“读取和运行权限”，此外如果要运行ASP.NET的话还得加上NETWORK SERVICE账户的权限，如图：</span></div><div><span style=\"color:#013add;\"><img src=\"http://niunan.net/bbspic/addweb.jpg\" alt=\"\" border=\"0\" /></span></div></div>',NULL,897,'0103','随笔',NULL,0),(943,'2009-11-01 19:27:51','linux真他X的难搞!!!','&nbsp;&nbsp; &nbsp;许久不进WUBI安装的UBUNTU9.04了，正好前几天9.10版出来了，进去升级玩，进去后点击升级，直接在里面下载最新的9.10,直接在线升级，结果把1131个文件下载完了之后死活都跳不到下一步，NND。。。<div>&nbsp;&nbsp; &nbsp;等了一个多小时了还是那样，于是直接点取消升级，然后重启后再次点击升级，呵呵。这回直接跳到那个下载文件的结尾，把第1131个文件下载下来后继续安装，最后终于升级成功了，不过再接下来的自动重启的时候他竟然不重启，直接就定在那个黄色背景那里了。。<div>&nbsp;&nbsp; &nbsp;按了机箱上的重启后进入UBUNTU，成功进入，本以为升级成功了，结果点击联网死活都联不上网络，晕，上不了网，打开设置看看，用户名和密码都没变的，也是用的PPPOE，以前在9.04一下就连接到网络了，可是现在升级到了9.10了死活都连接不上。。。郁闷。。。在设置面板中编辑连接竟然弹出个“编辑器初始化错误”的信息，郁闷。。。</div><div>&nbsp;&nbsp; &nbsp;一气之下回到XP把WUBI安装的UBUNTU删除掉，直接从官网上再次下载9.10的ISO，下载之后在XP中用虚拟光驱加载了后再次WUBI安装，安装成功后，重启再次进到UBUNTU，这时是英文界面的，不过怎么设置联网自己还是知道的，在设置面板输入用户名和密码，先是用PPPOE的，再次连接。。。结果还是死活都连接不上。。更郁闷。。。。不知道怎么回事了。。。</div><div>&nbsp;&nbsp; &nbsp;不搞UBUNTU了。。回到XP下看PPS。。。本来想在UBUNTU上安装PPSlinux版的，结果搞得连个网都上不了。。</div><div>&nbsp;&nbsp; &nbsp;连个基本的联网操作都搞得让人郁闷。。。对ubuntu这个￥%……*￥——*……——（实在是太失望了。。。</div></div>',NULL,945,'0108','linux',NULL,0),(942,'2009-10-31 14:32:41','牛腩学习sqlite － 简记','	      到<a target=\"_blank\" href=\"http://www.sqlite.org\">http://www.sqlite.org</a>网站（发现好多非盈利性的机构都爱用org的，呵呵，看来我的<a target=\"_blank\" href=\"http://www.niunan.org\">http://www.niunan.org</a>还是申请对了，唉，可惜niunan.com被人家拿来了，要不然加上我现在有的niunan.net和niunan.org那就太prefect了！）上下载最新的sqlite，下载下来压缩出来到D盘的sqlitetest目录下，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/01.jpg\" />\n<br />    然后打开CMD命令窗口，切换到D盘的sqlitetest目录下，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/02.jpg\" />\n<br />    新建立一个数据库，在CMD窗口下输入<div class=\"quote_title\">引用</div><div class=\"quote_div\">sqlite3 test<span class=\"quoteend\"></span></div>，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/03.jpg\" />\n<br />    test就是我们的数据库文件名，注意这里没有后缀名，实际你也可以给他一个后缀名的，比如sqlite3 test.db，甚至可以是sqlite3 test.php，执行了这条命令之后，假如在当前的sqlitetest目录下没有建立过test数据库的话则是建立一个空的数据库，数据库名叫test，否则则是打开当前sqlitetest目录下的test数据库，注意，如果是新建立数据库的话那么这时数据库里是空的，这时候在当前的sqlitetest目录下新建立的数据库test并不会显示出来。如图，这是执行了创建命令之后的sqlitetest目录：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/01.jpg\" />\n<br />    这时我们输入<div class=\"quote_title\">引用</div><div class=\"quote_div\">.database<span class=\"quoteend\"></span></div>指令查看当前的数据库信息后，sqlitetest目录下才会生成一个test文件，即我们建立的数据库，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/04.jpg\" /><img src=\"http://niunan.net/bbspic/sqlite/05.jpg\" />\n<br />    这时候就看到sqlitetest目录生成的test文件了\n<br />    接下来就轮到建立表了，在官网上看了一下，其实官网上的英文说明文档也都是些简单的英文的，基本上连词成句都能知道是什么意思了，上面说到sqlite数据库的表的字段的类型其实就5种类型（TEXT、NUMERIC、INTEGER、REAL、NONE），而且好像在建立表的时候写的类型不必写刚刚列出的几种类型的全称的，上面说\n<br />    1、如果你写的类型中含有int字符的那么他就是INTEGER\n<br />    2、如果写的类型中含有\"CHAR\", \"CLOB\", 或者 \"TEXT\" 字符的那么就是TEXT类型\n<br />    3、如果写的类型中含有 \"REAL\", \"FLOA\", 或者 \"DOUB\" 字符的那么就是REAL类型\n<br />    4、其他几句英文不太明白说什么了，呵呵，英文好的朋友可以来这里看，<a target=\"_blank\" href=\"http://www.sqlite.org/datatype3.html%20\">http://www.sqlite.org/datatype3.html\n</a><br />    我们试试看创建一张表看看，在这里我创建的同时也设置主键primary key，不知道这个sqlite创建主键是不是这样子设置的，我们输入创建table的指令：<div class=\"quote_title\">引用</div><div class=\"quote_div\"> create table person(id int primary key,name nvarchar(10),age integer,address text);<span class=\"quoteend\"></span></div> 如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/06.jpg\" />\n<br />    我们可以看到，如果输入的语句出错的话是会直接在当前命令窗口中提示的，输入正确的话就什么都没提示了，而且每条SQL语句后都必须以分号;结尾，这个和MYSQL一样\n<br />    我们可以通过<div class=\"quote_title\">引用</div><div class=\"quote_div\">.table<span class=\"quoteend\"></span></div>指令来查看当前的数据库中所有的表的信息，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/07.jpg\" />\n<br />    那么除了.database和.table这两个sqlite指令外还有哪些指令呢？我们可以通过<div class=\"quote_title\">引用</div><div class=\"quote_div\">.help<span class=\"quoteend\"></span></div>来查看，如图：\n<br />      <img src=\"http://niunan.net/bbspic/sqlite/08.jpg\" />\n<br />    注意，在输入sqlite指令的时候不要又多余来个分号；结尾。。。\n<br />    我们可以看到，又是一大串的E文，其实也都是些简单的E文，连词成句也基本搞掂。。\n<br />    看到有个<div class=\"quote_title\">引用</div><div class=\"quote_div\">.schema<span class=\"quoteend\"></span></div>指令，我们来试试，后面跟的是表的名称，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/09.jpg\" />\n<br />    可以看到，该指令把表的创建语句给我们打出来了。\n<br />    我们来插入一条数据再选择出来试试看，在这里我不插入ID列，看看有没有什么问题。\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/10.jpg\" />\n<br />    我们可以看到，插进去了，但是选出来的前面的ID号是空的，我们再插入一条再选择看看\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/11.jpg\" />\n<br />    晕，也能插进去，也能选择出来，那么就是我前面建立的SQL语句中的primary key不起作用了，后来自己上网搜索了一下，发现其实在建立表的时候设置主键的时候必须得写integer primary key，这样在每插入一条数据库时候那个字段都会自动增长的，相应的起到一个主键的功能，我把整个表删除了再重新建立了一次，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/12.jpg\" />\n<br />    OK,这时我们插入数据的时候可以看到，前面的ID字段自增了，嘿嘿。\n<br />    如果我们有很多条语句要批量插入的话怎么办？我们在sqlitetest目录下建立一个sql_ins.txt文本文档，里面写上我们的插入语句，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/13.jpg\" />\n<br />     然后我们可以使用sqlite中的.read指令来进行读取，如图：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/14.jpg\" />\n<br />    这样我们就成功的导入了我们的数据了。\n<br />    接下来是一个字段连接的问题，这个问题群里的朋友提过，自己试着用MSSQL的方法测试不成功，正常来说应该是如下SQL语句：\n<br /> <div class=\"quote_title\">引用</div><div class=\"quote_div\">select &#039;姓名：&#039;+name+&#039;，年龄：&#039;+age from person;\n<span class=\"quoteend\"></span></div><br />    但是在SQLITE中执行了会选择出错误的数据，最后搜索后发现原来sqlite中的连接字符是||或符号，正确的SQL语句应该是：\n<br /> <div class=\"quote_title\">引用</div><div class=\"quote_div\">select &#039;姓名：&#039;||name||&#039;，年龄：&#039;||age from person;\n<span class=\"quoteend\"></span></div><br />    <img src=\"http://niunan.net/bbspic/sqlite/15.jpg\" />\n<br />    接下来，就是至今为止最激动人心的时刻，就是sqlite的分页，呵呵，和MYSQL一样的，可以直接用limit来进行分页了，就是因为这个，我开始有把我的Access的博客转为sqlite存储数据的冲动了。呵呵。。。\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/16.jpg\" />\n<br />    命令行的操作就到这里，接下来该用图形管理工具了。。试用了下，感觉sqlitespy不错，其实我也就用过sqlitespy，其他的管理工具都没用过。。呵呵。。大家可以到该网站下载最新版：<a target=\"_blank\" href=\"http://www.yunqa.de/delphi/doku.php/products/sqlitespy/index%20\">http://www.yunqa.de/delphi/doku.php/products/sqlitespy/index\n</a><br />    下载下来后解压出来，其实也就两个文件，一个Exe，另一个应该是示例数据库：\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/17.jpg\" />\n<br />    运行那个exe文件，可以看到是英文界面，不过都是简单的英文，都应该能看得懂的，打开我们刚刚在命令行下创建的数据库，注意是打开，别选成上面那个new ....新建数据库了。\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/18.jpg\" />\n<br />    发现双击了exe文件运行以后目录下又会多出一个SQLiteSpy.db3数据库了，应该是他自动生成的吧\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/19.jpg\" />\n<br />    在打开的选择数据库的窗口中看不到我们刚刚建立的test数据库，因为我们没有用到后缀外，软件默认显示的是db3和db后缀名的文件的，我们选择显示所有文件，然后就可以看到了\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/20.jpg\" />\n<br />    选择test数据库后打开person表，问题出来了，竟然是乱码，晕。。可是刚刚我们在CMD命令窗口中明明是可以查询出中文出来的\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/21.jpg\" /><img src=\"http://niunan.net/bbspic/sqlite/16.jpg\" />\n<br />    我们执行一条语句看看，F9是执行语句\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/22.jpg\" /><img src=\"http://niunan.net/bbspic/sqlite/23.jpg\" />\n<br />    然后我们再查看表数据，可以看到，插入的中文竟然可以正常显示出来了\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/24.jpg\" />\n<br />    晕啊。。搞不懂是怎么回事，应该是编码的问题，可是我;OGLE了蛮久都没有找到什么解决方法\n<br />    先不管这些，继续下一步，.NET查询SQLITE，上网找了下，下载System.Data.SQLite.dll，可到这里下载<a target=\"_blank\" href=\"http://sqlite.phxsoftware.com/%20\">http://sqlite.phxsoftware.com/\n</a><br />    用VS建立一个网站，把上面下载的DLL放到BIN目录下，然后写代码，和平时写的MSSQL的代码基本一样的，还真不错。\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/25.jpg\" />\n<br />gv是一个gridview控件，这里只是简单的显示表中数据而已，结果出来的界面不出所料，有乱码，郁闷，但是最后一条记录又不是乱码，那条记录是我在sqlitespy软件中添加的\n<br />    <img src=\"http://niunan.net/bbspic/sqlite/26.jpg\" />\n<br />    至于怎么解决这个乱码的问题，本人;OGLE过多次，也找不到解决的方法，只能留待高人解决！！！\n<br />    认真写篇博客还真累人。。。整整花了一上午。。。<br />因为这个乱码问题，把我从access转到sqlite的决心又降低了不少！！！<br />	  \n	  ',NULL,2960,'0106','SQL',NULL,0),(941,'2009-10-30 16:43:40','重构了一下整个代码','&nbsp;&nbsp; 主要是把一些导入用到$_server&#039;document&#039;的全都去掉了。。现在全都是用相对路径 <br />&nbsp;<br />&nbsp;&nbsp; 相对的。。。源码也更新了。。下载下来进行部署的话必须要放到wamp的www根目录下进行部署，要不然的话路径 会发生错误的。<br /><br />源码下载：<a target=\"_blank\" href=\"http://www.niunan.net/download/blog.7z\">http://www.niunan.net/download/blog.7z</a><br />	  	  \n	  ',NULL,685,'0103','随笔',NULL,0),(940,'2009-10-30 15:03:30','心情不爽。。。。','&nbsp; &nbsp; 心情不爽。。。。退了30多个QQ群。。。	  	  	\n	  ',NULL,702,'0103','随笔',NULL,0),(939,'2009-10-30 09:57:31','昨晚做了个梦。。。','好久没有做梦了。。。昨晚做了个梦。。。梦到手机被偷了。。<div>唉。。怎么不是真的呢。。。要是真被偷了就能换个QWERT键盘的手机了。。呵呵。。。</div><div>现在就差这种类型的手机没有玩过了。。。</div>',NULL,688,'0103','随笔',NULL,0),(938,'2009-10-29 22:54:03','改进了一下对代码段和引用的一些方法','代码如下：<br /><pre name=\"code\" class=\"php\">\n	  // 把引用标签转成对应的div\nfunction Quote2Div($content)\n{\n&nbsp;&nbsp;&nbsp; preg_match_all ( &#039;%&#91;quote&#93;(.+?)&#91;/quote&#93;%s&#039;, $content, $regs, PREG_SET_ORDER );\n&nbsp;&nbsp;&nbsp; foreach($regs as $v)\n&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp = &#039;&lt;div class=\"quote_title\"&gt;引用&lt;/div&gt;&#039;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= sprintf(&#039;&lt;div class=\"quote_div\"&gt;%s&lt;span class=\"quoteend\"&gt;&lt;/span&gt;&lt;/div&gt;&#039;,$v&#91;1&#93;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content = str_replace($v&#91;0&#93;,$tmp,$content);\n&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; return $content;\n}\n\n// 把div转成对应的引用标签\nfunction Div2Quote($content)\n{\n&nbsp;&nbsp;&nbsp;\n$reg = &#039;%&lt;div class=\"quote_title\"&gt;引用&lt;/div&gt;&lt;div\nclass=\"quote_div\"&gt;(.+?)&lt;span\nclass=\"quoteend\"&gt;&lt;/span&gt;&lt;/div&gt;%s&#039;;&nbsp; //\n本人还不会匹配嵌套HTML标签的正则，只好在这里作个标识，表示引用块的结束\n&nbsp;&nbsp;&nbsp; preg_match_all ($reg, $content, $regs, PREG_SET_ORDER );\n&nbsp;&nbsp;&nbsp; foreach($regs as $v)\n&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp = &#039;&#91;quote&#93;&#039;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .=&nbsp;&nbsp; &nbsp;$v&#91;1&#93;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= &#039;&#91;/quote&#93;&#039;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content = str_replace($v&#91;0&#93;,$tmp,$content);\n&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; return $content;\n}\n\n// 把代码段转成对应的pre\nfunction Code2Pre($content)\n{\n&nbsp;&nbsp;&nbsp; $reg = &#039;%&#91;(c|(c#)|(c++)|(html)|(java)|(js)|(php)|(sql)|(xml))&#93;(.+?)&#91;/1&#93;%s&#039;;\n&nbsp;&nbsp;&nbsp; preg_match_all ( $reg, $content, $regs, PREG_SET_ORDER );\n&nbsp;&nbsp;&nbsp; foreach($regs as $v)\n&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp =&nbsp;&nbsp; sprintf(&#039;&lt;pre name=\"code\" class=\"%s\"&gt;&#039;,$v&#91;1&#93;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace( \"&lt;br /&gt;\",\"\r\n\",$v&#91;10&#93;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace( \"&lt;/div&gt;\",\"\r\n\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace( \"&lt;/p&gt;\",\"\r\n\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace( \"&lt;div&gt;\",\"\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace( \"&lt;p&gt;\",\"\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace(\"&#91;\",\"&amp;#91;\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str_replace(\"&#93;\",\"&amp;#93;\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= $s;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= &#039;&lt;/pre&gt;&#039;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content = str_replace($v&#91;0&#93;,$tmp,$content);\n&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; return $content;\n}\n\n// 把pre转成对应的代码段\nfunction Pre2Code($content)\n{\n&nbsp;&nbsp;&nbsp; $reg = &#039;%&lt;pre name=\"code\" class=\"(.+?)\"&gt;(.+?)&lt;/pre&gt;%s&#039;;\n&nbsp;&nbsp;&nbsp; preg_match_all ( $reg, $content, $regs, PREG_SET_ORDER );\n&nbsp;&nbsp;&nbsp; foreach($regs as $v)\n&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp =&nbsp; \"&#91;\".$v&#91;1&#93;.\"&#93;\";&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s&nbsp;&nbsp; = str_replace( \"\r\n\",\"&lt;br /&gt;\",$v&#91;2&#93;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s&nbsp;&nbsp; = str_replace( \"&gt;\",\"&amp;gt;\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s&nbsp;&nbsp; = str_replace( \"&lt;\",\"&amp;lt;\",$s);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= $s;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp .= \"&#91;/\".$v&#91;1&#93;.\"&#93;\";&nbsp;&nbsp; &nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content = str_replace($v&#91;0&#93;,$tmp,$content);\n&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; return $content;\n}\n</pre><br />',NULL,820,'0103','随笔',NULL,0),(937,'2009-10-29 16:41:24','MSSQL中使用SQL语句建立用户并授权','	  昨天花了点时间从网上找到的。。觉得蛮不错的。。。以后做项目再也不用SA了。。。<div><pre name=\"code\" class=\"sql\">\n--首先使用sp_addlogin添加登录\nexec sp_addlogin &#039;用户名&#039;,&#039;密码&#039;,&#039;默认数据库&#039;\n\n\n--然后向该用户授予访问某数据库的权限,其实就是给该数据库添加用户\nuse 数据库名\nexec sp_grantdbaccess &#039;用户名&#039;\n\n\n--最后授予该用户的具体权限，比如可以对某个表进行select操作，这要根据该用户需要的权限来设定\nuse 数据库名\ngrant select\non 表名 &nbsp; -- 该行可以去掉，去掉就是对该数据库下现有的表进行授权\nto 用户名&nbsp;\n\n</pre></div>	  	\n	  ',NULL,920,'0106','SQL',NULL,0),(936,'2009-10-27 16:28:39','SQLITE测试成功！！！庆祝一下。。。','刚刚花了点时间下载sqlite研究了一下，会建库会建表了，又下了.NET的驱动试了下，呵呵。成功查询出来。。。传到空间上也试了也。。呵呵。。也成功了。。。<br />看来支持ACCESS的空间也支持sqlite。。。。<br /><br /><a target=\"_blank\" href=\"http://niunan.org/sqlitetest.aspx\">http://niunan.org/sqlitetest.aspx</a><br />	  	  	\n	  ',NULL,831,'0103','随笔',NULL,0),(935,'2009-10-24 14:46:19','美化CMD窗口','	  	  很久以前在某杂志上看到的小玩意，用于CMD窗口的美化，见下图：<br /><img src=\"http://niunan.net/bbspic/cmd/01.jpg\" alt=\"\" border=\"0\" /><br /><br />下载：<a target=\"_blank\" href=\"http://niunan.net/download/meihuacmd.7z\">http://niunan.net/download/meihuacmd.7z</a><br />	  	  	\n	  	  \n	  	  \n	  ',NULL,1298,'0104','下载',NULL,0),(934,'2009-10-23 14:01:59','给博客的编辑器加上了JAVAEYE的那个引用功能','从JAVAEYE那导过来的文章有些是有那个引用的。。。。<br />刚刚把他做了上去。。样式也是照搬JAVAEYE的。。嘿嘿。。。<br />	  	  	\n	  ',NULL,769,'0103','随笔',NULL,0),(933,'2009-10-21 21:59:57','给博客加上了代码高亮的功能！','	  代码高亮是从JAVAEYE上搞下来的。。呵呵。。。<br />基本是可以显示代码高亮了。。不过总觉得有些不满意的地方。。具体哪不满意也不知道。。。<br /><br />',NULL,2011,'0103','随笔',NULL,0),(932,'2009-10-21 16:56:19','ASCII及十六进制转换工具','刚刚找到的好工具。<br />\n以前数据库被注入的时候看IIS日志发现注入的代码都是用16进制写的。。呵呵。。。<br />\n有了这个工具，可以知道对方的注入的代码是怎么写的了。。嘿嘿。。<br />\n<img src=\"http://niunan.net/bbspic/asc2change.jpg\" alt=\"\" border=\"0\" /><br />\n<br />\n下载地址：<a target=\"_blank\" href=\"http://niunan.net/download/asc2change.7z\">http://niunan.net/download/asc2change.7z</a><br />\n	  	  		  	                          ',NULL,744,'0104','下载',NULL,0),(931,'2009-10-21 16:10:55','把JAVAEYE的博客文章都转移过来了。。','问人家问了半天没人知道怎么读取RSS的历史记录。。郁闷。。。<br />干脆自己写个程序直接把整个网页源代码采集下来，然后再慢慢分析。。。。<br />在采集JAVAEYE的网站页面的源码的时候发现，好像同一IP的采集多几次后就突然报错了，说什么401拒绝访问之类的。。可是在浏览器中能打开JAVAEYE的网站。。。<br />估计应该是那边做了什么限制的吧。。呵呵。。<br /><br />我自己做的采集代码，做了二个版本，.NET和PHP的。。结果都是有那个401拒绝访问的问题。。<br /><a target=\"_blank\" href=\"/download/getjavaeyetitle.7z\">http://niunan.net/download/getjavaeyetitle.7z</a><br />	  	  	\n	  ',NULL,1253,'0103','随笔',NULL,0),(930,'2009-10-21 15:52:43','在GridView的RowDataBound事件中获取某行某列的值！','	  	  \n    　　在目前的工作中经常用到，特此记录，特别是那个 <span style=\"color:red;\">DataRowView </span>，经常是忘记怎么拼写的，嘿嘿！\n<br />\n<pre name=\"code\" class=\"c#\">\n// 判断订单状态填充“操作”列\nprotected void gdvOrders_RowDataBound(object sender, GridViewRowEventArgs e)\n{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n&nbsp;&nbsp;&nbsp; if (e.Row.RowType == DataControlRowType.DataRow)\n&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRowView drv = (DataRowView)e.Row.DataItem ;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (drv.Row\"Status\".ToString() == \"审核中\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((Label)e.Row.Cells6.FindControl(\"lblOperator\")).Text = \"我要改单\";\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (drv.Row\"Status\".ToString() == \"已发货\" &amp;&amp; \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drv.Row\"ResponseDate\".ToString() == \"\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((Label)e.Row.Cells6.FindControl(\"lblOperator\")).Visible = false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((LinkButton)e.Row.Cells6.FindControl(\"lbtnAccept;ods\")).Visible = true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\n&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n}\n</pre><br />	  	\n	  ',NULL,868,'0101','ASP.NET',NULL,0),(919,'2009-10-21 15:52:42','ASP.NET读取RSS','	  \n    从网上找的一段读取RSS的代码,经测能用:\n<br /><pre name=\"code\" class=\"C#\">\n    /// \n    /// 加载RSS\n    /// \n    /// RSS地址\n    /// 要提取的文章数量\n    /// \n    public string LoadRSS(string RssUrl, int RssCount)\n    {\n        XmlDocument doc = new XmlDocument();\n        string Rss = \"\";\n        if (RssUrl != \"\")\n        {\n            try\n            {\n                doc.Load(RssUrl);\n                XmlNodeList nodelist = doc.GetElementsByTagName(\"item\");\n                XmlNodeList objItems1;\n                int i = 1;\n                if (doc.HasChildNodes)\n                {\n                    foreach (XmlNode node in nodelist)\n                    {\n                        string title = \"\"; // 文章标题\n                        string link = \"\";  // 链接\n                        string content = \"\"; // 内容\n                        string createDate = \"\"; // 发表时间\n                        i += 1;\n                        if (node.HasChildNodes)\n                        {\n                            objItems1 = node.ChildNodes;\n                            foreach (XmlNode node1 in objItems1)\n                            {\n                                switch (node1.Name)\n                                {\n                                    case \"title\":\n                                        title = node1.InnerText;\n                                        break;\n                                    case \"link\":\n                                        link = node1.InnerText;\n                                        break;\n                                    case \"description\":\n                                        content = node1.InnerText;\n                                        break;\n                                    case \"pubDate\":\n                                        createDate = node1.InnerText;\n                                        break;\n                                }\n                                if (title != \"\" &amp;&amp; link != \"\")\n                                    break;\n                            }\n                            Rss += \"<a href=\"%22%20+%20link%20+%20%22\" target=\"_blank\">\" + title + \"</a> 发表于 \"+createDate+\"<hr />\";\n                            Rss += content;\n\n                        }\n                        if (i &gt; RssCount)\n                            break;\n                    }\n                }\n            }\n            catch (Exception)\n            {\n                Rss = \"RSS Feed 源数据出错！\";\n            }\n        }\n        else\n        {\n            Rss = \"未找到信息源，您可刷新重试或联系管理员！\";\n        }\n        return Rss;\n    }\n</pre>\n  	  	\n	  ',NULL,765,'0101','ASP.NET',NULL,0),(920,'2009-10-21 15:52:42','ACCESS中的内置函数','	  \n    网上找到的，今天做东西的时候用到了，记下来，以备下回使用\n<br />\n<br />★日期/时间★\n<br />CDate&nbsp; 将字符串转化成为日期 select CDate(\"2005/4/5\")\n<br />Date&nbsp; 返回当前日期\n<br />DateAdd&nbsp; 将指定日期加上某个日期select dateAdd(\"d\",30,Date())将当前日期加上30天,其中d可以换为yyyy或H等\n<br />DateDiff 判断两个日期之间的间隔 select DateDiff(\"d\",\"2006-5-1\",\"2006-6-1\")返回31,其中d可以换为yyyy,m,H等\n<br />DatePart 返回日期的某个部分 select DatePart(\"d\",\"2006-5-1\")返回1,即1号，d也可以换为yyyy或m\n<br />Day&nbsp; 返回日期的d部分,等同于datepart的d部分\n<br />Hour&nbsp; 返回日期的小时\n<br />IsDate&nbsp; 判断是否是日期,是日期返回-1,不是日期返回0\n<br />Minute&nbsp; 返回日期的分钟部分\n<br />Month&nbsp; 返回日期的月份部分\n<br />Now&nbsp; 返回当前时间(完整时间，包括年月日 小时分秒)\n<br />Second&nbsp; 返回日期的秒部分\n<br />Time&nbsp; 返回当前的时间部分(即除去年/月/日的部分)\n<br />Weekday&nbsp; 返回某个日期的当前星期(星期天为1,星期一为2,星期二为3...)，例如select weekday(now());\n<br />Year&nbsp; 返回某个日期的年份\n<br />\n<br />▲检查\n<br />IsEmpty&nbsp; 检测是否为空(不过经测试，不管什么情况，都返回0)\n<br />IsNull&nbsp; 检测是否为Null值，null值返回0，非null值返回-1\n<br />IsNumeric 检测是否为数字,是数字返回-1，否则返回0\n<br />\n<br />算术\n<br />Abs&nbsp;&nbsp; 绝对值\n<br />Atn&nbsp;&nbsp; 返正切值。\n<br />Cos&nbsp;&nbsp; 余弦值\n<br />Exp&nbsp;&nbsp; 返回 e 的给定次幂。\n<br />Fix&nbsp;&nbsp; 返回数字的整数部分(即小数部分完全截掉)\n<br />Int&nbsp; 将数字向下取整到最接近的整数。(其实等同于Fix)\n<br />Log&nbsp; 返回以E为底的对数值\n<br />Rnd&nbsp; 返回一个0到1之间的随机数值\n<br />Sgn&nbsp; 返回数字的正负符号(正数返回1,负数返回-1,0值返回0)\n<br />Sin&nbsp; 正弦值\n<br />Sqr&nbsp; 返回平方根值\n<br />Tan&nbsp;&nbsp; 正切值\n<br />\n<br />★程序流程★\n<br />Choose&nbsp; 根据第一参数，返回后面字符串组的值,Select Choose(1,\"a\",\"b\",\"c\")返回a,将1改成2后，返回b,改成3后，返回c(第一个参数也可以是某个字段)\n<br />IIF&nbsp; 根据表达式返回特定的值 Select IIF(\"3&gt;1\",\"OK\",\"False\")，返回OK\n<br />\n<br />★Sql合计函数★\n<br />Avg&nbsp; 取字段平均值\n<br />Count&nbsp; 统计记录条数\n<br />Max&nbsp; 取字段最大值\n<br />Min&nbsp; 取字段最小值\n<br />StDev&nbsp; 估算样本的标准差（忽略样本中的逻辑值和文本）。\n<br />StDevP&nbsp; 计算以参数形式（忽略逻辑值和文本）给出的整个样本总体的标准偏差。\n<br />Sum&nbsp; 计算字段的总合\n<br />Var&nbsp; 估算样本方差（忽略样本中的逻辑值和文本）。\n<br />VarP&nbsp; 计算整个样本总体的方差（忽略样本总体中的逻辑值和文本）。\n<br />\n<br />\n<br />★文本★\n<br />Asc&nbsp;&nbsp; 返回字母的Acsii值，select Asc(\"A\")返回65\n<br />Chr&nbsp;&nbsp; 将ascii值转换到字符 select chr(65)返回\"A\"\n<br />Format&nbsp;&nbsp; 格式化字符串，Select Format(now(),&#039;yyyy-mm-dd&#039;)返回类似于\"2005-04-03\" ,Select Format(3/9,\"0.00\")返回0.33\n<br />InStr&nbsp;&nbsp; 查询子串在字符串中的位置 select Instr(\"abc\",\"a\")返回1,select Instr(\"abc\",\"f\")返回0 \n<br />LCase&nbsp; 返回字符串的小写形式 \n<br />Left&nbsp; 左截取字符串\n<br />Len&nbsp; 返回字符串长度\n<br />LTrim&nbsp; 左截取空格\n<br />Mid&nbsp;&nbsp;&nbsp; 取得子字符串 select mid(\"123\",1,2) as midDemo 返回12\n<br />Right&nbsp; 右截取字符串\n<br />RTrim&nbsp; 右截取空格\n<br />Space&nbsp; 产生空格 select Space(4)返回4个空格\n<br />StrComp&nbsp; 比较两个字符串是否内容一致(不区分大小写)select StrComp(\"abc\",\"ABC\")返回0,select StrComp(\"abc\",\"123\")返回-1\n<br />Trim&nbsp; 截取字符串两头的空格\n<br />UCase&nbsp; 将字符串转大写\n  	  	\n	  ',NULL,816,'0106','SQL',NULL,0),(921,'2009-10-21 15:52:42','VS2008修改自定义模板','	  \n    我们开发的时候习惯在代码顶部加上自己的版权说明。\n<br />每次拷贝挺麻烦的，上网查了一下，2003的介绍但不少。但08的模板生成方式好像改变了\n<br />后来2005的一篇介绍给了我一点提示。原来模板文件放在common7目录下。\n<br />主要分为ProjectTemplates和ItemTemplates，前者生成项目的时候用，后者add new item的时候用\n<br />下面就以修改Web项目里的class文件为例。\n<br />\n<br />模板文件位于 D:\\Program Files\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ItemTemplates\\Web\\CSharp\\1033下\n<br />（D盘是我的安装目录）\n<br />这里面是一大堆.zip文件，我们把需要的文件Class.zip。解压后修改Class.cs,在头部加上\n<br /><span style=\"font-family:monospace;\"><br /></span><pre name=\"code\" class=\"c#\">/*\n * 作者: 牛腩\n * 创建时间: $time$\n * Email: 164423073@qq.com\n * 说明: \n */</pre><br /><span style=\"font-family:monospace;\"><br /></span>这里$var$ 都是系统的变量，但是我没找到是在哪里定义的，有知道的朋友麻烦告知一下。\n<br />\n<br />修改好后打包回去覆盖原来的Class.zip,然后在visual studuo的命运行下运行 <br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">devenv /setup </div><br />就可以使用了。\n<br />这个命令比较耗时，大概要几分钟，如果要想临时看效果，也可以修改ItemTemplatesCache目录下的相关文件。\n<br />\n<br />其他的文件根据需要修改相应的文件即可。这样我们就可以减少很多手工的劳动了。\n<br />\n<br />',NULL,946,'0101','ASP.NET',NULL,0),(922,'2009-10-21 15:52:42','Visual Studio中的邮箱验证正则表达式！','	  \n    　　VS中自带的，为了以后需要的时候再打开VS，先记录在这里了。。嘿嘿。。。\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\"><br />\n　　\\w+(-+.&#039;\\w+)*@\\w+(-.\\w+)*\\.\\w+(-.\\w+)*\n\n	  <span class=\"quoteend\"></span></div>',NULL,1141,'0107','正则表达式',NULL,0),(923,'2009-10-21 15:52:42','匹配汉字的正则表达式！','	  \n    总有用到的时候，先记下来！！！\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\"><br />\n\\u4e00-\\u9fa5<br /><span class=\"quoteend\"></span></div><br />',NULL,1029,'0107','正则表达式',NULL,0),(924,'2009-10-21 15:52:42','n个for循环的嵌套','	  \n    用递归函数，举个例子：\n<br /><pre name=\"code\" class=\"c\">\nvoid f(int n)\n{\n  int i;\n\n  if(n==1)\n    for(i=0;i\n    {\n      /*这里是最内层  可以放上一些代码*/\n      printf(\"123\\n\");\n    }\n  else\n  for(i=0;i\n    f(n-1);\n}\n</pre>\n<br />////////////////////////////\n<br />这样 f(5);语句就可以实现5个for循环的嵌套了 \n  	  	\n	  ',NULL,714,'0103','随笔',NULL,0),(925,'2009-10-21 15:52:42','jQuery插件—获取URL参数','做的项目中需要用到通过JS获取GET参数，上网找了一下，找到如下插件，使用：<br />\njs<br />\n例如 当前你的URL是：<br />\nhttp://www.xxx.com/index.php?test=1&amp;kk=2 <br />\n<br />\n如果想获取test，则可以引入插件后，<br />\n用如下方法获取：<br />\nvar test = $.query.get(’test’);<br />\n<br />\n如果参数有多个相同的名称 ，则可以这样：<br />\nvar arr = $.query.get(’testy’);<br />\n输出：&nbsp;  值1 ,&nbsp; 值2,&nbsp; 值3...<br />\n<br />\n如果要获取多个相同名称中的某一个，可以这样：<br />\nvar arrayElement = $.query.get(’testy1‘);<br />\n/js<br />\n<br />\n此插件不仅能获取参数，也能设置参数。<br />\n<br />\njs<br />\n设置一个参数：<br />\nvar newUrl = $.query.set(\"section\", 5).toString(); <br />\n输出&nbsp; ： \"?section=5\"<br />\n<br />\n设置两个参数：<br />\nvar newUrl = $.query.set(\"section\", 5).set(\"action\", \"do\").toString(); <br />\n输出 :&nbsp; \"?action=do&amp;section=5\"<br />\n<br />\n删除一个参数：<br />\nvar oldQueryAgain = $.query.REMOVE(\"type\");<br />\n<br />\n清空所有参数：<br />\nvar emptyQuery = $.query.empty();<br />\n<br />\n复制所有参数：<br />\nvar stillTheSame = $.query.copy();<br />\n/js<br />\n<br />\n插件地址：<br />\n<a target=\"_blank\" href=\"http://plugins.jquery.com/project/query-object%20\">http://plugins.jquery.com/project/query-object</a><br />\n<br />\n直接下载地址：<br />\n<a target=\"_blank\" href=\"http://niunan.net/download/jquery.query-2.1.7.js\">http://niunan.net/download/jquery.query-2.1.7.js</a><br />\n',NULL,1099,'0110','jQuery',NULL,0),(926,'2009-10-21 15:52:42','Windows IIS服务器.7z文件不能下载的解决办法','7-Zip是一款号称有着现今最高压缩比的压缩软件，它不仅支持独有的7z文件格式，而且还支持各种其它压缩文件格式，其中包括ZIP, RAR, CAB, GZIP, BZIP2和TAR。此软件压缩的压缩比要比普通ZIP文件高30-50%。因此，它可以把经WinZip压缩的文件再压缩2-10%。文件扩展名:.7z，可目前windows服务器无法支持.7z格式，所以我们需要设置一下。<br />\nwin2003的IIS6默认是不支持7z的，需要手工添加 <br />\n在IIS里所需要的站点---属性---HTTP头---MIME类型--添加如下内容 <br />\n扩展名：.7z（注意前面有个点） <br />\nMIME类型：application/octet-stream&nbsp;<div>&nbsp;<br />\n<img src=\"http://niunan.net/bbspic/iis_7z.jpg\" alt=\"\" border=\"0\" /></div>\n	                          ',NULL,840,'0103','随笔',NULL,0),(927,'2009-10-21 15:52:42','有关javascript模态窗口的使用','	  <div class=\"attachments\"><div><div>在web页面中需要弹出一些模态窗口，对于如何应用大体做了一下总结。&nbsp;</div><div>打开模态窗口&nbsp;</div><div><pre name=\"code\" class=\"js\">\nvar result = showModalDialog(\"b2.htm\",\"dialogWidth:270px;dialogHeight:140px;status:&#039;no&#039;\"); &nbsp;&nbsp;\n//显示dialog窗，result变量为此窗返回值数组 &nbsp;\n\n</pre>&nbsp;</div><div><br /></div><div><br /></div><div><br /></div><div>从模态窗口返回值&nbsp;</div><div><br /></div><div><pre name=\"code\" class=\"js\">\nwindow.returnValue=”aaa” //返回aaa,可直接从表单里获取数据如document.all.textfield.value; &nbsp;\n&nbsp;window.close(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //关闭模态窗口 &nbsp;\n\n\n\n</pre></div><div><br /></div><div>向模态窗口传值&nbsp;</div><div>传递&nbsp;</div><div><pre name=\"code\" class=\"js\">\nvar args = new array(); &nbsp;\nargs0=”a”; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//第一个参数为”a” &nbsp;\nargs1=”b”; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//第二个参数为”b” &nbsp;\nurl=\"a2.htm\"; &nbsp;&nbsp;\nstate=\"dialogWidth:200px;dialogHeight:100px;status:&#039;no&#039;\";　　 &nbsp;\nvar result = showModalDialog(url, args,state); &nbsp;&nbsp;\n\n</pre></div><div><br /></div><div><br /></div><div><br /></div><div>窗口中接收&nbsp;</div><div><pre name=\"code\" class=\"js\">\nv1=window.dialogArguments0;　 &nbsp;\nv2=window.dialogArguments1;&nbsp;\n\n</pre></div><div>&nbsp;&nbsp;</div><div><br /></div><div><br /></div><div>模态窗口中的页面提交问题&nbsp;</div><div>在模态窗口中，如有提交按钮，点击后会弹出新的页面。解决此问题有两方法&nbsp;</div><div><br /></div><div>1、在head中，添加&lt;base target=\"_self\"&gt;&nbsp;</div><div>注意：不要在form中再添加target=\"_self\"　否则失效&nbsp;</div><div><br /></div><div>2、把弹出的窗口页面做成框架网页，去加载要展示的网页&nbsp;</div><div><br /></div></div><ul><li><a href=\"http://dl.javaeye.com/topics/download/5791f191-8640-36bd-bf5c-b3f297d9f324\">JS模态窗口传值示例.rar</a> (4 KB)</li>\n        </ul>\n      \n    \n    \n  	  	\n	  </div>	  	\n	  	  	\n	  	  	\n	  ',NULL,845,'0105','javascript',NULL,0),(928,'2009-10-21 15:52:42','C#控制台应用程序中输入密码时用掩码显示','	  \n    <pre name=\"code\" class=\"c#\">\nstatic void Main(string args)\n        {\n            string password = string.Empty; \n            ConsoleKeyInfo info; \n            do\n            {\n                info = Console.ReadKey(true);\n                if (info.Key != ConsoleKey.Enter &amp;&amp; info.Key != ConsoleKey.Backspace &amp;&amp; info.Key != ConsoleKey.Escape &amp;&amp; info.Key != ConsoleKey.Tab &amp;&amp; info.KeyChar != &#039;\\0&#039;)\n                {\n                    password += info.KeyChar; \n                    Console.Write(&#039;*&#039;);\n                }\n            } while (info.Key != ConsoleKey.Enter); \n            Console.WriteLine(); \n            Console.WriteLine(password);\n\n        }\n</pre>\n<br />\n<br />if \n是判断按键是否为可打印字符键。\n  	  	\n	  ',NULL,733,'0101','ASP.NET',NULL,0),(929,'2009-10-21 15:52:42','nokia5200中使用ucweb浏览器','	  	  \n    用5200手机上网下载了ucweb浏览器，但是有时候总是出现网络异常，;OGLE了一下发现，原来手机中的有个地方还没有设置，在NOKIA5200中用UCWEB浏览器上网设置如下：\n<br />\n<br />\n<div class=\"quote_title\">引用</div><div class=\"quote_div\"><br /><br />（一）、 设置—→配置设置—→个人配置设置—→增加—→网络<br /><br />&nbsp;&nbsp;&nbsp; 帐号名称：CMWAP<br /><br />&nbsp;&nbsp;&nbsp; 主页：http://wap.monternet.com&nbsp; （也可以不用填）<br /><br />&nbsp;&nbsp;&nbsp; 用户名：（空）<br /><br />&nbsp;&nbsp;&nbsp; 密码：（空）<br /><br />&nbsp;&nbsp;&nbsp; 使用首选接入点：取消<br /><br />&nbsp;&nbsp;&nbsp; 接入点设置：<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 代理：启动<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 代理地址： 10.0.0.172<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 代理端口： 80<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传输方式：分组数据<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传输方式设置：<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 分组数据接入点： cmwap<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 网络类型： Ipv4<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 鉴权类型：普通<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用户名：（空）<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 密码：（空） <br /><br />&nbsp;&nbsp;&nbsp; 返回到：个人帐号CMWAP——&gt;操作——&gt;启动<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 设置—→配置设置—→预设配置设置—→个人配置——&gt;预设<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 设置—→配置设置—→为全部应用软件启动预设（有提示出现，选择：确认）<br /><br />&nbsp;&nbsp;&nbsp; <br /><br />通过以上的设置，手机自带浏览器上网就没有问题了，但是使用ucweb不能上网，那么再做一下下面的操作：<br /><br /><br /><br />（二）、 设置—→配置设置—→个人配置设置—→操作—→新增—→接入点<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 帐号名称：CMWAP<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 接入点设置：<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传输方式：分组数据<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传输方式设置：<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 分组数据接入点： cmwap （默认是 internet ，一定要改过来）<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 网络类型： Ipv4<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 鉴权类型：普通<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用户名：（空）<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 密码：（空）<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回到：个人帐号CMWAP——&gt;操作——&gt;启动<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; （这时看到首选接入点的地方已经有CMWAP显示了）<br /><br /><br /></div><br />\n<br />这时，手机自带浏览器和UCWEB都可以上网了\n  	  	\n	  	  	\n	  ',NULL,711,'0103','随笔',NULL,0),(908,'2009-10-21 15:52:41','复制文档有乱码的解决方法！','\n    &nbsp; 从网页复制了一篇文章，复制好后每段结尾都有乱码！！像{vowW0ao，每段都有，有什么办法解决哩？？？(常见于从A网复制情色小说^_^!)\n<br />&nbsp; 解决方法：针对利用span参数对文章进行加密应对方法： \n<br />利用span参数对文章进行加密，是目前流行的一种方法，用此方法加密，文章看起来是正常的，但是复制粘贴后就会有乱码，本人现介绍怎样把乱码去掉，呵呵！！ \n<br />比如龙战士第31集文字版，复制前显示的是： \n<br />第一章 龙瘟 \n<br />灰色的天空，灰色的神龙广场，还有被缚在十字架上 \n<br />但是，复制粘贴后就变成了： \n<br />-- 第一章 龙瘟 (kH(#ai= \n<br />! 5r@t+fI \n<br />灰色的天空，灰色的神龙广场，还有被缚在十字架上 \n<br />每一行都有乱码，一个一个删显然不太现实，可以这样： \n<br />查看页面源文件，将带有想复制内容那一部分保存到写字板,可以看到开头为： \n<br /><pre name=\"code\" class=\"html\">\n&lt;span style=\"font-size: 0pt;color:\'#F7F7F7\'\" &gt; eT~C148(b &lt;/span&gt; &lt;br&gt;&lt;div \nclass=quote&gt; -- 第一章 龙瘟&lt;span style=\"font-size: 0pt;color:\'#F7F7F7\'\" \n&gt; (kH(# ai= &lt;/span&gt; &lt;br&gt;&lt;span style=\"font-size: 0pt;color:\'#F7F7F7\'\" &gt; ! \n5r@t+fI &lt;/span&gt; &lt;br&gt; 灰色的天空，灰色的神龙广场，还有被缚在十字架上 \n</pre>\n<br />利用替换功能，将“span”全替换为“title”，好了，保存成文本文件，再把扩展名改成htm，打开看看，怎么样，复制时没乱码了吧！ \n<br />总而言之，其他用span加密的网页都可以用这种方法驱除乱码，方便快捷！具体就是： \n<br />1、查看页面源文件，将带有想复制内容那一部分复制粘贴到写字板。 \n<br />2、利用写字板的替换功能，将“span”全替换为“title”。 \n<br />3、保存成文本文件，再把扩展名改成htm。 \n<br />这样，打开这个htm文件，再复制就正常了。至于为什么用写字板而不用记事本，是因为用记事本的话，由于记事本本身原因，文本长的话，只一会，就停止响应了。用写字板的话就很快。\n  ',NULL,715,'0103','随笔',NULL,0),(909,'2009-10-21 15:52:41','DDR3的内存能不能插DDR2的插糟？','\n    &nbsp; DDR3内存相对于DDR2内存，其实只是规格上的提高，并没有真正的全面换代的新架构，DDR3在大容量内存的支持较好。\n<br />&nbsp; DDR3内存接触针脚数目同DDR2皆为240pin，但是防呆的缺口位置不同。DDR3与DDR2内存的核心电压也不同，DDR3内存的核心电压为1.8V，DDR2内存的核心电压为1.5V。因此，DDR3内存不能插在DDR2内存的插槽中使用。\n<br />&nbsp; SDR的频率是100、133。\n<br />&nbsp; DDR1的频率是266、333、400。\n<br />&nbsp; DDR2的频率是533、667、800。\n<br />&nbsp; DDR3的频率是800、1066、1333、1600。\n<br />\n<br />　　最近在做“装机大师”的模块，http://www.360buy.com/diy/diy_zx.asp,得搞懂各种接口能不能互插了！！！先记下来，嘿嘿！！！\n<br />\n  ',NULL,642,'0103','随笔',NULL,0),(910,'2009-10-21 15:52:41','关于.net发送EMAIL的总结','	  	  \n    ①导入相应的包：\n<br /><pre name=\"code\" class=\"c#\">\nusing System.Web.Mail;\nusing System.Net.Mail;\nusing System.Net;\n</pre>\n<br />②建立发送Email的方法：\n<br />\n<pre name=\"code\" class=\"c#\">\n/// &lt;summary&gt;\n/// 发送email,默认是25端口\n/// &lt;/summary&gt;\n/// &lt;param name=\"title\"&gt;邮件标题&lt;/param&gt;\n/// &lt;param name=\"body\"&gt;邮件内容&lt;/param&gt;\n/// &lt;param name=\"toAdress\"&gt;收件人&lt;/param&gt;\n/// &lt;param name=\"fromAdress\"&gt;发件人&lt;/param&gt;\n/// &lt;param name=\"userName\"&gt;发件用户名&lt;/param&gt;\n/// &lt;param name=\"userPwd\"&gt;发件密码&lt;/param&gt;\n/// &lt;param name=\"smtpHost\"&gt;smtp地址&lt;/param&gt;\nprivate void sendMail(string title, string body, string toAdress, string fromAdress,\n                      string userName, string userPwd, string smtpHost)\n{\n    try\n    {\n        MailAddress to = new MailAddress(toAdress);\n        MailAddress from = new MailAddress(fromAdress);\n        System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage(from, to);\n        message.IsBodyHtml = true; // 如果不加上这句那发送的邮件内容中有HTML会原样输出 \n        message.Subject = title; message.Body = body;\n        SmtpClient smtp = new SmtpClient();\n        smtp.UseDefaultCredentials = true;\n        smtp.Port = 25;\n        smtp.Credentials = new NetworkCredential(userName, userPwd);\n        smtp.DeliveryMethod = SmtpDeliveryMethod.Network;\n        smtp.Host = smtpHost;\n        message.To.Add(toAdress);\n        smtp.Send(message);\n    }\n    catch (Exception ex)\n    {\n        Response.Write(ex.Message);\n    }\n}\n</pre>\n<br />③测试发送Email：\n<br />\n<pre name=\"code\" class=\"c#\">\nsendMail(\"标题\", \"<span style=\"color:red;\">内容啊</span>\", \"164423073@qq.com\", \"test@126.com\",\n                    \"test\", \"test\", \"smtp.126.com\");\n</pre>\n<br /><span style=\"color:red;\">\n<br />注：有些邮件服务器的端口不是25,比如说Gmail，改一下相应的方法内容即可，另发现在本机能够测试通过。可是传到局域网里的另一台机器上发送失败，说什么“积极拒绝...”之类的，网上也有些方法说可以解决，但没亲自测试过....\n<br /></span>\n<br />\n<br /><span style=\"color:green;\">\n<br />本人摘录自：http://www.cnblogs.com/VocanoLee/archive/2008/10/09/1306725.html\n<br /></span>\n  	  	\n	  	  \n	  ',NULL,932,'0101','ASP.NET',NULL,0),(911,'2009-10-21 15:52:41','window.print()的使用','\n    &nbsp; window.print()&nbsp; 实际上，是浏览器打印功能菜单的一种程序调用。与点击打印功能菜单一样，不能精确分页，不能设置纸型，套打的问题更加无从谈起，只不过，可以让用户不用去点菜单，直接点击网页中的一个按钮，或一个链接里面调用罢了。事实上，很多用户都是采用这种方式打印，但是这种方式最致命的缺点是不能设置打印参数，比如纸型，页边距，选择打印机等等。 \n<br />\n<br />\n<br />&nbsp; 需要指出的是这种方法提供一个打印前和打印后的事件onbeforeprint、onafterprint。可以在打印前的时候重新编辑一些格式，专门送去打印，打印后又处理回来。\n<br />\n<br />function window.onbeforeprint()\n<br />{\n<br />//将一些不需要打印的隐藏\n<br />}\n<br />function window.onafterprint()\n<br />{\n<br />//放开隐藏的元素\n<br />}\n<br />\n<br />通过这两个方法，就可以实现页面的部分打印.\n<br />\n<br />转自:http://mywork.javaeye.com/blog/69523\n<br />\n<br />\n  ',NULL,881,'0105','javascript',NULL,0),(912,'2009-10-21 15:52:41','没想到我竟然吃王八过敏了！！！','	  \n    　　昨晚亲戚生日，下班晚了，去到那里喝了一碗甲鱼汤，以前喝都没事的，没想到昨晚一喝就肚子疼了，后来也就没吃什么东西就回家了，回到家里疼得更加难受，而且还全身痒痒的，还没洗澡的就上床了，整个晚上一直都不舒服，痒死了，等到３点钟的时候又爬起来洗澡。。。\n<br />　　现在还在痒着的，上网查了一下竟然是吃甲鱼过敏，晕。。。以后好像吃着都没事的。。郁闷啊。。。以后不吃了。。。\n  	  	\n	  ',NULL,688,'0103','随笔',NULL,0),(913,'2009-10-21 15:52:41','利用BulletedList的DataBound事件设置BulletedList的超链接！','\n    　前台页面代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;asp:BulletedList ID=\"bulPPName\" runat=\"server\" \n                ondatabound=\"bulPPName_DataBound\" CssClass=\"bul\"&gt;\n&lt;/asp:BulletedList&gt;\n</pre>　\n<br />\n<br />&nbsp; 后台绑定代码：\n<br /><pre name=\"code\" class=\"C#\">\nbulPPName.DataSource = ProListDAO.GetPPNameByProId(productid);\nbulPPName.DataTextField = \"Name\";\nbulPPName.DataValueField = \"BrandId\";\nbulPPName.DisplayMode = BulletedListDisplayMode.HyperLink;\nbulPPName.DataBind();\n</pre>\n<br />\n<br />&nbsp; DataBoundg事件代码：\n<br /><pre name=\"code\" class=\"c#\">\nprotected void bulPPName_DataBound(object sender, EventArgs e)\n{\n        for (int i = 0; i &lt; bulPPName.Items.Count; i++)\n        {\n            bulPPName.Itemsi.Value = \"prolistbybrand.aspx?Pid=\" + Request.QueryString\"PId\" + \"&amp;brandid=\" + bulPPName.Itemsi.Value;\n        }\n}\n</pre>\n<br />\n  ',NULL,905,'0101','ASP.NET',NULL,0),(914,'2009-10-21 15:52:41','在ASP.NET中如何在前台使用urlencode！','	  	  \n    　　原来我的写法是：\n<br /><pre name=\"code\" class=\"C#\">\n&lt;%# Server.UrlEncode(Eval(\"IPVN\")) %&gt;\n</pre>\n<br />\n<br />　　测试不成功，后来改了一下，加个ToString（）方法就成了。嘿嘿，完成的代码如下：\n<br /><pre name=\"code\" class=\"c#\">\n&lt;%# Server.UrlEncode(Eval(\"IPVN\").ToString()) %&gt;\n</pre>\n  	  	\n	  	  	\n	  ',NULL,714,'0101','ASP.NET',NULL,0),(915,'2009-10-21 15:52:41','.NET使用了UpdatePanel后如何弹出对话框！','	  \n    <pre name=\"code\" class=\"c#\">\nScriptManager.RegisterStartupScript(this.UpdatePanel1,this.GetType(), \"提示\", \"alert(&#039;购物车为空,请先购物!&#039;)\", true);\n</pre>\n<br />\n<br />现在才知道原来.NET中弄AJAX这么容易啊，任何页面拉个SM控件，再按个UP控件，把页面内容全包在一起就成了，呵呵，真的蛮方便滴。。。\n  	  	\n	  ',NULL,762,'0101','ASP.NET',NULL,0),(916,'2009-10-21 15:52:41','.NET在后置代码中输入JS提示语句（背景不会变白）','	  \n    <pre name=\"code\" class=\"c#\">\nPage.ClientScript.RegisterStartupScript(Page.GetType(), \"message\", \"alert(&#039;加入暂存架成功！&#039;);\"); \n</pre>\n<br />\n<br />类似于AJAX的效果，页面不刷新！！！\n  	  	\n	  ',NULL,901,'0101','ASP.NET',NULL,0),(917,'2009-10-21 15:52:41','GridView模板列中的TextBox的ontextchanged事件中获取当前行的某列！','	  \n    　　GridView模板列有一TextBox，TextBox的AutoPostBack属性为True，在TextChanged事件中可通过如下代码获取当前行某列的值：\n<br />\n<br /><pre name=\"code\" class=\"C#\">\n　　　　　TextBox t = (TextBox)sender;\n        GridViewRow drv = (GridViewRow)t.NamingContainer;\n        int rowIndex = drv.RowIndex;\n        string coid = ((Label)gdvList.Rowsdrv.RowIndex.FindControl(\"lblCoId\")).Text;\n</pre>\n<br />\n<br />　　要注意的是当前行中的控件只能有一个控件名为lblCoId。\n  	  	\n	  ',NULL,762,'0101','ASP.NET',NULL,0),(918,'2009-10-21 15:52:41','在前台ASPX页面中直接判断绑定的数据是否为空！','\n    　　用GridView或其他控件绑定数据的时候，有时候需要判断从数据库中获取的值是否是空值，然后显示相应的内容，如果在后置代码中写的话只有是在<span style=\"color: blue\">RowDataBound</span>事件里判断，而我们可以在前台ASPX页面中使用如下代码来判断绑定的值是否是空值：\n<br />\n<br /><pre name=\"code\" class=\"c#\">\n&lt;%# string.IsNullOrEmpty(Eval(\"pic\").ToString()) ? \"\" : Eval(\"pic\") %&gt;\n</pre>\n  ',NULL,893,'0101','ASP.NET',NULL,0),(897,'2009-10-21 15:52:40','jQuery控制元素间隔滚动!','\n    只记录了本人需要用到的,转载自http://www.yaosansi.com/post/1309.html\n<br />\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;!--\n	创建人：牛腩\n	创建时间：2009-1-12 11:59:55\n--&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"&gt;\n&lt;head&gt;\n    &lt;title&gt;多行滚动演示&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        ul, li\n        {\n            margin: 0;\n            padding: 0;\n        }\n        #scrollDiv\n        {\n            width: 300px;\n            height: 100px;\n            min-height: 25px;\n            line-height: 25px;\n            border: #ccc 1px solid;\n            overflow: hidden;\n        }\n        #scrollDiv li\n        {\n            height: 25px;\n            padding-left: 10px;\n        }\n    &lt;/style&gt;\n\n    &lt;script type=\"text/javascript\" src=\"/js/jquery.pack.js\"&gt;&lt;/script&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n\n        $.fn.extend({\n\n            Scroll: function(opt, callback) {\n\n                //参数初始化\n\n                if (!opt) var opt = {};\n\n                var _this = this.eq(0).find(\"ul:first\");\n\n                var lineH = _this.find(\"li:first\").height(), //获取行高\n\n                      line = opt.line ? parseInt(opt.line, 10) : parseInt(this.height() / lineH, 10), //每次滚动的行数，默认为一屏，即父容器高度\n\n                       speed = opt.speed ? parseInt(opt.speed, 10) : 500, //卷动速度，数值越大，速度越慢（毫秒）\n\n                       timer = opt.timer ? parseInt(opt.timer, 10) : 3000; //滚动的时间间隔（毫秒）\n\n                if (line == 0) line = 1;\n\n                var upHeight = 0 - line * lineH;\n\n                //滚动函数\n\n                scrollUp = function() {\n\n                    _this.animate({\n\n                        marginTop: upHeight\n\n                    }, speed, function() {\n\n                        for (i = 1; i &lt;= line; i++) {\n\n                            _this.find(\"li:first\").appendTo(_this);\n\n                        }\n\n                        _this.css({ marginTop: 0 });\n\n                    });\n\n                }\n\n                //鼠标事件绑定\n\n                _this.hover(function() {\n\n                    clearInterval(timerID);\n\n                }, function() {\n\n                    timerID = setInterval(\"scrollUp()\", timer);\n\n                }).mouseout();\n\n            }\n\n        })\n\n\n\n\n\n        $(document).ready(function() {\n\n            $(\"#scrollDiv\").Scroll({ line: 4, speed: 500, timer: 3000 });\n\n        });\n\n    &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p&gt;\n        多行滚动演示：&lt;/p&gt;\n    &lt;div id=\"scrollDiv\"&gt;\n        &lt;ul&gt;\n            &lt;li&gt;这是公告标题的第一行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第二行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第三行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第四行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第五行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第六行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第七行&lt;/li&gt;\n            &lt;li&gt;这是公告标题的第八行&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n</pre>\n<br />\n  ',NULL,1031,'0110','jQuery',NULL,0),(898,'2009-10-21 15:52:40','VS2008添加数据库连接出错~','\n    当使用VS2008时，添加数据库连接，可能出现下面的提示：\n<br />\n<br /><span style=\"color: red\">无法添加数据库\n<br />未能加载文件或程序集“Microsoft.SqlServer.Management.Sdk.Sfc, Version=10.0.0.0, Culture=neutral,PublicKeyToken=89845dcd8080cc91”或它的一个依赖项。系统找不到指定的文件。</span>\n<br />\n<br />可以按照下面的步骤解决：\n<br />\n<br />http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=c6c3e9ef-ba29-4a43-8d69-a2bed18fe73c\n<br />\n<br />下载\n<br />\n<br />Microsoft SQL Server 2008 管理对象\n<br />\n<br />转自：　http://blog.csdn.net/net_lover/archive/2008/09/07/2894636.aspx\n<br />\n<br />\n  ',NULL,712,'0101','ASP.NET',NULL,0),(899,'2009-10-21 15:52:40','SQL Server 2005 Express附加数据库为“只读”的解决方法!','    在SQL Server 2005 Express 上附加从另外一台电脑Copy过来的数据库后，数据库为“只读”。<br />\n<img src=\"http://niunan.net/bbspic/sqlonlyread/01.jpg\" /> <br />\n<br />\n解决办法：<br />\n打开 开始→程序→Microsoft SQL Server 2005→配置工具→SQL Server 配置管理器, 打开SQL Server SQLEXPRESS 的属性.<br />\n<img src=\"http://niunan.net/bbspic/sqlonlyread/02.jpg\" /><br />\n<br />\n在内置帐号处，把“网络服务”改成“本地系统”，重新启动SQL Server 2005 Express 后，再附加数据库一切正常。<br />\n<img src=\"http://niunan.net/bbspic/sqlonlyread/03.jpg\" /><br />\n<br />\n总结：之所以附加上的数据库为“只读”，是因为启动SQL Server 的默认的启动帐号“网络服务”对所附加(Attach)的数据库文件的权限不够造成的。<br />\n<br />\n转自:http://blog.csdn.net/psongchao/archive/2006/07/13/915432.aspx  	                          ',NULL,890,'0106','SQL',NULL,0),(900,'2009-10-21 15:52:40','ASP.NET中根据模板生成静态页!','&nbsp;&nbsp; &nbsp;从51aspx.com网站上下到的源码,预先定义好htm,然后在后面添加标题和内容后把标题和内容放在定义好的htm中生成静态页,觉得蛮有用的,先记下来了,以后改进我的那个新闻发布系统的话肯定会用到这招,嘿嘿! <br />\n    template.htm模板页源码: <br />\nhtml&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;<br />\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" &gt;<br />\n&lt;head&gt;<br />\n    &lt;title&gt; $title$ &lt;/title&gt;<br />\n    &lt;meta http-equiv=content-type content=\"text/html; charset=UTF-8\" /&gt;<br />\n    &lt;style type=\"text/css\"&gt;<br />\n    &lt;!--<br />\n        .STYLE1 {<br />\n            font-size: 16px;<br />\n            font-weight: bold;<br />\n        }<br />\n    --&gt;<br />\n    &lt;/style&gt;<br />\n&lt;/head&gt;<br />\n&lt;body&gt;<br />\n&lt;br /&gt;<br />\n&lt;br /&gt;<br />\n&lt;table width=\"100%\" border=\"0\" bgcolor=\"#339900\"&gt;<br />\n  &lt;tr&gt;<br />\n    &lt;td height=\"34\" align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;span class=\"STYLE1\"&gt;$title$ &lt;/span&gt;&lt;/td&gt;<br />\n  &lt;/tr&gt;<br />\n  &lt;tr&gt;<br />\n    &lt;td height=\"42\" bgcolor=\"#FFFFFF\"&gt;&lt;br /&gt;<br />\n      &lt;br /&gt;<br />\n    内容：$content$ &lt;/td&gt;<br />\n  &lt;/tr&gt;<br />\n&lt;/table&gt;<br />\n&lt;a href=\"http://www.51aspx.com\" target=\"_blank\"&gt;51aspx.com 版权所有&lt;/a&gt;<br />\n&lt;/body&gt;<br />\n&lt;/html&gt;<br />\n/html<br />\n<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">Default.aspx页面源码:&nbsp;<br />\nhtml&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"Default.aspx.cs\" Inherits=\"_Default\" %&gt;<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div><br />\n</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;&lt;/title&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;form id=\"form1\" runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;标题:&lt;asp:TextBox ID=\"txtTitle\" runat=\"server\" Width=\"352px\"&gt;&lt;/asp:TextBox&gt;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;内容:&lt;asp:TextBox ID=\"txtContent\" runat=\"server\" Height=\"179px\" TextMode=\"MultiLine\"</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Width=\"350px\"&gt;&lt;/asp:TextBox&gt;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;asp:Button ID=\"Button1\" runat=\"server\" OnClick=\"Button1_Click\" Text=\"生成静态页\" /&gt;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/form&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n<br />\nDefault.aspx.cs源码:&nbsp;<br />\nc#using System;<br />\nusing System.Collections.Generic;<br />\nusing System.Linq;<br />\nusing System.Web;<br />\nusing System.Web.UI;<br />\nusing System.Web.UI.WebControls;<br />\nusing System.Text;<br />\nusing System.IO;<br />\n<br />\npublic partial class _Default : System.Web.UI.Page<br />\n{<br />\n    protected void Page_Load(object sender, EventArgs e)<br />\n    {<br />\n<br />\n    }<br />\n<br />\n    protected void Button1_Click(object sender, EventArgs e)<br />\n    {<br />\n        //思路是替换掉模板中的特征字符<br />\n        string mbPath = Server.MapPath(\"template.htm\");<br />\n        Encoding code = Encoding.GetEncoding(\"UTF-8\");<br />\n        StreamReader sr = null;<br />\n        StreamWriter sw = null;<br />\n        string str = null;<br />\n<br />\n        //读取<br />\n        try<br />\n        {<br />\n            sr = new StreamReader(mbPath, code);<br />\n            str = sr.ReadToEnd();<br />\n<br />\n        }<br />\n        catch (Exception ex)<br />\n        {<br />\n            throw ex;<br />\n        }<br />\n        finally<br />\n        {<br />\n            sr.Close();<br />\n        }<br />\n<br />\n        //根据时间自动重命名，扩展名也可以自行修改<br />\n        string fileName = DateTime.Now.ToString(\"yyyyMMddHHmmss\") + \".htm\";<br />\n        str = str.Replace(\"$title$\", txtTitle.Text);//替换Title<br />\n        str = str.Replace(\"$content$\", txtContent.Text);//替换content<br />\n<br />\n        //生成静态文件<br />\n        try<br />\n        {<br />\n            sw = new StreamWriter(Server.MapPath(\"htm/\") + fileName, false, code);<br />\n            sw.Write(str);<br />\n            sw.Flush();<br />\n<br />\n        }<br />\n        catch (Exception ex)<br />\n        {<br />\n            throw ex;<br />\n        }<br />\n        finally<br />\n        {<br />\n            sw.Close();<br />\n            Response.Write(\"恭喜&lt;a href=htm/\" + fileName + \" target=_blank&gt;\" + fileName + \"&lt;/a&gt;已经生成，保存在htm文件夹下！\");<br />\n        }<br />\n<br />\n    }<br />\n}<br />\n/c#<br />\n<br />\n</span>&nbsp;&nbsp; &nbsp;源码下载：<a href=\"http://niunan.net/download/genstatichtml.7z\" target=\"_blank\">http://niunan.net/download/genstatichtml.7z</a><div class=\"attachments\"><ul>        </ul>\n                	                          </div>\n',NULL,941,'0101','ASP.NET',NULL,0),(901,'2009-10-21 15:52:40','.NET截取指定长度汉字超出部分以&quot;...&quot;代替','\n    做的新闻发布系统中需要用到这个，上网找了一下，在CSDN处找到个方法，蛮好的，记下来了。。嘿嘿。。\n<br /><pre name=\"code\" class=\"c#\">\n ///   &lt;summary&gt; \n    ///   将指定字符串按指定长度进行剪切， \n    ///   &lt;/summary&gt; \n    ///   &lt;param   name= \"oldStr \"&gt; 需要截断的字符串 &lt;/param&gt; \n    ///   &lt;param   name= \"maxLength \"&gt; 字符串的最大长度 &lt;/param&gt; \n    ///   &lt;param   name= \"endWith \"&gt; 超过长度的后缀 &lt;/param&gt; \n    ///   &lt;returns&gt; 如果超过长度，返回截断后的新字符串加上后缀，否则，返回原字符串 &lt;/returns&gt; \n    public static string StringTruncat(string oldStr, int maxLength, string endWith)\n    {\n        if (string.IsNullOrEmpty(oldStr))\n            //   throw   new   NullReferenceException( \"原字符串不能为空 \"); \n            return oldStr + endWith;\n        if (maxLength &lt; 1)\n            throw new Exception(\"返回的字符串长度必须大于0 \");\n        if (oldStr.Length &gt; maxLength)\n        {\n            string strTmp = oldStr.Substring(0, maxLength);\n            if (string.IsNullOrEmpty(endWith))\n                return strTmp;\n            else\n                return strTmp + endWith;\n        }\n        return oldStr;\n    } \n</pre>\n<br />\n<br />另外还看到了有人说用CSS也能做出来的，测试了一下他给的代码，却没有成功，看来还是得用程序的方法了！！！\n<br />\n  ',NULL,1028,'0101','ASP.NET',NULL,0),(902,'2009-10-21 15:52:40','select into 和 insert into select 两种表复制语句','	  \n    <pre name=\"code\" class=\"sql\">\nselect * into destTbl from srcTbl\ninsert into destTbl(fld1, fld2) select fld1, 5 from srcTbl\n</pre>\n<br />以上两句都是将 srcTbl 的数据插入到 destTbl，但两句又有区别的。\n<br />\n<br />第一句（select into from）要求目标表（destTbl）不存在，因为在插入时会自动创建。\n<br />\n<br />第二句（insert into select from）要求目标表（destTbl）存在，由于目标表已经存在，所以我们除了插入源表（srcTbl）的字段外，还可以插入常量，如例中的：5。\n<br />\n  	  \n	  ',NULL,860,'0106','SQL',NULL,0),(903,'2009-10-21 15:52:40','巧妙用水可以治病！','\n    &nbsp;&nbsp;&nbsp; <span style=\"color: blue\">色斑 清晨一杯白开水</span>\n<br />&nbsp;&nbsp;&nbsp; 很多人都听说过早晨喝一杯水对身体有好处。有人喝盐水，有人喝蜂蜜水，还有人为了美白喝柠檬水，到底喝什么水最好呢？人体经过了一宿的代谢，体内的垃圾需要一个强有力的外作用帮助排泄，没有任何糖分和营养物质的凉白开水是最好的！如果是糖水或放入营养物质的水，这就需要时间在体内转化，不能起到迅速冲刷我们机体的作用。所以，清晨一杯清澈的白开水是排毒妙方。\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">胃疼 经常喝点粥</span>\n<br />&nbsp;&nbsp;&nbsp; 有胃病的人，或者感到胃不舒服，可以采取喝粥的“水养护”措施。熬粥的温度要超过60℃，这个温度会产生一种糊化作用，软嫩热腾的稀饭入口即化，下肚后非常容易消化，很适合肠胃不适的人食用。稀饭中含有大量水分，还能有效地润滑肠道，荡涤肠道中的有害物质，并顺利地把它们排出体外\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">恶心 用盐水催吐</span>\n<br />&nbsp;&nbsp;&nbsp; 出现恶心的情况很复杂。有时候是对吃了不良食物的一种保护性反应，遇到这样的情况，不要害怕呕吐，因为吐出脏东西可以让身体舒服很多。如果感到特别难以吐出，可以利用淡盐水催吐，准备一杯淡盐水放在手边，喝上几大口，促使污物吐出。吐干净以后，可以用盐水漱口，起到简单地消炎作用，淡盐水也是很好的补充液，可以缓解患者虚弱的状态。\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">肥胖 餐后半小时喝一些水</span>\n<br />&nbsp;&nbsp;&nbsp; 有些人有这样的谬论，不喝水可以减肥！现在医学家可以明确地告诉你：这是一个错误的做法。想减轻体重，又不喝足够的水，身体的脂肪不能代谢，体重反而增加。体内的很多化学反应都是水为介质进行的。身体的消化功能、内分泌功能都需要水，代谢产物中的毒性物质要靠水来排除，适当饮水可避免肠胃功能紊乱。你可以在用餐半小时后，喝一些水，加强身体的消化功能，助你维持身材。\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">失眠 热水的按摩作用是最强效的安眠药</span>\n<br />&nbsp;&nbsp;&nbsp; 人体逐渐进入梦寐的状态是体温下降的一个过程。而适宜人体睡眠的要求中，温暖的环境必不可少。睡前洗个热水澡和用热水泡脚一样，都可以给人温暖的外环境，弥补体温下降带来的不适，催人入眠。而值得一提的是，水对于身体有着独特的按摩功效，轻缓、柔和、滋润的效果是最好的镇静安神剂。\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">心脏病 睡前一杯水</span>\n<br />&nbsp;&nbsp;&nbsp; 如果你心脏不好，可以养成睡前一杯水的习惯，这样可以预防容易发生在凌晨的，像心绞痛、心肌梗塞这样的疾病。心肌梗塞等疾病是由于血液的黏稠度高而引起的。当人熟睡时，由于出汗，身体内的水分丢失，造成血液中的水分减少，血液的黏稠度会变得很高。但是，如果在睡前喝上一杯水的话，可以减低血液的黏稠度，减少心脏病突发的危险。因此睡前的一杯水，可以是一杯救命水呀。&nbsp; \n<br />\n<br />转自：《南国早报》&nbsp; \n  ',NULL,631,'0103','随笔',NULL,0),(904,'2009-10-21 15:52:40','Visual Studio 2005/2008 调试出现“无法显示该网页”！','\n    调试Web程序的时候，突然页面不能显示出来，老是显示着“网页无法显示”的页面。云里雾里，鬼知道是怎么解决的，终于一个惊天大发现：IE地址栏里面显示端口号和桌面任务栏右下角“ASP.NET Development Server”的端口压根就不一致，我把IE地址栏的端口号改成“ASP.NET Development Server”显示的端口号，结果网页就出来了，后面在;ogle上继续搜索，查询关键字“VS2005&nbsp; 调试 端口不一致”，终于找到了答案，原来是防火墙的缘故，我把高人的原话引用过来：\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />“是否安装了NOD32 3.0以上版本？或者还有其它什么防火墙类软件？\n<br />如果你是安装NOD32 3.0的，按照以下方法做： \n<br />依次进入NOD32的高级设置（F5），Web访问保护，HTTP，Web浏览器，会看到一个程序列表你的devenv.exe应该在其中，双击前面的勾（相当于去掉选中状态），确定退出，停止一切运行的ASP.NET Development Server，在VS中打开并重新编译运行你的Web程序”\n<br /></div>\n<br /><span style=\"color: red\">注</span>：其实出现端口号不一致的问题，如果想要web程序跑起来还是没有问题的，那就是不采用随机端口的方式，在VS2005里面的“网站”--&gt;“启动选项”--&gt;“启动选项”，找到“服务器”，然后选中“使用自定义服务器”，在“基URL”中填上web程序的虚拟路径即可，一般就是:：http://机器名(或你本机的IP地址)/web程序别名 \n<br />\n  ',NULL,822,'0101','ASP.NET',NULL,0),(905,'2009-10-21 15:52:40','用jquery控制图片的最大宽度','\n    &nbsp;&nbsp; 基本思路是查看所有网页上的图片，如果大于一个数值，则设定宽度，否则，就按照原来的尺寸显示。代码如下：\n<br /><pre name=\"code\" class=\"js\">\n$(document).ready(function() {\n	var maxwidth=552;\n	$(\"img\").each(function(){      \n		if (this.width&gt;maxwidth) \n		 this.width = maxwidth; \n	}); \n});\n</pre>\n<br />第一行是国际化的jQuery写法，当页面加载完成后执行\n<br />第二行设定最大的宽度\n<br />第三行是查找所有img标签，每一个做后边的function处理\n<br />第四，五行判断图片的宽度，如果超过这个宽度则设其宽度为允许的最大宽度。\n  ',NULL,947,'0110','jQuery',NULL,0),(906,'2009-10-21 15:52:40','photoshop cs3 + xp sp3 不能自动刷新问题','\n    &nbsp;&nbsp; 前两天重装系统，发现龙卷风V1.3的Photoshop CS3工作区内所有操作都不会自动刷新了，即操作后无法即时显示操作效果。\n<br />\n<br />&nbsp;&nbsp;&nbsp; 用网友的话“对工作区(工作窗口)的任何修改如绘制，选取，删除之类的操作，都无法自动刷新，要拖动一下窗口，修改后的结果才呈现出来，比如平时候建立了选区时，选区是流动的虚线框（蚂蚁线），现在框（蚂蚁线）不见了，要拖一下窗口，框才出来，而且也不是流动的，另外导航窗口和图层缩略图的内容也不能自动更新。”\n<br />所有做的步骤都在放大再缩小一下或动一下窗口才能显示出来。\n<br />\n<br />几经千辛万苦，终于找到决解方法：<span style=\"color: blue\">去掉“首选项（Ctrl+K）”“文字”中的“显示亚洲字体选项”和“字体预览”前的勾，再重启PS即可。</span>\n<br />\n<br />CS3套装没有这个问题，网改单版会出现此种情况。\n<br />\n<br />摘录自：http://blog.sina.com.cn/s/blog_48da559a0100ahlu.html\n<br />\n  ',NULL,673,'0103','随笔',NULL,0),(907,'2009-10-21 15:52:40','发工资啦！！！哈哈哈，，，好多钱哦~~~','\n    &nbsp;&nbsp; 今天终于发钱啦。。。正好是一个月，￥1，370，呵呵 ，第一次看到这么多钱，哦哦哦！！！\n<br />&nbsp;&nbsp;&nbsp; 工作44天，头14天￥370，后一个月￥1，370，嘿嘿。。。拿到钱的感觉蛮爽滴。。。\n<br />&nbsp;&nbsp;&nbsp; 工作一个多月，深刻感觉到一句话的重要性：“文档比代码重要！！！”\n<br />&nbsp;&nbsp;&nbsp; 做的这个网站虽然说是一个购物商城之类的，可是里面的逻辑远非以前在青鸟做商城的项目可比，唉。。。\n<br />&nbsp;&nbsp;&nbsp; BOSS IS ;D！叫做什么就做什么吧！！！\n<br />\n<br />&nbsp;&nbsp;&nbsp; 肚子饿了，吃饭！！！\n  ',NULL,677,'0103','随笔',NULL,0),(886,'2009-10-21 15:52:39','不知道从哪里弄来的正则表达式汇总','    quote\"^\\d+$\"　　//非负整数（正整数 + 0） <br />\n\"^0-9*1-90-9*$\"　　//正整数 <br />\n\"^((-\\d+)|(0+))$\"　　//非正整数（负整数 + 0） <br />\n\"^-0-9*1-90-9*$\"　　//负整数 <br />\n\"^-?\\d+$\"　　　　//整数 <br />\n\"^\\d+(\\.\\d+)?$\"　　//非负浮点数（正浮点数 + 0） <br />\n\"^((0-9+\\.0-9*1-90-9*)|(0-9*1-90-9*\\.0-9+)|(0-9*1-90-9*))$\"　　//正浮点数 <br />\n\"^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$\"　　//非正浮点数（负浮点数 + 0） <br />\n\"^(-((0-9+\\.0-9*1-90-9*)|(0-9*1-90-9*\\.0-9+)|(0-9*1-90-9*)))$\"　　//负浮点数 <br />\n\"^(-?\\d+)(\\.\\d+)?$\"　　//浮点数 <br />\n\"^A-Za-z+$\"　　//由26个英文字母组成的字符串 <br />\n\"^A-Z+$\"　　//由26个英文字母的大写组成的字符串 <br />\n\"^a-z+$\"　　//由26个英文字母的小写组成的字符串 <br />\n\"^A-Za-z0-9+$\"　　//由数字和26个英文字母组成的字符串 <br />\n\"^\\w+$\"　　//由数字、26个英文字母或者下划线组成的字符串 <br />\n\"^\\w-+(\\.\\w-+)*@\\w-+(\\.\\w-+)+$\"　　　　//email地址 <br />\n\"^a-zA-z+://(\\w+(-\\w+)*)(\\.(\\w+(-\\w+)*))*(\\?\\S*)?$\"　　//url<br />\n<br />\n整数或者小数：^0-9+\\.{0,1}0-9{0,2}$<br />\n只能输入数字：\"^0-9*$\"。<br />\n只能输入n位的数字：\"^\\d{n}$\"。<br />\n只能输入至少n位的数字：\"^\\d{n,}$\"。<br />\n只能输入m~n位的数字：。\"^\\d{m,n}$\"<br />\n只能输入零和非零开头的数字：\"^(0|1-90-9*)$\"。<br />\n只能输入有两位小数的正实数：\"^0-9+(.0-9{2})?$\"。<br />\n只能输入有1~3位小数的正实数：\"^0-9+(.0-9{1,3})?$\"。<br />\n只能输入非零的正整数：\"^\\+?1-90-9*$\"。<br />\n只能输入非零的负整数：\"^\\-1-90-9\"*$。<br />\n只能输入长度为3的字符：\"^.{3}$\"。<br />\n只能输入由26个英文字母组成的字符串：\"^A-Za-z+$\"。<br />\n只能输入由26个大写英文字母组成的字符串：\"^A-Z+$\"。<br />\n只能输入由26个小写英文字母组成的字符串：\"^a-z+$\"。<br />\n只能输入由数字和26个英文字母组成的字符串：\"^A-Za-z0-9+$\"。<br />\n只能输入由数字、26个英文字母或者下划线组成的字符串：\"^\\w+$\"。<br />\n验证用户密码：\"^a-zA-Z\\w{5,17}$\"正确格式为：以字母开头，长度在6~18之间，只能包含字符、数字和下划线。<br />\n验证是否含有^%&amp;&#039;&#039;,;=?$\\\"等字符：\"^%&amp;&#039;&#039;,;=?$\\x22+\"。<br />\n只能输入汉字：\"^\\u4e00-\\u9fa5{0,}$\"<br />\n验证Email地址：\"^\\w+(-+.\\w+)*@\\w+(-.\\w+)*\\.\\w+(-.\\w+)*$\"。<br />\n验证InternetURL：\"^http://(\\w-+\\.)+\\w-+(/\\w-./?%&amp;=*)?$\"。<br />\n验证电话号码：\"^(\\(\\d{3,4}-)|\\d{3.4}-)?\\d{7,8}$\"正确格式为：\"XXX-XXXXXXX\"、\"XXXX-XXXXXXXX\"、\"XXX-XXXXXXX\"、\"XXX-XXXXXXXX\"、\"XXXXXXX\"和\"XXXXXXXX\"。<br />\n验证身份证号（15位或18位数字）：\"^\\d{15}|\\d{18}$\"。<br />\n验证一年的12个月：\"^(0?1-9|10-2)$\"正确格式为：\"01\"～\"09\"和\"1\"～\"12\"。<br />\n验证一个月的31天：\"^((0?1-9)|((1|2)0-9)|30|31)$\"正确格式为；\"01\"～\"09\"和\"1\"～\"31\"。整数或者小数：^0-9+\\.{0,1}0-9{0,2}$<br />\n只能输入数字：\"^0-9*$\"。<br />\n只能输入n位的数字：\"^\\d{n}$\"。<br />\n只能输入至少n位的数字：\"^\\d{n,}$\"。<br />\n只能输入m~n位的数字：。\"^\\d{m,n}$\"<br />\n只能输入零和非零开头的数字：\"^(0|1-90-9*)$\"。<br />\n只能输入有两位小数的正实数：\"^0-9+(.0-9{2})?$\"。<br />\n只能输入有1~3位小数的正实数：\"^0-9+(.0-9{1,3})?$\"。<br />\n只能输入非零的正整数：\"^\\+?1-90-9*$\"。<br />\n只能输入非零的负整数：\"^\\-1-90-9\"*$。<br />\n只能输入长度为3的字符：\"^.{3}$\"。<br />\n只能输入由26个英文字母组成的字符串：\"^A-Za-z+$\"。<br />\n只能输入由26个大写英文字母组成的字符串：\"^A-Z+$\"。<br />\n只能输入由26个小写英文字母组成的字符串：\"^a-z+$\"。<br />\n只能输入由数字和26个英文字母组成的字符串：\"^A-Za-z0-9+$\"。<br />\n只能输入由数字、26个英文字母或者下划线组成的字符串：\"^\\w+$\"。<br />\n验证用户密码：\"^a-zA-Z\\w{5,17}$\"正确格式为：以字母开头，长度在6~18之间，只能包含字符、数字和下划线。<br />\n验证是否含有^%&amp;&#039;&#039;,;=?$\\\"等字符：\"^%&amp;&#039;&#039;,;=?$\\x22+\"。<br />\n只能输入汉字：\"^\\u4e00-\\u9fa5{0,}$\"<br />\n验证Email地址：\"^\\w+(-+.\\w+)*@\\w+(-.\\w+)*\\.\\w+(-.\\w+)*$\"。<br />\n验证InternetURL：\"^http://(\\w-+\\.)+\\w-+(/\\w-./?%&amp;=*)?$\"。<br />\n验证电话号码：\"^(\\(\\d{3,4}-)|\\d{3.4}-)?\\d{7,8}$\"正确格式为：\"XXX-XXXXXXX\"、\"XXXX-XXXXXXXX\"、\"XXX-XXXXXXX\"、\"XXX-XXXXXXXX\"、\"XXXXXXX\"和\"XXXXXXXX\"。<br />\n验证身份证号（15位或18位数字）：\"^\\d{15}|\\d{18}$\"。<br />\n验证一年的12个月：\"^(0?1-9|10-2)$\"正确格式为：\"01\"～\"09\"和\"1\"～\"12\"。<br />\n验证一个月的31天：\"^((0?1-9)|((1|2)0-9)|30|31)$\"正确格式为；\"01\"～\"09\"和\"1\"～\"31\"。/quote  	                          ',NULL,1128,'0107','正则表达式',NULL,0),(887,'2009-10-21 15:52:39','ASP.NET汉字转拼音源码','    <p>刚刚项目中要用到的小功能，上网搜索了一下，找到个源码，先保存起来先。。。<br />\n<br />\n源码下载: &nbsp; <a href=\"http://niunan.net/download/dotnet_pinyin.rar\" target=\"_blank\">点击下载</a><br />\n<br />\n<br />\n<br />\n</p>\n',NULL,657,'0101','ASP.NET',NULL,0),(888,'2009-10-21 15:52:39','ASP.NET中防止重复提交','\n    <p><span class=\"Apple-style-span\">解决方法：<br><br>              .Framework2.0中才有的button属性：</span></p>\n<p><span class=\"Apple-style-span\">\n<pre name=\"code\" class=\"c#\">&lt;asp:button id=\"btnSubmit\" onclick=\"btnSubmit_Click\" runat=\"server\"  OnClientClick=\"this.disabled=true;this.form.submit();\" UseSubmitBehavior=\"False\" /&gt;</pre>\n<p> <br>            解决重复提交：OnClientClick=\"this.disabled=true;this.form.submit();\" UseSubmitBehavior=\"False\"</p>\n</span></p>\n<p> </p>\n<p><span class=\"Apple-style-span\">摘录自：<a href=\"http://www.cnblogs.com/fan2k/archive/2008/03/10/1098240.html\">http://www.cnblogs.com/fan2k/archive/2008/03/10/1098240.html</a></span></p>\n  ',NULL,865,'0101','ASP.NET',NULL,0),(889,'2009-10-21 15:52:39','兼容IE和Firefox的设为首页和收藏的Javascript代码','    <div class=\"cnblogs_code\">&nbsp;&nbsp; &nbsp; &nbsp;更新于2010年6月19日，之前的代码发现还是有兼容问题的，干脆直接点，不能自动设置的直接aler弹出提示框就行了，以下的改进后的代码：<br />\njs<br />\nfunction addCookie() {   //  加入收藏夹 <br />\n    if (document.all) {<br />\n        window.external.AddFavorite(&#039;http://gxbest.cn&#039;, &#039;展志office&#039;);<br />\n    }<br />\n    else if (window.sidebar) {<br />\n    window.sidebar.addPanel(&#039;展志office&#039;, &#039;http://gxbest.cn&#039;, \"\");<br />\n    } else {<br />\n        alert(\"您的浏览器不支持自动加入收藏，请使用浏览器菜单手动设置\");<br />\n    }<br />\n}<br />\nfunction setHomepage() {   //  设置首页<br />\n    if (document.all) {<br />\n        document.body.style.behavior = &#039;url(#default#homepage)&#039;;<br />\n        document.body.setHomePage(&#039;http://gxbest.cn&#039;);<br />\n    } else {<br />\n        alert(\"您的浏览器不支持自动设置首页，请使用浏览器菜单手动设置\");<br />\n    }<br />\n}<br />\n/js</div>\n  	                          	                          ',NULL,818,'0105','javascript',NULL,0),(890,'2009-10-21 15:52:39','母版页和相对路径','\n    <p>一个经常让开发人员疑惑的问题是母版页是如何处理相对路径的。如果你使用的是静态文字，这一问题不会困扰你。不过，如果你加入了&lt;img&gt;标签或者指向其他资源的HTML标签，问题就可能发生。</p>\n<p>当你把母版页和内容页放在不同的目录时，问题就发生了。把母版页和内容页分放到不同的目录，这是大型网站推荐使用的最佳实践。实际上，微软建议你在专门的文件夹里保存所有的母版页。不过，如果你不够小心，使用相对路径时会带来问题。</p>\n<p>例如，假设你把母版页放在一个叫做MasterPages的子文件夹里，并在母版页里加入了如下的&lt;img&gt;标签：</p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/01.jpg\" alt=\"\" width=\"207\" height=\"30\" /></p>\n<p>假设文件&#92;MasterPages&#92;banner.jpg存在，这看起来是行得通的。甚至在Visual Studio设计环境会出现图片。但是，如果你在另一个子文件夹里创建了一个内容页，路径就会被解释成相对于那个文件夹。如果文件在那里不存在，就会得到 一个破损的链接而看不到图片。更糟的是，如果有一幅具有相同文件名的另外一个图片，你会不经意地得到一幅错误的图片。</p>\n<p>这样的问题之所以会发生，是因为&lt;img&gt;标签是普通的HTML。所以，ASP.NET不会接触到它。遗憾的是，当ASP.NET创建 内容页的时候，这个标签就不合适了。相同的问题出现在向其他页面提供相对链接的&lt;a&gt;标签以及用来把母版页链接到样式表 的&lt;link&gt;元素。</p>\n<p>要解决这一问题，你可以预先把URL写成相对于内容页面的地址。不过这会带来混淆，限制母版页使用的范围，并且产生在设计环境里不正确显示母版页的负面效应。</p>\n<p>另一个快捷的解决方案是把图片标签变成服务器端控件，这样ASP.NET就会修复这个错误：</p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/02.jpg\" alt=\"\" width=\"303\" height=\"29\" /></p>\n<p>&nbsp;</p>\n<p>这个解决办法会起作用是因为ASP.NET根据这一信息创建一个HtmlImage服务器控件。这个对象在母版页的Page对象实例化后创建，此时，ASP.NET把所有路径解释为相对于母版页的位置。你可以使用同样的技术来修复&lt;a&gt;标签对其他页面的链接。</p>\n<p>你还可以使用根路径语法，并用\"~\"字符作为URL的开头。例如，下面这个&lt;img&gt;标签毫无歧义地指向网站的MasterPages文件夹中的banner.jpg文件。</p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/03.jpg\" alt=\"\" width=\"419\" height=\"28\" /></p>\n<p>遗憾的是，这种语法只对服务器端控件有效。如果你要对普通的HTML产生同样的效果，你需要在链接里包含域名的完整的相对路径。这样的HTML代码难看且不可移植，所以不推荐使用。</p>\n<p>&nbsp;</p>\n<p><span style=\"color: red;\">\n<p>摘录自:http://book.51cto.com/art/200809/91060.htm</p>\n<p>刚刚在做项目中时遇到的这个问题,呵呵...特此记录....项目进展缓慢....老大要发火啦...郁闷....</p>\n<p>中餐牛腩粉￥4.2</p>\n<p><span style=\"color: #0000ff;\"><span style=\"color: #0000ff;\">今天在解决这个问题的时候另一个问题又出现了,现在我要在母版页引入jquery的文件,按照上面的方法我写成&nbsp;&nbsp;&nbsp; </span></span></p>\n<p><span style=\"color: #0000ff;\"><span style=\"color: #0000ff;\">&lt;script src=\"js/jquery.js\" type=\"text/javascript\" runat=\"server\"&gt;&lt;/script&gt;</span></span></p>\n</span></p>\n<p><span style=\"color: #0000ff;\">可是在运行的时候却出错了,说是<span style=\"color: #0000ff;\">jquery.js</span>中的第12行的$符号不知道是什么意思,然后我把<span style=\"color: #0000ff;\">runat=\"server\"去掉后就又运行成功了,看来是不能加<span style=\"color: #0000ff;\">runat=\"server\"</span>这个属性了,可是这样的话我在另一文件夹中套用母版页的时候又会出现上面这个相对路径的错误了,经到CSDN论坛发贴问,解决方法如下:</span></span></p>\n<p><span style=\"color: #0000ff;\">&lt;script src=\'&lt;%=ResolveUrl(\"~/js/jquery.js\") %&gt;\' type=\"text/javascript\"&gt;&lt;/script&gt;</span></p>\n<p><span style=\"color: #0000ff;\">第一次知道有<span style=\"color: #0000ff;\">ResolveUrl</span>这个方法,还真不错,呵呵...\n<p>&nbsp;</p>\n</span></p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n  ',NULL,799,'0101','ASP.NET',NULL,0),(891,'2009-10-21 15:52:39','根据之前发的那SQL语句查询表结构的语句做了个MSSQL实体类生成器!','    <p>昨晚花了一晚上做的,整天用.NET用网站,突然想用WINFORM做个小玩意的,竟然发现好多东西都不会了...怎么在WINFORM里面下拉控件没有DataBind方法滴....嘿嘿...</p>\n<p>整个生成器其实也没啥技术含量的,也就是文件IO流操作,向文本文件写入代码而已....软件界面如下图:</p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/2009-04-04_141338.jpg\" height=\"583\" alt=\"\" width=\"954\" />&nbsp;&nbsp;</p>\n<p>下面附上源码:,其实源码里有些地方还可以重构一下的,不过我这人懒...也就将就着吧..呵呵..</p>\n<p><a href=\"http://files.cnblogs.com/niunan/mssqlclassgen.rar\">http://files.cnblogs.com/niunan/mssqlclassgen.rar</a>&nbsp;</p>\n<p>&nbsp;</p>\n  	                          	                          ',NULL,884,'0104','下载',NULL,0),(892,'2009-10-21 15:52:39','U盘隐藏文件属性无法修改解决办法','\n    &nbsp;&nbsp;&nbsp; 老妈拿MP4去打印资料，回来后MP4中总是发现有毒。。。把里面的所有文件夹都设置了隐藏属性，而且还不可更改，上网搜索后得如下解决方法，亲测可行。\n<br />\n<br />打开CMD（命令行）窗口。\n<br />在命令行下输入：\n<br />for /f \"delims=\" %i in (\'dir /b /ad H:\') do attrib \"H:&#92;%i\" -r -s -h /s /d\n<br />\n<br />呵呵，有两点值得说明：\n<br />(1)、命令行中的\"H:\"为你的U盘盘符\n<br />(2)、可以处理含空格的文件（夹）名\n<br />\n<br />转自：http://www.2laoshi.cn/post/33.html\n  ',NULL,613,'0103','随笔',NULL,0),(893,'2009-10-21 15:52:39','jquery xpath详解','\n    <p>比如下面html代码<br />\n&lt;ul&gt;<br />\n&lt;li class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/li&gt;<br />\n&lt;li class=\"bbbb\"&gt;li-2&lt;/li&gt;<br />\n&lt;li title=\"fffff\"&gt;li-2&lt;/li&gt;<br />\n&lt;/ul&gt;<br />\n&lt;div class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/div&gt;<br />\n&lt;div class=\"bbbb\"&gt;li-2&lt;/div&gt;<br />\n&lt;div title=\"fffff\"&gt;li-2&lt;/div&gt;<br />\n－－－－－－－－－－－－－－－－－－－－－－－－－－－</p>\n<p><strong>第一种根据属性选择E@attr<br />\n</strong>\n$(\"@title\").click()..........</p>\n<p>即选择所有元素内 属性带有title的元素<br />\n即<br />\n&lt;li class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/li&gt;<br />\n&lt;li title=\"fffff\"&gt;li-2&lt;/li&gt;<br />\n&lt;div class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/div&gt;<br />\n&lt;div title=\"fffff\"&gt;li-2&lt;/div&gt;<br />\n<br />\n$(\"div@title\").click()..........</p>\n<p>选择所有div标签下的所有带title的元素<br />\n即<br />\n&lt;div class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/div&gt;<br />\n&lt;div title=\"fffff\"&gt;li-2&lt;/div&gt;<br />\n<br />\n<strong>第二种根据属性值选择E@attr=val</strong>\n<br />\n<br />\n$(\"div@title=ttt\").click()................</p>\n<p>\n选择div下所有title属性等于ttt的元素<br />\n即<br />\n&lt;div class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/div&gt;<br />\n<br />\n如果是 $(\"@title=ttt\").click()................<br />\n<br />\n所有元素下属性title等于ttt的元素<br />\n&lt;li class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/li&gt;<br />\n&lt;div class=\"aaaa\" title=\"ttt\"&gt;li-1&lt;/div&gt;<br />\n<br />\n<strong>第三种根据属性值开始字母选择E@attr^=val<br />\n<br />\n</strong>\n$(\"div@title^=t\").click()................<br />\n<br />\n所有div元素下所有属性title值是以t为开头的元素<br />\n<br />\n<br />\n<strong>第三种根据属性值开始字母选择E@attr$=val<br />\n</strong>\n<br />\n$(\"div@title$=t\").click()................<br />\n<br />\n所有div元素下所有属性title值是以t为结尾的元素<br />\n<br />\n<strong>第三种根据属性值包含字母选择E@attr*=val<br />\n</strong>\n<br />\n$(\"div@title*=t\").click()................<br />\n<br />\n所有div元素下所有属性title值是包含t的所有元素<br />\n<br />\n<strong>第三种根据多个属性选择E@attr=val@attr=val<br />\n<br />\n</strong>\n$(\"div@title=ttt@class=aaaa\").click()................<br />\n<br />\n所有div元素下所有属性title值是等于ttt并且属性class等于aaaa的元素</p>\n  ',NULL,816,'0110','jQuery',NULL,0),(894,'2009-10-21 15:52:39','javascript中的时间格式化的方法','\n    <pre name=\"code\" class=\"js\">\n/**\n* 时间对象的格式化;\n*/\nDate.prototype.format = function(format){\n /*\n  * eg:format=\"yyyy-MM-dd hh:mm:ss\";\n  */\n var o = {\n  \"M+\" :  this.getMonth()+1,  //month\n  \"d+\" :  this.getDate(),     //day\n  \"h+\" :  this.getHours(),    //hour\n      \"m+\" :  this.getMinutes(),  //minute\n      \"s+\" :  this.getSeconds(), //second\n      \"q+\" :  Math.floor((this.getMonth()+3)/3),  //quarter\n      \"S\"  :  this.getMilliseconds() //millisecond\n   }\n \n   if(/(y+)/.test(format)) {\n    format = format.replace(RegExp.$1, (this.getFullYear()+\"\").substr(4 - RegExp.$1.length));\n   }\n \n   for(var k in o) {\n    if(new RegExp(\"(\"+ k +\")\").test(format)) {\n      format = format.replace(RegExp.$1, RegExp.$1.length==1 ? ok : (\"00\"+ ok).substr((\"\"+ ok).length));\n    }\n   }\n return format;\n}\n\n</pre>\n<br /> \n<br />\n<br />使用方法:\n<br />\n<br /><pre name=\"code\" class=\"js\">\n  var testDate = new Date();\n\nvar testStr = testDate.format(\"yyyy年MM月dd日hh小时mm分ss秒\");\n\nalert(testStr);\n</pre>\n<br />\n<br />源自：http://blog.csdn.net/yzy0612/archive/2007/08/07/1730732.aspx\n  ',NULL,726,'0105','javascript',NULL,0),(895,'2009-10-21 15:52:39','javascript比较时间的方法','\n    &nbsp;&nbsp;&nbsp; 现在要用到，上网找了下，得如下方法，亲测成功！\n<br /><pre name=\"code\" class=\"js\">\n&lt;script type=\"text/javascript\"&gt;\n    var str1 = \"2009-2-6 08:00:00\";\n    var str2 = \"2009-2-6 15:00:00\";\n    alert(compareDate(str1,str2));\n    \n    function compareDate(d1, d2) {  // 比较时间的方法，d1时间比d2时间大，则返回true\n        return Date.parse(d1.replace(/-/g, \"/\")) &gt; Date.parse(d2.replace(/-/g, \"/\"))\n    }\n\n&lt;/script&gt;\n</pre>\n  ',NULL,669,'0105','javascript',NULL,0),(896,'2009-10-21 15:52:39','无法在web服务器上启动调试.调试失败,因为没有启用集成windows身份任证','\n    &nbsp;&nbsp; 今天不用出去串门拜年了，把公司的项目弄到自己家里的电脑上，部署到IIS上后，在VS里打开，打开的时候出现问题，需要调试一下。在VS里点击调试后，出现“无法在web服务器上启动调试.调试失败,因为没有启用集成windows身份任证”的对话框，上网搜索一下后发现，原来只要改改IIS中的设置即可调试，\n<br />\n<br /><span style=\"color: blue\">解决方法：\n<br />\n<br />在IIS管理器里的网站右键→属性→目录安全性→身份验证→“集成身份验证”</span>\n<br />\n<br />特此记录！\n<br />\n<br /><span style=\"color: red\">刚刚调试的时候卡死几次，郁闷，看来我的SP2200+ 512DDR400 的机子真的顶不住了，唉，过年后得换台电脑才行了，这样录视频也流畅！！！</span>\n  ',NULL,635,'0101','ASP.NET',NULL,0),(875,'2009-10-21 15:52:38','.NET使用一般处理程序生成验证码!','\n    &nbsp; 正在看CSDN上的ITCST上的王兴魁老师的AJAX技术入门,里面讲到了一个验证码的小程序,觉得蛮有用的,先记下来.\n<br />最后运行的效果图：\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23329/98fe0d29-ff36-3d0b-add0-890d90dd3e43.jpg\" />\n<br />HTML的代码:\n<br /><pre name=\"code\" class=\"html\">\n&lt;!-- \n    Document   : ASP.NET用一般处理程序生成验证码\n    Created on : 2008-10-13 17：04\n    Author     : 牛腩\n--&gt;\n&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;&lt;/title&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        function change() {\n            var imgNode = document.getElementById(\"vimg\");\n            imgNode.src = \"WaterMark.ashx?t=\" + (new Date()).valueOf();  // 这里加个时间的参数是为了防止浏览器缓存的问题\n        }\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;img src=\"WaterMark.ashx\" id=\"vimg\" alt=\"\" /&gt;&lt;input type=\"button\" value=\"换一张图片\" onclick=\"change()\" /&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />&nbsp; 一般处理程序WaterMark.ashx的代码:\n<br /><pre name=\"code\" class=\"c#\">\n&lt;%@ WebHandler Language=\"C#\" Class=\"WaterMark\" %&gt;\n\nusing System;\nusing System.Web;\nusing System.Drawing;\nusing System.Drawing.Drawing2D;\nusing System.Web.SessionState;  \n\npublic class WaterMark : IHttpHandler, IRequiresSessionState  // 要使用session必须实现该接口,记得要导入System.Web.SessionState命名空间\n{\n\n    public void ProcessRequest(HttpContext context)\n    {\n        string checkCode = GenCode(5);  // 产生5位随机字符\n        context.Session\"Code\" = checkCode; //将字符串保存到Session中，以便需要时进行验证\n        System.Drawing.Bitmap image = new System.Drawing.Bitmap(70, 22);\n        Graphics g = Graphics.FromImage(image);\n        try\n        {\n            //生成随机生成器\n            Random random = new Random();\n\n            //清空图片背景色\n            g.Clear(Color.White);\n\n            // 画图片的背景噪音线\n            int i;\n            for (i = 0; i &lt; 25; i++)\n            {\n                int x1 = random.Next(image.Width);\n                int x2 = random.Next(image.Width);\n                int y1 = random.Next(image.Height);\n                int y2 = random.Next(image.Height);\n                g.DrawLine(new Pen(Color.Silver), x1, y1, x2, y2);\n            }\n\n            Font font = new System.Drawing.Font(\"Arial\", 12, (System.Drawing.FontStyle.Bold));\n            System.Drawing.Drawing2D.LinearGradientBrush brush = new System.Drawing.Drawing2D.LinearGradientBrush(new Rectangle(0, 0, image.Width, image.Height), Color.Blue, Color.DarkRed, 1.2F, true);\n            g.DrawString(checkCode, font, brush, 2, 2);\n\n            //画图片的前景噪音点\n            g.DrawRectangle(new Pen(Color.Silver), 0, 0, image.Width - 1, image.Height - 1);\n            System.IO.MemoryStream ms = new System.IO.MemoryStream();\n            image.Save(ms, System.Drawing.Imaging.ImageFormat.Gif);\n            context.Response.ClearContent();\n            context.Response.ContentType = \"image/Gif\";\n            context.Response.BinaryWrite(ms.ToArray());\n        }\n        finally\n        {\n            g.Dispose();\n            image.Dispose();\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// 产生随机字符串\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"num\"&gt;随机出几个字符&lt;/param&gt;\n    /// &lt;returns&gt;随机出的字符串&lt;/returns&gt;\n    private string GenCode(int num)\n    {\n        string str = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";//\"的一是在不了有和人这中大为上个国我以要他时来用们生到作地于出就分对成会可主发年动同工也能下过子说产种面而方后多定行学法所民得经十三之进着等部度家电力里如水化高自二理起小物现实加量都两体制机当使点从业本去把性好应开它合还因由其些然前外天政四日那社义事平形相全表间样与关各重新线内数正心反你明看原又么利比或但质气第向道命此变条只没结解问意建月公无系军很情者最立代想已通并提直题党程展五果料象员革位入常文总次品式活设及管特件长求老头基资边流路级少图山统接知较将组见计别她手角期根论运农指几九区强放决西被干做必战先回则任取据处队南给色光门即保治北造百规热领七海口东导器压志世金增争济阶油思术极交受联什认六共权收证改清己美再采转更单风切打白教速花带安场身车例真务具万每目至达走积示议声报斗完类八离华名确才科张信马节话米整空元况今集温传土许步群广石记需段研界拉林律叫且究观越织装影算低持音众书布复容儿须际商非验连断深难近矿千周委素技备半办青省列习响约支般史感劳便团往酸历市克何除消构府称太准精值号率族维划选标写存候毛亲快效斯院查江型眼王按格养易置派层片始却专状育厂京识适属圆包火住调满县局照参红细引听该铁价严\";\n        char chastr = str.ToCharArray();\n        // string source ={ \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"#\", \"$\", \"%\", \"&amp;\", \"@\" };\n        string code = \"\";\n        Random rd = new Random();\n        int i;\n        for (i = 0; i &lt; num; i++)\n        {\n            //code += sourcerd.Next(0, source.Length);\n            code += str.Substring(rd.Next(0, str.Length), 1);\n        }\n        return code;\n\n    }\n\n    public bool IsReusable\n    {\n        get\n        {\n            return false;\n        }\n    }\n\n}\n</pre>\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/1671caee-6e7b-33f7-bbc4-e63fab6ea24a\">CheckCode.rar</a> (6.3 KB)</li>\n          \n          <li>下载次数: 49</li>\n        </ul>\n      \n    \n    \n  ',NULL,1186,'0101','ASP.NET',NULL,0),(876,'2009-10-21 15:52:38','利用javascript实现图片等比例缩放','\n    下面方法可以实现等比例缩放：\n<br />1． 把Image的Width和Height属性删除。\n<br />2.　把下面js代码复制在Image<span style=\"color: red\">后面</span>（注意：这里假设你的Image名称叫“Image1”如果不同请把它改过来，图片按等比例缩放成200×200）。\n<br /><pre name=\"code\" class=\"js\">\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt; \nfunction DrawImage() \n{ \n	var FitWidth = 200,FitHeight = 200;\n	var ImgD = document.getElementById(\'Image1\');\n	var image = new Image();\n	image.src=ImgD.src;\n	if(image.width&gt;0 &amp;&amp; image.height&gt;0) \n	{ \n		if(image.width/image.height&gt;= FitWidth/FitHeight) \n		{ \n			if(image.width&gt;FitWidth) \n			{ \n				ImgD.width=FitWidth; \n				ImgD.height=(image.height*FitWidth)/image.width; \n			} \n			else \n			{ \n				ImgD.width=image.width; \n				ImgD.height=image.height; \n			} \n		} \n		else \n		{ \n			if(image.height&gt;FitHeight) \n			{ \n				ImgD.height=FitHeight; \n				ImgD.width=(image.width*FitHeight)/image.height; \n			} \n			else \n			{ \n				ImgD.width=image.width; \n				ImgD.height=image.height; \n			} \n		} \n	} \n} \n\nDrawImage();\n&lt;/script&gt;\n</pre>\n<br />整个网页的源码如下：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /&gt;\n&lt;title&gt;图片等比例绽放&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;img src=\"Spring.jpg\" id=\"Image1\"/&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt; \nfunction DrawImage() \n{ \n	var FitWidth = 200,FitHeight = 200;\n	var ImgD = document.getElementById(\'Image1\');\n	var image = new Image();\n	image.src=ImgD.src;\n	if(image.width&gt;0 &amp;&amp; image.height&gt;0) \n	{ \n		if(image.width/image.height&gt;= FitWidth/FitHeight) \n		{ \n			if(image.width&gt;FitWidth) \n			{ \n				ImgD.width=FitWidth; \n				ImgD.height=(image.height*FitWidth)/image.width; \n			} \n			else \n			{ \n				ImgD.width=image.width; \n				ImgD.height=image.height; \n			} \n		} \n		else \n		{ \n			if(image.height&gt;FitHeight) \n			{ \n				ImgD.height=FitHeight; \n				ImgD.width=(image.width*FitHeight)/image.height; \n			} \n			else \n			{ \n				ImgD.width=image.width; \n				ImgD.height=image.height; \n			} \n		} \n	} \n} \n\nDrawImage();\n&lt;/script&gt;\n</pre>\n  ',NULL,752,'0105','javascript',NULL,0),(877,'2009-10-21 15:52:38','MSSQL中按照日期来搜索记录.','\n    &nbsp;&nbsp; 数据库中存储日期的字段类型为datetime类型的时候，在按照日期来查询的时候就有问题，不能是\n<br /><pre name=\"code\" class=\"sql\">where riqi like \'%2008-09%\'</pre>\n<br />\n<br />之类的来查询。。。必须得先把riqi列转化成字符串后方可查询，下面是按日期查询的例子：\n<br /><pre name=\"code\" class=\"sql\">\nselect * from orders\nwhere replace(CONVERT(char(10),OrderDate,111),\'/\',\'-\') like \'2008-09%\'\n</pre>\n<br />其中“111”参数是把日期转成形如“2008/09/12”　的样子，所以得用replace函数把/转成-\n<br />\n  ',NULL,761,'0106','SQL',NULL,0),(878,'2009-10-21 15:52:38','Repeater控件中点击按钮后获取某一行的数据！','\n    &nbsp;&nbsp; 其实和GridView差不多的，如果模板中是有按钮之类的可以设置CommandName值的，可直接在ItemCommand事件中获取CommandName或者CommandArgument，\n<br />\n<br />　　如果是模板中有文本框之类的，把文件框的AutoPostBack属性设置为True，然后在TextChanged事件中编写如下代码：\n<br /><pre name=\"code\" class=\"c#\">\nTextBox t = (TextBox)sender;\nRepeaterItem ri = (RepeaterItem)t.NamingContainer;\nstring itemid =((HiddenField)ri.FindControl(\"hdfItemId\")).Value;\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 形式和GridView一样，只需记住GridView是<span style=\"color: red\">GridViewRow</span>，而Repeater是<span style=\"color: blue\">RepeaterItem </span>　\n<br />\n  ',NULL,981,'0101','ASP.NET',NULL,0),(879,'2009-10-21 15:52:38','JS复制网页上的内容到剪切板','\n    <pre name=\"code\" class=\"js\">\n function copyToClipboard(txt) {\n     if(window.clipboardData) {\n       window.clipboardData.clearData();\n       window.clipboardData.setData(\"Text\", txt);\n       alert(\"Your request has been processed successfully.\");\n     } else if(navigator.userAgent.indexOf(\"Opera\") != -1) {\n      window.location = txt;\n     } else if (window.netscape) {\n      try {\n       netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\");\n      } catch (e) {\n       alert(\"被浏览器拒绝！&#92;n请在浏览器地址栏输入\'about:config\'并回车&#92;n然后将\'signed.applets.codebase_principal_support\'设置为\'true\'\");\n      }\n      var clip = Components.classes\'@mozilla.org/widget/clipboard;1\'.createInstance(Components.interfaces.nsIClipboard);\n      if (!clip)\n       return;\n      var trans = Components.classes\'@mozilla.org/widget/transferable;1\'.createInstance(Components.interfaces.nsITransferable);\n      if (!trans)\n       return;\n      trans.addDataFlavor(\'text/unicode\');\n      var str = new Object();\n      var len = new Object();\n      var str = Components.classes\"@mozilla.org/supports-string;1\".createInstance(Components.interfaces.nsISupportsString);\n      var copytext = txt;\n      str.data = copytext;\n      trans.setTransferData(\"text/unicode\",str,copytext.length*2);\n      var clipid = Components.interfaces.nsIClipboard;\n      if (!clip)\n       return false;\n      clip.setData(trans,null,clipid.kGlobalClipboard);\n      alert(\"Your request has been processed successfully.\");\n     }\n    }\n</pre>\n<br />\n<br />转自：http://blog.csdn.net/nileel/archive/2009/03/27/4029737.aspx\n  ',NULL,700,'0105','javascript',NULL,0),(880,'2009-10-21 15:52:38','ASP.NET生成随机密码','\n    【转贴】ASP.NET 中的随机密码生成 \n<br />\n<br />--------------------------------------------------------------------------------\n<br />ASP.NET 中的随机密码生成\n<br />在开发需要用户注册后才能使用提供的各项功能的应用程序时，在新用户提交注册信息后，较常见的做法是由程序生成随机密码，然后发送密码到用户注册时填写的电子信箱，用户再用收到的密码来激活其帐户。\n<br />　　在 ASP.NET 中，实现随机密码生成功能是很容易的，下面的代码给出了完整的实现方法：\n<br /><pre name=\"code\" class=\"C#\">\npublic static string MakePassword(string pwdchars, int pwdlen){\nstring tmpstr = \"\";\nint iRandNum;\nRandom rnd = new Random();\nfor(int i=0;i&lt;pwdlen;i++){\niRandNum = rnd.Next(pwdchars.Length);\ntmpstr += pwdcharsiRandNum;\n}\nreturn tmpstr;\n}\n</pre>\n<br />　　对照源码，讲一下具体的思路：\n<br />　　方法 MakePassword 接受两个参数，pwdchars 参数指定生成的随机密码串可以使用哪些字符，pwdlen 指定生成的随机密码串的长度。有了这两个参数，通过调用 Random 类的 Next() 方法，先获得一个大于或等于 0 而小于 pwdchars 长度的整数，以该数作为索引值，从可用字符串中随机取字符，以指定的密码长度为循环次数，依次连接取得的字符，最后即得到所需的随机密码串了。\n<br />　　下面的代码调用 MakePassword() 方法获取长度为 10 ，可用字符范围为大小写字母及数字的随机字符串。\n<br /><pre name=\"code\" class=\"C#\">\nstring randomchars = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nstring password = MakePassword(randomchars, 10);\n</pre>\n<br />\n<br />\n<br /> \n<br />\n  ',NULL,691,'0101','ASP.NET',NULL,0),(881,'2009-10-21 15:52:38','命令编写注册表文件修改注册表项','\n    命令编写注册表文件修改注册表项 \n<br />\n<br />命令编写注册表文件修改注册表项 \n<br />1、何谓REG文件\n<br />\n<br />　　REG文件实际上是一种注册表脚本文件，双击REG文件即可将其中的数据导入到注册表中。利用REG文件我们可以直接对注册表进行任何修改操作，它对注册表的操作可以不受注册表编辑器被禁用的限制，因此功能更为强大、灵活，另外，由于REG文件可以用任何文本文件编辑工具(例如记事本)进行修改，因此通过它对注册表数据进行修改后，如果发生错误，还可以通过改回REG文件中的数据后再导入，从而实现恢复操作，因此它又较之直接用注册表编辑器修改更安全，所以熟练掌握REG文件的运用，有时可以起到事半功倍、意想不到的效果。\n<br />2、创建REG文件\n<br />　　REG文件的创建是非常简单的，可以通过任何一个文本文件编辑工具来实现。我们就以创建一个可以解除注册表禁用限制的REG文件restore.reg为例来介绍一下具体过程。\n<br />　　打开记事本，在记事本文件中输入以下内容：\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_CURRENT_USER＼Software＼Microsoft＼Windows＼CurrentVersion＼Policies＼System\"DisableRegistryTools\"=dword : 00000000\n<br />　　保存此文件，在打开的“另存为”对话框中选择好保存路径，再单击“保存类型”中的下拉箭头选择“所有文件”(一定要选择此步，不然保存后的文件会自动加上TXT的扩展名)，然后在“文件名”中输入“restore.reg”后按“保存”按钮。以后你就可以通过双击这个restore.reg来直接解除禁用注册表的限制。\n<br />3、对REG文件进行修改\n<br />　　我们在利用REG文件对注册表进行操作时，要操作的对象有两种：一种是对主键进行操作，一种是对主键下的键值项目进行操作。对主键的操作有添加、删除两种，而对键值项目的操作则分为添加、修改和删除三种。下面我们就一个一个来实现。\n<br />　　1、对主键的操作\n<br />　　(1)添加主键\n<br />　　要想利用REG文件在注册表中添加一个主键是非常方便的，只需要在文件体部分直接以“ ”的形式写上要添加的主键路径即可。\n<br />　　例如：在HKEY_LOCAL_MACHINE＼Software主键下添加一个名称为“软件工作室”的主键，内容如下：\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_LOCAL_MACHINE＼Software＼软件工作室\n<br />\n<br />(2)删除主键\n<br />　　要用REG文件在注册表中删除一个主键，在文件体部分“ ”括起来的主键路径前面加上一个“-”符号即可，删除主键操作将会一并删除该主键下的所有子键及其键值项目，所以这是个比较危险的命令，使用要十分注意。例如要删除我们刚才添加的那个主键，内容如下：\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　-HKEY_LOCAL_MACHINE＼Software＼软件工作室\n<br />　　2、对键值项目的操作\n<br />　　(1)添加键值项目\n<br />　　添加键值项目的操作如同注册表编辑器中的“新建”命令，一般来说，键值的数据类型分为三种：字符串值、二进制值和DWORD值。在REG文件中我们也要设置添加的键值项目的数据类型，如果要添加字符串值，则“=”号后边要用英文的双引号引住数据；如果添加的为DWORD类型值，“=”号后边的格式为“dword:数据”；如果添加的为二进制值，“=”号后边则为“hex:数据”。要设置默认值的键值数据时，“=”号前边的键值名称应为“@”符号，并且没有双引号。\n<br />　　例如我们要在“HKEY_LOCAL_MACHINE＼Software＼软件工作室”主键下设置默认键值为“工作室”，并分别添加“姓名”键值项目(字符串值)、“年龄”键值项目(二进制值)、“婚否”键值项目(DWORD值)。相应的REG文件内容如下：\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_LOCAL_MACHINE＼Software＼软件工作室\n<br />　　@=\"工作室\"\n<br />　　\"姓名\"=\"徐徐徐\"\n<br />　　\"年龄\"=hex:23\n<br />　　\"婚否\"=dword:00000000\n<br />　　在添加键值项目时，如果该键值所在的主键路径不存在的话，在添加键值项目的同时会自动新建该主键。另外在添加字符串值的键值项目时还有一点值得注意的地方，当这个字符串值是包括文件路径的字符串值时，路径分隔符应用“＼＼”双斜杠表示，以示和注册表中的主键路径分隔符区别开来。例如我们要在注册中“HKEY_LOCAL_MACHINE＼Software＼Microsoft＼Windows＼CurrentVersion＼\n<br />　　Run”主键下的启动组中添加位于“C:＼PROGRAM FILES＼BOOBSOFT＼屏幕保护控制器”目录下的一个应用程序“屏幕保护控制器.exe”的启动键值项目，REG文件内容如下：\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_LOCAL_MACHINE＼Software＼Microsoft＼Windows＼CurrentVersion＼Run\n<br />　　\"scr\"=\"C:＼＼PROGRAM ILES＼＼BOOBSOFT＼＼屏幕保护控制器＼＼屏幕保护控制器.exe\"\n<br />　　(2)修改键值项目\n<br />　　其实修改和添加很类似，对于已经存在的键值项目，我们要修改其数据时，只需要将正确的数据赋予对应的键值项目即可，新的数据会自动覆盖错误的旧数据，例如，当某些恶意网页修改了你的IE标题栏文字，在标题栏中总是显示那个网站的广告文字，很讨厌，我们知道修改IE标题栏文字是通过“HKEY_CURRENT_USER＼Software＼\n<br />　　Microsoft＼Internet Explorer＼Main”主键下的“Window Title”键值的数据进行设置的，那么我们就可以通过REG文件改回默认的IE标题栏文字。\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_CURRENT_USER＼Software＼Microsoft＼Internet Explorer＼Main\n<br />　　\"Window Title\"=\"\"\n<br />　　(3)删除键值项目\n<br />　　用REG文件删除键值项目也是很方便的，和删除主键相类似，也是通过“=”号实现的，不过这次不是加在前面，而是把“-”符号放在键值项目的等号后面。例如一些恶意网页在修改IE标题栏等设置的同时，还修改了开始菜单相关的键值项目数据，使得开始菜单中的“运行”、“查找”、“关闭”等命令都不见了，导入下面的这个REG文件删除相应的键值项目后就可以找回开始菜单中的这些命令了。\n<br />　　REGEDIT4\n<br />　　空一行\n<br />　　HKEY_CURRENT_USER＼Software＼Microsoft＼Windows＼CurrentVersion＼Policies＼Explorer \n<br />　　\"NoRun\"=-(解除“运行”命令)\n<br />　　\"NoClose\"=-(找回“关闭系统”命令)\n<br />　　\"NoFind\"=-(找回“查找”命令)\n<br />\n<br />4、将REG文件中的数据导入到注册表中\n<br />导入信息\n<br />　　当我们双击REG文件时，系统会首先提示“确实要把XXX.REG内的信息添加到注册表吗？”的询问对话框，单击“是”按钮，系统就会按照REG文件中所描述的操作对注册表进行修改，完成以后并会给出提示“XXX.REG中的信息已经成功输入注册表”，把REG文件中的信息导入注册表的操作称为“合并”。\n<br />　　修改默认值\n<br />　　在REG文件上单击鼠标右键，有三个命令是关于REG文件的：合并、Print、编辑，以粗体显示的就是“合并”操作，这也是默认的打开方式，也就是双击时执行的操作。如果你不想让双击REG文件时执行“合并”的操作，你可以更改它的默认打开方式为“编辑”。打开资源管理器，单击“查看”菜单中的“文件夹选项”命令，在打开的对话框中单击“文件类型”标签，然后在“已注册的文件类型”列表中找到并选中“注册表项目”，从下面的“打开方式”我们也可以看出：原来REG文件默认的“合并”操作关联的是注册表编辑器Regedit呀!接下来点击“编辑”按钮，打开“编辑文件类型”对话框，然后选择“操作”列表中的“编辑”，再点击“设为默认值”按钮即可，以后双击REG文件时就会用记事本来打开进行编辑。\n<br />　　在这里笔者顺便告诉大家一个独门绝技，如果你希望REG文件在导入时没有任何提示，你可以在图4所示的对话框中选中“合并”，然后单击“编辑”按钮，在弹出对话框的命令行中输入“regedit.exe /s \"%1\"”即可，这是使用了注册表编辑器Regedit的一个被称为安静导入模式的隐藏参数“/S”，在导入REG文件时如果加上“/S”参数，系统就不会再弹出任何提示对话框而直接导入了。\n<br />\n<br />　　解除禁用\n<br />　　有时在某些电脑中设置了禁用注册表编辑器后，为了防止一些电脑高手使用REG文件，来解除对注册表编辑器的限制，会让REG文件的默认打开程序设置为其他无关程序，当然这时可以通过修改“文件夹选项”中的相关设置改回来，但还有一种更绝的办法可以使REG文件不能用系统默认的方式打开。\n<br />　　运行注册表编辑器，将“HKEY_CLASSES_ROOT.reg”下的默认值改为“txtfile”，这时REG文件的打开方式都指向了TXT文本文件。这样更改后不知道的人即使修改“文件夹类型”中的“注册表项目”设置也无法改回来，当然这时系统也已经禁用了注册表编辑器，你是无法通过注册表编辑器修改了。但经过笔者的研究发现还有一种方法可以破解这种禁用REG文件。我们可以在编辑好的REG文件上按住“Shift”键的同时单击鼠标右键，这时系统会让你重新选择打开方式，从中选取用注册表编辑器Regedit打开就可以将REG文件导入注册表\n<br />\n<br />\n<br />摘录自：http://www.cnblogs.com/liweibird/articles/1114694.html\n  ',NULL,600,'0103','随笔',NULL,0),(882,'2009-10-21 15:52:38','ASP.NET中移除全部缓存','\n    <pre name=\"code\" class=\"c#\">\n            IDictionaryEnumerator CacheEnum = HttpRuntime.Cache.GetEnumerator();\n            while (CacheEnum.MoveNext())\n            {\n                Cache.Remove(CacheEnum.Key.ToString());\n            }\n\n            Response.Write(\"缓存移除完毕！\");\n</pre>\n  ',NULL,674,'0101','ASP.NET',NULL,0),(883,'2009-10-21 15:52:38','sql跨数据库查询','\n    数据库1：AAA\n<br />数据库2：BBB\n<br />\n<br />数据库名和表名之间放两个点\n<br />\n<br /><pre name=\"code\" class=\"sql\">\nselect * from AAA..TableA a \ninner join BBB..TableB b on a.AcountID = b.ClientID\n</pre>\n<br />\n<br />注意：必须是单个Sql实例！ \n<br />\n  ',NULL,761,'0106','SQL',NULL,0),(884,'2009-10-21 15:52:38','CMD命令更改IP地址','\n    CMD命令更改IP地址三招\n<br />CMD命令更改IP地址三招：\n<br />第一招：批处理\n<br />我们知道在命令行下用netsh命令更改IP的步骤是：\n<br />1。在运行栏裡输入cmd打开命令提示符\n<br />2。输入netsh 回车\n<br />3。输入int ip 回车\n<br />4。输入set address name=\"本地连接\" source=\"static\" addr=ip mask=255.255.255.0 Gateway 1\n<br />解释一下：\n<br />set address 是更改IP的命令\n<br />name = 你要更改IP的连接名称\n<br />source = 设置成静态的IP\n<br />addr = 要更改成的IP\n<br />mask=子网掩码\n<br />gateway是你的网关IP，后面的1是到达网关的跃点数\n<br />等待几秒鐘会出现一个”确定“的信息，表示你的IP已经更改成功了，不信用ipconfig /all检验一下。\n<br />知道了命令的用户我们就可以把它写成批处理如下：\n<br />@ echo off\n<br />echo This Programe will change your Ipaddress and Gateway.\n<br />echo Press any key to continue\n<br />pause &gt;nul\n<br />rem 设置变量\n<br />set Nic=本地连接 \n<br />rem //可以根据你的需要更改,\n<br />set Add=202.96.134.9 \n<br />rem //可以根据你的需要更改\n<br />set Gat=202.96.134.60\n<br />netsh interface ip set address name=%Nic% source=static addr=%add% mask=255.255.255.0 %Gat% 1\n<br />rem //顺便把DNS也改掉\n<br />netsh interface ip set dns name=%Nic% source=static addr=%add% primary\n<br />echo OK!\n<br />注：把上面代码复制到空白的记事本裡，把“Nic=、Add= Gat=”更改成你自己的值然后另存為*.bat即可\n<br />\n  ',NULL,592,'0103','随笔',NULL,0),(885,'2009-10-21 15:52:38','ps调整倾斜图案水平简便方法','\n    用photoshop打开需要调整水平的图，点击“测量工具”－－－在图案上找应该是水平或垂直的参考线－－－测量工具随参考线拉线，点“图像”－－“旋转画布”－－“任意角度”，点击“确定”，完成。\n<br />\n<br />&nbsp; 此方法只能对单独一幅图做调整，如果设计版面上有多幅图需要做水平调整，需要另建新的文件，把图调整后拖入设计版面。如果在设计版面上做调整，多幅图会随同一起改变角度。\n<br />\n<br />摘录自：http://gengnongyishuzaixian.blog.hexun.com/32051026_d.html\n  ',NULL,568,'0103','随笔',NULL,0),(865,'2009-10-21 15:52:37','解决Opera的本地化字体显示问题!','\n    &nbsp;&nbsp;&nbsp; 因为黄金的存储量少,所以价值高, Opera的市场占有率蛮低, 想必也应该蛮好的吧!\n<br />上官网下载Opera的国际化版,安装之后打开来看,字体渲染一它糊涂,如下图:\n<br /><img src=\"http://taotao.wsyren.com/bbspic/opera/01.jpg\" />\n<br />&nbsp;&nbsp;&nbsp; 经多方查证和搜索,现得出如下解决方法:\n<br /><span style=\"color: blue\">首选项-高级-字体。修改浏览器菜单、浏览器工具栏、对话框、面板、工具提示、普通文字为宋体好了<img src=\"/images/smiles/icon_smile.gif\"/>,最小字体大小设置为 12 就ok了。（当然你也可以修改为其他字体）。</span>\n<br /><img src=\"http://taotao.wsyren.com/bbspic/opera/02.jpg\" />\n  ',NULL,680,'0103','随笔',NULL,0),(866,'2009-10-21 15:52:37','符合WEB标准的浮动层（jQuery版）！','&nbsp;&nbsp; &nbsp;网上有好多的浮动层之类的代码，所谓的浮动层，就是层里的内容会随着页面的滚动而滚动，很多网站上都有的“QQ在线服务”就是个很好的例子，目前本人工作的这个网站中也需要用到了“QQ在线服务”，于是自己从网上下载了N多源码，这些源码运行起来是没有问题的，可是当我把其中的一些重要代码粘贴到vs中新建的ASPX页面的时候，运行ASPX页面的时候就不能随着页面的滚动而滚动了。 <br />\n&nbsp;&nbsp; &nbsp;仔细对比ASPX页面代码和他的源码后发现，原来问题出现在DOCTYPE定义上，那些源码N多都是没有定义到DOCTYPE的，而新建的每个一ASPX页面都会有如下DOCTYPE定义：<br />\n html<br />\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n/html<br />\n&nbsp;&nbsp; &nbsp;网上搜索后发现，这是目前很多网页都采用的标准，正好自己目前又在学习JQUERY，就想自己写一个符合WEB标准的浮动出来，首先研究一下之前下载的那些源码，找到浮动层的编写思路： 层可以随着页面滚动而滚动，说明肯定是脱离了标准流的，所以在层的CSS定义中以下的这句代码肯定少不了：<br />\ncss<br />\nposition:absolute;<br />\n/css<br />\n&nbsp;&nbsp; &nbsp;紧接着，因为是上下移动，所以就是要改变层的CSS样式中的top属性，注意是小写的，如果在代码中写大写的话那是会出错的，因为要符合“标准”... <br />\n&nbsp;&nbsp; &nbsp;那我们又如何改变top属性呢？在每回页面滚动的时候，都会有一个滚动的高度，也就是scrollTop，我们就可以在每回页面滚动的时候把我们原来层的top+滚动的高度，这样也就成了。 <br />\n接下来问题又来了，scrollTop的获取IE和非IE的又有不同，经搜索得知，可用如下代码获取scrollTop： <br />\njs<br />\n<div>&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var bodyTop = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (typeof window.pageYOffset != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = window.pageYOffset;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else if (typeof document.compatMode != &#039;undefined&#039; &amp;&amp; document.compatMode != &#039;BackCompat&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.documentElement.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (typeof document.body != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.body.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/js<br />\n&nbsp;&nbsp; &nbsp;经过上面的分析我们知道，只要在每回页面滚动的时候都重新设置层的top属性即可。下面是我用自己写的源码： <br />\nc#<br />\n<div>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"qqonline.aspx.cs\" Inherits=\"qqonline\" %&gt;</div>\n<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div><br />\n</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;浮动广告&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;style type=\"text/css\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;#qqonline{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color:Yellow;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border: 1px solid #fcc;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;position:absolute;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top:250px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left:16px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width:200px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height:120px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/style&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"jquery-1.2.6.pack.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(window).scroll(function() { &nbsp; &nbsp;// 页面发生scroll事件时触发</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var bodyTop = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (typeof window.pageYOffset != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = window.pageYOffset;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else if (typeof document.compatMode != &#039;undefined&#039; &amp;&amp; document.compatMode != &#039;BackCompat&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.documentElement.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (typeof document.body != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.body.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#qqonline\").css(\"top\", 250 + bodyTop) &nbsp; // 设置层的CSS样式中的top属性, 注意要是小写，要符合“标准”</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#qqonline\").text(bodyTop); &nbsp; // 设置层的内容，这里只是显示当前的scrollTop</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;});&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/script&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body style=\"height:1800px\"&gt;&lt;!-- 给BODY加个样式，让页面出现滚动条 --&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;form id=\"form1\" runat=\"server\"&gt; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/form&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"qqonline\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;QQ在线服务</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/c#<br />\n&nbsp;&nbsp; &nbsp;因为新建立的是ASPX页面，所以开头有&lt;%@那句，不过在后置代码里是什么都没有写。 <br />\n&nbsp;&nbsp; &nbsp;最后运行页面，即可看到，随着页面滚动的滚动，层总是保持在同一个地方。 <br />\n以上代码经测试，IE6,IE7,IE8 b2，FF,OPERA,插肉咪（chrome）浏览器都能正确的显示，而且页面还符合“标准”。<br />\nquote<br />\n<font class=\"Apple-style-span\" face=\"Arial, sans-serif, Helvetica, Tahoma\"># if (typeof window.pageYOffset != &#039;undefined&#039;) {&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bodyTop = window.pageYOffset;&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (typeof document.compatMode != &#039;undefined&#039; &amp;&amp; document.compatMode != &#039;BackCompat&#039;) {&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bodyTop = document.documentElement.scrollTop;&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (typeof document.body != &#039;undefined&#039;) {&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bodyTop = document.body.scrollTop;&nbsp;&nbsp;<br />\n#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br />\n其实这一大串代码在jQuery中有一行代码可以代替，那就是<br />\nvar bodyTop = $(document).scrollTop();<br />\n经测试，如果是写成$(window).scrollTop()的话则在IE系列下是没有值的，万恶的jQuery API竟然没有scrollTop().<br />\n</font>/quote<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n<br />\n',NULL,1197,'0110','jQuery',NULL,0),(867,'2009-10-21 15:52:37','javascript检测浏览器和操作系统','\n    从《精通JavaScript+jQuery》上摘录的代码，蛮有用的，先记下来了。\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;检测浏览器和操作系统&lt;/title&gt;\n&lt;script language=\"javascript\"&gt;\nvar sUserAgent = navigator.userAgent;\n//检测Opera、KHTML\nvar isOpera = sUserAgent.indexOf(\"Opera\") &gt; -1;\nvar isKHTML = sUserAgent.indexOf(\"KHTML\") &gt; -1 || sUserAgent.indexOf(\"Konqueror\") &gt; -1 || sUserAgent.indexOf(\"AppleWebKit\") &gt; -1;\n//检测IE、Mozilla\nvar isIE = sUserAgent.indexOf(\"compatible\") &gt; -1 &amp;&amp; sUserAgent.indexOf(\"MSIE\") &gt; -1 &amp;&amp; !isOpera;\nvar isMoz = sUserAgent.indexOf(\"Gecko\") &gt; -1 &amp;&amp; !isKHTML;\n//检测操作系统\nvar isWin = (navigator.platform == \"Win32\") || (navigator.platform == \"Windows\");\nvar isMac = (navigator.platform == \"Mac68K\") || (navigator.platform == \"MacPPC\") || (navigator.platform == \"Macintosh\");\nvar isUnix = (navigator.platform == \"X11\") &amp;&amp; !isWin &amp;&amp; !isMac;\nif(isOpera) document.write(\"当前浏览器是：Opera \");\nif(isKHTML) document.write(\"当前浏览器是：KHTML \");\nif(isIE) document.write(\"当前浏览器是：IE \");\nif(isMoz) document.write(\"当前浏览器是：Mozilla \");\nif(isWin) document.write(\"当前操作系统是：Windows\");\nif(isMac) document.write(\"当前操作系统是：Mac\");\nif(isUnix) document.write(\"当前操作系统是：Unix\");\n&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />说明一下，Opera 、IE 、Mozilla 是什么浏览器就不用说了，那个KHTML 的话，经测试，谷歌的“插肉咪”(Chrome)属于这一类的浏览器。\n<br />\n  ',NULL,725,'0105','javascript',NULL,0),(868,'2009-10-21 15:52:37','在.NET中使用正则表达式对太平洋产品参数进行分析！','\n    目前在做的项目是一个类似于太平洋的产品报价系统（其实说白了就是一个仿太平洋的网站，产品数据全是摘录自太平洋），产品的参数分参数分类（主要参数、性能参数...），参数名称（型号、芯片组、CPU接口...）,数据库里已经录好了产品的参数分类及参数名称，目前正在对着太平洋的产品库进行产品的参数录入，之前都是复制一个参数值了再粘贴到我们的网站里然后点击确定了进行参数录入的，某天觉得这种方法蛮麻烦，几万种产品的要录参数到什么时候啊，于是自己看了下太平洋的产品参数，如下图：\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23789/d85c77f0-df6a-37b4-8fe4-c29461921466.jpg\" />\n<br />好像没发觉什么特别的地方，然后自己如下图的方式一次性把参数全复制了粘贴到记事本里，\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23787/035cbf06-d51d-3e82-a472-6678b4108920.jpg\" />\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23785/29e02c32-bf88-31ec-868e-2e3c1874e08b.jpg\" />\n<br />呵呵，发觉什么了没，每条参数名称和参数值占一行，而且他们之间都是用空格格开的，（大部分是），这样的话我们可以通过一些字符串的处理，以空格为分界符把参数名称和参数值拆开，这样就得到最后我们所要的结果了，就能批量的把参数值插入到数据库里了。\n<br />试了一下用普通的字符串处理，觉得蛮麻烦的，于是就想到了正则表达式，也正好借此机会试试.NET中如何使用正则表达式吧，先把正则表达式写出来吧。最近从网上无意中找到的一个验证正则表达式的好软件（RegexBuddy），个人觉得蛮好用的，打开后界面如下：\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23791/685ee524-646d-3c26-a8db-21a6f103fe39.jpg\" />\n<br />注意画圈圈的那三个按钮，分配是 匹配、替换、分割，我们要用到的是替换按钮\n<br />点击Replace 和 Test 按钮，然后输入正则表达式及粘贴复制出来的参数名称及参数值，瑞在Test按钮上面那个框框里输入 $1 → $2 ,如下图：\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23803/def11fe1-35a6-3efa-b045-9206dc51054e.jpg\" />\n<br />熟悉正则的朋友应该知道，(.+) (.+)匹配 1个以上的任意字符后有个空格，空格之后再有1个以上的任意字符，加上括号是给匹配的结果进行分组$1和$2就表示第一组和第二组，下面的测试参数会变色就说明匹配我们写的正则表达式，每个匹配的结果用不同的颜色相隔表示，上面表示每一行都匹配我们写的正则表达式，然后我们如下图按下那个按钮，\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23801/9a9bb941-1515-30df-8413-73164153a29e.jpg\" />\n<br />得到下图结果\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23797/8b7dd9a6-3864-35b6-9293-c338f6c6b9d3.jpg\" />\n<br />大家看到什么了，匹配出来了吧，不过有点不对劲，我们要的是把第一个空格之前的分为第一组，而匹配的结果却是把最后一个空格之前的分为第一组了，这就是正则表达式<span style=\"color: blue\">贪婪匹配与懒惰匹配</span>的区别，下图是我改了正则表达式之后匹配的结果，注意我把 PCI Express插槽 改成 PCI-Express插槽 ，把空格换成一个减号，这样才不至于替换后的结果是PCI → *****。\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23807/e55e4b58-4522-3fd1-9d96-7a441fcc3cf9.jpg\" />\n<br />这样就得到了我们想要的结果，至于那个 PCI-Express插槽 ，我能想到的方法也只能是在更新数据库的时候判断一下，如果参数名称是 PCI-Express插槽 ，则更新数据库中 字段为 PCI Express插槽 的参数值。\n<br />既然正则表达式写出来了，那下面就来做ASPX页面的代码编写，在这里我只是把分析出的结果输出到界面上，新建ASPX页面，拉入一个文本框，一个按钮，一个标签，如图：\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23811/d86bf579-062d-3cf8-be7c-64e09f14713d.jpg\" />\n<br />然后ASPX.CS的源码如下：\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Text.RegularExpressions;  // 要使用正则表达式得导入此包\n\npublic partial class regTest : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    // 分析参数\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        Label1.Text = \"\";\n        string str = TextBox1.Text;\n        // 建立正则对象，可以加些杂七杂八的参数，如忽略大小写之类的\n        // 在这里我没加，想知道如何加的自己去;OGLE\n        Regex reg = new Regex(@\"(.+?) (.+)\");\n        // 匹配，把结果放在MatchCollection集合里\n        MatchCollection mc = reg.Matches(str);\n        // 遍历集合，取出分组，即参数名称和参数值\n        foreach (Match m in mc)\n        {\n            Label1.Text += m.Groups1.Value + \" → \" + m.Groups2.Value + \"&lt;br /&gt;\";\n        }\n    }\n}\n</pre>\n<br />最后再预览页面，测试一下就得到分析出的结果了。\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23813/b7b968f9-03f6-34ca-a70f-74988ed26590.jpg\" />\n<br />最后就是把分析出的结果与数据库中已经有的参数名称想比较，相同的就插入相应的参数值，只要注意一个那个 PCI EXPRESS插槽 的问题就行了。\n<br />发个图文并茂的贴子还真难啊，足足弄了2个半小时，真是个消磨时间的好方法！！！\n<br />以前装了个动易的CMS，发现里面有个“采集”的功能，好像是个自动收集新闻的玩意吧，不知道能不能“采集”到太平洋上的产品参数和对应的值，那样的话就太爽啦。。\n<br />现在我的这方法只是复制参数后进行字符串的拆分处理之类的，之前还得先找到相应的产品的，要是能自动采集产品的相关信息那就爽啦。。呵呵 。。\n<br />源码传上来给大家。。\n<br />此外本人有《精通正则表达式》和《实战正则表达式》两部视频，《精通》用的是JAVA语言来讲正则，《实战》用的是C#来讲正则，有需要的朋友可发邮件到164423073@qq.com索取，也可索取那个RegexBuddy的软件，个人觉得这软件太有用啦。。。<img src=\"/images/smiles/icon_biggrin.gif\"/>&nbsp;<img src=\"/images/smiles/icon_biggrin.gif\"/>&nbsp;<img src=\"/images/smiles/icon_biggrin.gif\"/> \n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/33e5a750-105e-3ae6-9b1b-4f497c567ee2\">niunantest.rar</a> (1.2 KB)</li>\n          \n          <li>下载次数: 2</li>\n        </ul>\n      \n    \n    \n  </div>\n\n\n  \n\n  \n  <div id=\"digg_bottom\" class=\"clearfix\"><a href=\'#\' onclick=\'digg(\"blogs\", 257628, false);return false;\'><div><strong>0</strong> <br/>顶</div></a><a href=\'#\' onclick=\'digg(\"blogs\", 257628, true);return false;\'><div><strong>0</strong> <br/>踩</div></a>',NULL,636,'0101','ASP.NET',NULL,0),(869,'2009-10-21 15:52:37','去医院验光了，呵呵，视力没我想的高！！！','\n    好久不去吃那清真寺的牛肉粉了，今天趁着休息去吃了一顿，哦哦哦~~~真好吃，嘿嘿，然后又跟去医院的视光中心那去验光，检测的结果是左眼550度，右眼575度，嘿嘿，没我想像的高嘛，我目前的这眼镜是四年前配的了，那时是左眼500度，右眼550度，没想到经过四年的通宵网游，才增加了那么点，嘿嘿。看来以后更可以无所顾忌了。。。\n  ',NULL,662,'0103','随笔',NULL,0),(870,'2009-10-21 15:52:37','在命令行的模式下启动及停止sqlexpress服务!','\n    &nbsp;&nbsp;&nbsp; 习惯了使用net start及net stop 来启动及停止服务的,装了SQL 2005 EXPRESS版本之后发现,以前的net start mssqlserver和net stop mssqlserver命令来启动和停止服务已经不行了,每回启动/停止05的服务总是得先services.msc后再慢慢找...\n<br />&nbsp;&nbsp;&nbsp; 上网搜索了一下,发现启动/停止SQL 2005 EXPRESS服务的命令是\n<br />net start mssql$sqlexpress\n<br />和\n<br />net stop mssql$sqlexpress\n<br />\n<br />&nbsp;&nbsp;&nbsp; 特此记录,以免忘记!\n  ',NULL,747,'0106','SQL',NULL,0),(871,'2009-10-21 15:52:37','.NET用使用存储过程获取输出参数的代码示例!','    &nbsp;&nbsp;&nbsp; 在网上也找到许多关于.NET中使用存储过程获取输出参数的代码,但怎么看怎么都是记不住,还是自己亲自实践一遍后再记录下来,这样才能记得住,必竟自己做过的东西是比较难忘记的!!!<br />\n&nbsp;&nbsp;&nbsp; 步骤如下:<br />\n&nbsp;&nbsp;&nbsp; ①建立数据库logintest,在数据库中建立表User.<br />\n<img src=\"http://niunan.net/bbspic/netproc.jpg\" /><br />\n&nbsp;&nbsp;&nbsp;&nbsp; 向建立的表中添加几条测试数据.<br />\n ②在数据库中建立存储过程: <br />\nsqlUSE logintest<br />\n;<br />\n-- =============================================<br />\n-- Author:		牛腩<br />\n-- Create date: 2008-10-21 14:01<br />\n-- Description:	通过传入的uid获取用户姓名<br />\n-- =============================================<br />\nSET ANSI_NULLS ON<br />\n;<br />\nSET QUOTED_IDENTIFIER ON<br />\n;<br />\nCREATE PROCEDURE dbo.GetUNameById<br />\n@uid int,<br />\n@name varchar(50) output<br />\nAS<br />\nBEGIN<br />\n	select @name=uname from User where uid=@uid<br />\nEND<br />\n/sql<br />\n<br />\n③在VS中建立一个测试页面ProcTest.aspx,在ProcTest.aspx.cs中导入命名空间 <br />\nc#using System.Data;<br />\n<div>using System.Data.SqlClient;</div>\n/c#<br />\n<br />\n    ④在Page_Load方法里写入如下代码: <br />\nc#&nbsp;// 建立连接字符串,在正式项目中可放在web.config中<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string connStr = \"server=niunan\\\\sqlexpress;uid=sa;pwd=123456;database=logintest\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 连接数据库</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;SqlConnection conn = new SqlConnection(connStr);</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 打开数据库连接</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Open();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 创建用于执行数据库操作的命令对象, GetUNameById为存储过程名称</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SqlCommand cmd = new SqlCommand(\"GetUNameById\", conn);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 设置执行命令的方式为存储过程</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.CommandType = CommandType.StoredProcedure;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 向命令对象添加存储过程所需要的参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(\"@uid\", SqlDbType.Int);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 设置要传入到存储过程的参数值</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters\"@uid\".Value = 2;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 添加存储过程中的输出参数,如果是字符型的必须定义长度</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters.Add(\"@name\", SqlDbType.VarChar, 50);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 设置参数为output输出参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.Parameters\"@name\".Direction = ParameterDirection.Output;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 执行存储过程</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmd.ExecuteReader();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 获取执行存储过程后的输出参数</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string name = cmd.Parameters\"@name\".Value.ToString();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(name);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Response.Write(ex.Message);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;finally</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (conn.State == ConnectionState.Open)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conn.Close();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;</div>\n/c#<br />\n  运行ASPX页面,则能够看到执行存储过程后返回的结果! <br />\n    <span style=\"color:#f10b00;\">需要注意的是如果输出参数是varchar类型的话则必须定义长度,否则会出错,如果输出参数是数字型的话就不必定义长度了! </span><br />\n<br />\n<br />\n	                          	                          ',NULL,923,'0101','ASP.NET',NULL,0),(872,'2009-10-21 15:52:37','生平第一次买彩票中大奖，特开此贴，以此留念！','\n    &nbsp;&nbsp; 买双色球头一回中奖，￥5.00，乃生平买彩票最高中奖金额，特开此贴，以此留念！\n  ',NULL,632,'0103','随笔',NULL,0),(873,'2009-10-21 15:52:37','JavaScript访问同一个页面中的不同iframe的内容！','\n    &nbsp;&nbsp;&nbsp; 比较大一点的WEB项目一般页面都会用到iframe，这样如何访问各个iframe的内容就显得比较重要，比如登陆页放在一个iframe中，而登陆状态显示页又放在同一个页面的另一个iframe中，那样的话在登陆的时候就得刷新另一个iframe中的登陆状态显示页，经本人一晚上;OGLE+亲测，得如下代码，可通过javascript来访问或刷新同一个页面中不同iframe中的内容。\n<br />&nbsp;&nbsp;&nbsp; 本样例共3个测试文件：index.html, ye1.html, ye2.html&nbsp;&nbsp; 各个文件源码如下：\n<br />index.html:\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /&gt;\n&lt;title&gt;JS框架测试&lt;/title&gt;\n&lt;/head&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nfunction fun()\n{\n    window.frames\"ye1\".document.getElementById(\"con1\").innerHTML = \"aaa\";  // 设置子窗体中的内容\n//	window.frames\"ye1\".location.reload();    // 刷新子窗体\n}\n&lt;/script&gt;\n&lt;body&gt;\n&lt;p&gt;\n&lt;iframe src=\"ye1.html\" name=\"ye1\" width=\"200\" height=\"120\" scrolling=\"auto\"&gt;&lt;/iframe&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;iframe src=\"ye2.html\" name=\"ye2\" width=\"300\" height=\"120\" scrolling=\"auto\"&gt;&lt;/iframe&gt;\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;input type=\"button\" name=\"Submit\" value=\"改变frm1的内容\" onclick=\"fun()\" /&gt;\n&lt;/p&gt;\n&lt;div id=\"main\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />ye1.html:\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /&gt;\n&lt;title&gt;页面一&lt;/title&gt;\n&lt;script&gt;\n	var i = Math.random();\n	document.write(i);\n&lt;/script&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;p&gt;页面一&lt;/p&gt;\n&lt;div id=\"con1\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />ye1里加上一段javascript是为了方便在测试刷新的时候能看到效果，即每回刷新都随机生成一个数.\n<br />ye2.html\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /&gt;\n&lt;title&gt;页面一&lt;/title&gt;\n&lt;/head&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nfunction fun()\n{\n	// window.parent.document.getElementById(\"main\").innerHTML = \"哎呀\";   // 设置父窗体内的内容\n	// window.parent.frames\"ye1\".location.reload();   // 刷新父窗体中的另一個子窗體\n	window.parent.frames\"ye1\".document.getElementById(\"con1\").innerHTML = \"bbb\";  // 设置父窗体中的另一个子窗体的内容\n}\n&lt;/script&gt;\n&lt;body&gt;\n&lt;p&gt;页面二&lt;/p&gt;\n&lt;p&gt;\n  &lt;input type=\"button\" name=\"Submit\" value=\"改变页面内容\"  onclick=\"fun()\"/&gt;\n&lt;/p&gt;\n&lt;div id=\"con2\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 运行index.html点击按钮即可看到效果，以上代码解决如下问题：\n<br />&nbsp;&nbsp;&nbsp; ① 父窗体访问或刷新子窗体\n<br />&nbsp;&nbsp;&nbsp; ② 子窗体访问或刷新父窗体\n<br />&nbsp;&nbsp;&nbsp; ③ 同一个父窗体中的两个子窗体之间的相互访问或刷新\n<br />代码经测试在IE5.5, IE6, IE7, IE8 Beta 2, FireFox, Opera, Chrome浏览器上测试通过！\n  ',NULL,883,'0105','javascript',NULL,0),(874,'2009-10-21 15:52:37','AJAX五步使用法及中文乱码处理！','\n    &nbsp;&nbsp;&nbsp; 也是从《AJAX技术入门》的视频上摘录的代码，觉得蛮有用滴，记下来了，以后要用到AJAX的直接在自己的博客上找就得了，省了;OGLE的时间，嘿嘿！\n<br />效果图如下：只是实现一个简单的用户名验证！\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/23327/8d9f3947-98b9-3cef-a6ce-cabda3fbfa35.jpg\" />\n<br />\n<br />程序使用ASP.NET实现！\n<br />Default.aspx页面源码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"Default.aspx.cs\" Inherits=\"_Default\" %&gt;\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;title&gt;AJAX五步使用法及中文乱码处理&lt;/title&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        var xmlhttp;\n\n        function submit() {\n            // 1.创建XMLHttpRequest对象\n            if (window.XMLHttpRequest) {\n                // IE7,IE8,FireFox,Mozilla,Safari,Opera\n                xmlhttp = new XMLHttpRequest();\n                if (xmlhttp.overrideMimeType) {\n                    xmlhttp.overrideMimeType(\"text/xml\");\n                }\n            } else if(window.ActiveXObject) {\n                // IE6,IE5.5,IE5\n                var activexName = \"MSXML2.XMLHTTP\",\"Miscrosoft.XMLHTTP\";\n                for (var i = 0; i &lt;activexName.length; i++) {\n                    try{\n                        xmlhttp = new ActiveXObject(activexNamei);\n                        break;\n                    } catch(e) {                        \n                    }\n                }\n            }\n            if (xmlhttp == undefined || xmlhttp == null) {\n                alert(\'当前浏览器不支持创建XMLHttpRequest对象，请更换浏览器\');\n                return;\n            }\n\n            //2.注册回调方法\n            xmlhttp.onreadystatechange = callback;\n            //错误的写法\n            //xmlhttp.onreadystatechange = callback();\n            \n            // 获取文本框中输入的内容，经过两次编码防止中文乱码\n            var userName = document.getElementById(\"UserName\").value;\n            userName = encodeURI(encodeURI(userName));\n            \n           \n            // GET方式交互\n            // 3.设置和服务器端交互的相应参数\n            xmlhttp.open(\"GET\",\"AJAXGB.ashx?name=\" + userName,true);\n            \n            // 4.设置向服务器端发送的数据，启动和服务器端的交互\n            xmlhttp.send(null);\n            \n           /*\n            // POST方式交互\n            // 3.设置和服务器端交互的相应参数\n            xmlhttp.open(\"POST\",\"AJAXGB.ashx\",true);\n            \n            // POST方式交互所需要增加的代码\n            xmlhttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n            \n            // 4.设置向服务器端发送的数据，启动和服务器端的交互\n            xmlhttp.send(\"name=\" + userName);\n            */\n        }\n        \n        function callback() {\n            // 5 .判断和服务器端的交互是否完成，还要判断服务器端是否正确返回了数据\n            if (xmlhttp.readyState == 4) {\n                // 表示和服务器端的交互已经完成\n                if (xmlhttp.status == 200) {\n                    // 表示服务器的响应代码是200，正确的返回了数据\n                    // 纯文本数据的接受方法\n                    var message = xmlhttp.responseText;\n                    // XML数据对应的DOM对象的接受方法\n                    // 使用的前提是，服务器端需要设置content-type为text/xml\n                    // var domXml = xmlhttp.responseXML;\n                    \n                    //向div标签中填充文本内容的方法\n                    var div = document.getElementById(\"message\");\n                    div.innerHTML = message;\n                }\n            }\n        }\n    &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n&lt;input type=\'text\' id=\'UserName\' value=\'牛腩\' /&gt;\n&lt;input type=\'button\' onclick=\'submit()\' value=\'校验用户名\' /&gt;\n&lt;br /&gt;\n&lt;div id=\"message\"&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />一般处理程序AJAXGB.ashx源码:\n<br /><pre name=\"code\" class=\"c#\">\n&lt;%@ WebHandler Language=\"C#\" Class=\"AJAXGB\" %&gt;\n\nusing System;\nusing System.Web;\n\npublic class AJAXGB : IHttpHandler {\n    \n    public void ProcessRequest (HttpContext context) {\n        context.Response.ContentType = \"text/plain\";\n        string old = context.Request\"name\";\n\n        if (string.IsNullOrEmpty(old))\n        {\n            context.Response.Write(\"用户名不能为空\");\n        }\n        else\n        {\n            string name = context.Server.UrlDecode(old);\n            if (name.Equals(\"牛腩\"))\n            {\n                context.Response.Write(\"用户名\" + name + \"已经存在，请使用其他用户名！\");\n            }\n            else\n            {\n                context.Response.Write(\"用户名\" + name + \"尚未存在，可以使用该用户名注册！\");\n            }\n        }\n        context.Response.End();\n    }\n \n    public bool IsReusable {\n        get {\n            return false;\n        }\n    }\n\n}\n</pre>\n  ',NULL,784,'0105','javascript',NULL,0),(855,'2009-10-21 15:52:36','开机自动联网！','\n    <div>    以前我的机器开机后要上网得先双击那“网络连接”后输入用户名和密码才能上网的，最近正用电驴下载松迪科技的Struts和Hibernate视频，呵呵，想让电脑一开机就自动开电驴和联网开始下载的，嘿嘿，上网查了下，发现原来也蛮简单的，步骤如下：</div>\n<div>    IE里的“工具”→“Intel选项”→“连接”，只要点选“始终拨默认连接”就行了，这样以后开机的时候就会自动的联网了，当然，之前的用户名和密码得设置为自动保存的，然后开机后自动联网了以后你不上网得20分钟左右的，他又会跳出一个“自动断线”的对话框，这时把那个“从不自动断线”框框勾选就可以了，嘿嘿！！！</div>\n<div>    下了二个月， 松迪科技的Struts和Hibernate视频快要下载完了，看了那个Struts入门那一部视频，感觉还不错，呵呵，等把青鸟的考试完了以后认真的学一下。。。。</div>\n  ',NULL,686,'0103','随笔',NULL,0),(856,'2009-10-21 15:52:36','.NET代码段生成器','    用于生成.NET里的代码段,其实在VS里新建XML里也有的....不过感觉用这个比较好吧..呵呵 ..<br />\n名字叫做: <span style=\"color:blue;\">Snippy</span><br />\n可直接到;OGLE上搜索下载即可',NULL,1058,'0104','下载',NULL,0),(857,'2009-10-21 15:52:36','存储过程代码生成器','    &nbsp;&nbsp;&nbsp; 自己在SQL2005上试过,能生成插入和更新的存储过程,蛮好玩的...<br />\n&nbsp;&nbsp;&nbsp; 名字叫做:<span style=\"color:blue;\">Stored Procedure Generator</span><br />\n&nbsp;&nbsp;&nbsp; 先记下来,省得以后要找的时候到处翻!<br />\n&nbsp;&nbsp; &nbsp;可直接到;ogle上搜索下载最新版的即可',NULL,988,'0104','下载',NULL,0),(858,'2009-10-21 15:52:36','如何判断电脑电源是否烧坏！不用替换的情况下！','\n    <p>有个办法能检测电源是不是烧了，方法如下：</p>\n<p> <br/>首断开电源，找一段能通电的导线（要细的那种，用网线或者回型针都可以），然后把电源从主板上拔出来，找到一根绿线跟一根黑线（绿线就一根，黑色线就很多，随便连一根黑的），把导线分别插进去（造成短路，直接接通电源，就跟你按了开机按钮的效果一样），最后接通电源，如果电源风扇没转，肯定就是电源烧了。因为输出只有12V，所以不必担心会触电 </p>\n  ',NULL,675,'0103','随笔',NULL,0),(859,'2009-10-21 15:52:36','鼠标点击一幅矩形图片,以矩形对角线为界算出是点了左边还是右边!','\n    &nbsp; 今天QQ交流群里有人问了这题,就是鼠标在一幅矩形图片上点击,以矩形的对角线为界,如何知道点击的是矩形的左半部分还是右半部分.想了一下,也跟群里人讨论了一下,如下图:\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/24021/3cd26219-e011-303b-8f74-ba10fed830df.jpg\" />\n<br />假设鼠标在矩形上任意点的一点的坐标是(95,130),那么只要计算对角线上的那一点(?,130),把?算出来了再比较与95的大小即可知道点击的是图片的左边还是右边!\n  ',NULL,806,'0103','随笔',NULL,0),(860,'2009-10-21 15:52:36','JAVA接收EMAIL','\n    下面是查看邮件信息列表的JAVA代码：\n<br /><pre name=\"code\" class=\"java\">\npackage showmailmsgm;\n\nimport javax.mail.Store;\nimport javax.mail.FetchProfile;\nimport java.util.Properties;\nimport javax.mail.Session;\nimport javax.mail.Folder;\nimport javax.mail.Message;\nimport javax.mail.internet.InternetAddress;\n\npublic class Semail {\n    public static void main(String args) {\n        try {\n\n            Properties props = new Properties();\n            Session s = Session.getInstance(props);\n            Store store = s.getStore(\"pop3\");\n            store.connect(\"pop.163.com\", \"bluebit_cn\", \"xiaohao\");\n\n            Folder folder = store.getFolder(\"Inbox\");\n            folder.open(Folder.READ_WRITE);\n\n            FetchProfile profile = new FetchProfile();\n            profile.add(FetchProfile.Item.ENVELOPE);\n            Message arraymessage = folder.getMessages();\n            folder.fetch(arraymessage, profile);\n\n            System.out.println(\"收件箱的邮件数：\" + arraymessage.length);\n            for (int i = 0; i &lt; arraymessage.length; i++) {\n                //邮件发送者\n                String from = arraymessagei.getFrom()0.toString();\n                InternetAddress ia = new InternetAddress(from);\n                System.out.println(\"FROM:\" + ia.getPersonal() + \'(\' +\n                                   ia.getAddress() + \')\');\n                //邮件标题\n                System.out.println(\"TITLE:\" + arraymessagei.getSubject());\n                //邮件大小\n                System.out.println(\"SIZE:\" + arraymessagei.getSize());\n                //邮件发送时间\n                System.out.println(\"DATE:\" + arraymessagei.getSentDate());\n            }\n\n            folder.close(false);\n            store.close();\n        } catch (Exception ee) {\n            ee.printStackTrace();\n        }\n    }\n}\n</pre>\n<br />\n<br />忘记了，再说一句，上面的代码老师是在JBuilder里写的，之前的话记得在工程属性里把JAVAMAIL相关的包加入工程里。。。 \n  ',NULL,849,'0109','JAVA',NULL,0),(861,'2009-10-21 15:52:36','jQuery实战(一)','\n    &nbsp;&nbsp;&nbsp; 从ITCAST上看到出了个jQuery实战的视频(http://www.itcast.net/portal/courses/unit/198),目前不用钱,呵呵,昨晚看了一下,觉得很不错,遂记录下来,以便日后复习!!!\n<br />&nbsp;&nbsp;&nbsp; <span style=\"color: blue\">JQuery实战课程是一个系列课，采用每节课动手实战一个实例效果的方式来介绍如何使用JQuery快速开发AJAX前端应用，并结合实例介绍一些前端开发中HTML，CSS，Javascript的知识以及跨浏览器差异问题的解决方法。</span>\n<br />&nbsp;&nbsp;&nbsp; 第一节课除了讲了一些环境的安装及参考资料,还讲了一个使用jQuery的AJAX功能来进行进一简单的用户验证,视频里用的是JAVA,于是我把他改成了.NET版的.\n<br />&nbsp;&nbsp;&nbsp; 因为这是一系列的课程,所以我在VS中建立了一个jQueryTest的工程,来专门做这些实例,为了分类,我专门在工程中建立了css,js,handler,images文件夹,用于存放不同的文件,在这里我的服务器端全都使用<span style=\"color: red\">一般处理程序</span>,存在于handler文件夹下,整个源码之后我会随之传上来.\n<br />&nbsp;&nbsp;&nbsp; 实例中还加了样子的变化,同样也是用jQuery来实现样子的切换的,代码如下:\n<br />首先是HTML页面文件的代码,很简单,两个文本框一个按钮,在这里我全都使用ID来命名:\n<br /><pre name=\"code\" class=\"html\">\n&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"userlogin.aspx.cs\" Inherits=\"userlogin\" %&gt;\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;AJAX用户登陆&lt;/title&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n    &lt;link href=\"css/userlogin.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;script src=\"js/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/userlogin.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    请输入用户名: &lt;input  type=\"text\" id=\"userName\" class=\"notValue\" /&gt;&lt;br /&gt;\n    请输入密　码: &lt;input type=\"password\" id=\"userPassword\" class=\"notValue\" /&gt;&lt;br /&gt;\n    &lt;input type=\"button\" value=\"登陆\" id=\"btnLogin\" /&gt;\n    &lt;div id=\"mes\"&gt;&lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 一开始文本框里是没有值的,所以拥有notValue样式,样式表文件userlogin.css的源码如下:\n<br /><pre name=\"code\" class=\"html\">\n.hasValue{    /* 文本框有值的时候的样式 */\n    border: 1px solid #9EC9FF;\n}\n\n.notValue{  /* 文本框无值的时候的样式 */\n    border: 1px solid #f00;\n    background: url(../images/userVerify.gif) repeat-x bottom;    \n}\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 接下来就是编写JS文件,下面是userlogin.js的源码:\n<br /><pre name=\"code\" class=\"js\">\n$(document).ready(function() {  // 页面加载后就执行此函数,相当于以前在body标签上加上onload=....\n    // 注册登陆按钮点击事件\n    $(\"#btnLogin\").click(function() {\n        // 获取文本框内容并二次转码,防止中文乱码\n        var userName = encodeURI(encodeURI($(\"#userName\").val()));\n        var userPassword = encodeURI(encodeURI($(\"#userPassword\").val()));\n        // 判断是否文本框是否有内容\n        if (userName == \"\") {\n            alert(\"请输入用户名!\");\n            return;\n        }\n        if (userPassword == \"\") {\n            alert(\"请输入密码!\");\n            return;\n        }\n        // AJAX发送数据\n        $.get(\"handler/userlogin.ashx?username=\"+userName+\"&amp;userpassword=\"+userPassword, null, function(data) {\n            $(\"#mes\").text(data);\n        });\n    });\n\n    // 注册文本框的键盘按键事件\n    $(\"#userName\").keyup(function() {\n        // alert($(\"#userName\").val());\n        if ($(\"#userName\").val() != \"\") {\n            // 如果文本框里的内容不为空,则切换样式到hasValue\n            $(\"#userName\").removeClass(\"notValue\").addClass(\"hasValue\");\n        } else {\n            $(\"#userName\").removeClass(\"hasValue\").addClass(\"notValue\");\n        }\n    });\n\n    $(\"#userPassword\").keyup(function() {\n        if ($(\"#userPassword\").val() != \"\" &amp;&amp; $(\"#userPassword\").val() != null) {\n            // 如果文本框里的内容不为空,则切换样式到hasValue\n            $(\"#userPassword\").removeClass(\"notValue\").addClass(\"hasValue\");\n        } else {\n            $(\"#userPassword\").removeClass(\"hasValue\").addClass(\"notValue\");\n        }\n    });\n});\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 以上的JS代码没什么好说的,只要花点时间查查jQuery的API文档就懂,我会把需要用于的jQuery的参数资料放在附件里,包括jQuery中文API,jQuery的1.2.6版本, CSS参考手册,DHTML参考手册, <span style=\"color: red\">需要注意的是:打开下载好的CHM文件的时候,我的XPSP3会弹出一个\"打开文件-安全警告\"的对话框,我要把对话框里的\"打开此文件前总是询问\"的勾勾取消掉,否则的话打开后是看不到任何内容的!</span>\n<br />&nbsp;&nbsp;&nbsp; 以上就是第一课讲的小实例,今晚下班回去继续看第二课,嘿嘿!!!\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/1ea0a152-a57c-3ad6-bb9f-d2d6ed3c5fd3\">实例源码_用VS打开网站即可_.rar</a> (21.7 KB)</li>\n          \n          <li>下载次数: 75</li>\n        </ul>\n      \n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/335c34b2-7c14-3422-8024-b657314680e4\">jQuery参考资料.rar</a> (6 MB)</li>\n          \n          <li>下载次数: 415</li>\n        </ul>\n      \n    \n    \n  </div>\n\n\n  \n\n  \n  <div id=\"digg_bottom\" class=\"clearfix\"><a href=\'#\' onclick=\'digg(\"blogs\", 258487, false);return false;\'><div><strong>1</strong> <br/>顶</div></a><a href=\'#\' onclick=\'digg(\"blogs\", 258487, true);return false;\'><div><strong>0</strong> <br/>踩</div></a>',NULL,903,'0110','jQuery',NULL,0),(862,'2009-10-21 15:52:36','JAVA发送Email ','	  \n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 今天老师讲完第四章了，JAVAMAIL的，主要就是用JAVA来发送邮件了，嘿嘿，这样看来，后天的上机课是能够开网了，呵呵，好爽，今天讲课主要就是用JAVAMAIL发送邮件的，下面是发送邮件的代码：\n<br /><pre name=\"code\" class=\"java\">\nimport java.util.*;\nimport java.io.*;\nimport javax.mail.*;\nimport javax.mail.internet.*;\nimport javax.activation.*;\n \npublic class SendMail {\n    public static void main(String args) {\n        try {\n           Properties p = new Properties(); //Properties p = System.getProperties();\n            p.put(\"mail.smtp.auth\", \"true\");\n            p.put(\"mail.transport.protocol\", \"smtp\");\n            p.put(\"mail.smtp.host\", \"smtp.163.com\");\n            p.put(\"mail.smtp.port\", \"25\");\n            //建立会话\n            Session session = Session.getInstance(p);\n            Message msg = new MimeMessage(session); //建立信息\n \n            msg.setFrom(new InternetAddress(\"bluebit_cn@163.com\")); //发件人\n            msg.setRecipient(Message.RecipientType.TO,\n                             new InternetAddress(\"javaonline@163.com\")); //收件人\n \n            msg.setSentDate(new Date()); // 发送日期\n            msg.setSubject(\"答话稀有\"); // 主题\n            msg.setText(\"快点下在\"); //内容\n            // 邮件服务器进行验证\n            Transport tran = session.getTransport(\"smtp\");\n            tran.connect(\"smtp.163.com\", \"bluebit_cn\", \"xiaohao\");\n            // bluebit_cn是用户名，xiaohao是密码\n            tran.sendMessage(msg, msg.getAllRecipients()); // 发送\n            System.out.println(\"邮件发送成功\");\n \n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</pre>\n<br />&nbsp;&nbsp;&nbsp;&nbsp; 上面的代码是一个简单的用JAVA发送邮件的例子，其中我们是用163的邮箱来发送邮件的，所以服务器是smtp.163.com，然后发件人是bluebit_cn@163.com，注意，因为我们是用163的服务器来发送邮件的，所以我们的发件人就必须是163的邮箱，至于收件人的话可以是任意的邮箱。\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 整个发邮件的思想：导入相关的包→生成属性对象→创建javamail会话→编写javamail消息→发送javamail消息。\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 导入包用不着多说，生成属性对象的话就是开关部分，这个的话全世界都是一样的，只是注意那个邮件服务器的设置就行，对了，额外说句，发送邮件是用SMTP协议，接收邮件才是POP3协议或者其他的。。。\n<br />下面的话还是发送邮件的，不过是通过HTML网页来发送的，网页制作我就不多说了，下面是源码，而且是带有附件的源码：\n<br />\n<br /><pre name=\"code\" class=\"java\">\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\nimport java.util.*;\nimport javax.mail.*;\nimport javax.mail.internet.*;\nimport javax.activation.*;\n\n\npublic class sendMailMul extends HttpServlet {\n    private static final String CONTENT_TYPE = \"text/html; charset=GBK\";\n\n    //Initialize global variables\n    public void init() throws ServletException {\n    }\n\n    //Process the HTTP Get request\n    public void doGet(HttpServletRequest request, HttpServletResponse response) throws\n            ServletException, IOException {\n        response.setContentType(CONTENT_TYPE);\n        PrintWriter out = response.getWriter();\n        request.setCharacterEncoding(\"gbk\");\n        response.setCharacterEncoding(\"gbk\");\n\n        String mailServer = request.getParameter(\"txtServer\").trim();\n        String mailFrom = request.getParameter(\"txtFrom\").trim();\n        String mailTo = request.getParameter(\"txtTo\").trim();\n        String mailSubject = request.getParameter(\"txtSubject\").trim();\n        String mailMessage = request.getParameter(\"txtMessage\").trim();\n        String file = request.getParameter(\"txtAttachment\").trim();\n\n        mailSubject = new String(mailSubject.getBytes(\"ISO-8859-1\"), \"gbk\");\n        mailMessage = new String(mailMessage.getBytes(\"ISO-8859-1\"), \"gbk\");\n        file = new String(file.getBytes(\"ISO-8859-1\"), \"gbk\");\n\n        System.out.println(\"页面数据：\");\n        System.out.println(\"mailServer:\" + mailServer);\n        System.out.println(\"mailFrom:\" + mailFrom);\n        System.out.println(\"mailTo:\" + mailTo);\n        System.out.println(\"mailSubject:\" + mailSubject);\n        System.out.println(\"mailMessage:\" + mailMessage);\n        System.out.println(\"file:\" + file);\n\n        Properties p = new Properties();\n        p.put(\"mail.smtp.auth\", \"true\");\n        p.put(\"mail.transport.protocol\", \"smtp\");\n        p.put(\"mail.smtp.host\", mailServer);\n        p.put(\"mail.smtp.port\", \"25\");\n\n        Session mailsession = Session.getInstance(p);\n\n        MimeMessage msg = new MimeMessage(mailsession);\n\n        try {\n            msg.setFrom(new InternetAddress(mailFrom));\n            msg.setRecipients(Message.RecipientType.TO,\n                              InternetAddress.parse(mailTo));\n            msg.setSentDate(new Date());\n            msg.setSubject(mailSubject);\n\n            //设置邮件内容，作为Multipart对象的一部分\n            MimeBodyPart mbp = new MimeBodyPart();\n            mbp.setText(mailMessage);\n            Multipart mulp = new MimeMultipart();\n            mulp.addBodyPart(mbp);\n            //设置附件，作为Multipart对象的一部分\n            mbp = new MimeBodyPart();\n            DataSource source = new FileDataSource(file);\n            mbp.setDataHandler(new DataHandler(source));\n            mbp.setFileName(file);\n            mulp.addBodyPart(mbp);\n            //设置信息内容，将Multipart 对象加入信息中\n            msg.setContent(mulp);\n\n            Transport tran = mailsession.getTransport(\"smtp\");\n            tran.connect(mailServer, \"bluebit_cn\", \"xiaohao\");\n            tran.sendMessage(msg, msg.getAllRecipients());\n\n            msg.writeTo(System.out);\n            out.println(\"邮件已经发送到\n\" + mailTo);\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n        out.close();\n    }\n\n    //Process the HTTP Post request\n    public void doPost(HttpServletRequest request, HttpServletResponse response) throws\n            ServletException, IOException {\n        doGet(request, response);\n    }\n\n    //Clean up resources\n    public void destroy() {\n    }\n}\n</pre>\n  	  \n	  ',NULL,908,'0109','JAVA',NULL,0),(863,'2009-10-21 15:52:36','前天买了10块的彩票,今天对奖发现又中了5块!','\n    &nbsp;&nbsp;&nbsp;&nbsp;<img src=\"/images/smiles/icon_biggrin.gif\"/>&nbsp;<img src=\"/images/smiles/icon_biggrin.gif\"/>&nbsp;<img src=\"/images/smiles/icon_biggrin.gif\"/> 哇哈哈!!!今天下班了再去买!!!\n  ',NULL,645,'0103','随笔',NULL,0),(864,'2009-10-21 15:52:36','JSP制作验证码','\n    　　刚刚从缘少那里弄到个JSP的验证码，嘿嘿，自己测试了一下，刚刚开始总是不成功，总是有异常，后来才发现原来把println写成pritnln，唉，以后得结合jb和DW来写JSP了。。。。\n<br />　　下面是JSP验证码的源码，下面的是生成数字验证码的：\n<br /><pre name=\"code\" class=\"java\">\n&lt;%@ page contentType=\"image/jpeg\" import=\"java.awt.*,java.awt.image.*,java.util.*,javax.imageio.*\" %&gt;\n&lt;%!\nColor getRandColor(int fc,int bc){//给定范围获得随机颜色\n        Random random = new Random();\n        if(fc&gt;255) fc=255;\n        if(bc&gt;255) bc=255;\n        int r=fc+random.nextInt(bc-fc);\n        int g=fc+random.nextInt(bc-fc);\n        int b=fc+random.nextInt(bc-fc);\n        return new Color(r,g,b);\n        }\n%&gt;\n&lt;%\n//设置页面不缓存\nresponse.setHeader(\"Pragma\",\"No-cache\");\nresponse.setHeader(\"Cache-Control\",\"no-cache\");\nresponse.setDateHeader(\"Expires\", 0);\n\n// 在内存中创建图象\nint width=60, height=20;\nBufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);\n\n// 获取图形上下文\nGraphics g = image.getGraphics();\n\n//生成随机类\nRandom random = new Random();\n\n// 设定背景色\ng.setColor(getRandColor(200,250));\ng.fillRect(0, 0, width, height);\n\n//设定字体\ng.setFont(new Font(\"Times New Roman\",Font.PLAIN,18));\n\n//画边框\n//g.setColor(new Color());\n//g.drawRect(0,0,width-1,height-1);\n\n\n// 随机产生155条干扰线，使图象中的认证码不易被其它程序探测到\ng.setColor(getRandColor(160,200));\nfor (int i=0;i&lt;155;i++)\n{\n int x = random.nextInt(width);\n int y = random.nextInt(height);\n        int xl = random.nextInt(12);\n        int yl = random.nextInt(12);\n g.drawLine(x,y,x+xl,y+yl);\n}\n\n// 取随机产生的认证码(4位数字)\nString sRand=\"\";\nfor (int i=0;i&lt;4;i++){\n    String rand=String.valueOf(random.nextInt(10));\n    sRand+=rand;\n    // 将认证码显示到图象中\n    g.setColor(new Color(20+random.nextInt(110),20+random.nextInt(110),20+random.nextInt(110)));//调用函数出来的颜色相同，可能是因为种子太接近，所以只能直接生成\n    g.drawString(rand,13*i+6,16);\n}\n\n// 将认证码存入SESSION\nsession.setAttribute(\"numrand\",sRand);\n\n\n// 图象生效\ng.dispose();\n\n// 输出图象到页面\nImageIO.write(image, \"JPEG\", response.getOutputStream());\nout.clear();\nout = pageContext.pushBody(); \n%&gt;\n</pre>\n<br />\n<br />　　另外还有一个源码，下面的这个源码是生成中文验证码的：\n<br /><pre name=\"code\" class=\"java\">\n&lt;%@ page contentType=\"image/jpeg\" import=\"java.awt.*,java.awt.image.*,java.util.*,javax.imageio.*\" %&gt;\n&lt;%!\n//create by smallnest\n//email: smallnest@gmail.com\n//website:www.kuaff.com\n\n\n\n\n//生成随机颜色\nColor getRandColor(Random random,int fc,int bc)\n{\n        if(fc&gt;255) fc=255;\n        if(bc&gt;255) bc=255;\n        int r=fc+random.nextInt(bc-fc);\n        int g=fc+random.nextInt(bc-fc);\n        int b=fc+random.nextInt(bc-fc);\n        return new Color(r,g,b);\n}\n%&gt;\n&lt;%\n//设置页面不缓存\nresponse.setHeader(\"Pragma\",\"No-cache\");\nresponse.setHeader(\"Cache-Control\",\"no-cache\");\nresponse.setDateHeader(\"Expires\", 0);\n\n\n// 设置图片的长宽\nint width=176, height=30;\n//设置备选汉字，剔除一些不雅的汉字\nString base = \"&#92;u7684&#92;u4e00&#92;u4e86&#92;u662f&#92;u6211&#92;u4e0d&#92;u5728&#92;u4eba&#92;u4eec&#92;u6709&#92;u6765&#92;u4ed6&#92;u8fd9&#92;u4e0a&#92;u7740&#92;u4e2a&#92;u5730&#92;u5230&#92;u5927&#92;u91cc&#92;u8bf4&#92;u5c31&#92;u53bb&#92;u5b50&#92;u5f97&#92;u4e5f&#92;u548c&#92;u90a3&#92;u8981&#92;u4e0b&#92;u770b&#92;u5929&#92;u65f6&#92;u8fc7&#92;u51fa&#92;u5c0f&#92;u4e48&#92;u8d77&#92;u4f60&#92;u90fd&#92;u628a&#92;u597d&#92;u8fd8&#92;u591a&#92;u6ca1&#92;u4e3a&#92;u53c8&#92;u53ef&#92;u5bb6&#92;u5b66&#92;u53ea&#92;u4ee5&#92;u4e3b&#92;u4f1a&#92;u6837&#92;u5e74&#92;u60f3&#92;u751f&#92;u540c&#92;u8001&#92;u4e2d&#92;u5341&#92;u4ece&#92;u81ea&#92;u9762&#92;u524d&#92;u5934&#92;u9053&#92;u5b83&#92;u540e&#92;u7136&#92;u8d70&#92;u5f88&#92;u50cf&#92;u89c1&#92;u4e24&#92;u7528&#92;u5979&#92;u56fd&#92;u52a8&#92;u8fdb&#92;u6210&#92;u56de&#92;u4ec0&#92;u8fb9&#92;u4f5c&#92;u5bf9&#92;u5f00&#92;u800c&#92;u5df1&#92;u4e9b&#92;u73b0&#92;u5c71&#92;u6c11&#92;u5019&#92;u7ecf&#92;u53d1&#92;u5de5&#92;u5411&#92;u4e8b&#92;u547d&#92;u7ed9&#92;u957f&#92;u6c34&#92;u51e0&#92;u4e49&#92;u4e09&#92;u58f0&#92;u4e8e&#92;u9ad8&#92;u624b&#92;u77e5&#92;u7406&#92;u773c&#92;u5fd7&#92;u70b9&#92;u5fc3&#92;u6218&#92;u4e8c&#92;u95ee&#92;u4f46&#92;u8eab&#92;u65b9&#92;u5b9e&#92;u5403&#92;u505a&#92;u53eb&#92;u5f53&#92;u4f4f&#92;u542c&#92;u9769&#92;u6253&#92;u5462&#92;u771f&#92;u5168&#92;u624d&#92;u56db&#92;u5df2&#92;u6240&#92;u654c&#92;u4e4b&#92;u6700&#92;u5149&#92;u4ea7&#92;u60c5&#92;u8def&#92;u5206&#92;u603b&#92;u6761&#92;u767d&#92;u8bdd&#92;u4e1c&#92;u5e2d&#92;u6b21&#92;u4eb2&#92;u5982&#92;u88ab&#92;u82b1&#92;u53e3&#92;u653e&#92;u513f&#92;u5e38&#92;u6c14&#92;u4e94&#92;u7b2c&#92;u4f7f&#92;u5199&#92;u519b&#92;u5427&#92;u6587&#92;u8fd0&#92;u518d&#92;u679c&#92;u600e&#92;u5b9a&#92;u8bb8&#92;u5feb&#92;u660e&#92;u884c&#92;u56e0&#92;u522b&#92;u98de&#92;u5916&#92;u6811&#92;u7269&#92;u6d3b&#92;u90e8&#92;u95e8&#92;u65e0&#92;u5f80&#92;u8239&#92;u671b&#92;u65b0&#92;u5e26&#92;u961f&#92;u5148&#92;u529b&#92;u5b8c&#92;u5374&#92;u7ad9&#92;u4ee3&#92;u5458&#92;u673a&#92;u66f4&#92;u4e5d&#92;u60a8&#92;u6bcf&#92;u98ce&#92;u7ea7&#92;u8ddf&#92;u7b11&#92;u554a&#92;u5b69&#92;u4e07&#92;u5c11&#92;u76f4&#92;u610f&#92;u591c&#92;u6bd4&#92;u9636&#92;u8fde&#92;u8f66&#92;u91cd&#92;u4fbf&#92;u6597&#92;u9a6c&#92;u54ea&#92;u5316&#92;u592a&#92;u6307&#92;u53d8&#92;u793e&#92;u4f3c&#92;u58eb&#92;u8005&#92;u5e72&#92;u77f3&#92;u6ee1&#92;u65e5&#92;u51b3&#92;u767e&#92;u539f&#92;u62ff&#92;u7fa4&#92;u7a76&#92;u5404&#92;u516d&#92;u672c&#92;u601d&#92;u89e3&#92;u7acb&#92;u6cb3&#92;u6751&#92;u516b&#92;u96be&#92;u65e9&#92;u8bba&#92;u5417&#92;u6839&#92;u5171&#92;u8ba9&#92;u76f8&#92;u7814&#92;u4eca&#92;u5176&#92;u4e66&#92;u5750&#92;u63a5&#92;u5e94&#92;u5173&#92;u4fe1&#92;u89c9&#92;u6b65&#92;u53cd&#92;u5904&#92;u8bb0&#92;u5c06&#92;u5343&#92;u627e&#92;u4e89&#92;u9886&#92;u6216&#92;u5e08&#92;u7ed3&#92;u5757&#92;u8dd1&#92;u8c01&#92;u8349&#92;u8d8a&#92;u5b57&#92;u52a0&#92;u811a&#92;u7d27&#92;u7231&#92;u7b49&#92;u4e60&#92;u9635&#92;u6015&#92;u6708&#92;u9752&#92;u534a&#92;u706b&#92;u6cd5&#92;u9898&#92;u5efa&#92;u8d76&#92;u4f4d&#92;u5531&#92;u6d77&#92;u4e03&#92;u5973&#92;u4efb&#92;u4ef6&#92;u611f&#92;u51c6&#92;u5f20&#92;u56e2&#92;u5c4b&#92;u79bb&#92;u8272&#92;u8138&#92;u7247&#92;u79d1&#92;u5012&#92;u775b&#92;u5229&#92;u4e16&#92;u521a&#92;u4e14&#92;u7531&#92;u9001&#92;u5207&#92;u661f&#92;u5bfc&#92;u665a&#92;u8868&#92;u591f&#92;u6574&#92;u8ba4&#92;u54cd&#92;u96ea&#92;u6d41&#92;u672a&#92;u573a&#92;u8be5&#92;u5e76&#92;u5e95&#92;u6df1&#92;u523b&#92;u5e73&#92;u4f1f&#92;u5fd9&#92;u63d0&#92;u786e&#92;u8fd1&#92;u4eae&#92;u8f7b&#92;u8bb2&#92;u519c&#92;u53e4&#92;u9ed1&#92;u544a&#92;u754c&#92;u62c9&#92;u540d&#92;u5440&#92;u571f&#92;u6e05&#92;u9633&#92;u7167&#92;u529e&#92;u53f2&#92;u6539&#92;u5386&#92;u8f6c&#92;u753b&#92;u9020&#92;u5634&#92;u6b64&#92;u6cbb&#92;u5317&#92;u5fc5&#92;u670d&#92;u96e8&#92;u7a7f&#92;u5185&#92;u8bc6&#92;u9a8c&#92;u4f20&#92;u4e1a&#92;u83dc&#92;u722c&#92;u7761&#92;u5174&#92;u5f62&#92;u91cf&#92;u54b1&#92;u89c2&#92;u82e6&#92;u4f53&#92;u4f17&#92;u901a&#92;u51b2&#92;u5408&#92;u7834&#92;u53cb&#92;u5ea6&#92;u672f&#92;u996d&#92;u516c&#92;u65c1&#92;u623f&#92;u6781&#92;u5357&#92;u67aa&#92;u8bfb&#92;u6c99&#92;u5c81&#92;u7ebf&#92;u91ce&#92;u575a&#92;u7a7a&#92;u6536&#92;u7b97&#92;u81f3&#92;u653f&#92;u57ce&#92;u52b3&#92;u843d&#92;u94b1&#92;u7279&#92;u56f4&#92;u5f1f&#92;u80dc&#92;u6559&#92;u70ed&#92;u5c55&#92;u5305&#92;u6b4c&#92;u7c7b&#92;u6e10&#92;u5f3a&#92;u6570&#92;u4e61&#92;u547c&#92;u6027&#92;u97f3&#92;u7b54&#92;u54e5&#92;u9645&#92;u65e7&#92;u795e&#92;u5ea7&#92;u7ae0&#92;u5e2e&#92;u5566&#92;u53d7&#92;u7cfb&#92;u4ee4&#92;u8df3&#92;u975e&#92;u4f55&#92;u725b&#92;u53d6&#92;u5165&#92;u5cb8&#92;u6562&#92;u6389&#92;u5ffd&#92;u79cd&#92;u88c5&#92;u9876&#92;u6025&#92;u6797&#92;u505c&#92;u606f&#92;u53e5&#92;u533a&#92;u8863&#92;u822c&#92;u62a5&#92;u53f6&#92;u538b&#92;u6162&#92;u53d4&#92;u80cc&#92;u7ec6\";\n//备选汉字的长度\nint length = base.length();\n\n\n//创建内存图像\nBufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);\n// 获取图形上下文\nGraphics g = image.getGraphics();\n\n\n//创建随机类的实例\nRandom random = new Random();\n\n\n// 设定图像背景色(因为是做背景，所以偏淡)\ng.setColor(getRandColor(random,200,250));\ng.fillRect(0, 0, width, height);\n\n\n//备选字体\nString fontTypes = {\"&#92;u5b8b&#92;u4f53\",\"&#92;u65b0&#92;u5b8b&#92;u4f53\",\"&#92;u9ed1&#92;u4f53\",\"&#92;u6977&#92;u4f53\",\"&#92;u96b6&#92;u4e66\"};\nint fontTypesLength = fontTypes.length;\n\n\n//在图片背景上增加噪点\ng.setColor(getRandColor(random,160,200));\ng.setFont(new Font(\"Times New Roman\",Font.PLAIN,14));\nfor (int i=0;i&lt;6;i++)\n{\n    g.drawString(\"*********************************************\",0,5*(i+2));\n}\n\n\n\n\n//取随机产生的认证码(6个汉字)\n\n\n//保存生成的汉字字符串\nString sRand=\"\";\nfor (int i=0;i&lt;6;i++)\n{\n    int start = random.nextInt(length);\n    String rand=base.substring(start,start+1);\n    sRand+=rand;\n\n    //设置字体的颜色\n    g.setColor(getRandColor(random,10,150));\n    //设置字体\n    g.setFont(new Font(fontTypesrandom.nextInt(fontTypesLength),Font.BOLD,18 + random.nextInt(6)));\n    //将此汉字画到图片上\n    g.drawString(rand,24*i+ 10 + random.nextInt(8),24);\n}\n\n\n//将认证码存入session\nsession.setAttribute(\"hanzirand\",sRand);\n\n\ng.dispose();\n\n\n//输出图象到页面\nImageIO.write(image, \"JPEG\", response.getOutputStream());\n%&gt;\n</pre>\n<br />\n<br />把上面两个文件保存为image.jsp（数字）和hanzi.jsp（汉字），然后我们编写一个测试文件test.jsp来测试，源码如下：\n<br />\n<br /><pre name=\"code\" class=\"java\">\n&lt;%@ page contentType=\"text/html; charset=gb2312\" %&gt;\n&lt;%\nString incode = (String)request.getParameter(\"code\");\nString rightcode = (String)session.getAttribute(\"numrand\");//汉字验证码的话则是hanzirand\nif (incode != null &amp;&amp; rightcode != null)\nif (rightcode.equals(incode))\n{\nout.println(\"验证码输入正确!\");\n}\nelse\n{\nout.println(\"验证码错误，请重新输入!\");\n}\n\n%&gt;\n\n&lt;form action=\"test.jsp\" method=\"post\"&gt;\n请输入验证码：&lt;img src=\"image.jsp\" /&gt;//如果是要用汉字验证码的就换成hanzi.jsp\n   \n&lt;input type=\"text\" name=\"code\"&gt;\n&lt;input type=\"submit\" value=\"验证\"&gt;&lt;/form&gt;\n</pre>\n<br />\n<br />　　只要运行test.jsp即可看到结果！！！\n<br />\n<br />\n<br />\n<br />\n  ',NULL,887,'0109','JAVA',NULL,0),(843,'2009-10-21 15:52:35','牛腩自制-.NET实体类生成器','作者：牛腩<br />\n<br />\n开发目的：因为VS05里自带的代码重构功能中的封装字段，一次只能封装一个字段，一定程度造成程序员的重复性工作。<br />\n<br />\n软件描述：可根据填写的类名，类说明，命名空间，以及各个字段的属性名、类型、备注自动生成相对应的代码。<br />\n<br />\n开发工具：Visual Studio 2005<br />\n<br />\n开发语言：C#<br />\n<br />\n开发平台：Windows<br />\n<br />\n界面预览:<br />\n<img src=\"http://niunan.net/bbspic/classgen/classgen.jpg\" /><br />\n<br />\n视频下载地址:<br />\n<span style=\"color:#f10b00;\"><font color=\"#000000\"><a href=\"http://item.taobao.com/item.htm?id=7909651241\">http://item.taobao.com/item.htm?id=7909651241</a><br />\n<br />\n</font></span><br />\n源码下载地址：<br />\n<a href=\"http://niunan.net/download/classgen_src.7z\" target=\"_blank\">http://niunan.net/download/classgen_src.7z</a><br />\n',NULL,1633,'0112','原创视频',NULL,0),(844,'2009-10-21 15:52:35','jQuery实战(二)','\n    &nbsp;&nbsp;&nbsp; 很久不上来写文章了,嘿嘿,最近在做一个简单的新闻发布系统,打算做好了以后出个视频的,呵呵,很久不录视频了,不知道家里的那破话筒还用不用得..还有那破机子顶不顶得住啊....唉..一个月1000块上下的工作...吃饭去300,坐公交去100,给外婆100,给奶奶100,给老妈100,还有300,要攒到何年何月才能买台2G内存,开VS08不卡的电脑啊...郁闷....<img src=\"/images/smiles/icon_cry.gif\"/> \n<br />&nbsp;&nbsp;&nbsp; 不说这么多了,这回给大家带来的是利用jQuery制作一个可编辑表格的WEB页面,大家应该用过Excel吧,里面的表格是可编辑的,点击任一个单元格,可向里面输入东西,按下回车后确认,如果是按下Esc键后就是取消,单元格中的内容会恢复到之前状态.\n<br />&nbsp;&nbsp;&nbsp; 现在我们要把这个功能移殖到web页面上来,我们先来理一下思路:\n<br /><span style=\"color: blue\">\n<br />① 点击单元格后可以输入,即是td的click事件处理函数里,让td的innerHTML的内容是一个input输入框\n<br />② 在input输入文字后按回车或Esc会触发相应的事件,即是在input的***事件中判断按下的键,然后做出相应的执行,这个***我们可以初步断定是keydown、keypress、keyup三种之一,至于用哪种后面再说.\n<br />③ 暂时想到这么多!\n<br /></span>\n<br />&nbsp;&nbsp;&nbsp; 下面来具体的编写代码,首先先把HTML页面搭建好,HTML代码如下:\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;可以编辑的表格&lt;/title&gt;\n    &lt;link href=\"css/edittable.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;script src=\"js/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/edittable.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;table id=\"cate;ry\"&gt;\n        &lt;tr&gt;\n            &lt;th&gt;序号&lt;/th&gt;\n            &lt;th&gt;新闻类别&lt;/th&gt;\n            &lt;th&gt;删除&lt;/th&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;1&lt;/td&gt;\n            &lt;td class=\"niu\"&gt;财经新闻&lt;/td&gt;   \n            &lt;td&gt;删除&lt;/td&gt; \n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;2&lt;/td&gt;\n            &lt;td class=\"niu\"&gt;体育新闻&lt;/td&gt;  \n            &lt;td&gt;删除&lt;/td&gt;  \n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;3&lt;/td&gt;\n            &lt;td class=\"niu\"&gt;社会新闻&lt;/td&gt;   \n            &lt;td&gt;删除&lt;/td&gt; \n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 接下来先设置一下CSS样式,CSS代码如下:\n<br /><pre name=\"code\" class=\"html\">\n* {\n    margin: 0;\n    padding: 0;\n}\ntable {\n    border: 1px solid #7BCB98;\n    width: 300px;\n    border-collapse: collapse;\n}\nth {\n    border: 1px solid #7BCB98;\n    background-color: #E9FDF1;\n}\ntd {\n    border: 1px solid #7BCB98;\n    text-align:center;\n}\n.niu {\n    width: 200px;\n}\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 在这里我们设置可点击修改的只是\"新闻类别\"这一列,所以我们要在这一列上加上个niu样式,并给他一个固定宽度,这样可去除一些界面上的不协调之类的...而且也方便我们用jQuery选择出这一列,我就直接把JS代码都贴出来,然后再说说要注意的问题.JS代码如下:\n<br /><pre name=\"code\" class=\"js\">\n$(function() {\n    $(\"tr\").children(\".niu\").click(function() {\n        var tdObj = $(this);\n        var souText = tdObj.text();   // 原来的内容\n        var input = $(\"&lt;input type=\'text\' value=\'\" + souText + \"\' /&gt;\");\n        // 设置文本框的宽\n        input.width(tdObj.width());\n        // 设置文本框的点击事件\n        input.click(function() {\n        return false;\n        });\n        // 设置文本框的样式\n        input.css({ \"border-width\": 0 });\n        // 将文本框替换当前td的内容\n        tdObj.html(input);\n        // 触发文本框的focus事件后再触发select事件\n        input.trigger(\"focus\").trigger(\"select\");\n        // 文件框的焦点失去事件, 把文本框中填写的内容变成\n        input.blur(function() {\n        tdObj.html(input.val());\n        // 查找当前td的前一个td中的内容, 即当前行的序号\n        alert(tdObj.prev().text());\n        });\n        // 处理文本框中键盘按键事件, Enter 13确认,Esc 27取消\n        input.keydown(function(event) {\n        var keyCode = event.keyCode;\n        if (keyCode == 13) {\n            // 按下回车\n            tdObj.html(input.val());\n            // 查找当前td的前一个td中的内容, 即当前行的序号\n            alert(tdObj.prev().text());\n        }\n        if (keyCode == 27) {\n            // 按下Esc\n            tdObj.html(souText);\n        }\n        });\n    });\n});\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 在这里我们通过jQuery的元素筛选功能,用children找出每一tr行中有.niu样式的单元格td,然后给td加上click事件,在触发的函数中先保存原来td中的文本,然后利用html方法把td中的内容变成一个input文本框,随后设置了一些input文本框的样式,以保持界面的美观,然后给文本框加上blur焦点失去事件,相当于回车确认,把文本框中输入的内容变成单元格td的内容,再加上keydown事件,进行按键处理,在这里我们使用keydown事件,因为经本人检测, keypress事件在某些浏览器上按键并不会产生按键代码, keyup<span style=\"color: red\">好像</span>也是一样,<img src=\"/images/smiles/icon_confused.gif\"/> \n<br />&nbsp;&nbsp;&nbsp; 之所以说好像,因为在测试的时候我的IETester出了问题,竟然不给我响应回车和Esc,一按就死了,重装了IETester也还是一样...\n<br />&nbsp;&nbsp;&nbsp; 最后要说的是jQuery中获取按键代码可用event.keyCode和event.which这两种方法,经本人检测,如果使用event.which,在opera浏览器中检测不到Esc键的按键代码,因此在这里采用event.keyCode方式来获取.\n<br />&nbsp;&nbsp;&nbsp; 最最后还要说的是我们还得给文本框的click点击事件返回false,要不然的话你点击单元格,里面蛮文本框了之后再点击文本框,触发完文本框的click事件后还会再触发文本框所处在的父结点,即单元格的click事件,这样会产生意想不到的麻烦.所以要给文本框的click点击事件返回false就行了.\n<br />&nbsp;&nbsp;&nbsp; 还有忘了说了,在正式项目中用到这个功能的话,除了要获取文本框输入的内容,即修改后的内容,还得要获取当前行的某一列,即要获取id,这样才能通过唯一值id来更新数据库中相应的内容,在这里通过prev方法,即当前结点的前一个兄弟结点来获取.\n<br />&nbsp;&nbsp; 最最最后还要说的一点,就是我在做新闻发布系统的时候用到了上面的这个功能,在实际的操作中想要回车后通过AJAX方式发送数据还有一点小问题,就是如果在当前ASPX页面中有按钮的话,按回车了会让触发ASPX的Page_Load事件,如何解决的话这个留待视频里再说!!!\n<br />&nbsp;&nbsp; 上头有任务下来了...开始工作....忽忽悠悠又过一个上午....\n  ',NULL,947,'0110','jQuery',NULL,0),(845,'2009-10-21 15:52:35','.NET中获取字符串的MD5码','\n    ① 导入命名空间：\n<br /><pre name=\"code\" class=\"c#\"> using System.Web.Security;</pre>\n<br />\n<br />② 获取MD5码：\n<br /><pre name=\"code\" class=\"c#\">\nstring Password = FormsAuthentication.HashPasswordForStoringInConfigFile(TextBox1.Text.ToString(), \"MD5\");\n</pre>\n<br />\n  ',NULL,794,'0101','ASP.NET',NULL,0),(846,'2009-10-21 15:52:35','制作符合WEB标准的QQ弹出消息(jQuery)','&nbsp;&nbsp; &nbsp;网上有好多的浮动层之类的代码，所谓的浮动层，就是层里的内容会随着页面的滚动而滚动，很多网站上都有的“QQ在线服务”就是个很好的例子，目前本人工作的这个网站中也需要用到了“QQ在线服务”，于是自己从网上下载了N多源码，这些源码运行起来是没有问题的，可是当我把其中的一些重要代码粘贴到vs中新建的ASPX页面的时候，运行ASPX页面的时候就不能随着页面的滚动而滚动了。 <br />\n<br />\n&nbsp;&nbsp; &nbsp;仔细对比ASPX页面代码和他的源码后发现，原来问题出现在DOCTYPE定义上，那些源码N多都是没有定义到DOCTYPE的，而新建的每个一ASPX页面都会有如下DOCTYPE定义： <br />\nhtml&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;<br />\n/html<br />\n&nbsp;&nbsp; &nbsp;网上搜索后发现，这是目前很多网页都采用的标准，正好自己目前又在学习JQUERY，就想自己写一个符合WEB标准的浮动出来，首先研究一下之前下载的那些源码，找到浮动层的编写思路： 层可以随着页面滚动而滚动，说明肯定是脱离了标准流的，所以在层的CSS定义中以下的这句代码肯定少不了： <br />\ncssposition:absolute;  /css<br />\n<br />\n&nbsp;&nbsp; &nbsp;紧接着，因为是上下移动，所以就是要改变层的CSS样式中的top属性，注意是小写的，如果在代码中写大写的话那是会出错的，因为要符合“标准”... <br />\n那我们又如何改变top属性呢？在每回页面滚动的时候，都会有一个滚动的高度，也就是scrollTop，我们就可以在每回页面滚动的时候把我们原来层的top+滚动的高度，这样也就成了。 <br />\n接下来问题又来了，scrollTop的获取IE和非IE的又有不同，经搜索得知，可用如下代码获取scrollTop： <br />\njs <br />\n            var bodyTop = 0;<br />\n            if (typeof window.pageYOffset != &#039;undefined&#039;) {<br />\n                bodyTop = window.pageYOffset;<br />\n            } else if (typeof document.compatMode != &#039;undefined&#039; &amp;&amp; document.compatMode != &#039;BackCompat&#039;) {<br />\n                bodyTop = document.documentElement.scrollTop;<br />\n            }<br />\n            else if (typeof document.body != &#039;undefined&#039;) {<br />\n                bodyTop = document.body.scrollTop;<br />\n            }<br />\n/js<br />\n经过上面的分析我们知道，只要在每回页面滚动的时候都重新设置层的top属性即可。下面是我用自己写的源码：<br />\nhtml&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"qqonline.aspx.cs\" Inherits=\"qqonline\" %&gt;<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div><br />\n</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;浮动广告&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;style type=\"text/css\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;#qqonline{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color:Yellow;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border: 1px solid #fcc;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;position:absolute;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top:250px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left:16px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width:200px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height:120px;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/style&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"jquery-1.2.6.pack.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script type=\"text/javascript\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(window).scroll(function() { &nbsp; &nbsp;// 页面发生scroll事件时触发</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var bodyTop = 0;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (typeof window.pageYOffset != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = window.pageYOffset;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else if (typeof document.compatMode != &#039;undefined&#039; &amp;&amp; document.compatMode != &#039;BackCompat&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.documentElement.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (typeof document.body != &#039;undefined&#039;) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bodyTop = document.body.scrollTop;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#qqonline\").css(\"top\", 250 + bodyTop) &nbsp; // 设置层的CSS样式中的top属性, 注意要是小写，要符合“标准”</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#qqonline\").text(bodyTop); &nbsp; // 设置层的内容，这里只是显示当前的scrollTop</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;});&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/script&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body style=\"height:1800px\"&gt;&lt;!-- 给BODY加个样式，让页面出现滚动条 --&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;form id=\"form1\" runat=\"server\"&gt; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/form&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"qqonline\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;QQ在线服务</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n因为新建立的是ASPX页面，所以开头有&lt;%@那句，不过在后置代码里是什么都没有写。 <br />\n最后运行页面，即可看到，随着页面滚动的滚动，层总是保持在同一个地方。 <br />\n以上代码经测试，<span style=\"color:#0021b0;\">IE6,IE7,IE8 b2，FF,OPERA,插肉咪（chrome）</span>浏览器都能正确的显示，而且页面还符合“标准”。 <br />\n从以上得知，一般来说“标准”都有两个，一个是强者制定的标准（IE），一个是由众多与强者相对的弱者组合起来制定的标准，俗话说分久必合，可看来我想等到我去见毛爷爷的那一天都合不了啊！！！<br />\n<br />\n',NULL,807,'0110','jQuery',NULL,0),(847,'2009-10-21 15:52:35','项目文件“ ”已被重命名或已不在解决方案中','	  \n    &nbsp;&nbsp; 昨晚在家里做那个三层架构的新闻发布系统,做得一半了,今天拿到公司里继续做,在DAL层改了些东西,对DAL层重新生成,发现VS弹出一个对话框,说\"项目文件“ ”已被重命名或已不在解决方案中\",经上网查证,发现可能是路径问题吧,只需要在把WEB层中把出错的引用移除,再重新添加引用即可.如图:\n<br />\n<br /><img src=\"http://niunan.net/bbspic/vserror/01.jpg\" />\n<br />\n<br /><img src=\"http://niunan.net/bbspic/vserror/02.jpg\" />\n<br />\n<br />然后再重新生成DAL层即可生成.\n  	  \n	  ',NULL,900,'0101','ASP.NET',NULL,0),(848,'2009-10-21 15:52:35','公车就像海绵,只要肯挤总是会有位置的!','\n    &nbsp;&nbsp; 今天什么日子啊...公车好多人啊...一路上来又塞车,从邕江大桥一路塞到江滨公园....\n<br />\n<br />差点迟到了...算了..不说了..继续工作..嘿嘿...自从有了双休,干活也起劲了...感觉时间过得好快....过完明天又能睡懒觉了!!!!<img src=\"/images/smiles/icon_biggrin.gif\"/> \n  ',NULL,822,'0103','随笔',NULL,0),(849,'2009-10-21 15:52:35','建立以当天日期为文件名的文件夹的批处理','\n    新建一记事本文件，在里面输入\n<br /><pre name=\"code\" class=\"java\">\nmd %date:~0,10%\n</pre>\n<br />\n<br />保存为“建立文件夹.bat”，以后每回双击之后都会在该文件当前的目录下建立一个文件夹，文件夹的名字是当天的日期。\n<br />\n<br />解释一下以上的命令，md是DOS下建立文件夹的命令，%date% 是显示当前时候，大家可在CMD命令行下输入echo %date%可看到效果。\n<br />\n<br /><img src=\"http://taotao.wsyren.com/bbspic/cmd/01.jpg\" />\n<br />\n<br />然后剩下的:~0,10是什么意思大家看上图应该能推得出来了，类似于SubString()方法！\n  ',NULL,653,'0103','随笔',NULL,0),(850,'2009-10-21 15:52:35','验证日期的正则（可输入形如2008、2008-9、2008-09...）','    　　工作中碰到的问题，记录一下，可输入形如2008、2008-9、2008-09、2008-9-9、2008-09-09.。。<br />\n　<br />\n<span style=\"color:red;\"><br />\n<span style=\"font-size:medium;\"><br />\n^(\\d{4}|(\\d{4}-\\d{1,2})|(\\d{4}-\\d{1,2}-\\d{1,2}))$<br />\n</span><br />\n</span>          <div id=\"digg_bottom\" class=\"clearfix\"><b><br />\n</b></div>\n',NULL,873,'0107','正则表达式',NULL,0),(851,'2009-10-21 15:52:35','.NET中使用三层构架如何从DAL层读取web.config中的数据库连接字符串！','	  	  	  \n    看了N多.NET三层的资料，可是自己还没有真的试过用三层来做个小项目，今天终于下决心，用三层做个新闻发布系统，很简单，对数据库的增删查改而已。。。\n<br />没想到在刚刚开始的时候就碰到了麻烦，在解决方案里添加新建项目DAL后如何在DAL中的类中读取到web.config里的数据库连接字符串。。。。\n<br />经本人多方查证和搜索，终于解决，现在方法记下：\n<br />新建项目，如图：\n<br /><img src=\"http://niunan.net/bbspic/dal/01.jpg\" />\n<br />文件→添加→新建项目，如图：\n<br /><img src=\"http://niunan.net/bbspic/dal/02.jpg\" />\n<br />选择C#的内裤，保存位置最好是在WEB项目所有的目录，如图：\n<br /><img src=\"http://niunan.net/bbspic/dal/03.jpg\" />\n<br />这时解决方案管理器如图，可以把默认的类名改一下：\n<br /><img src=\"http://niunan.net/bbspic/dal/04.jpg\" />\n<br />前戏准备完了之后，我们就开始在web.config里写上数据库连接字符串了，下面是我的web.config的代码片段：\n<br />\n<pre name=\"code\" class=\"xml\">\n&lt;connectionStrings&gt;\n		&lt;add name=\"connStr\" connectionString=\"server=niunan\\sqlexpress;database=newssystem;uid=sa;pwd=123456\" providerName=\"System.Data.SqlClient\"/&gt;\n	&lt;/connectionStrings&gt;\n</pre>\n<br />我们要从DAL层中读取到web.config中的信息，得使用System.Web下的***类，可是在我们在类开关输入using System.Web.发现后面的代码自动提示点不出来，大家可以看一下解决方案管理器中DAL层的引用：\n<br /><img src=\"http://niunan.net/bbspic/dal/05.jpg\" />\n<br />，发现并没有System.Web,所以之前我们的代码自动提示就出不来，接下来我们只要引出System.Web就行了，此外，经测试，还得引入System.Configuration才能读取到web.config中的信息，如图添加引用：\n<br /><img src=\"http://niunan.net/bbspic/dal/06.jpg\" />\n<br /><img src=\"http://niunan.net/bbspic/dal/07.jpg\" />\n<br /><img src=\"http://niunan.net/bbspic/dal/08.jpg\" />\n<br />添加成功后解决方案管理器如图：\n<br /><img src=\"http://niunan.net/bbspic/dal/09.jpg\" />\n<br />这时我们就可以使用代码智能提示引用System.Web.Configuration了，然后我们就能开始获取web.config中的内容了，下面是我写的SQLHelper.cs的代码：\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Web.Configuration;   // 要引用这个命名空间\n\nnamespace DAL\n{\n    public class SQLHelper\n    {\n        /// \n        ///  测试方法，获取数据库连接字符串\n        /// \n        /// \n        public static string getConnStr()\n        {\n            return WebConfigurationManager.ConnectionStrings\"connStr\".ToString();\n        }\n    }\n}\n</pre>\n<br />紧接着我们就在页面上先测试一下是否成功的获取出来，同样的，在WEB项目中要使用DAL层里的东西，因为属于不同的二个项目，所以也得引用DAL，如图：\n<br /><img src=\"http://niunan.net/bbspic/dal/10.jpg\" />\n<br /><img src=\"http://niunan.net/bbspic/dal/11.jpg\" />\n<br />引用后发现解决方案管理器里没啥变化，的确是没啥变化，可是的确是已经引用了DAL层了，这时就可以写代码了，以下是我的default.aspx.cs的源码，在这里只是测试一下能不能获取出来，页面上什么都没放：\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing DAL;   // 引用DAL层，注意大小写,要与那边建立的内裤名称相对应\n\npublic partial class _Default : System.Web.UI.Page \n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        // 在那边我是使用了static静态方法，所以可以直接通过类名点出他的方法\n        Response.Write(DAL.SQLHelper.getConnStr());\n    }\n}\n</pre>\n<br />最后预览页面，即可看到读取出来了。。。。\n<br /><img src=\"http://niunan.net/bbspic/dal/12.jpg\" />\n  \n\n  \n\n  \n\n  \n  <div class=\"clearfix\"><b><br /></b></div>	  \n	  	  \n	  ',NULL,780,'0101','ASP.NET',NULL,0),(852,'2009-10-21 15:52:35','ASP.NET中把2008-9-6形式的字符串转成2008-09-06形式的方法！','\n    　　目前在做项目的时候碰到的一个小问题，就是当要按照日期查询的时候，在数据库里查询必须是2008-09-06形式的，可是用户在输入的时候经常习惯输入2008-9-6（至少我就经常这样子输入，呵呵！）\n<br />\n<br />　　上网搜索了好一会，解决方法如下：\n<br />　　　　可以利用.NET中格式化字符串的方法转换！代码如下：\n<br /><pre name=\"code\" class=\"C#\">\nstring str = \"2008-9-6\"\nDateTime dt = DateTime.Parse(str);\nResponse.Write(String.Format(\"{0:yyyy-MM-dd}\", dt));\n</pre>\n  ',NULL,729,'0101','ASP.NET',NULL,0),(853,'2009-10-21 15:52:35','ACDSee2.43版','    &nbsp;&nbsp; 古典, 小巧, 好用!      <br />\n<br />\n&nbsp;&nbsp; 下载：<a target=\"_blank\" href=\"http://niunan.net/download/acdsee32.7z\">http://niunan.net/download/acdsee32.7z</a><br />\n',NULL,914,'0104','下载',NULL,0),(854,'2009-10-21 15:52:35','ASP.NET中用JS弹出模态对话框后在里面的分页的问题!','\n    下面是我打开模态对话框的JS函数： \n<br /><pre name=\"code\" class=\"js\">\n&lt;script language=\"javascript\"&gt;\n                function OpenWin(){\n                var str=window.showModalDialog(\'selorder.aspx\',\'\',\'dialogLeft=80px;dialogTop=80px;dialogWidth=650px;dialogHeight=450px\');\n                if(str!=null)  \n                    document.getElementById(\"ctl00_ContentPlaceHolder1_txtPayMoney\").value = str;\n                }\n&lt;/script&gt;\n</pre>\n<br />\n<br />下面是selorder.aspx页面的主要代码： \n<br /><pre name=\"code\" class=\"html\">\n&lt;asp:GridView ID=\"gdvOrders\" runat=\"server\" AutoGenerateColumns=\"False\" \n                CssClass=\"mconttable\" PageSize=\"5\"&gt;\n        ．．．\n            &lt;/asp:GridView&gt;\n            &lt;br /&gt;\n            &lt;webdiyer:AspNetPager PageSize=\"5\" ID=\"anpOrderByLocId\" runat=\"server\" FirstPageText=\'首\'\n            LastPageText=\'尾\' CssClass=\"pageindexlink\" CurrentPageButtonClass=\"aaa\" CustomInfoClass=\"\"\n            PagingButtonSpacing=\"\" OnPageChanged=\"anpOrderByLocId_PageChanged\"&gt;\n        &lt;/webdiyer:AspNetPager&gt;\n            &lt;br /&gt;\n&lt;input type=\'button\' name=\'bb\' id=\'bb\' style=\"width:80px\" value=\'选择\' runat=\"server\" /&gt;\n</pre>\n<br />\n<br />下面是selorder.aspx.cs页面的主要代码： \n<br /><pre name=\"code\" class=\"C#\">\n   protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!Page.IsPostBack)\n        {\n            // 通过登陆的用户名获取公司ID\n            DataTable dt = OrderDAO.SearchLocByUserName(Profile.UserName);\n            int locid = int.Parse(dt.Rows0\"Id\".ToString());  // 公司ID\n            ViewState\"locid\" = locid;\n\n            anpOrderByLocId.RecordCount = OrderDAO.QueryOrderCount(\"CoLocId=\" + locid);\n\n            BindDataOrderByLocId(locid);\n\n            bb.Attributes.Add(\"onclick\", \"window.parent.returnValue=76.78;window.close();\");\n        }\n    }\n\n    // 绑定订单数据,用于默认查询\n    private void BindDataOrderByLocId(int locid)\n    {\n        int startIndex = anpOrderByLocId.StartRecordIndex;\n        int endIndex = anpOrderByLocId.EndRecordIndex;\n\n        gdvOrders.DataSource = OrderDAO.QueryOrderByLocId(locid, startIndex, endIndex);\n        gdvOrders.DataBind();\n    }\n\n\n    // 默认查询换页\n    protected void anpOrderByLocId_PageChanged(object sender, EventArgs e)\n    {\n        BindDataOrderByLocId(int.Parse(ViewState\"locid\".ToString()));\n    }\n</pre>\n<br />\n<br />　可是我在弹出的模态对话框内点击换页的按键的时候就换不了页，不知道怎么回事，但是单独运行selorder.aspx是可以分页的.\n<br /> \n<br />&nbsp; 解决方法：\n<br />　　　得在selorder.aspx的head部分加入些代码，下面是head的代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;选择订单&lt;/title&gt;\n    &lt;!-- 防止重新打开页面形式的对话框 --&gt;\n    &lt;base target=\"_self\" /&gt; \n&lt;/head&gt;\n</pre>\n  ',NULL,746,'0101','ASP.NET',NULL,0),(834,'2009-10-21 15:52:34','精通CSS-高级Web解决方案','    【内容简介】<br />\n本书将最有用的CSS技术汇总在一起，在介绍基本的CSS概念和最佳实践之后，讨论了核心的CSS技术，例如图像、链接、列表操纵、表单设计、数据表格设计以及纯CSS布局。每一章内容由浅入深，直到建立比较复杂的示例。之后本书用两章讨论招数、过滤器、bug和bug修复，最后由Simon Collison和Cameron Moll两位杰出的CSS设计人员，将书中讨论的许多技术组合起来，给出了两个实例研究，这两个实例研究将书中讨论的许多技术组合起来，使读者不仅理解工作原理，而且能够学到如何将它们应用在实际项目中，迅速精通CSS，成为CSS专家。本书还集中介绍了现实的浏览器问题，是弥补CSS知识欠缺不可或缺的参考书。本书弥补了一直以来CSS图书的空白。正因如此，英文版出版后，一时洛阳纸贵，多次重印，并迅速登上Amazon图书排行榜前列，最高时甚至与哈里·波特并驾齐驱，创造了计算机图书的销售奇迹。<br />\n本书适合具有(X)HTML和CSS基本知识的任何网页设计人员阅读。<br />\n<br />\n“Andy Budd对CSS设计的底层技术和当代方法有着深刻的理解，而且他更善于将这些知识娓娓道来。在跨浏览器支持问题上，无人可以望其项背。”<br />\n——Molly E．Holzschlag，Web标准项目负责人，W3C HTML工作组专家<br />\n<br />\n“Andy Budd多年来一直在编写、设计和宣传基于标准的网页设计，我们现在有幸在本书中看到他以简洁清晰的方式讲授最重要的CSS技术。本书提供了一套网页设计人员不可或缺的解决方案、技巧和经验。”<br />\n——Dan Cederholm，Web Standards Solutions的作者 <br />\n<br />\n<span style=\"color:red;\">下载:<br />\n</span><a target=\"_blank\" href=\"http://www.namipan.com/d/1041219841bdf652cabf6317f83bfde6fba9fc18905bd002\"><span style=\"color:red;\">http://www.namipan.com/d/1041219841bdf652cabf6317f83bfde6fba9fc18905bd002</span><span style=\"color:red;\">&nbsp;</span></a>  	                          ',NULL,845,'0104','下载',NULL,0),(835,'2009-10-21 15:52:34','《C#高级编程》第四版  ','    C＃经典名著！也是Wrox红皮书中最畅销的品种之一，从第一版开始就名满天下；其第3版被中华读书报、CSDN、《程序员》等机构评选为2005年最权威的十大IT图书之一（第2名）；在中国版协、中国出版科学研究所、《出版参考》杂志组织的“2005年度输出版、引进版优秀图书”评选活动中获得“2005年度引进版科技类优秀图书”奖。第4版面向C＃ 2005，在全面展示.NET新特性的同时继续完善原有的内容，是有一些C＃基础知识的学习者或者想迁移到C＃的其他程序员全面掌握C＃的首选教程。<br />\n<br />\nC#和.NET全面革新了编写程序的方式。本书以最新的.NET Framework 2.0和Visual Studio 2005为基础，全面介绍了C#编程的工具，提供了理解.NET体系结构的工作原理所必需的背景知识。<br />\n<br />\n本书首先探讨了C#的基础知识,包括基本语法、数据类型和面向对象的特性。接着阐述了如何把该语句应用于各种使用相关技术的应用程序，例如数据库访问和高级绘图技术。这种方式有助于对C#语言的各个方面进行深入细致的理解，以专业人员的方式开始编程。<br />\n<br />\n本书涵盖的内容有助于编写动态WEB页面、XML WEB服务、分布式应用程序的组件，以及Windows桌面应用程序等。<br />\n<br />\nC#高级编程（第四版）中文版<br />\n目 录<br />\n<br />\n第Ⅰ部分 C#语言<br />\n第1章 .NET体系结构 <br />\n第2章 C#基础<br />\n第3章 对象和类型<br />\n第4章 继承<br />\n第5章 运算符和类型强制转换<br />\n第6章 委托和事件<br />\n第7章 内存管理和指针<br />\n第8章 字符串和正则表达式<br />\n第9章 集合<br />\n第10章 泛型<br />\n第11章 反射<br />\n第12章 错误和异常<br />\n第13章 线程<br />\n第Ⅱ部分 .NET环境<br />\n第14章 Visual Studio 2005<br />\n第15章 程序集<br />\n第16章 .NET的安全性<br />\n第17章 本地化<br />\n第18章 部署 <br />\n第Ⅲ部分 数 <br />\n第19章 .NET数据访问<br />\n第20章 .NET编程和<br />\n第21章 处理XML <br />\n第22章 使用Active Directory <br />\n第Ⅳ部分 Windows应用程序<br />\n第23章 Windows窗体<br />\n第24章 查看.NET数据<br />\n第25章 使用GDI+绘图<br />\n第Ⅴ部分 Web应用程序<br />\n第26章 ASP.NET页面<br />\n第27章 ASP.NET开发<br />\n第Ⅵ部分 通信<br />\n第28章 Web服务<br />\n第29章 .NET Remoting<br />\n第30章 Enterprise Services<br />\n第31章 消息队列<br />\n第32章 分布式编程的未来产品<br />\n第Ⅶ部分 互操作性<br />\n第33章 COM的互操作性<br />\n第Ⅷ部分 Windows基本服务<br />\n第34章 文件和注册表操作<br />\n第35章 访问Internet<br />\n第36章 Windows服务<br />\n<br />\n<span style=\"color:red;\">下载:<a target=\"_blank\" href=\"http://www.namipan.com/d/8067a57079921f0cbabe4e6906dfbe45ca370e61821fb906\">http://www.namipan.com/d/8067a57079921f0cbabe4e6906dfbe45ca370e61821fb906</a></span>  	                          ',NULL,1005,'0104','下载',NULL,0),(836,'2009-10-21 15:52:34','精通Java Web动态图表编程(PDF)','    名称:精通Java Web动态图表编程.pdf<br />\n大小:12M<br />\n下载:<a target=\"_blank\" href=\"http://www.rayfile.com/files/6c9fd466-b5db-11dd-8f2b-0019d11a795f/\">http://www.rayfile.com/files/6c9fd466-b5db-11dd-8f2b-0019d11a795f/</a><br />\n<br />\n<span style=\"color:blue;\">本书是国内第一部系统阐述如何开发基于Java的Web动态图表的专著。<br />\n本书不仅详述了如何利用Java对图形的处理能力，通过Java Applet、Jave Servelet、JSP、Java Bean以及借助开源软件JFreeChart及Cewolf动态图表生成引擎等多种方式开发Web动力图表，还详解了如何设计Web动态图表生成引擎，并将其封装成Java Bean，以达到高效、重复使用的目的。本书不但剖析理论，更强调实际运用；针对编程人员开发过程中遇到的技术难点，提供了典型的实例，逐一剖析，帮助读者快速掌握和精通Java Web动态图表编程思想和技巧，提高编程能力和水平。全书共分9章。<br />\n本书面向各级Java应用程序中实现Web动态图表功能的Java及Web程序人员。 </span>          <div id=\"digg_bottom\" class=\"clearfix\"><a href=\"http://niunan.org/admin/%27#%27\" onclick=\"&#039;digg(&quot;blogs&quot;,\" 269846,=\"\" true);return=\"\" false;&#039;=\"\"><br />\n</a></div>\n',NULL,681,'0104','下载',NULL,0),(837,'2009-10-21 15:52:34','jQuery实战（三）','\n    刚刚看完第三讲，是用jQuery制作下拉菜单，自己也试着做了一个，只是没有用到图片之类的，呵呵，所以比较难看，也比较简单。\n<br />因为我是用VS做的，所以HTML界面顶上都会有&lt;%%&gt;的内容的，大家换成静态页的时候把上面的去掉就成！\n<br />menu.aspx源码\n<br /><pre name=\"code\" class=\"html\">\n&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"menu.aspx.cs\" Inherits=\"menu\" %&gt;\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;jQuery实战-下拉菜单&lt;/title&gt;\n    &lt;link href=\"css/menu.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;script src=\"js/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/menu.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h4&gt;纵向菜单&lt;/h4&gt;\n    &lt;ul&gt;\n        &lt;li class=\"main\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单一&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单11&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单12&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"main\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单二&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单21&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单22&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"main\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单三&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单31&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单32&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;br /&gt;\n    &lt;br /&gt;\n    &lt;br /&gt;\n    &lt;h4&gt;横向菜单&lt;/h4&gt;\n    &lt;ul&gt;\n        &lt;li class=\"hmain\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单一&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单11&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单12&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"hmain\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单二&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单21&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单22&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"hmain\"&gt;&lt;a href=\"#\" class=\"first\"&gt;菜单三&lt;/a&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单31&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"#\"&gt;菜单32&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n    &lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />menu.css源码：\n<br /><pre name=\"code\" class=\"html\">\na:link, a:visited {  /* 设置默认及访问过的超链接样式 */\n    text-decoration: none;\n    text-align: center;\n    color: #000;\n    display: block;\n    display: inline-block;\n    width: 120px;\n    height: 20px;   \n    line-height: 20px; \n}\nul {  /* 设置UL样式，去掉小圆点，让二级菜单与一级菜单之间没有缩进 */\n    list-style: none;\n    margin: 0;\n    padding: 0;\n}\n.main {\n    margin-bottom: 1px;\n}\n.main, hmain { /* 菜单的样式 */\n    width: 120px;\n}\n.main a.first, .hmain a.first{  /* 设置一级菜单的样式 */\n    background-color: #000;\n    color: #fff;\n}\n.main ul , .hmain ul{ /* 设置二级菜单的样式 */\n    background-color: #eee;\n    display: none;\n    width: 120px;\n}\n.main li, .hmain li{\n    padding: 3px;    \n}\n.hmain {\n    float: left;\n    margin-right: 1px;\n}\n</pre>\n<br />menu.js源码：\n<br /><pre name=\"code\" class=\"js\">\n$(function() {\n    // 针对纵向菜单，只要点击后显示或隐藏即可\n    $(\".main &gt; a\").click(function() {\n        var ulNode = $(this).next(\"ul\");\n        ulNode.slideToggle(\"slow\");\n    });\n\n    // 针对横向菜单，需要在鼠标移上时显示，移除时隐藏\n    $(\".hmain\").hover(function() {\n        $(this).children(\"ul\").slideDown(\"slow\");\n    }, function() {\n        $(this).children(\"ul\").slideUp(\"slow\");\n    });\n});\n</pre>\n<br />从JS代码可以看出，比较简单，主要就是一个slideToggle和hover的使用了。。。\n<br />下面附上的文件是从网上下载的，比较完整，还包括了图片的切换等。。\n<br />以上代码兼容：ie6,7,8,opera,ff,chrome\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/b3489509-3532-3805-8c0f-ac8097df0786\">3.menu.rar</a> (31.9 KB)</li>\n          <li>描述: 源码</li>\n          <li>下载次数: 41</li>\n        </ul>\n      \n    \n    \n  ',NULL,694,'0110','jQuery',NULL,0),(838,'2009-10-21 15:52:34','只能输入数字的文本框(兼容ie6,7,8,opera,ff,chrome)','     星期天上班真不知道干什么事哦，只好随便看看之前下载的电子书了，在看jQuery基础教程，里面看到一个小例子，拒绝非数字输入，觉得蛮好玩的，跟着那书上了例子把代码打了出来，可是在测试的时候却是有问题的，本来应该是只能输入数字的，可连英文字母都能输入，自己稍微改了一下。<br />\nhtml源码如下：<br />\nhtml<br />\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"js/jquery.pack.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"js/JScript.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;只能输入数字的文本框:&lt;input type=\"text\" id=\"quantity\" name=\"quantity\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;span id=\"mes\" style=\"color:#00f;\"&gt;&lt;/span&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n<br />\nJScript.js源码如下：&nbsp;<br />\njs<br />\n<div>$(function() {</div>\n<div>&nbsp;&nbsp; &nbsp;// 给文本框加个keypress，即键盘按下的时候判断</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#quantity\").keypress(function(event) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (!$.browser.mozilla) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#mes\").text(\"您按下的键值是: \" + event.keyCode);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (event.keyCode &amp;&amp; (event.keyCode &lt; 48 || event.keyCode &gt; 57)) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// ie6,7,8,opera,chrome管用</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;event.preventDefault();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;} else {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#mes\").text(\"您按下的键值是: \" + event.charCode);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (event.charCode &amp;&amp; (event.charCode &lt; 48 || event.charCode &gt; 57)) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// firefox管用</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;event.preventDefault();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div>});</div>\n/js<br />\n<br />\n要注意的就是我们是在文本框的keypress事件上编写代码，即键盘按下的时候我们就要做判断了。。&nbsp;<br />\n之所以要加判断是经本人测试，有些浏览器支持keyCode，有些浏览器支持charCode的，总之以上代码兼容IE6,7,8,oprea,firefox,chrome浏览器。&nbsp;<br />\n以上代码还有一个缺陷就是可以往文本框里输入中文的，请哪位高手帮忙改一下。。。呵呵。。。多谢了。。。&nbsp;<br />\n<br />\n注：如果是要只能输入最多两位小数的正数的话则JS代码如下：&nbsp;<br />\njs<br />\n<div>/*</div>\n<div>&nbsp;* 创建人：牛腩</div>\n<div>&nbsp;* 说明：只能向文本框里输入数字，缺点是可以输入中文，所以还要在焦点失去的时候做个判断</div>\n<div>&nbsp;*/</div>\n<div>$(function() {</div>\n<div>&nbsp;&nbsp; &nbsp;// 给文本框加个keypress，即键盘按下的时候判断</div>\n<div>$(\"#ctl00_ContentPlaceHolder1_txtSumValue\").keypress(function(event) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (!$.browser.mozilla) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (event.keyCode &amp;&amp; (event.keyCode &lt; 48 || event.keyCode &gt; 57) &amp;&amp; event.keyCode != 46) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// ie6,7,8,opera,chrome管用</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;event.preventDefault();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;} else {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (event.charCode &amp;&amp; (event.charCode &lt; 48 || event.charCode &gt; 57) &amp;&amp; event.keyCode != 46) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// firefox管用</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;event.preventDefault();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;// 当文本框失去焦点的时候，检测输入的是否是数字</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#ctl00_ContentPlaceHolder1_txtSumValue\").blur(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;var input = $(this);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;var v = $.trim(input.val());</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;//alert(\"输入值：\" + v);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;var reg = new RegExp(\"^0-9+(.0-9{2})?$\", \"g\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (!reg.test(v)) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert(\"请输入一个数字，最多只能有两位小数！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;input.val(\"0\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div>});</div>\n/js<br />\n<br />\n一位网友提供的，屏蔽输入法和粘贴：<br />\njs<br />\n<div>//屏蔽输入法</div>\n<div>$(#ctl00_ContentPlaceHolder1_txtSumValue).css(\"ime-mode\", \"disabled\");</div>\n<div>//然后用jquery绑定一个paste事件，屏蔽粘贴。</div>\n<div>$(#ctl00_ContentPlaceHolder1_txtSumValue).bind(\"paste\", function() {</div>\n<div>&nbsp;&nbsp;//....</div>\n<div>});</div>\n/js                   	                          	                          	                          ',NULL,1169,'0110','jQuery',NULL,0),(839,'2009-10-21 15:52:34','又发工资啦...嘿嘿...','\n    前天刚刚发工资,总共￥1350\n<br />\n<br />给老娘￥200\n<br />给奶奶￥100\n<br />配眼镜￥200\n<br />*****￥200\n<br />公交卡充值￥100\n<br />手机话费充值￥50\n<br />CD刻录光盘一盒￥50\n<br />购买杂七杂八的东西￥100\n<br />公司同事儿子百日酒￥100\n<br />\n<br />距离下次发工资还有27天左右~~~~~\n<br />\n<br />\n<br />\n  ',NULL,772,'0103','随笔',NULL,0),(840,'2009-10-21 15:52:34','(视频)在Linux服务器上部署Java应用','    &nbsp;&nbsp;&nbsp; 北大青鸟5.0课件里附带的linux视频,用的是redhat操作系统,里面涉及到安装,简单使用,部署JAVA应用程序这几方面的操作,自己看过了觉得还是很有用的,想要学习LINUX下部署JAVA应用的朋友可以看看.<br />\n<br />\n下载地址:<br />\n<a target=\"_blank\" href=\"http://www.namipan.com/d/%e5%9c%a8Linux%e6%9c%8d%e5%8a%a1%e5%99%a8%e4%b8%8a%e9%83%a8%e7%bd%b2Java%e5%ba%94%e7%94%a8.7z/a297d6320c0b29a781fbcd96519abcf2379df5a33c10770b\">http://www.namipan.com/d/%e5%9c%a8Linux%e6%9c%8d%e5%8a%a1%e5%99%a8%e4%b8%8a%e9%83%a8%e7%bd%b2Java%e5%ba%94%e7%94%a8.7z/a297d6320c0b29a781fbcd96519abcf2379df5a33c10770b</a><br />\n<br />\n纳米盘下载,有下不了的可发邮件我,我已上传到QQ超大附件上.<br />\n164423073@qq.com<br />\n<br />\n滥发别人的视频不知道算不算侵权哦!!!  	                          ',NULL,888,'0104','下载',NULL,0),(841,'2009-10-21 15:52:34','SQL分页语句','	  	  	  	  \n    比较万能的分页：\n<br /><br /><pre name=\"code\" class=\"sql\">select top 每页显示的记录数 * from topic where id not in (select top （当前的页数-1）×每页显示的记录数 id from topic order by id desc)\n order by id desc\n</pre>\n\n&nbsp;需要注意的是在access中不能是top 0，所以如果数据只有一页的话就得做判断了。。\n\n\n\n\nSQL2005中的分页代码:\n\n<pre name=\"code\" class=\"sql\">with temptbl as (  SELECT ROW_NUMBER() OVER (ORDER BY id desc)AS Row, \n  ...\n)\nSELECT * FROM temptbl where Row between @startIndex and @endIndex</pre>\n\n&nbsp;\n  	  	\n	  	  	\n	  	  	\n	  	  	\n	  ',NULL,1130,'0106','SQL',NULL,0),(842,'2009-10-21 15:52:34','牛腩新闻发布系统','&nbsp;&nbsp;&nbsp; 初学.NET三层，自己做了一个新闻发布系统，打算录制成视频，共享出来给大家看看评评，鸡蛋砖头请自备，欢迎来砸！ <br />\n&nbsp;&nbsp;&nbsp; 整个新闻发布系统的功能很简单，数据库增删查改而已，再配合一些杂七杂八的花哨。。。 <br />\n&nbsp;&nbsp;&nbsp; 具体的视频里再说，下面先早泄出一些界面图，以供大家欣赏！ <br />\n<br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/01.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/02.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/03.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/04.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/05.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/06.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/07.jpg\" width=\"480\" /><br />\n<img border=\"0\" alt=\"\" src=\"http://niunan.net/bbspic/newssystem/08.jpg\" width=\"480\" /><br />\n<br />\n&nbsp;&nbsp; 整个视频录制打算分四部分来录制：<br />\n1、软件安装及数据库设计、文档编写<br />\n2、.NET三层后台代码编写<br />\n3、DIV+CSS前台界面设计（兼容IE6,7,8,firefox,opera,chrome）<br />\n4、后台代码与前台界面的整合及其他杂七杂八的花哨（ajax,jQuery）<br />\n视频目录：<br />\n<span style=\"color:#0162f4;\">第01讲-软件安装 </span><br />\n<span style=\"color:#0162f4;\">第02讲-数据库设计1 </span><br />\n<span style=\"color:#0162f4;\">第03讲-数据库设计2 </span><br />\n<span style=\"color:#0162f4;\">第04讲-界面模拟图设计 </span><br />\n<br />\n<span style=\"color:#0162f4;\">第05讲-数据表操作类设计 </span><br />\n<span style=\"color:#0162f4;\">第06讲-编写SQLHelper</span><br />\n<span style=\"color:#0162f4;\">第07讲-编写类别表操作类</span><br />\n<span style=\"color:#0162f4;\">第08讲-重构SQLHelper</span><br />\n<span style=\"color:#0162f4;\">第09讲-浅入浅出SQL注入</span><br />\n<span style=\"color:#0162f4;\">第10讲-建立新闻类别实体类</span><br />\n<span style=\"color:#0162f4;\">第11讲-浅入浅出SQL触发器</span><br />\n<span style=\"color:#0162f4;\">第12讲-编写新闻评论类</span><br />\n<span style=\"color:#0162f4;\">第13讲-浅入浅出存储过程</span><br />\n<span style=\"color:#0162f4;\">第14讲-重构SQLHelper2 </span><br />\n<span style=\"color:#0162f4;\">第15讲-编写剩下的存储过程 </span><br />\n<span style=\"color:#0162f4;\">第16讲-完成新闻表操作类 </span><br />\n<span style=\"color:#0162f4;\">第17讲-编写BLL层</span><br />\n<br />\n<span style=\"color:#0162f4;\">第18讲-界面制作必备软件 </span><br />\n<span style=\"color:#0162f4;\">第19讲-CSS简介</span><br />\n<span style=\"color:#0162f4;\">第20讲-CSS核心内容</span><br />\n<span style=\"color:#0162f4;\">第21讲-制作首页1</span><br />\n<span style=\"color:#0162f4;\">第22讲-制作首页2 </span><br />\n<span style=\"color:#0162f4;\">第23讲-制作首页3 </span><br />\n<span style=\"color:#0162f4;\">第24讲-首页制作4 </span><br />\n<span style=\"color:#0162f4;\">第25讲-首页制作5 </span><br />\n<span style=\"color:#0162f4;\">第26讲-制作母版页　</span><br />\n<span style=\"color:#0162f4;\">第27讲-其他页面制作1</span><br />\n<span style=\"color:#0162f4;\">第28讲-其他页面制作2 </span><br />\n<span style=\"color:#0162f4;\">第29讲-带边框的圆角框制作1</span><br />\n<span style=\"color:#0162f4;\">第30讲-带边框的圆角框制作2 </span><br />\n<span style=\"color:#0162f4;\">第31讲-制作出错页</span><br />\n<span style=\"color:#0162f4;\">第32讲-可变宽度的圆角框制作1</span><br />\n<span style=\"color:#0162f4;\">第33讲-可变宽度的圆角框制作2</span><br />\n<span style=\"color:#0162f4;\">第34讲-完成类别管理页面制作</span><br />\n<span style=\"color:#0162f4;\">第35讲-完成界面制作</span><br />\n<br />\n<span style=\"color:#0162f4;\">第36讲-整合首页1</span><br />\n<span style=\"color:#0162f4;\">第37讲-整合首页2</span><br />\n<span style=\"color:#0162f4;\">第38讲-整合新闻列表页</span><br />\n<span style=\"color:#0162f4;\">第39讲-整合搜索页</span><br />\n<span style=\"color:#0162f4;\">第40讲-整合新闻内容页1</span><br />\n<span style=\"color:#0162f4;\">第41讲-整合新闻内容页2</span><br />\n<span style=\"color:#0162f4;\">第42讲-整合新闻内容页3</span><br />\n<span style=\"color:#0162f4;\">第43讲-前台页面除错</span><br />\n<span style=\"color:#0162f4;\">第44讲-整合登陆页</span><br />\n<span style=\"color:#0162f4;\">第45讲-整合类别管理页1</span><br />\n<span style=\"color:#0162f4;\">第46讲-整合类别管理页2 </span><br />\n<span style=\"color:#0162f4;\">第47讲-整合类别管理页3 </span><br />\n<span style=\"color:#0162f4;\">第48讲-整合类别管理页4</span><br />\n<span style=\"color:#0162f4;\">第49讲-整合类别管理页5 </span><br />\n<span style=\"color:#0162f4;\">第50讲-整合类别管理页6 </span><br />\n<span style=\"color:#0162f4;\">第51讲-整合类别管理页7</span><br />\n<span style=\"color:#0162f4;\">第52讲-整合类别管理页8</span><br />\n<span style=\"color:#0162f4;\">第53讲-整合类别管理页9</span><br />\n<span style=\"color:#0162f4;\">第54讲-整合类别管理页10 </span><br />\n<span style=\"color:#0162f4;\">第55讲-整合类别管理页11</span><br />\n<span style=\"color:#0162f4;\">第56讲-整合新闻管理页1</span><br />\n<span style=\"color:#0162f4;\">第57讲-整合新闻管理页2 </span><br />\n<span style=\"color:#0162f4;\">第58讲-整合新闻管理页3 </span><br />\n<span style=\"color:#0162f4;\">第59讲-整合添加新闻页1</span><br />\n<span style=\"color:#0162f4;\">第60讲-整合添加新闻页2 </span><br />\n<span style=\"color:#0162f4;\">第61讲-尾声</span><br />\n<span style=\"color:#0162f4;\">第62讲-尾声续 </span><br />\n<span style=\"color:#0162f4;\">第63讲-尾声最后续</span><br />\n&nbsp;&nbsp; &nbsp;<span style=\"color:#fe2419;\">视频下载地址：</span><br />\n<span style=\"color:#f10b00;\"><font color=\"#000000\"><a href=\"http://item.taobao.com/item.htm?id=7897929467\">http://item.taobao.com/item.htm?id=7897929467</a><br />\n<br />\n</font></span><br />\n<span style=\"color:#9b014f;\">注：话筒好像有问题，录出的视频有杂音，请大家多多包涵，将就一下！</span><br />\n<span style=\"color:#9b014f;\">采用标准的带有广西特点的普通话讲课，所以有些北方的朋友可能刚刚开始听着有点听不懂，听久了就习惯了！</span><br />\n<br />\n<span style=\"color:#5c585a;font-size:16px;\">采用到的技术: .NET三层构架+SQL2005+jQuery+AJAX+DIV+CSS</span><br />\n<span style=\"color:#5c585a;font-size:16px;\">开发平台: Visual Studio 2008 Express + SQL2005 Express + XP SP3</span><br />\n<span style=\"color:#5c585a;font-size:16px;\">开发语言：ASP.NET C#</span><br />\n<br />\n',NULL,2829,'0112','原创视频',NULL,0),(824,'2009-10-21 15:52:33','jQuery插件_jcarousel(用于图片滚动)','	  \n    效果图如下:\n<br /><img src=\"http://niunan.net/bbspic/jquery/03.jpg\" />\n<br />\n<br />目前制作的项目中用到,先记下来,以备不时之需!\n<br />\n<br />附件中一个是直接从网上下下来的,另一个是自己精简了一下,只留下自己需要的~\n  \n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://niunan.net/download/jqueryscrollpic.7z\">jquery插件_图片滚动__jcarousel.zip</a></li>\n  \n        </ul>    \n    \n      \n   \n      \n    \n    \n  	  \n	  </div>',NULL,879,'0110','jQuery',NULL,0),(825,'2009-10-21 15:52:33','自己封装的一个ASP.NET上传文件的方法','<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">&nbsp;&nbsp;自我感觉封装得还不错！！！&nbsp;<br />\n代码如下：&nbsp;<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// 上传文件方法</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;/summary&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"myFileUpload\"&gt;上传控件ID&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"allowExtensions\"&gt;允许上传的扩展文件名类型,如：string allowExtensions = { \".doc\", \".xls\", \".ppt\", \".jpg\", \".gif\" };&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"maxLength\"&gt;允许上传的最大大小，以M为单位&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"savePath\"&gt;保存文件的目录，注意是绝对路径,如：Server.MapPath(\"~/upload/\");&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/// &lt;param name=\"saveName\"&gt;保存的文件名，如果是\"\"则以原文件名保存&lt;/param&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;private void Upload(FileUpload myFileUpload, string allowExtensions, int maxLength, string savePath, string saveName)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 文件格式是否允许上传</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bool fileAllow = false;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//检查是否有文件案</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (myFileUpload.HasFile)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 检查文件大小, ContentLength获取的是字节，转成M的时候要除以2次1024</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (myFileUpload.PostedFile.ContentLength / 1024 / 1024 &gt;= maxLength)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Exception(\"只能上传小于2M的文件！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//取得上传文件之扩展文件名，并转换成小写字母</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string fileExtension = System.IO.Path.GetExtension(myFileUpload.FileName).ToLower();</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string tmp = \"\"; &nbsp; // 存储允许上传的文件后缀名</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//检查扩展文件名是否符合限定类型</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (int i = 0; i &lt; allowExtensions.Length; i++)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tmp += i == allowExtensions.Length - 1 ? allowExtensionsi : allowExtensionsi + \",\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (fileExtension == allowExtensionsi)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fileAllow = true;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (fileAllow)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string path = savePath + (saveName == \"\" ? myFileUpload.FileName : saveName);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//存储文件到文件夹</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;myFileUpload.SaveAs(path);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Exception(ex.Message);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Exception(\"文件格式不符，可以上传的文件格式为：\" + tmp);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Exception(\"请选择要上传的文件！\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/c#<br />\n<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">以下是测试的代码：&nbsp;<br />\nc#<br />\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;try</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string ss = { \".jpg\", \".gif\" };</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string path = Request.MapPath(\"~/upload/\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Upload(FileUpload1, ss, 1, path, \"\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Label1.Text = \"文件上传成功！\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;catch (Exception ex)</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Label1.Text = ex.Message;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n/c#<br />\n以前一直没有认真的学习异常处理，今天弄了一下还发现异常处理还蛮好的。。。起码代码量上感觉比if..else..少。。。呵呵。。。</span><br />\n</span>',NULL,1075,'0101','ASP.NET',NULL,0),(826,'2009-10-21 15:52:33','Response.Redirect能在新窗口中打开','    &nbsp;&nbsp;&nbsp; 在ASP.NET中，给BUTTON控件里的事件加上Response.Redirect...页面会在当前的页面打开，如果想要让在新窗口中打开的话只需要在Page_Load事件中加上如下代码即可：<br />\n<br />\nc#<br />\n//当点击搜索按钮时在新窗口中打开<br />\nbtnSearch.Attributes.Add(\"onclick\", \"this.form.target=&#039;_newName&#039;\"); &nbsp;&nbsp;<br />\n/c#                       	                          ',NULL,786,'0101','ASP.NET',NULL,0),(827,'2009-10-21 15:52:33','获取FileUpload控件中的文件名','\n    两种方式可以取得：\n<br />①　FileUpload1.FileName;\n<br />②　FileUpload1.PostedFile.FileName;\n<br />\n<br />经测试，假如选择的文件是c:&#92;aaa.rar\n<br />则通过方法１获取的文件名就是aaa.rar，ie6,7,8,opera,ff,chrome上都是这样\n<br />如果通过方法２获取，则ie6上是取出c:&#92;aaa.rar,其他浏览器是取出aaa.rar \n<br />\n<br />特此记录，以备不时之需！\n  ',NULL,703,'0101','ASP.NET',NULL,0),(828,'2009-10-21 15:52:33','GridView生成的HTML代码','\n    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"false\" <span style=\"color: red\">CssClass=\"tablecss\"</span>&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Columns&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:TemplateField HeaderText=\"编号\" <span style=\"color: green\">HeaderStyle-CssClass=\"aaa\"</span> <span style=\"color: blue\">ItemStyle-CssClass=\"bbb\"</span>&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ItemTemplate&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%#Eval(\"id\") %&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ItemTemplate&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:TemplateField&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:TemplateField HeaderText=\"姓名\" HeaderStyle-CssClass=\"aaa\" ItemStyle-CssClass=\"bbb\"&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ItemTemplate&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%#Eval(\"name\") %&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ItemTemplate&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:TemplateField&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Columns&gt;\n<br />&nbsp;&nbsp;&nbsp; &lt;/asp:GridView&gt;\n<br />↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓\n<br />&nbsp;&nbsp; &lt;div&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;table <span style=\"color: red\">class=\"tablecss\"</span> cellspacing=\"0\" rules=\"all\" border=\"1\" id=\"Table1\" style=\"border-collapse: collapse;\"&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;th <span style=\"color: green\">class=\"aaa\"</span> scope=\"col\"&gt;编号&lt;/th&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;th <span style=\"color: green\">class=\"aaa\"</span> scope=\"col\"&gt;姓名&lt;/th&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span style=\"color: blue\">class=\"bbb\"</span>&gt;1&lt;/td&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span style=\"color: blue\">class=\"bbb\"</span>&gt;张三&lt;/td&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span style=\"color: blue\">class=\"bbb\"</span>&gt;2&lt;/td&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;td <span style=\"color: blue\">class=\"bbb\"</span>&gt;李四&lt;/td&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/tr&gt;\n<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/table&gt;\n<br />&nbsp;&nbsp;&nbsp; &lt;/div&gt;\n  ',NULL,732,'0101','ASP.NET',NULL,0),(829,'2009-10-21 15:52:33','制作多级滑动tab菜单','    效果演示网站:http://kr.shopping.yahoo.com/<br />\n就是上面网址中居中的那个多级的滑动tab菜单,下面的图是我自己用jquery制作出的效果:<br />\n<img src=\"http://taotao.wsyren.com/bbspic/multitab/01.jpg\" /><br />\n我自己制作的效果演示网址是:<br />\nhttp://taotao.wsyren.com/multitab/multitab.html<br />\n<br />\n总的来说制作这个效果用到的js代码并不是很难,难的主要就是CSS的样式设置问题,以上代码兼容ie6,7,8,opera,ff,chrome.<br />\n<br />\n附上源码,供有需要的朋友下载改动!      <div class=\"attachments\">                  <ul>          <li><a href=\"http://dl.javaeye.com/topics/download/12cbb4df-2253-32a7-9246-f6b93b04bfe9\">多级滑动菜单.rar</a> (44.1 KB)</li>\n                </ul>\n                </div>\n	                          ',NULL,878,'0110','jQuery',NULL,0),(830,'2009-10-21 15:52:33','ASP.NET中读取excel内容,并显示在界面上','\n    &nbsp;&nbsp;&nbsp; 项目中经常会用到把excel的文件内容导入到数据库中的,刚刚花了点时间,做了个例子,基本上能实现导入Excel后显示的功能吧,导入的excel文件得是xls,即是2003的.\n<br />&nbsp;&nbsp;&nbsp; 代码思路如下:要读取的excel文件必得得是在本地硬盘,所以一般来说都是让远程用户选择自己硬盘上的Excel文件,然后把用户选择的文件上传到本地服务器上,再在本地服务器上进行操作.我把界面后置代码重要部分贴出来,大家自己慢慢看吧,都有注释了.\n<br /><pre name=\"code\" class=\"c#\">\n// 上传按钮\n    protected void btnUp_Click(object sender, EventArgs e)\n    {\n        bool b = Upload(fuExcel);  // 上传excel文件\n        if (!b)\n        {\n            return;\n        }\n        string name = fuExcel.FileName;\n        string filepath = Server.MapPath(\"~/upload/\") + name;\n        DataSet ds = ExcelDataSource(filepath, ExcelSheetName(filepath)0.ToString());\n        GridView1.DataSource = ds;\n        GridView1.DataBind();\n    }\n\n    //上传文件方法\n    private bool Upload(FileUpload myFileUpload)\n    {\n        bool flag = false;\n        //是否允许上载\n        bool fileAllow = false;\n        //设定允许上载的扩展文件名类型\n        string allowExtensions = { \".xls\" };\n\n        //取得网站根目录路径\n        string path = HttpContext.Current.Request.MapPath(\"~/upload/\");\n        //检查是否有文件案\n        if (myFileUpload.HasFile)\n        {\n            //取得上传文件之扩展文件名，并转换成小写字母\n            string fileExtension = System.IO.Path.GetExtension(myFileUpload.FileName).ToLower();\n            //检查扩展文件名是否符合限定类型\n            for (int i = 0; i &lt; allowExtensions.Length; i++)\n            {\n                if (fileExtension == allowExtensionsi)\n                {\n                    fileAllow = true;\n                }\n            }\n\n            if (fileAllow)\n            {\n                try\n                {\n                    //存储文件到文件夹\n                    myFileUpload.SaveAs(path + myFileUpload.FileName);\n                    lblMes.Text = \"文件导入成功\";\n                    flag = true;\n                }\n                catch (Exception ex)\n                {\n                    lblMes.Text += ex.Message;\n                    flag = false;\n                }\n            }\n            else\n            {\n                lblMes.Text = \"不允许上载：\" + myFileUpload.PostedFile.FileName + \"，只能上传xls的文件，请检查！\";\n                flag = false;\n            }\n        }\n        else\n        {\n            lblMes.Text = \"请选择要导入的excel文件!\";\n            flag = false;\n        }\n        return flag;\n    }\n\n    //该方法实现从Excel中导出数据到DataSet中，其中filepath为Excel文件的绝对路径， sheetname为excel文件中的表名\n    public DataSet ExcelDataSource(string filepath, string sheetname)\n    {\n        string strConn;\n        strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + filepath + \";Extended Properties=Excel 8.0;\";\n        OleDbConnection conn = new OleDbConnection(strConn);\n        OleDbDataAdapter oada = new OleDbDataAdapter(\"select * from \" + sheetname + \"\", strConn);\n        DataSet ds = new DataSet();\n        oada.Fill(ds);\n        conn.Close();\n        return ds;\n    }\n\n    //获得Excel中的所有sheetname。\n    public ArrayList ExcelSheetName(string filepath)\n    {\n        ArrayList al = new ArrayList();\n        string strConn;\n        strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + filepath + \";Extended Properties=Excel 8.0;\";\n        OleDbConnection conn = new OleDbConnection(strConn);\n        conn.Open();\n        DataTable sheetNames = conn.GetOleDbSchemaTable\n        (System.Data.OleDb.OleDbSchemaGuid.Tables, new object { null, null, null, \"TABLE\" });\n        conn.Close();\n        foreach (DataRow dr in sheetNames.Rows)\n        {\n            al.Add(dr2);\n        }\n        return al;\n    }\n</pre>\n<br />要注意的是我们要一开始就在网站根目录下建立upload文件夹,而且要把他的权限设置为可读可写的?这个权限的问题搞得头大,不知道到底应该怎么搞的,XP系统下新建立的文件夹好像都是只读的,我右键属性把只读去掉,结果再次查看的时候还是只读,不过好像发现对程序没有什么意思,上传完excel文件后还是可以读取查看的.\n<br />下面是源码:\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/aed9a3c9-a2a5-372b-98db-12fc2e3b1dac\">上传excel后查看内容.rar</a> (2 KB)</li>\n          \n          <li>下载次数: 41</li>\n        </ul>\n      \n    \n    \n  ',NULL,813,'0101','ASP.NET',NULL,0),(831,'2009-10-21 15:52:33','ACCP5.0Y2项目说明文档','    ACCP5.0Y2项目说明文档<br />\n<br />\n下载：<a target=\"_blank\" href=\"http://www.rayfile.com/files/793f41e3-b61b-11dd-884d-0019d11a795f/\">http://www.rayfile.com/files/793f41e3-b61b-11dd-884d-0019d11a795f/</a><br />\n<br />\n说明：包括四个项目的说明文档（HR人力资源管理系统、CRM客户关系管理系统、B2C游戏点卡销售系统、OA办公自动化系统），闲得发荒的人可以做做这些项目，对你们以后找工作是很有用滴！！！  	                          ',NULL,804,'0104','下载',NULL,0),(832,'2009-10-21 15:52:33','jQuery实战(四) - tab菜单','    很多天前就已经看完jQuery实战第四讲了,不过一直没有时间做笔记,呵呵,趁着今天有点空,上来记录记录...<br />\n这一讲的内容是制作tab菜单,所谓的tab菜单,也就是类似于OFFICE2007的界面菜单那样子的,当然,用在网页上面的话我们只是需要鼠标滑过就显示相应的内容而不必点击了,效果图如下:<br />\n<img src=\"http://niunan.net/bbspic/tab/01.jpg\" /><br />\n在这节课里讲到了二个tab菜单的制作,第一个没有用到AJAX,每个菜单对应的内容都是事先已经在网页里的,只是把他们隐藏了而已,而第二个就用到了AJAX实时的提取内容数据.其实整个JS代码的编写也并不是很复杂,本人觉得难的主要在于CSS的编写上,如何才能让菜单与内容进行无缝结合...<br />\n以下是tab.aspx的源码:<br />\nhtml&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"tab.aspx.cs\" Inherits=\"tab\" %&gt;<div><br />\n</div>\n<div>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head runat=\"server\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;jQuery实战-tab菜单&lt;/title&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;link href=\"css/tab.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"js/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;script src=\"js/tab.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</div>\n<div><br />\n</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"tab1\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;ul&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li class=\"tabin first\"&gt;菜单一&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li&gt;菜单二&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li&gt;菜单三&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/ul&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=\"contentin\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;菜单一的内容&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;菜单二的内容&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;菜单三的内容&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;br /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;div id=\"tab2\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;ul&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li class=\"tabin first\"&gt;获取整个网页内容&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li&gt;获取网页部分内容&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;li&gt;获取handler输入的内容&lt;/li&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/ul&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=\"container\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=\"loading\"&gt;&lt;img src=\"images/loading.gif\" alt=\"loading\" /&gt; 数据提取中,请稍候...&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=\"content\"&gt;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;/div&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">以下是tab.css的源码:&nbsp;<br />\n</span>cssbody {<div>&nbsp;&nbsp; &nbsp;font-size:14px;</div>\n<div>}</div>\n<div>ul, li {</div>\n<div>&nbsp;&nbsp; &nbsp;list-style:none;</div>\n<div>&nbsp;&nbsp; &nbsp;padding: 0;</div>\n<div>&nbsp;&nbsp; &nbsp;margin: 0;</div>\n<div>}</div>\n<div>#tab1 li {</div>\n<div>&nbsp;&nbsp; &nbsp;width: 50px;</div>\n<div>&nbsp;&nbsp; &nbsp;height: 25px;</div>\n<div>&nbsp;&nbsp; &nbsp;line-height: 25px;</div>\n<div>&nbsp;&nbsp; &nbsp;background-color: #8A4B04;</div>\n<div>&nbsp;&nbsp; &nbsp;float: left;</div>\n<div>&nbsp;&nbsp; &nbsp;margin-right: 2px;</div>\n<div>&nbsp;&nbsp; &nbsp;border: 2px solid #fff;</div>\n<div>&nbsp;&nbsp; &nbsp;text-align: center;</div>\n<div>&nbsp;&nbsp; &nbsp;cursor: pointer; &nbsp;/* 移上该元素上时鼠标为手形 */</div>\n<div>}</div>\n<div>#tab1 div {</div>\n<div>&nbsp;&nbsp; &nbsp;width: 300px;</div>\n<div>&nbsp;&nbsp; &nbsp;height: 100px;</div>\n<div>&nbsp;&nbsp; &nbsp;background-color: #8A4B04;</div>\n<div>&nbsp;&nbsp; &nbsp;display: none; /* 默认不显示 */</div>\n<div>&nbsp;&nbsp; &nbsp;padding: 10px;</div>\n<div>&nbsp;&nbsp; &nbsp;clear: left;</div>\n<div>}</div>\n<div>.first { &nbsp;/* 第一个tab菜单 */</div>\n<div>&nbsp;&nbsp; &nbsp;margin-left:10px;</div>\n<div>}</div>\n<div>#tab1 .contentin { &nbsp;/* 当前菜单对应的DIV的样式 */</div>\n<div>&nbsp;&nbsp; &nbsp;display: block;</div>\n<div>}</div>\n<div>#tab1 .tabin { /* 当前菜单的样式 */</div>\n<div>&nbsp;&nbsp; &nbsp;border-bottom-color: #8A4B04;</div>\n<div>}</div>\n<div><br />\n</div>\n<div>#tab2 li {</div>\n<div>&nbsp;&nbsp; &nbsp;width: 150px;</div>\n<div>&nbsp;&nbsp; &nbsp;height: 25px;</div>\n<div>&nbsp;&nbsp; &nbsp;line-height: 25px;</div>\n<div>&nbsp;&nbsp; &nbsp;border: 1px solid #9EC9FE;</div>\n<div>&nbsp;&nbsp; &nbsp;float: left;</div>\n<div>&nbsp;&nbsp; &nbsp;text-align:center;</div>\n<div>&nbsp;&nbsp; &nbsp;margin-right: 10px;</div>\n<div>&nbsp;&nbsp; &nbsp;cursor: pointer; &nbsp;/* 移上该元素上时鼠标为手形 */</div>\n<div>}</div>\n<div>#tab2 #container {</div>\n<div>&nbsp;&nbsp; &nbsp;width: 600px;</div>\n<div>&nbsp;&nbsp; &nbsp;height: 200px;</div>\n<div>&nbsp;&nbsp; &nbsp;border: 1px solid #9EC9FE;</div>\n<div>&nbsp;&nbsp;/* margin-top: -1px; &nbsp;如果用这条样式的话那只是在IE里能出现缺口*/</div>\n<div>&nbsp;&nbsp; &nbsp;padding: 20px;</div>\n<div>&nbsp;&nbsp; &nbsp;position: relative;</div>\n<div>&nbsp;&nbsp; &nbsp;top: -1px;</div>\n<div>&nbsp;&nbsp; &nbsp;clear: left;</div>\n<div>}</div>\n<div>#tab2 .tabin {</div>\n<div>&nbsp;&nbsp; &nbsp;border-bottom: 1px solid #fff;</div>\n<div>&nbsp;&nbsp; &nbsp;position:relative; &nbsp; /* 要让z-index产生效果,则必须把元素的position设置为relative或者absolute */</div>\n<div>&nbsp;&nbsp; &nbsp;z-index: 100;</div>\n<div>}</div>\n/css<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">以下是tab.js的源码:&nbsp;<br />\n</span>jsvar timeoutid; &nbsp; &nbsp;// 延迟处理时使用<div>$(function() {</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#tab1 li\").each(function(index) { &nbsp;// index为当前菜单的索引,从0开始</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;var liNode = $(this);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;liNode.mouseover(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timeoutid = setTimeout(function() { &nbsp; &nbsp;// 延迟处理</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab1 .contentin\").removeClass(\"contentin\"); &nbsp; // 原来含有contentin样式的DIV块去除contentin样式</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab1 .tabin\").removeClass(\"tabin\"); &nbsp;// 原来含有tabin样式的菜单去除tabin样式</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab1 div\").eq(index).addClass(\"contentin\"); &nbsp;// 显示相应的DIV块的内容</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;liNode.addClass(\"tabin\"); // 给当前菜单加上tabin样式</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, 300);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;});</div>\n<div>&nbsp;&nbsp; &nbsp;}).mouseout(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;clearTimeout(timeoutid);</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;//在整个页面装入完成后，标签效果2的内容区域需要装入静态的html页面内容</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#tab2 #container #content\").load(\"tab.htm\"); &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#tab2 li\").each(function(index) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(this).mouseover(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var liNode = $(this);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timeoutid = setTimeout(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab2 .tabin\").removeClass(\"tabin\"); &nbsp;// 原来含有tabin样式的菜单去除tabin样式</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;liNode.addClass(\"tabin\"); // 给当前菜单加上tabin样式</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;switch (index) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case 0:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab2 #container #content\").load(\"tab.htm\"); &nbsp;// 提取网页全部内容</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case 1:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab2 #container #content\").load(\"tab.htm h2\"); &nbsp; // 提取网页部分内容</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case 2:</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 提取handler的输出内容, 加个参数防止页面缓存</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab2 #container #content\").load(\"handler/tab.ashx?t=\" + new Date().getTime()); &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, 300);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}).mouseout(function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;clearTimeout(timeoutid);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;});</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;//对于loading图片绑定ajax请求开始和交互结束的事件</div>\n<div>&nbsp;&nbsp; &nbsp;$(\"#tab2 #loading\").bind(\"ajaxStart\", function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(\"#tab2 #container #content\").text(\"\");&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(this).show();</div>\n<div>&nbsp;&nbsp; &nbsp;}).bind(\"ajaxStop\", function() {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;$(this).hide();</div>\n<div>&nbsp;&nbsp; &nbsp;});</div>\n<div>});</div>\n/js<br />\n<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">在这里我们还使用了loading图片,让他绑定jQuery提供给我们的ajaxStart和ajaxStop事件.&nbsp;<br />\n为了能让我们的loading看到更好的效果,我在handler里用了线程,让他暂停3秒后再执行输出代码,以下是tab.ashx的源码:&nbsp;<br />\n</span>c#&lt;%@ WebHandler Language=\"C#\" Class=\"tab\" %&gt;<div><br />\n</div>\n<div>using System;</div>\n<div>using System.Web;</div>\n<div><br />\n</div>\n<div>public class tab : IHttpHandler {</div>\n<div>&nbsp;&nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;public void ProcessRequest (HttpContext context) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;context.Response.ContentType = \"text/plain\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;System.Threading.Thread.Sleep(3000); &nbsp; // 暂停3秒后再执行以下代码</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;context.Response.Write(\"这是Handler输出的内容!\");</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;public bool IsReusable {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;get {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return false;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>}</div>\n/c#<br />\n<br />\n<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">另外还有一个静态页面用于测试第二个tab菜单的第一项和第二项-载入静态页面,以下是tab.htm的源码:&nbsp;<br />\n</span>html&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;<div><br />\n</div>\n<div>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;</div>\n<div>&lt;head&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;title&gt;第4讲的测试网页&lt;/title&gt;</div>\n<div>&lt;/head&gt;</div>\n<div>&lt;body&gt;</div>\n<div>&lt;h2&gt;第4讲的测试网页&lt;/h2&gt;</div>\n<div>&lt;p&gt;今晚打老虎!!!&lt;/p&gt;</div>\n<div>&lt;/body&gt;</div>\n<div>&lt;/html&gt;</div>\n/html<br />\n<br />\n其实不只是静态页,即使是动态页如ASPX等,jQuery里的load方法也能载入,jQuery中的load方法其实也就是相当于一个简化了的AJAX提交而已... <br />\n以上就是这节课的内容,我会附上源码的,我是在vs2008下测试的! <br />\n以上代码兼容ie6,7,8,opera,ff,chrome<br />\n源码下载：<a href=\"http://niunan.net/download/jQueryAction4.rar\" target=\"_blank\">http://niunan.net/download/jQueryAction4.rar</a><br />\n<br />\n',NULL,951,'0110','jQuery',NULL,0),(833,'2009-10-21 15:52:33','Programming ASP.NET 中文版(第3版) ','    【内容简介】<br />\n本书主要介绍.NET平台和ASP.NET；HTML编程基础；比较ASP和ASP.NET；ASP.NET中的事件；比较HTML控件和ASP控件；基本的ASP控件APl；代码隐藏窗体：使用Visual Studio.NET集成开发环境：跟踪，调试和错误处理；ASP.NET中的验证控件；数据绑定技术基础；列表控件和DataGrid控件；ADO.NET指南；调用存储过程；更新数据库记录；Repeater和DataList控件；自定义ASP.NET控件；Web服务概观；创建和消费一个用于证券报价机的Web服务示例；解释ASP.NET缓存技术；ASP.NET中用于验证、授权和模拟的安全选项；ASP.NET中的配置和部署选项：一个数据库设计快速指南的附录。.<br />\n<br />\n本书对于ASP.NET 2.0技术和Visual Studio 2005进行了全面讲解，出色地囊括了读者在实际编程中会用到的ASP.NET的重要特性，十分适合中级读者。..<br />\n<br />\n自2001年问世以来，Microsoft Visual Studio 和 ASP.NET已经成为构建基于Windows的web应用程序和服务的最受欢迎的开发工具。数千名开发人员已经通过这本权威的书籍掌握了这些工具。如今，在这本经过重新修订和扩充的新版本中，作者Jesse Liberty 和 Dan Hurwitz向你展示了如何使用Visual Studio 2005、C# 2.0和 ASP.NET 2.0构建下一代的web应用程序。你很快就可以在更短的时间内以更少的代码构建更为安全、交互性更强的站点，其效果甚至会超出你的想象。<br />\n<br />\n《Programming ASP.NET》首先简要介绍了ASP.NET 2.0 和 Visual Studio 2005，这样可以很快地提高你的工作效率。本书前面的章节深入介绍了控件、事件、ASP.NET web页的生命周期以及其他一些使用ASP.NET框架的基本概念。...<br />\n<br />\n<span style=\"color:red;\">下载:&nbsp;</span>  	<a href=\"http://www.namipan.com/d/107f27a50fd1b5d039b4f643e17a2aa7ab5b74a333646303\" target=\"_blank\">http://www.namipan.com/d/107f27a50fd1b5d039b4f643e17a2aa7ab5b74a333646303</a>                          ',NULL,776,'0104','下载',NULL,0),(815,'2009-10-21 15:52:32','用SQL语句来查询表结构!','    刚刚在做一个小项目,数据库中一张表有20来个字段,用我以前做的一个.NET实体类生成器一个一个的输入还是闲麻烦,于是打算找个时间来重新的改造一个那个.NET实体类,能够通过选择的数据库及用户表自动生成实体类,而且该实体类还有注释,即字段的说明字段,然后再加一个功能,生成数据库文档,其实也就是把字段字,类型,字段说明输出一个漂亮的表格而已,只要能获取出来生成HTML表格就比较容易了,上网找了一下,得到如下有用的SQL语句:<br />\nsql<br />\n-- 查询非系统数据库Select name FROM Master.. SysDatabases where dbid&gt;4<br />\n<br />\n-- 选择water数据库下的所有表<br />\n<br />\nuse water SELECT name FROM sysobjects WHERE xtype = &#039;U&#039; Or xtype = &#039;S&#039;<br />\n<br />\n-- 选择water数据库下的所有用户表<br />\n<br />\nuse water SELECT name FROM sysobjects WHERE xtype = &#039;U&#039; AND OBJECTPROPERTY (id, &#039;IsMSShipped&#039;) = 0<br />\n<br />\n-- 查询water数据库下的admin表的字段名,长度,类型,字段说明<br />\n<br />\nuse water SELECT a.name as &#039;字段名&#039;,a.length &#039;长度&#039;,c.name &#039;类型&#039;,e.value as &#039;字段说明&#039; FROM syscolumns  a left   join    systypes    b   on      a.xusertype=b.xusertype left 	join 	systypes 	c 	on  	a.xtype = c.xusertype inner   join   sysobjects  d   on      a.id=d.id     and   d.xtype=&#039;U&#039; left join sys.extended_properties e on a.id = e.major_id and a.colid = e.minor_id and e.name=&#039;MS_Description&#039;where d.name=&#039;admin&#039; /sql<br />\n其中sys.extended_properties系统内置视图用于存储字段说明,且只有在MSSQL2005以上才有这张表的,且前面的sys.不能去掉,SQL2000的话字段说明是存在另一个张表里的,表名忘记了,反正我不需要也懒得去查了...<br />\n特此记录!!!<br />\n<br />\n经测试若要查询某张表的字段信息的话还可用如下方法：<br />\n<pre name=\"code\" class=\"SQL\">select * from information_schema.columns where table_name =&#039;colocal&#039;</pre><br />\n经测试在MSSQL 2008中测试通过<br />\n<br />\n加多一条语句，选择出字段的默认值：<br />\nsql<br />\nSELECT a.name as &#039;字段名&#039;,c.name &#039;类型&#039;,e.value as &#039;字段说明&#039;,sm.text as &#039;默认值&#039; FROM syscolumns  a  <br />\nleft   join    systypes    b   on      a.xusertype=b.xusertype<br />\nleft 	join 	systypes 	c 	on  	a.xtype = c.xusertype<br />\ninner   join   sysobjects  d   on      a.id=d.id     and   d.xtype=&#039;U&#039; <br />\nleft join syscomments sm on a.cdefault=sm.id<br />\nleft join sys.extended_properties e on a.id = e.major_id and a.colid = e.minor_id and <br />\ne.name=&#039;MS_Description&#039; where d.name=&#039;dsajw_user&#039;<br />\n/sql<br />\n<br />\n<br />\n如果要查找表中的主键字段，则用如下SQL语句：<br />\nsql<br />\n1:利用sql自带的存储过程<br />\n<br />\nexec sp_pkeys @table_name=&#039;表名&#039;<br />\n<br />\n2:利用系统表information_schema.key_column_usage <br />\n<br />\nselect table_name,column_name from information_schema.key_column_usage <br />\nwhere table_name=&#039;表名&#039;<br />\n/sql<br />\n<br />\n<br />\n  	                          	                          	                          ',NULL,1052,'0106','SQL',NULL,0),(816,'2009-10-21 15:52:32','VS2008中设置成绝对定位的布局方式！','\n    <p>    绝对定位我根本就不用，那样会生成太多太多的多余代码，不过群里有个问起，花了点时间在VS2008中找了一下，</p>\n<p>工具→选项→HTML设计器→CSS样式→对于使用工具箱、粘贴或播放操作添加的控件，将定位更改为绝对定位打勾</p>\n<p> </p>\n<p>先记录下来，以备不时之需！</p>\n  ',NULL,681,'0101','ASP.NET',NULL,0),(817,'2009-10-21 15:52:32','热烈庆祝本人更换新电脑！！！','\n    <p>\n</p><p><span style=\"font-weight: bold;\">技嘉MA770-US3</span></p>\n<p><span style=\"font-weight: bold;\">迪兰恒进4670/512M雷钻</span></p>\n<p><span style=\"font-weight: bold;\">AMD 5400+</span></p>\n<p><span style=\"font-weight: bold;\">KINGMAX 2G DDR800</span></p>\n<p><span style=\"font-weight: bold;\">LG W1942SP</span></p>\n<p><span style=\"font-weight: bold;\">先锋217CH 20X DVD刻录机</span></p>\n<p><span style=\"font-weight: bold;\">西数不清320G 16M SATA 串</span></p>\n<p><span style=\"font-weight: bold;\">先马1908机箱（空）</span></p>\n<p><span style=\"font-weight: bold;\">航嘉冷静王VISTA版</span></p>\n<p></p>\n<p> </p>\n<p><span style=\"font-weight: bold;\"><br /></span></p>\n<p><span style=\"font-weight: bold;\">以前这旧电脑性能哇，速度贼慢贼慢滴，开2个QQ都会死机，自从换了新电脑以后，速度贼快，开20个QQ不成问题，以前安装VS08要1小时多，现在安装只要半小时不到，显示器也换成19寸宽屏了，这面子呀，也比以前大多了，这新电脑性能哇，一台顶过去三台，真值！！！<br /></span></p>\n<p> </p>\n  ',NULL,722,'0103','随笔',NULL,0),(818,'2009-10-21 15:52:32','jQuery中使用插件解决ie6下selectfqg元素设置z-index无效的问题！','\n    <p>      没用插件时的效果如下，这是在IE6下预览的结果，层的z-index不管设置多大都没用，select元素还是会在层上的<br />\n<img src=\"/upload/attachment/74453/313a720c-4afe-3cab-a8d1-ae14dd93157c.jpg\" alt=\"\" />\n</p>\n<p> </p>\n<p>    用了插件后的效果<br />\n <br />\n<img src=\"/upload/attachment/74455/1b5b8216-2110-3992-b070-b41176273ec9.jpg\" alt=\"\" />\n</p>\n<p> </p>\n<p>select元素会自动隐藏，当层消失会又会自动显示，</p>\n<p>此插件用法很简单： </p>\n<pre name=\"code\" class=\"js\">$(\".board\").bgiframe();  // 解决ie6下select元素会在上面的问题 </pre>\n<p> 之前记得先导入相应的JQUERY文件及插件，下面附上源码，源码中的那个弹出窗口的样式是自己对着效果图用CSS自己一点一点做的，CSS有时候真的很烦。。。消灭IE6,人人有责！</p>\n<p> </p>\n<p> </p>\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/74453/313a720c-4afe-3cab-a8d1-ae14dd93157c.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/74453/313a720c-4afe-3cab-a8d1-ae14dd93157c-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 8.7 KB</li>\n        </ul>\n      \n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/74455/1b5b8216-2110-3992-b070-b41176273ec9.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/74455/1b5b8216-2110-3992-b070-b41176273ec9-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 5 KB</li>\n        </ul>\n      \n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/645f89cd-67d1-3c3b-b567-3065f3c3a8ab\">拍卖弹出窗口.rar</a> (105.5 KB)</li>\n          \n          <li>下载次数: 62</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,845,'0110','jQuery',NULL,0),(819,'2009-10-21 15:52:32','ASP.NET中使用代码来进行备份和还原数据库','\n    &nbsp;&nbsp;&nbsp; 昨天看了《C#项目实录》中的进销存管理系统，和其他书里讲的案例一样，无非也就是数据库增删查改，但是这个进销存系统中有一个备份和还原数据库的功能，蛮有兴趣的，看了一下代码，原来如此，也就是通过SQL语句来进行备份和还原数据库，SQL语句如下：\n<br /><pre name=\"code\" class=\"sql\">\n-- 备份数据库\nbackup database db_CSManage to disk=\'c:&#92;backup.bak\'\n-- 还原数据库，必须先备份该数据库的日志文件到原先的备份文件中\nbackup log db_CSManage to disk=\'c:&#92;backup.bak\'\nrestore database db_CSManage from disk=\'c:&#92;backup.bak\'\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 其中db_CSManage是数据库名称，disk后的路径即是备份文件存储的路径。\n<br />知道了SQL语句，那么在.NET代码中就容易多了，备份的.NET代码如下：\n<br /><pre name=\"code\" class=\"c#\">\ntry\n{\n	if (txtPath.Text != \"\" &amp;&amp; txtName122.Text != \"\")\n	{\n		getSqlConnection geCon = new getSqlConnection();\n		SqlConnection con = geCon.GetCon();\n\n		string strBacl = \"backup database db_CSManage to disk=\'\" + txtPath.Text.Trim() + \"&#92;&#92;\" + txtName.Text.Trim() + \".bak\'\";\n		SqlCommand Cmd = new SqlCommand(strBacl, con);\n		if (Cmd.ExecuteNonQuery() != 0)\n		{\n			MessageBox.Show(\"数据备份成功！\", \"提示框\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n			this.Close();\n		}\n		else\n		{\n			MessageBox.Show(\"数据备份失败！\", \"提示框\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n		}\n\n	}\n	else\n	{\n		MessageBox.Show(\"请填写备份的正确位置及文件名！\", \"提示框\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n\n	}// end \n}\ncatch (Exception ee)\n{\n	MessageBox.Show(ee.Message.ToString());\n}\n</pre>\n<br />以下是还原数据库的代码，在示例中发现开头得先删除与该数据库相关的进程，然后在还原之前得先把数据库日志备份到开始的备份文件中，然后才还原备份文件，要不然会出错的，代码如下：\n<br /><pre name=\"code\" class=\"c#\">\nif (textPaht.Text != \"\")\n{\n	getSqlConnection geCon = new getSqlConnection();\n	SqlConnection con = geCon.GetCon();\n	if (con.State == ConnectionState.Open)\n	{\n		con.Close();\n	}\n	string DateStr = \"Data Source=niunan&#92;&#92;sqlexpress;Database=master;User id=sa;PWD=123456\";\n	SqlConnection conn = new SqlConnection(DateStr);\n	conn.Open();\n\n	//-------------------杀掉所有连接 db_CSManage 数据库的进程--------------\n	string strSQL = \"select spid from master..sysprocesses where dbid=db_id( \'db_CSManage\') \";\n	SqlDataAdapter Da = new SqlDataAdapter(strSQL, conn);\n\n	DataTable spidTable = new DataTable();\n	Da.Fill(spidTable);\n\n	SqlCommand Cmd = new SqlCommand();\n	Cmd.CommandType = CommandType.Text;\n	Cmd.Connection = conn;\n\n	for (int iRow = 0; iRow &lt;= spidTable.Rows.Count - 1; iRow++)\n	{\n		Cmd.CommandText = \"kill \" + spidTable.RowsiRow0.ToString();   //强行关闭用户进程 \n		Cmd.ExecuteNonQuery();\n	}\n	conn.Close();\n	conn.Dispose();\n	//--------------------------------------------------------------------\n\n	SqlConnection sqlcon = new SqlConnection(DateStr);\n	sqlcon.Open();\n	string sql = \"backup log db_CSManage to disk=\'\" + textPaht.Text.Trim() + \"\' restore database db_CSManage from disk=\'\" + textPaht.Text.Trim() + \"\'\";\n	SqlCommand sqlCmd = new SqlCommand(sql, sqlcon);\n	sqlCmd.ExecuteNonQuery();\n	sqlCmd.Dispose();\n	sqlcon.Close();\n	sqlcon.Dispose();\n	MessageBox.Show(\"数据还原成功！\", \"提示\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n	MessageBox.Show(\"为了必免数据丢失，在数据库还原后将关闭整个系统。\");\n	Application.Exit();\n}\nelse\n{\n	MessageBox.Show(\"请选择备份文件！\", \"提示\", MessageBoxButtons.OK, MessageBoxIcon.Warning);\n}\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 附上整个进销存系统的源码\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/2c06103a-9414-3154-9f88-7baee27be538\">08.rar</a> (5.8 MB)</li>\n          \n          <li>下载次数: 65</li>\n        </ul>\n      \n    \n    \n  ',NULL,967,'0101','ASP.NET',NULL,0),(820,'2009-10-21 15:52:32','重装系统后要做的事！','\n    &nbsp;&nbsp;&nbsp; 放假无聊没事干，把以前下的C#项目案例视频拿出来看了一下，看完后要运行一下源代码，安装了Microsoft Visual C# 2008 Express Edition，在安装的时候手痒把SQL 2008 Express版本也安装了（原先电脑上已经安装了SQL2005EXPRESS版了），安装完毕后看了一下开始→程序，多了个SQL2008,但是里面没有那个管理器，打开05的管理器，想登陆进去后附加示例数据库，想不到竟然登陆不进去，说是05的管理器只能登陆2000或者2005的数据库引擎，晕，看来那个SQL2008已经安装进去了，可是SQL2008没有管理器，不知道怎么用，郁闷啊，进控制面板把SQL08给卸载了，结果又出错，气死人了，上网搜索了一下，发现SQL2008 Express版本的管理器已经出来了，名称叫Microsoft SQL Server 2008 Express with Tools，不过蛮大的，295M左右，正在下，估计得明天才能下完吧，想想也好久没有重装了，正好上回赶上雨林木风关门大吉，把他的最后一版XP SP3 GHOST 9.9版本下载并刻盘了，干脆明天把SQL2008下载好了重装吧，上网查了一下，SQL2008的最低配置要求是CPU1G Hz，内存512M，我的SP2200+, 512M DDR400也正好够了，昨天晚上在VS中调试卡死好几次，看来真的要换电脑了，配套在自己心中都已经定好了，AMD5400+,技嘉GA-MA78GM-S2H,威钢DDR2 800 2G，西部数据 WD320G 7200转 16M（串口/YS），先锋DVR-216CH，算上机箱电源，主机能控制在￥2000以内，再加上一台低档液晶￥699,可以了，2G配置运行VS应该不会很卡了，游戏嘛，780G的集显FIFA2009也应该能玩，320G的硬盘要装多少爱情动作片就能装多少，何况还有DVD刻录机...\n<br />&nbsp;&nbsp;&nbsp; 废话说多了，接下来规划一下明天重装后要做的事情，写个备忘录，以后好查阅！！！\n<br />&nbsp;&nbsp;&nbsp; 重装系统后要做的事情如下：\n<br /><ul>\n<li>·把默认的adminstrators改名并设置密码\n</li><li>·开始→运行→control userpasswords2→设置自动登陆\n</li><li>·开始→运行→gpedit.msc→组策略中把所有驱动器的自动播放全关了（包括光驱）\n</li><li>·安装360版的NOD32，序列号从360中获取\n</li><li>·我的文档转移到D盘\n</li><li>·安装极点五笔\n</li><li>·安装IIS\n</li><li>·安装正则表达式测试工具RegexBuddy 3\n</li><li>·安装雨林木风工具箱\n</li><li>·安装7-zip解压工具\n</li><li>·安装Firefox浏览器\n</li><li>·安装Firebug插件\n</li><li>·看看GHOST后的OFFICE里有没有ACCESS，如果没有则卸载后安装OFFICE2007\n</li><li>·安装photoshop\n</li><li>·安装flash\n</li><li>·安装dreamweaver\n</li><li>·安装295M的那个SQL2008 Express\n</li><li>·安装Microsoft Visual Web Developer 2008 Express Edition\n</li><li>·安装Microsoft Visual C# 2008 Express Edition\n</li><li>·安装FIFA2007\n</li></ul>\n<br />\n<br />&nbsp;&nbsp;&nbsp; 目前就想到这么多，重装之后想起来的再来补充，也就当是我重装后要做的事情吧，嘿嘿。\n  ',NULL,642,'0103','随笔',NULL,0),(821,'2009-10-21 15:52:32','打广告~','	  \n    最近公司做好的网站,<a href=\"http://www.5mdn.com\" target=\"_blank\">http://www.5mdn.com</a>,请好心人帮忙上去看看有啥漏洞不....万一不幸进后台了拜托千万不要删除数据!!!!\n  	  	\n	  ',NULL,643,'0103','随笔',NULL,0),(822,'2009-10-21 15:52:32','jquery中筛选表格的特定行数后进行操作','\n    &nbsp;&nbsp;&nbsp; 项目中有个地方，一个页面显示两种商品，显示商品参数的时候有可以两种商品的参数数目不一致，这就导致了一边长一边短的，现在要做成如下图所示的：\n<br /><img src=\"http://taotao.wsyren.com/bbspic/jquery/01.jpg\" />\n<br />&nbsp;&nbsp;&nbsp; 一开始的时候先隐藏一部分参数，点击按钮后显示余下的参数，自己想了一下，基本思路是：页面进入时跟以前一样把商品参数全都取出来，然后利用jquery选择表格，把表格中行数&gt;3的进行隐藏，点击按钮后再把表格中隐藏的行显示出来。\n<br />&nbsp;&nbsp;&nbsp; 显示隐藏行都好做，主要就是筛选表格的某行以前没做过，自己实验了一下，得如下jquery代码：\n<br /><pre name=\"code\" class=\"js\">\n$(\"table.param\").each(function() {\n              $(this).find(\"tr\").filter(function(index) {\n                  return index &gt; 3;\n              }).css(\"backgroundColor\", \"#f00\");\n          });\n</pre>\n<br />&nbsp;&nbsp;&nbsp; 给要隐藏的表格加上一个param的class，方便在JS中选择，然后通过each对找到的每个表格依次进行each中的操作，重点就是filter这个jquery的筛选方法了，相信大家看了代码后都应该大概或许懂得啥回事了，index就是索引，从0开始，以上代码就是选择表格的第4行以后的行，让行的背景色变为红色！！！\n<br />&nbsp;&nbsp;&nbsp; 记得之前得先引入JQUERY的内裤。\n  ',NULL,866,'0110','jQuery',NULL,0),(823,'2009-10-21 15:52:32','JS实现图片轮换效果','&nbsp;&nbsp; &nbsp;当前的项目中要用到的效果,网上下了几个\"源码\",但都不是很如意,只好自己研究了,效果演示地址: http://www.cnbeta.com/ ,首页的左边的那个图片轮播就是我想要的效果, 研究了一下他的源码,发现原来是这么简单呀..一段JS代码搞掂.&nbsp;<br />\njs<br />\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">	</span>&lt;script language=\"javascript\"&gt;</div>\n<div>linkarr = new Array();</div>\n<div>picarr = new Array();</div>\n<div>textarr = new Array();</div>\n<div>var focus_width=409; &nbsp; // 图片的宽度</div>\n<div>var focus_height=307; &nbsp;// 图片的高度</div>\n<div>var text_height=20; &nbsp;// 底部文字的高度</div>\n<div>var pics = \"\";</div>\n<div>var links = \"\";</div>\n<div>var texts = \"\";</div>\n<div>var swf_height = focus_height+text_height; &nbsp; // 整个轮换效果的高度=图片高度+底部文字高度</div>\n<div>var defJpeg = \"http://www.cnbeta.com/images/index_37.jpg\";</div>\n<div><br />\n</div>\n<div>linkarr1=\"http://www.cnbeta.com/articles/73700.htm\";picarr1 =\"images/1.jpg\";textarr1=\"cnBeta 08年度精彩评论\";linkarr2=\"http://www.cnbeta.com/articles/73715.htm\";picarr2 =\"images/2.jpg\";textarr2=\"国务院常务会议同意启动3G牌照发放\";linkarr3=\"http://www.cnbeta.com/articles/73734.htm\";picarr3 =\"images/3.jpg\";textarr3=\"cnBeta 2009 新年献词\";linkarr4=\"http://www.cnbeta.com/articles/73473.htm\";picarr4 =\"images/4.jpg\";textarr4=\"三大XP盗版集团全面撤退 灰色产业链悄然漂白\";linkarr5=\"http://www.cnbeta.com/articles/73531.htm\";picarr5 =\"images/5.jpg\";textarr5=\"儿时经典动画《葫芦兄弟》也要出网游啦\";</div>\n<div><br />\n</div>\n<div>for(i=1;i&lt;picarr.length;i++){</div>\n<div>&nbsp;&nbsp;//if(picarri.indexOf(\"jpg\")==-1 &amp;&amp; picarri.indexOf(\"JPG\")==-1) picarri = defJpeg;</div>\n<div>&nbsp;&nbsp;if(pics==\"\") pics = picarri;</div>\n<div>&nbsp;&nbsp;else pics += \"|\"+picarri;</div>\n<div>}</div>\n<div><br />\n</div>\n<div>for(i=1;i&lt;linkarr.length;i++){</div>\n<div>&nbsp;&nbsp;if(links==\"\") links = linkarri;</div>\n<div>&nbsp;&nbsp;else links += \"|\"+linkarri;</div>\n<div>}</div>\n<div><br />\n</div>\n<div>for(i=1;i&lt;textarr.length;i++){</div>\n<div>&nbsp;&nbsp;if(texts==\"\") texts = textarri;</div>\n<div>&nbsp;&nbsp;else texts += \"|\"+textarri;</div>\n<div>}</div>\n<div><br />\n</div>\n<div><br />\n</div>\n<div>document.write(&#039;&lt;object type=\"application/x-shockwave-flash\" data=\"template/slide.swf\" width=\"&#039; + focus_width + &#039;\" height=\"&#039; + swf_height + &#039;\"&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"movie\" value=\"template/slide.swf\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"allowScriptAcess\" value=\"sameDomain\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"quality\" value=\"best\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"bgcolor\" value=\"#E5ECF4\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"scale\" value=\"noScale\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"menu\" value=\"false\"&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"wmode\" value=\"opaque\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;param name=\"FlashVars\" value=\"playerMode=embedded&amp;pics=&#039;+pics+&#039;&amp;links=&#039;+links+&#039;&amp;texts=&#039;+texts+&#039;&amp;borderwidth=&#039;+focus_width+&#039;&amp;borderheight=&#039;+focus_height+&#039;&amp;textheight=&#039;+text_height+&#039;\" /&gt;&#039;);</div>\n<div><span class=\"Apple-tab-span\" style=\"white-space:pre;\">			</span>document.write(&#039;&lt;/object&gt;&#039;);</div>\n<div><br />\n</div>\n<div>&lt;/script&gt;</div>\n/js<br />\n<div>&nbsp;&nbsp; &nbsp;实现图片轮换效果的其实是一个flash,就是那个template/slide.swf,真想看看他的源码,不知道他是怎么读取传进去的参数的哦!!!&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;要注意的时候图片和那个slide.swf必须在同一站点下,要不然就会显示出错了,比如上面的代码改成http://www.cnbeta.com/template/slide.swf后显示就不正常了!!!&nbsp;<br />\n&nbsp;&nbsp; &nbsp;又发现个问题，图片只能使用JPG格式的，如果换成GIF格式的话则图片显示不出来！！！<br />\n&nbsp;&nbsp; &nbsp;下载：<a href=\"http://niunan.net/download/flpicscoll.rar\">http://niunan.net/download/flpicscoll.rar</a></div>\n',NULL,1497,'0105','javascript',NULL,0),(806,'2009-10-21 15:52:31','.NET3.5 GDI+ 图形操作5','\n    <p>      前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a>\n ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.3.3 </span>\n</strong>\n<strong><span>绘制简单图形</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>简单图形是组成复杂图形的基础，通过本小节的例子，读者可以掌握绘制复杂图形的基础。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>除了直线外，矩形是所有简单图形的基础。因为在</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows</span>\n</strong>\n<strong><span>操作系统中，大部分图形在内存中的表示都是矩形块，比如一个窗体、一个按钮控件等。即使是圆形的界面元素，在表示其位置时，仍然以所在矩形的左上角坐标为参照点，通过宽和高来框定其位置及其区域。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>那么如何绘制矩形？</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>中的</span>\n</strong>\n<strong><span lang=\"EN-US\">DrawRectangle</span>\n</strong>\n<strong><span>可以在规定一个左上角顶点和长宽边长的情况下绘制一个矩形。下面的代码实现生成一个</span>\n</strong>\n<strong><span lang=\"EN-US\">400*300</span>\n</strong>\n<strong><span>的图片，并画出一个矩形。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">Pen pen = new Pen(Color.Red); // 创建一支红笔\nBitmap bmp = new Bitmap(400,300);\nGraphics g = Graphics.FromImage(bmp);\n// 以50,50为左上角，以长300,宽200绘制矩形\ng.DrawRectangle(pen,new Rectangle(50,50,300,200));\npen.Dispose();\ng.Dispose();\n// 存为新图片\nbmp.Save(Server.MapPath(\"~/aa.jpg\"));\nbmp.Dispose();</pre>\n \n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>运行后，查看</span>\n</strong>\n<strong><span lang=\"EN-US\">aa.jpg</span>\n</strong>\n<strong><span>的效果如图。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><img style=\"width: 742px; height: 564px;\" src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/18.jpg\" border=\"0\" alt=\"\" width=\"742\" height=\"564\"></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>如何绘制圆形呢？</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>中的</span>\n</strong>\n<strong><span lang=\"EN-US\">DrawDllipse</span>\n</strong>\n<strong><span>可以在一个矩形范围内绘制椭圆，当把矩形设置为正方形时，就能画成为正圆，代码如下所示：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">Pen pen = new Pen(Color.Red); // 创建一支红笔\nBitmap bmp = new Bitmap(400,400);\nGraphics g = Graphics.FromImage(bmp);\n// 以50,50为左上角，以长300,宽300的矩形内绘制圆\ng.DrawEllipse(pen, new Rectangle(50,50,300,300));\npen.Dispose();\ng.Dispose();\n// 存为新图片\nbmp.Save(Server.MapPath(\"~/bb.jpg\"));\nbmp.Dispose();</pre>\n \n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>运行后，查看</span>\n</strong>\n<strong><span lang=\"EN-US\">bb.jpg</span>\n</strong>\n<strong><span>的效果如下图。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/19.jpg\" border=\"0\" alt=\"\" width=\"297\" height=\"296\"></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.3.4 </span>\n</strong>\n<strong><span>绘制文本</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>有时用户需要在图片上显示文字，</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>中的</span>\n</strong>\n<strong><span lang=\"EN-US\">DrawString</span>\n</strong>\n<strong><span>可以在图形上绘制文字，其中可以指定坐标、字体、字号等信息。下面的代码简单地在图片上写了几个汉字。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">Bitmap bmp = new Bitmap(200, 100);\nGraphics g = Graphics.FromImage(bmp);\nstring str = \"画在图片上的文字\";\nFont font = new Font(\"宋体\", 10);\n// 黑色笔刷\nSolidBrush brush = new SolidBrush(Color.Black);\ng.DrawString(str, font, brush, 50, 50); // 从50,50位置开始写字\nfont.Dispose();\nbrush.Dispose();\ng.Dispose();\n// 存为新图片\nbmp.Save(Server.MapPath(\"~/text.jpg\"));\nbmp.Dispose();</pre>\n \n<div class=\"cnblogs_code\"><br></div>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>运行后，</span>\n</strong>\n<strong><span lang=\"EN-US\">text.jpg</span>\n</strong>\n<strong><span>的效果如下图所示。</span>\n</strong>\n</p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/20.jpg\" border=\"0\" alt=\"\" width=\"338\" height=\"179\"></p>\n<p> </p>\n<div class=\"MsoNormal\" style=\"text-align: center; margin: 0cm 0cm 0pt;\">\n<strong><span lang=\"EN-US\">\n<hr size=\"2\"></span>\n</strong>\n</div>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\"><span>         </span>\n</span>\n</strong>\n<strong><span>注意</span>\n</strong>\n<strong><span>：使用</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>画上去的文字是二进制信息，无法作为文本复制粘贴</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<div class=\"MsoNormal\" style=\"text-align: center; margin: 0cm 0cm 0pt;\">\n<strong><span lang=\"EN-US\">\n<hr size=\"2\"></span>\n</strong>\n</div>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.3.5 </span>\n</strong>\n<strong><span>填充图形</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>前面的简单图形基本只有边界，内部区域是空心的。如果想绘制一个实心图形，可以使用</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>中的</span>\n</strong>\n<strong><span lang=\"EN-US\">FillXXX</span>\n</strong>\n<strong><span>方法，并使用刷子（</span>\n</strong>\n<strong><span lang=\"EN-US\">Brush</span>\n</strong>\n<strong><span>对象）填充。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>下面的代码示例实现用蓝色填充一个圆形区域。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">Bitmap bmp = new Bitmap(300, 300);\nGraphics g = Graphics.FromImage(bmp);\n// 蓝色笔刷\nSolidBrush brush = new SolidBrush(Color.Blue);\ng.FillEllipse(brush, new Rectangle(5,5,250,250));\nbrush.Dispose();\ng.Dispose();\n// 存为新图片\nbmp.Save(Server.MapPath(\"~/fill.jpg\"));\nbmp.Dispose();</pre>\n \n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>运行后，查看</span>\n</strong>\n<strong><span lang=\"EN-US\">fill.jpg</span>\n</strong>\n<strong><span>的效果如图。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/21.jpg\" border=\"0\" alt=\"\" width=\"466\" height=\"461\"></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>由此可见，利用</span>\n</strong>\n<strong><span lang=\"EN-US\">Fill</span>\n</strong>\n<strong><span>操作可以很方便地填充图形，如果需要使边界实出显示，可以再用</span>\n</strong>\n<strong><span lang=\"EN-US\">Draw</span>\n</strong>\n<strong><span>方法将边界绘制出来。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n  ',NULL,795,'0101','ASP.NET',NULL,0),(807,'2009-10-21 15:52:31','.NET3.5 GDI+ 图形操作4','\n    <p>      前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a>\n ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<h2 style=\"margin: 13pt 0cm;\">\n<strong><span style=\"font-weight: normal; font-family: \'Cambria\',\'serif\';\">10.3 </span>\n</strong>\n<strong><span>基本绘图</span>\n</strong>\n<strong><span style=\"font-weight: normal; font-family: \'Cambria\',\'serif\';\">\n<p> </p>\n</span>\n</strong>\n</h2>\n<p class=\"MsoNormal\" style=\"text-align: left; text-indent: 21pt; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>在</span>\n</strong>\n<strong><span lang=\"EN-US\">.NET</span>\n</strong>\n<strong><span>中图形包括以下两个步骤。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; text-indent: 21pt; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>第一，创建</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; text-indent: 21pt; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>第二，使用</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象绘制线条和形状，呈现文本或显示操作图像。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; text-indent: 21pt; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>由此可见，如何创建</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象是首先要解决的问题。本节将讲述如何绘制直线、矩形、圆等基本图形，然后基本图形构成复杂的图形。</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>常用的绘图方法如下表。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<div><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/16.jpg\" border=\"0\" alt=\"\"></div>\n<div> </div>\n<div> </div>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span lang=\"EN-US\">10.3.1 </span>\n</strong>\n<strong><span>创建图形对象</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>创建图形对象可有如下几种方法。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\"><strong><span style=\"font-weight: normal; font-family: Wingdings;\"><span>²<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">  </span>\n</span>\n</span>\n</strong>\n<strong><span>在窗体或控件的</span>\n</strong>\n<strong><span lang=\"EN-US\">Paint</span>\n</strong>\n<strong><span>事件中接收对图形对象的引用，作为</span>\n</strong>\n<strong><span lang=\"EN-US\">PaintEventArgs</span>\n</strong>\n<strong><span>的一部分。在为控件创建绘制代码时，通常使用此方法来获取对图形对象的引用。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\"><strong><span style=\"font-weight: normal; font-family: Wingdings;\"><span>²<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">  </span>\n</span>\n</span>\n</strong>\n<strong><span>调用某控件或窗体的</span>\n</strong>\n<strong><span lang=\"EN-US\">CreateGraphics</span>\n</strong>\n<strong><span>方法，以获取对</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象的引用，该对象表示该控件或窗体的绘图图面。如果想在已存在的窗体或控件上绘图，可使用此方法。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\"><strong><span style=\"font-weight: normal; font-family: Wingdings;\"><span>²<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">  </span>\n</span>\n</span>\n</strong>\n<strong><span>由从</span>\n</strong>\n<strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>继承的任何对象创建</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象。此方法一般用来生成图片。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>就</span>\n</strong>\n<strong><span lang=\"EN-US\">ASP.NET Web</span>\n</strong>\n<strong><span>应用程序而言，前两种是无法做到的，因此只能采用第三种方法。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span>假设要从网站根目录</span>\n</strong>\n<strong><span lang=\"EN-US\">mm.jpg</span>\n</strong>\n<strong><span>图形创建图形对象，可以使用如下代码：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">Bitmap bmp  =   new  Bitmap(Server.MapPath( \" ~/mm.jpg \" ));\nGraphics g  =  Graphics.FromImage(bmp);\nbmp.Dispose();\ng.Dispose();</pre>\n \n<p> </p>\n<div class=\"cnblogs_code\">\n<span style=\"color: #000000;\">\n<hr></span>\n</div>\n<p> </p>\n<p> </p>\n<hr>\n<p> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21.1pt; margin: 0cm 0cm 0pt;\"><strong><span>注意</span>\n</strong>\n<strong><span>：这里要求图片必须存在，相当于对图片的修改操作，否则将不能创建</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>对象，也就无法创建图形对象了。另外，</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>对象和图形对象都是非常耗费计算机内存的，所以要及时调用</span>\n</strong>\n<strong><span lang=\"EN-US\">Dispose</span>\n</strong>\n<strong><span>方法释放占用资源。</span>\n</strong>\n</p>\n<p>\n<strong></strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21.1pt; margin: 0cm 0cm 0pt;\"> </p>\n<hr>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21.1pt; margin: 0cm 0cm 0pt;\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>当然，也可以在内存中新建</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>对象，对其绘制完毕后再保存到硬盘上或直接输入到</span>\n</strong>\n<strong><span lang=\"EN-US\">HTTP</span>\n</strong>\n<strong><span>流中发回客户端显示。比如在内存中创建一个</span>\n</strong>\n<strong><span lang=\"EN-US\">200*100</span>\n</strong>\n<strong><span>的图像，代码如下：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21.1pt; margin: 0cm 0cm 0pt;\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21.1pt; margin: 0cm 0cm 0pt;\">\n</p>\n<pre name=\"code\" class=\"c#\">Bitmap bmp  =   new  Bitmap( 200 , 100 );\nGraphics g  =  Graphics.FromImage(bmp);\nbmp.Dispose();\ng.Dispose();\n</pre>\n </strong></p>\n<div class=\"cnblogs_code\"><br></div>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>如果要新创建一个图像，则用这种方法是最好的。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<strong>\n<p> </p>\n</strong>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n\n<p> </p>\n \n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.3.2 </span>\n</strong>\n<strong><span>绘制直线</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>绘制直线一般使用</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象的</span>\n</strong>\n<strong><span lang=\"EN-US\">DrawLine</span>\n</strong>\n<strong><span>方法。下面的代码在</span>\n</strong>\n<strong><span lang=\"EN-US\">mm.jpg</span>\n</strong>\n<strong><span>图片上用红色线条斜画一条直线。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<div class=\"cnblogs_code\">\n<pre name=\"code\" class=\"c#\">Pen pen = new Pen(Color.Red); // 创建一支红笔\nBitmap bmp = new Bitmap(Server.MapPath(\"~/mm.jpg\"));\nGraphics g = Graphics.FromImage(bmp);\ng.DrawLine(pen, 0, 0, 200, 200); // 从0,0到200,200画直线\npen.Dispose();\ng.Dispose();\n// 存为新图片\nbmp.Save(Server.MapPath(\"~/mm2.jpg\"));\nbmp.Dispose();</pre>\n </div>\n<p> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>代码说明：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<div class=\"MsoNormal\" style=\"text-align: center; margin: 0cm 0cm 0pt;\">\n<strong><span lang=\"EN-US\">\n<hr size=\"2\"></span>\n</strong>\n</div>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">bmp.Save: </span>\n</strong>\n<strong><span>将</span>\n</strong>\n<strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>对象保存到磁盘。</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics</span>\n</strong>\n<strong><span>对象并非直接在原图上画直线，而是在内存中操作</span>\n</strong>\n<strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>对象，所以需要另存为</span>\n</strong>\n<strong><span lang=\"EN-US\">mm2.jpg</span>\n</strong>\n<strong><span>才能看出效果。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>程序运行后，查看</span>\n</strong>\n<strong><span lang=\"EN-US\">mm2.jpg</span>\n</strong>\n<strong><span>文件就可以看到效果了，如下图：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/17.jpg\" border=\"0\" alt=\"\" width=\"416\" height=\"539\">\n </p>\n  ',NULL,771,'0101','ASP.NET',NULL,0),(808,'2009-10-21 15:52:31','.NET3.5 GDI+ 图形操作3','\n    <p>      前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a>\n ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.4 Brush\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Brush</span>\n</strong>\n<strong><span>通常被称为，用于定义填充图形形状（如矩形、椭圆、饼形、多边形和封闭路径）的内部对象。</span>\n</strong>\n<strong><span lang=\"EN-US\">Brush</span>\n</strong>\n<strong><span>是一个抽象基类，不能进行实例化。若要创建一个画笔对象，需使用从</span>\n</strong>\n<strong><span lang=\"EN-US\">Brush</span>\n</strong>\n<strong><span>派生出的类，如</span>\n</strong>\n<strong><span lang=\"EN-US\">SolidBrush</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">TextureBrush</span>\n</strong>\n<strong><span>和</span>\n</strong>\n<strong><span lang=\"EN-US\">LinearGradientBrush</span>\n</strong>\n<strong><span>。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">SolidBrush</span>\n</strong>\n<strong><span>类用于定义单色画笔。画笔用于填充图形形状，如矩形、椭圆、扇形、多边形和封闭路径。下表列举了常用的方法和属性。</span>\n</strong>\n</p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/08.jpg\" border=\"0\" alt=\"\" width=\"570\" height=\"49\"></p>\n<p><strong><span lang=\"EN-US\">System.Drawing.Brushes</span>\n</strong>\n<strong><span>定义了很多标准笔刷，用户可以直接定义一个蓝色笔刷。</span>\n</strong>\n</p>\n<p><strong></strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n<strong>\n</strong></p>\n<p><strong>\n<div class=\"cnblogs_code\">\n<pre name=\"code\" class=\"c#\">System.Drawing.Brush brush  =  System.Drawing.Brushes.Blue;</pre>\n </div>\n</strong></p>\n<p> </p>\n<p><strong></strong>\n </p>\n<p><strong><span>当然，用户也可以自定义画笔。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n<strong>\n</strong></p>\n<p><strong>\n<div class=\"cnblogs_code\">\n<span style=\"color: #000000;\">\n<pre name=\"code\" class=\"c#\">//  定义一个红色笔刷 \nSystem.Drawing.Brush brush  =   new  System.Drawing.SolidBrush(System.Drawing.Color.Red);</pre>\n </span>\n</div>\n<p><span> </span>\n</p>\n<span>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">TextureBrush</span>\n</strong>\n<strong><span>类的每个属性都是</span>\n</strong>\n<strong><span lang=\"EN-US\">Brush</span>\n</strong>\n<strong><span>对象，这种对象使用图像来填充形状的内部，用户可以设置填充的方式。下表例举了常的方法和属性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<strong>\n<p> </p>\n</strong></span><strong>\n</strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/09.jpg\" border=\"0\" alt=\"\" width=\"569\" height=\"193\"></p>\n<p><strong><span>下面的代码示例演示了用图形填充区域的用法。</span>\n</strong>\n</p>\n<p><strong></strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p><span> </span>\n</p>\n</strong></p>\n<p> </p>\n<p>\n<strong><span>\n</span></strong></p>\n<p><strong>\n<div class=\"cnblogs_code\">\n<pre name=\"code\" class=\"c#\">// Brush图片\nstring brushfile = Server.MapPath(\"~/lo;.gif\");\n// 被填充的图片\nstring file = Server.MapPath(\"~/Element.jpg\");\n// 声明TextureBrush对象\nSystem.Drawing.Image brushimg = System.Drawing.Image.FromFile(brushfile);\nSystem.Drawing.TextureBrush texture = new System.Drawing.TextureBrush(brushimg);\ntexture.WrapMode = System.Drawing.Drawing2D.WrapMode.Tile;\n\nSystem.Drawing.Image img = System.Drawing.Image.FromFile(file);\nSystem.Drawing.Graphics g = System.Drawing.Graphics.FromImage(img); // 创建Graphics对象\ng.FillEllipse(texture, new System.Drawing.RectangleF(90.0f,110.0f,100,100)); // 用图形填充\ng.Dispose();\n// 原书中没有这句,这里要加上这句,如果不加这句则在非IE浏览器显示不出\nResponse.ContentType = \"image/JPEG\";\n// 将图形加载到Response中\nimg.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Jpeg);</pre>\n </div>\n</strong></p>\n<p> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>网页运行结果如图：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p> </p>\n<p align=\"center\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/11.jpg\" border=\"0\" alt=\"\" width=\"410\" height=\"328\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.5 Font\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Font</span>\n</strong>\n<strong><span>用于定义特定的文本格式，包括字体、字号和字形属性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span>下表列举了常用方法和属性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/10.jpg\" border=\"0\" alt=\"\" width=\"571\" height=\"260\"></p>\n<p align=\"left\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/12.jpg\" border=\"0\" alt=\"\" width=\"571\" height=\"89\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span>下面这行代码将构建一个</span>\n</strong>\n<strong><span lang=\"EN-US\">10</span>\n</strong>\n<strong><span>磅大小的宋体字体。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\">\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Font f1  =   new  System.Drawing.Font( \" 宋体 \" , 10 );\n</pre>\n \n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.6 Image\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>是为源自</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>和</span>\n</strong>\n<strong><span lang=\"EN-US\">Metafile</span>\n</strong>\n<strong><span>的类提供功能的抽象基类。下表列举了常用的方法和属性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/13.jpg\" border=\"0\" alt=\"\" width=\"571\" height=\"560\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>不可以实例化，但可以通过方法来构造：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\">\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Image img1  =  System.Drawing.Image.FromFile(Server.MapPath( \" ~/lo;.gif \" ));\n</pre>\n \n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span lang=\"EN-US\">Image</span>\n</strong>\n<strong><span>是基类，封装了很多有用的属性和方法，而实际运用时，尤其在生成或者修改图像的时候，一般用其派生类</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>表示内存中的图形。</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>是用于处理由像素数据定义的图像的对象，是图像处理开发中最常用的对象。用户可以通过多种途径构造</span>\n</strong>\n<strong><span lang=\"EN-US\">Bitmap</span>\n</strong>\n<strong><span>对象。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\">\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Bitmap bmp1  =   new  System.Drawing.Bitmap(Server.MapPath( \" ~/lo;.gif \" ));  //  通过文件构造 \nSystem.Drawing.Bitmap bmp2  =   new  System.Drawing.Bitmap( 300 , 200 );  //  构造一个宽300,高200的对象 </pre>\n \n<div class=\"cnblogs_code\">\n<span style=\"color: #008000;\"><br></span>\n</div>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>构造完对象后，可以调用其方法进行操作，比如</span>\n</strong>\n<strong><span lang=\"EN-US\">RotateFlip</span>\n</strong>\n<strong><span>方法可以实现图像反转，该方法接收</span>\n</strong>\n<strong><span lang=\"EN-US\">RotateFlipType</span>\n</strong>\n<strong><span>类型的参数，可以的值如下表。</span>\n</strong>\n</p>\n<p>\n<strong></strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/14.jpg\" border=\"0\" alt=\"\" width=\"570\" height=\"339\"></p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n<strong>\n</strong></p>\n<p><strong>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><strong><span>比如：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<strong>\n<p> </p>\n</strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"> </p>\n<div class=\"cnblogs_code\">\n<pre name=\"code\" class=\"c#\">System.Drawing.Bitmap bmp1 = new System.Drawing.Bitmap(Server.MapPath(\"~/lo;.gif\")); // 通过文件构造\nbmp1.RotateFlip(System.Drawing.RotateFlipType.Rotate90FlipX); // 水平翻转90度旋转\n// 原书中没有这句,这里要加上这句,如果不加这句则在非IE浏览器显示不出\nResponse.ContentType = \"image/JPEG\";\nbmp1.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Jpeg);</pre>\n </div>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><span style=\"font-weight: bold;\">网页运行如图：</span></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-align: left; margin: 0cm 0cm 0pt;\" align=\"left\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/15.jpg\" border=\"0\" alt=\"\" width=\"428\" height=\"312\"></p>\n  ',NULL,760,'0101','ASP.NET',NULL,0),(809,'2009-10-21 15:52:31','.NET3.5 GDI+ 图形操作2 ','\n    <p>      前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a>\n ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.1.3 .NET</span>\n</strong>\n<strong><span>对绘图的支持</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">.NET</span>\n</strong>\n<strong><span>对图形操作的支持类库都集中在</span>\n</strong>\n<strong><span lang=\"EN-US\">System.Drawing</span>\n</strong>\n<strong><span>命名空间下。所以在直接使用</span>\n</strong>\n<strong><span lang=\"EN-US\">.NET</span>\n</strong>\n<strong><span>类库时，不要忘记添加</span>\n</strong>\n<strong><span lang=\"EN-US\">using System.Drawing</span>\n</strong>\n<strong><span>。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p><strong><span>下表列出了绘图常的类库，下一节将以示例的方式辅助理解。</span>\n</strong>\n</p>\n<p align=\"center\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/04.jpg\" border=\"0\" alt=\"\" width=\"588\" height=\"284\"></p>\n<p align=\"center\"> </p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>上表只是罗列了部分常用类型，在基本图形操作中已经足够了。用户可以使用</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>在</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows</span>\n</strong>\n<strong><span>窗体和控件上呈现图形图像。虽然无法在</span>\n</strong>\n<strong><span lang=\"EN-US\">Web</span>\n</strong>\n<strong><span>窗体上直接使用</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+, </span>\n</strong>\n<strong><span>但可以通过形成图片的方式将图像发送到客户端浏览器。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>另外，图形操作是非常耗费计算机性能的，虽然本章是讲述</span>\n</strong>\n<strong><span lang=\"EN-US\">ASP.NET</span>\n</strong>\n<strong><span>图形操作方面的知识，但仍然不建议在</span>\n</strong>\n<strong><span lang=\"EN-US\">ASP.NET</span>\n</strong>\n<strong><span>程序中大量使用图形操作，否则会因为耗费计算机性能而导致其他问题。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\"> </p>\n<h2 style=\"margin: 13pt 0cm;\">\n<strong><span style=\"font-family: \'Cambria\',\'serif\';\">10.2 </span>\n</strong>\n<strong><span>常用绘图对象</span>\n</strong>\n<strong><span style=\"font-family: \'Cambria\',\'serif\';\">\n<p> </p>\n</span>\n</strong>\n</h2>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.1 Color\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Color</span>\n</strong>\n<strong><span>结构表示一种</span>\n</strong>\n<strong><span lang=\"EN-US\">ARGB</span>\n</strong>\n<strong><span>颜色（</span>\n</strong>\n<strong><span lang=\"EN-US\">Alpha</span>\n</strong>\n<strong><span>、红色、绿色、蓝色）。该结构中封装了数百个分别对应于标准调色板色彩的静态成员，如</span>\n</strong>\n<strong><span lang=\"EN-US\">Color.Red</span>\n</strong>\n<strong><span>代表红色，</span>\n</strong>\n<strong><span lang=\"EN-US\">Color.Purple</span>\n</strong>\n<strong><span>代表紫色等。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>下表列举了常用方法。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/05.jpg\" border=\"0\" alt=\"\" width=\"581\" height=\"115\">\n </p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>比如要对</span>\n</strong>\n<strong><span lang=\"EN-US\">ASP.NET</span>\n</strong>\n<strong><span>页面上的一个文本框背景着色，可以使用下面</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>种方式中的一种：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p align=\"left\"> </p>\n<div class=\"cnblogs_code\">\n<span style=\"color: #000000;\">\n<pre name=\"code\" class=\"c#\">TextBox1.BackColor  =  System.Drawing.Color.Green;\nTextBox1.BackColor  =  System.Drawing.Color.FromArgb( 0 ,  0 ,  255 ,  0 );\nTextBox1.BackColor  =  System.Drawing.Color.FromName( \" green \" );</pre>\n </span>\n</div>\n<p align=\"left\"> </p>\n<p><span>运行后，文本框的背景色将显示为指定的颜色。对于</span>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>值的颜色表，读者可查阅相关资料。</span>\n</strong>\n</p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.2 Point</span>\n</strong>\n<strong><span>和</span>\n</strong>\n<strong><span lang=\"EN-US\">PointF\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Point</span>\n</strong>\n<strong><span>结构和</span>\n</strong>\n<strong><span lang=\"EN-US\">PointF</span>\n</strong>\n<strong><span>结构表示在二维平面中定义点的</span>\n</strong>\n<strong><span lang=\"EN-US\">XY</span>\n</strong>\n<strong><span>坐标的有序对。</span>\n</strong>\n<strong><span lang=\"EN-US\">Point</span>\n</strong>\n<strong><span>坐标值为整型（</span>\n</strong>\n<strong><span lang=\"EN-US\">int</span>\n</strong>\n<strong><span>），</span>\n</strong>\n<strong><span lang=\"EN-US\">PointF</span>\n</strong>\n<strong><span>坐标值为浮点型（</span>\n</strong>\n<strong><span lang=\"EN-US\">float</span>\n</strong>\n<strong><span>）。声明一个点就是声明一个</span>\n</strong>\n<strong><span lang=\"EN-US\">Point(F)</span>\n</strong>\n<strong><span>结构对象。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Point p1  =   new  System.Drawing.Point( 100 ,  150 );\nSystem.Drawing.PointF p2  =   new  System.Drawing.PointF( 10.5f ,  35.2f );\n</pre>\n \n<div class=\"cnblogs_code\"><br></div>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>点坐标重载了加减操作，可以实现坐标的变化，变化量用</span>\n</strong>\n<strong><span lang=\"EN-US\">System.Drawing.Size</span>\n</strong>\n<strong><span>结构表示。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Point p3  =  p1  +   new  System.Drawing.Size( 100 ,  10 ); \nSystem.Drawing.PointF p4  =  p2  +   new  System.Drawing.Size( 100 ,  10 );</pre>\n \n<div class=\"cnblogs_code\">\n</div>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.2.3 Pen\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">Pen</span>\n</strong>\n<strong><span>对象通常称为画笔，用于绘制样式丰富的直线或曲线。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>下表列举了常用的方法和属性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/06.jpg\" border=\"0\" alt=\"\" width=\"571\" height=\"276\"><br><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/07.jpg\" border=\"0\" alt=\"\" width=\"571\" height=\"151\"></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">System.Drawing.Pens</span>\n</strong>\n<strong><span>定义了很多标准画笔，用户可以直接定义一个宽度为</span>\n</strong>\n<strong><span lang=\"EN-US\">1</span>\n</strong>\n<strong><span>的蓝色画笔。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">System.Drawing.Pen pen  =  System.Drawing.Pens.Blue;</pre>\n \n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>当然，用户也可以自定义画笔。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n</span></strong></p>\n<p><strong>\n<p> </p>\n</strong></p>\n<p> </p>\n<p>\n</p>\n<pre name=\"code\" class=\"c#\">//  定义一个宽度为10的红色画笔 \nSystem.Drawing.Pen pen2  =   new  System.Drawing.Pen(System.Drawing.Color.Red, 10 );\n//  定义一个绿色填充画笔 \nSystem.Drawing.Pen pen3  =   new  System.Drawing.Pen(System.Drawing.Brushes.Green);\n</pre>\n \n  ',NULL,944,'0101','ASP.NET',NULL,0),(810,'2009-10-21 15:52:31','.NET3.5 GDI+ 图形操作1','\n    <p>      前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a>\n ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<h1 style=\"text-align: center; margin: 17pt 0cm 16.5pt;\">\n<span>第</span>\n<span lang=\"EN-US\"><span>10</span>\n</span>\n<span>章</span>\n<span> </span>\n<span>图形操作</span>\n</h1>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>图形化界面是</span>\n<span lang=\"EN-US\"><span>Windows</span>\n</span>\n<span>操作系统最重要的特性之一，微软以此迅速打败对手，赢得了用户的认可。计算机图形学一直是计算机科学体系中的重要内容，在</span>\n<span lang=\"EN-US\"><span>Windows</span>\n</span>\n<span>编程史上，图形操作也一直是核心开发技术之一。本章将介绍如何在</span>\n<span lang=\"EN-US\"><span>ASP.NET</span>\n</span>\n<span>的</span>\n<span lang=\"EN-US\"><span>Web</span>\n</span>\n<span>应用程序中</span>\n<span lang=\"EN-US\"><span>GDI+</span>\n</span>\n<span>绘图。</span>\n</p>\n<p> </p>\n<h2 style=\"margin: 13pt 0cm;\">\n<strong><span style=\"font-family: \'Cambria\',\'serif\';\">10.1 </span>\n</strong>\n<strong><span>图形基础</span>\n</strong>\n<strong><span style=\"font-family: \'Cambria\',\'serif\';\">\n<p> </p>\n</span>\n</strong>\n</h2>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.1.1 GDI+</span>\n</strong>\n<strong><span>介绍</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>读者可能听说过</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows GDI</span>\n</strong>\n<strong><span>（</span>\n</strong>\n<strong><span lang=\"EN-US\">Graphics Device Interface</span>\n</strong>\n<strong><span>，</span>\n</strong>\n<strong><span> </span>\n</strong>\n<strong><span>图形装置界面），这是</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows</span>\n</strong>\n<strong><span>操作系统的一个图形包，用于支持</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows</span>\n</strong>\n<strong><span>操作系统中的图形界面，它也帮助开发人员在不考虑特定设备细节的情形下在计算机上进行绘图操作。比如就图形输出来说，开发人员在绘图时根本不用考虑是在屏幕上绘制还是在打印机上绘制，只需要指明输出设备即可让</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>自己解决这些细节问题。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>随着开发技术的进步，</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>从某种意义上已经不能满足需求，于是微软把</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>进一步封装抽象，形成新的</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>，并在性能和功能上进一步完善。</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>构成了</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows XP</span>\n</strong>\n<strong><span>操作系统及其后续版本的子系统的应用程序编程接口（</span>\n</strong>\n<strong><span lang=\"EN-US\">API</span>\n</strong>\n<strong><span>）。</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>负责在屏幕和打印机上显示信息，它是</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>的改进，同时也是</span>\n</strong>\n<strong><span lang=\"EN-US\">.NET</span>\n</strong>\n<strong><span>框架结构的重要组成部分。和</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>一样，它提供了对二维图形图像和文字排版处理的支持，通过</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>能够创建与设备无关的应用程序。使用</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>可以创建图形、绘制文本以及将图形图像作为对象来操作，旨在提高性能和易用性。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>与</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI</span>\n</strong>\n<strong><span>相比，</span>\n</strong>\n<strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>提供了一些新特性：</span>\n</strong>\n<strong><span lang=\"EN-US\">Alpha</span>\n</strong>\n<strong><span>混合技术、反锯齿处理技术、渐变色和纹理填充、宽线条、基本几何曲线样式、可缩放区域、浮点数坐标、嵌入画笔、高质量过滤和缩放、多种线条样式和端点选项等。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>当然，本书并不专门讲解图形编程，限于篇幅，本章将针对通用操作进行讲述。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">10.1.1 GDI+</span>\n</strong>\n<strong><span>基础</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span>在学习</span>\n</strong>\n<strong><span lang=\"EN-US\">.NET GDI+</span>\n</strong>\n<strong><span>图形操作以前，先将几个基础概念回顾一下。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\"><strong><span lang=\"EN-US\"><span>1.<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">       </span>\n</span>\n</span>\n</strong>\n<strong><span>坐标系</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>在坐标系中绘制直线、矩形和其他形状，默认坐标系的原点是左上角，并且</span>\n</strong>\n<strong><span lang=\"EN-US\">X</span>\n</strong>\n<strong><span>轴指向右边，</span>\n</strong>\n<strong><span lang=\"EN-US\">Y</span>\n</strong>\n<strong><span>轴指向下边。默认坐标系的度量单位是像素，如图所示。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p align=\"center\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/01.jpg\" border=\"0\" alt=\"\" width=\"326\" height=\"229\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\"><strong><span lang=\"EN-US\"><span>2.<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">       </span>\n</span>\n</span>\n</strong>\n<strong><span>像素</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>计算机监视器是在一个点的矩形数组上创建其显示，这些点被称为图片元素或像素。各台监视器屏幕上显示的像素数量都是不同的，并且用户通常可以在一定程序上配置单独一台监视器上显示的像素数量。比如通常所说的分辨率</span>\n</strong>\n<strong><span lang=\"EN-US\">1024*768</span>\n</strong>\n<strong><span>就是指</span>\n</strong>\n<strong><span lang=\"EN-US\">X</span>\n</strong>\n<strong><span>轴上有</span>\n</strong>\n<strong><span lang=\"EN-US\">1024</span>\n</strong>\n<strong><span>个像素、</span>\n</strong>\n<strong><span lang=\"EN-US\">Y</span>\n</strong>\n<strong><span>轴上有</span>\n</strong>\n<strong><span lang=\"EN-US\">768</span>\n</strong>\n<strong><span>个像素，所以坐标实际上是建立在像素点阵上的。下图表示了</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>个点及其坐标。</span>\n</strong>\n</p>\n<p>\n<strong></strong>\n<strong><span lang=\"EN-US\">\n<p><span>\n<p align=\"center\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/02.jpg\" border=\"0\" alt=\"\" width=\"421\" height=\"291\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>从这个意义上说，如何表示一条直线呢？下图演示了在确定两个点的情况下，如何在计算机点阵中表示一条直线。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p align=\"center\"><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/03.jpg\" border=\"0\" alt=\"\" width=\"417\" height=\"308\"></p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>由此可见，直线并非上那么直，只不过在分辨率很高的情况下肉眼无法分辨而已。当然，这个计算过程很复杂，是计算机图形学方面的知识，此处不再赘述。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p align=\"left\"> </p>\n<p class=\"MsoNormal\"><strong><span lang=\"EN-US\"><span>3.<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">       </span>\n</span>\n</span>\n</strong>\n<strong><span>位图</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>位图是位的数组，它指定了像素矩阵中各像素的颜色，专用于单个像素的位数，决定了可分配到该像素的颜色数。例如，如果用</span>\n</strong>\n<strong><span lang=\"EN-US\">4</span>\n</strong>\n<strong><span>位来呈现每个像素，那么一个给定的像素就可以分配到</span>\n</strong>\n<strong><span lang=\"EN-US\">16</span>\n</strong>\n<strong><span>（</span>\n</strong>\n<strong><span lang=\"EN-US\">2<sup>4</sup></span>\n</strong>\n<strong><span>＝</span>\n</strong>\n<strong><span lang=\"EN-US\">16</span>\n</strong>\n<strong><span>）种颜色中的一种。简单来说，位数越多，表现出来的图形颜色越丰富、逼真。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>存储位图的磁盘文件通常包含一个或多个信息块，信息块中存储了如每像素位数、每行的像素数以及数组中的行数等信息。不同格式的图形文件会采用不同的存储标准，一般会以不同的扩展名标识。</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong></strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">GDI+</span>\n</strong>\n<strong><span>支持如下图形文件格式</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇</span>\n</strong>\n<strong><span lang=\"EN-US\">BMP\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">BMP</span>\n</strong>\n<strong><span>是</span>\n</strong>\n<strong><span lang=\"EN-US\">Windows</span>\n</strong>\n<strong><span>使用的一种标准格式，用于存储设备无关和应用程序无关的图像。一个给定</span>\n</strong>\n<strong><span lang=\"EN-US\">BMP</span>\n</strong>\n<strong><span>文件的每像素位数值（</span>\n</strong>\n<strong><span lang=\"EN-US\">1,4,8,16,24,32</span>\n</strong>\n<strong><span>或</span>\n</strong>\n<strong><span lang=\"EN-US\">64</span>\n</strong>\n<strong><span>）在文件头中指定。每像素</span>\n</strong>\n<strong><span lang=\"EN-US\">24</span>\n</strong>\n<strong><span>位的</span>\n</strong>\n<strong><span lang=\"EN-US\">BMP</span>\n</strong>\n<strong><span>文件是通用的。</span>\n</strong>\n<strong><span lang=\"EN-US\">BMP</span>\n</strong>\n<strong><span>文件通常是不压缩的，因此不太适合通过</span>\n</strong>\n<strong><span lang=\"EN-US\">Internet</span>\n</strong>\n<strong><span>传输。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇可交换图像文件格式（</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>）</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>是一种用于在网页中显示图像的通用格式。</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件适用于画线、有纯色块的图片和在颜色之间有清晰边界的图片。</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件是压缩的，但是压缩过程中没有信息丢失，解压缩的图像与原始图像完全一样。</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件中的一种颜色可以被指定为透明，这样，图像将具有显示它的任何网页的背景色。在单个文件中存储一系列</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>图像可以形成一个动画</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>。</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件每像素最多能存储</span>\n</strong>\n<strong><span lang=\"EN-US\">8</span>\n</strong>\n<strong><span>位，所以它们只限于使用</span>\n</strong>\n<strong><span lang=\"EN-US\">256</span>\n</strong>\n<strong><span>种颜色</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇联合摄影专家组（</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>）</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>是一种适应于自然景观（如扫描的照片）的压缩方案。一些信息会在压缩过程中丢失，但这些丢失人眼是察觉不到的。</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>文件每像素存储</span>\n</strong>\n<strong><span lang=\"EN-US\">24</span>\n</strong>\n<strong><span>位，因此它们</span>\n</strong>\n<strong><span lang=\"EN-US\">8</span>\n</strong>\n<strong><span>能够显示超过</span>\n</strong>\n<strong><span lang=\"EN-US\">1600</span>\n</strong>\n<strong><span>万种颜色。</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>文件不支持透明或动画。</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>图像中的压缩级别是可以控制的，但较高的压缩级别（较小的文件）会导致丢失更多的信息。对于一幅以</span>\n</strong>\n<strong><span lang=\"EN-US\">20</span>\n</strong>\n<strong><span>：</span>\n</strong>\n<strong><span lang=\"EN-US\">1</span>\n</strong>\n<strong><span>压缩比生成的图像，人眼难以把它和原始图像区别开来。与</span>\n</strong>\n<strong><span lang=\"EN-US\">BMP</span>\n</strong>\n<strong><span>和</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>相比，</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>压缩不适用于线条图形、纯色块和清晰边界。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>有意思的是，</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>是一种压缩方案，不是一种文件格式，“</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>文件交换格式（</span>\n</strong>\n<strong><span lang=\"EN-US\">JFIF</span>\n</strong>\n<strong><span>）”是一种文件格式，常用于存储和传输已根据</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>方案压缩的图像。</span>\n</strong>\n<strong><span lang=\"EN-US\">Web</span>\n</strong>\n<strong><span>浏览器显示的</span>\n</strong>\n<strong><span lang=\"EN-US\">JFIF</span>\n</strong>\n<strong><span>文件使用</span>\n</strong>\n<strong><span lang=\"EN-US\">.jpg</span>\n</strong>\n<strong><span>扩展名</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇可交换图像文件（</span>\n</strong>\n<strong><span lang=\"EN-US\">EXIF</span>\n</strong>\n<strong><span>）</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">EXIF</span>\n</strong>\n<strong><span>是一种适用于数码相机拍摄的照片的文件格式，其文件中含有根据</span>\n</strong>\n<strong><span lang=\"EN-US\">JPEG</span>\n</strong>\n<strong><span>规格压缩的图像。</span>\n</strong>\n<strong><span lang=\"EN-US\">EXIF</span>\n</strong>\n<strong><span>文件中还包含了有关照片的信息（拍摄日期、快门速度、曝光时间等）和相机信息（制造商、型号等）。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇可移植网络图形（</span>\n</strong>\n<strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>）</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>格式不但保留了许多</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>格式的优点，还提供了超出</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>的功能。像</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件一样，</span>\n</strong>\n<strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>文件在压缩时也不损失信息。</span>\n</strong>\n<strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>文件能以每像素</span>\n</strong>\n<strong><span lang=\"EN-US\">8,24</span>\n</strong>\n<strong><span>或</span>\n</strong>\n<strong><span lang=\"EN-US\">48</span>\n</strong>\n<strong><span>位来存储颜色，并以每像素</span>\n</strong>\n<strong><span lang=\"EN-US\">1</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">2</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">4</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">8</span>\n</strong>\n<strong><span>或</span>\n</strong>\n<strong><span lang=\"EN-US\">16</span>\n</strong>\n<strong><span>位来存储灰度。相比之下，</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>文件只能使用每像素</span>\n</strong>\n<strong><span lang=\"EN-US\">1</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">2</span>\n</strong>\n<strong><span>、</span>\n</strong>\n<strong><span lang=\"EN-US\">4</span>\n</strong>\n<strong><span>或</span>\n</strong>\n<strong><span lang=\"EN-US\">8</span>\n</strong>\n<strong><span>位。</span>\n</strong>\n<strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>文件还可为每个像素存储一个</span>\n</strong>\n<strong><span lang=\"EN-US\">Alpha</span>\n</strong>\n<strong><span>值，该值指定了该像素颜色与背景颜色混合的程度。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>优于</span>\n</strong>\n<strong><span lang=\"EN-US\">GIF</span>\n</strong>\n<strong><span>之处在于，它能渐进地显示一幅图像（也就是说，在图像通过网络连接传递的过程中，显示的图像将越来越完整）。</span>\n</strong>\n<strong><span lang=\"EN-US\">PNG</span>\n</strong>\n<strong><span>文件可包含灰度校正和颜色校正信息，以便图像在各种各样的显示设备上精确地呈现。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>◇标签图像文件格式（</span>\n</strong>\n<strong><span lang=\"EN-US\">TIFF</span>\n</strong>\n<strong><span>）</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">TIFF</span>\n</strong>\n<strong><span>是一种灵活的、可扩展的格式，各种各样的平台和图像应用程序都支持这种格式。</span>\n</strong>\n<strong><span lang=\"EN-US\">TIFF</span>\n</strong>\n<strong><span>文件能以每像素任意位来存储图像，并可以使用各种各样的压缩算法。单个的多页</span>\n</strong>\n<strong><span lang=\"EN-US\">TIFF</span>\n</strong>\n<strong><span>文件可以存储数幅图像；可以把与图像相关的信息（扫描仪制造商、主机、压缩类型、打印方向和每像素采样等）存储在文件中并使用标签来排列这些信息；也可以根据需要通过批准和添加新标签来扩展</span>\n</strong>\n<strong><span lang=\"EN-US\">TIFF</span>\n</strong>\n<strong><span>格式。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n</span>\n</p>\n</span>\n</strong>\n</p>\n \n<p class=\"MsoNormal\"><strong><span lang=\"EN-US\"><span>4.<span style=\"font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-family: \'Times New Roman\';\">       </span>\n</span>\n</span>\n</strong>\n<strong><span>颜色</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt 18pt;\"><strong><span>计算机中的颜色表示通常有以下</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>种方式：</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt 18pt;\"><strong><span>◇</span>\n</strong>\n<strong><span lang=\"EN-US\">RGBA\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">R</span>\n</strong>\n<strong><span>代表红色，</span>\n</strong>\n<strong><span lang=\"EN-US\">G</span>\n</strong>\n<strong><span>代表绿色，</span>\n</strong>\n<strong><span lang=\"EN-US\">B</span>\n</strong>\n<strong><span>代表蓝色，</span>\n</strong>\n<strong><span lang=\"EN-US\">A</span>\n</strong>\n<strong><span>代表透明度，即可红、绿、蓝和透明度的组合来表示计算机中的所有颜色。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>是色光的色彩模式：</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>各色彩叠加形成了其他的色彩。因为</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>种颜色都有</span>\n</strong>\n<strong><span lang=\"EN-US\">256</span>\n</strong>\n<strong><span>个亮度水平级，所以</span>\n</strong>\n<strong><span lang=\"EN-US\">3</span>\n</strong>\n<strong><span>种色彩叠加就形成</span>\n</strong>\n<strong><span lang=\"EN-US\">1670</span>\n</strong>\n<strong><span>万种颜色了，也就是真彩色，通过它们足以展现绚丽的世界。在</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>模式中，由红、绿、蓝相叠加可以产生其他颜色，因此该模式也叫加色模式。所有显示器、投影设备以及电视机等许多设备都是依赖于这种加色模式来实现的。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>就编辑图像而言，</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>色彩模式也是最佳的色彩模式，因为它可以提供全屏幕的</span>\n</strong>\n<strong><span lang=\"EN-US\">24</span>\n</strong>\n<strong><span>位的色彩范围，即真彩色显示。但是，如果将</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>模式用于打印，那就不是最佳的了，因为</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>模式所提供的有些色彩已经超出了打印的范围之外，因此在打印一幅真彩色的图像时，就必然会损失一部分亮度，并且比较鲜艳的色彩会失真。</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong></strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt 18pt;\"><strong><span>◇</span>\n</strong>\n<strong><span lang=\"EN-US\">HSB\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>即用色调、饱和度、亮度的组合方式来表示颜色，其中</span>\n</strong>\n<strong><span lang=\"EN-US\">H</span>\n</strong>\n<strong><span>表示色相，</span>\n</strong>\n<strong><span lang=\"EN-US\">S</span>\n</strong>\n<strong><span>表示饱和度，</span>\n</strong>\n<strong><span lang=\"EN-US\">B</span>\n</strong>\n<strong><span>表示亮度。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>色相：表示纯色，即组成可见光谱的单色。红色在</span>\n</strong>\n<strong><span lang=\"EN-US\">0</span>\n</strong>\n<strong><span>度，绿色在</span>\n</strong>\n<strong><span lang=\"EN-US\">120</span>\n</strong>\n<strong><span>度，蓝色在</span>\n</strong>\n<strong><span lang=\"EN-US\">240</span>\n</strong>\n<strong><span>度。它基本上是</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>模式全色度的饼状图。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>饱和度：表示色彩的纯度，为</span>\n</strong>\n<strong><span lang=\"EN-US\">0</span>\n</strong>\n<strong><span>是为灰色。白、黑和其他灰色色彩都没有饱和度。在最大饱和度时，每一色相具有最纯的色光。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>亮度：表示色彩的明亮度。为</span>\n</strong>\n<strong><span lang=\"EN-US\">0</span>\n</strong>\n<strong><span>时即为黑色，最大亮度是色彩最鲜明的状态。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt 18pt;\"><strong><span>◇</span>\n</strong>\n<strong><span lang=\"EN-US\">CMYK\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>代表印刷上用的</span>\n</strong>\n<strong><span lang=\"EN-US\">4</span>\n</strong>\n<strong><span>种颜色，</span>\n</strong>\n<strong><span lang=\"EN-US\">C</span>\n</strong>\n<strong><span>代表青色，</span>\n</strong>\n<strong><span lang=\"EN-US\">M</span>\n</strong>\n<strong><span>代表洋红色，</span>\n</strong>\n<strong><span lang=\"EN-US\">Y</span>\n</strong>\n<strong><span>代表黄色，</span>\n</strong>\n<strong><span lang=\"EN-US\">K</span>\n</strong>\n<strong><span>代表黑色。这</span>\n</strong>\n<strong><span lang=\"EN-US\">4</span>\n</strong>\n<strong><span>种颜色的组合用来表示印刷上的颜色。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>当阳光照射到一个物体上时，这个物体将吸收一部分光线，并将剩下的光线进行反射，反射的光线就是人们所看见的物体颜色。这是一种减色色彩模式，同时也是与</span>\n</strong>\n<strong><span lang=\"EN-US\">RGB</span>\n</strong>\n<strong><span>模式的根本不同之处。不光人们看物体的颜色时用到了这种减色模式，而且在纸上印刷时应用的也是这种减色模式。按照这种减色模式，就衍变出了适合印刷的</span>\n</strong>\n<strong><span lang=\"EN-US\">CMYK</span>\n</strong>\n<strong><span>色彩模式。因为在实际应用中，青色、洋红色和黄色很难叠加形成真正的黑色，最多不过是褐色而已，因此才引入</span>\n</strong>\n<strong><span lang=\"EN-US\">K-</span>\n</strong>\n<strong><span>黑色。黑色的作用是强化暗调，加深暗部色彩。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span lang=\"EN-US\">CMYK</span>\n</strong>\n<strong><span>模式是最佳的打印模式。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><strong><span>在</span>\n</strong>\n<strong><span lang=\"EN-US\">.NET</span>\n</strong>\n<strong><span>平台上运用颜色时，用户不必关心这些细节，</span>\n</strong>\n<strong><span lang=\"EN-US\">System.Drawing.Color</span>\n</strong>\n<strong><span>结构封装了大部分常用颜色值及其操作。</span>\n</strong>\n<strong><span lang=\"EN-US\">\n<p> </p>\n</span>\n</strong>\n</p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p align=\"left\"> </p>\n  ',NULL,654,'0101','ASP.NET',NULL,0),(811,'2009-10-21 15:52:31','盼望着，盼望着，快来吧。。我的新书。。。。','\n    <p> </p>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\">昨天刚刚发工资，又正好收到邮件说是那本《 庖丁解牛:纵向切入ASP.NET 3.5控件和组件开发技术 》已经到货了，赶紧上china-pub下订单购买了，同时还买了另一本《ASP.NET 3.5从入门到精通:基于C#》，这本其实主要看中他的视频，呵呵，下午刚刚汇款过去。。晚上就说是已经发货了，嘿嘿，还真不错，邮寄是选择那比较贵的快递的，上面说是1~3天左右就到了，嘿嘿，得到书后第一件事就是把《ASP.NET 3.5从入门到精通:基于C#》附带光盘的视频传到网上共享给大家。。。如有人有需要的可留下你的email即可，下面是这二本书的介绍：</p>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\">《 庖丁解牛:纵向切入ASP.NET 3.5控件和组件开发技术 》：http://www.china-pub.com/192102</p>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\"> 《ASP.NET 3.5从入门到精通:基于C#》：http://www.china-pub.com/44991</p>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\">\n</p>\n<div class=\"quote_title\">.NET3.5从入门到精通目录 写道</div>\n<div class=\"quote_div\">第1章ASP.NET介绍.1<br>第2章VisualStudio2008集成开发环境11<br>视频路径：&#92;视频文件&#92;02（1）VS2008安装.avi<br>视频路径：&#92;视频文件&#92;02（2）第一个ASPNET网站.avi<br>第3章C#语言34<br>第4章ASP.NET页面103<br>视频路径：&#92;视频文件&#92;04ASPNET页面.avi<br>第5章服务器控件134<br>视频路径：&#92;视频文件&#92;05用户控件.avi<br>第6章状态保存162<br>第7章ADO.NET数据访问179<br>视频路径：&#92;视频文件&#92;07（1）ADONET和GridView.avi<br>视频路径：&#92;视频文件&#92;07（2）ADONET二进制数据.avi<br>第8章LINQ235<br>视频路径：&#92;视频文件&#92;08linq.avi<br>第9章文件操作257<br>视频路径：&#92;视频文件&#92;09文件操作.avi<br>第10章图形操作271<br>视频路径：&#92;视频文件&#92;10饼图.avi<br>第11章XML290<br>视频路径：&#92;视频文件&#92;11XML.avi<br>第12章主题和母版页305<br>视频路径：&#92;视频文件&#92;12（1）主题.avi<br>视频路径：&#92;视频文件&#92;12（2）母版页.avi<br>第13章高级应用321<br>视频路径：&#92;视频文件&#92;13（1）HTTP处理程序.avi<br>视频路径：&#92;视频文件&#92;13（2）HTTP模块.avi<br>视频路径：&#92;视频文件&#92;13（3）全球化和本地化.avi<br>第14章ASP.NET网站的配置与部署337<br>视频路径：&#92;视频文件&#92;14发布和部署.avi<br>第15章XMLWebservices361<br>视频路径：&#92;视频文件&#92;15WebService.avi<br>第16章ASP.NETAJAX379<br>视频路径：&#92;视频文件&#92;16AJAX.avi<br>第17章水晶报表431<br>视频路径：&#92;视频文件&#92;17水晶报表.avi<br>第18章UML基础455<br>第19章项目实践——人力资源系统476<br>视频路径：&#92;视频文件&#92;19人力资源系统.avi<br>第20章项目实践——淘书网网站529</div>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\"> <span style=\"\">刚刚在复制目录的时候发现个问题，目录里面有蛮多的多余字段的，都是&lt;font ..之类的，自己保存了页面之后用aspx把那些多余的乱码去掉了，在这里也记录一下代码：</span></p>\n<p style=\"margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-indent: 0px;\">\n</p>\n<pre name=\"code\" class=\"c#\">           StreamReader sr = new StreamReader(\"c:&#92;&#92;Catalog2.htm\");\n           string str =  sr.ReadToEnd();\n           str = Regex.Replace(str, @\"&lt;font color=\"\"(#ffffff|white)\"\"&gt;&#92;w+&lt;/font&gt;\", \"\");\n           Response.Write(str);</pre>\n \n\n<p> </p>\n  ',NULL,688,'0103','随笔',NULL,0),(812,'2009-10-21 15:52:31','重置表的自增字段','\n    刚刚在转移数据的时候要用到的，上网查了一下，特此记录\n<br /><pre name=\"code\" class=\"sql\">\n--删除原表数据\ntruncate table tb_producttype \n-- 重置表的自增字段\nDBCC CHECKIDENT (tb_producttype,reseed,0) \n</pre>\n<br />要注意的就是重置之前得先删除原表的数据，还有，如果是用truncate删除原表数据的话那么该表不能有外键关系。\n<br />\n<br />以上代码用于MSSQL\n  ',NULL,638,'0106','SQL',NULL,0),(813,'2009-10-21 15:52:31','生成Insert语句的存储过程','\n    网上找到的玩意，觉得很有用，呵呵，特此记录！\n<br /><pre name=\"code\" class=\"sql\">\n-- spGenInsertSQL存储过程生成的语句：insert cate;ry values(1,\'CPU\')\n-- spGenInsertSQLHan存储过程生成的语句：insert cate;ry(id,name) values(1,\'CPU\')\nif exists (select * from dbo.sysobjects where id = object_id(N\'dbo.spGenInsertSQL\') and OBJECTPROPERTY(id, N\'IsProcedure\') = 1)\ndrop procedure dbo.spGenInsertSQL\n;\n\nSET QUOTED_IDENTIFIER OFF \n;\nSET ANSI_NULLS ON \n;\n\nCREATE  proc spGenInsertSQL (@tablename varchar(256))\n\nas\n\nbegin\n\ndeclare @sql varchar(8000)\n\ndeclare @sqlValues varchar(8000)\n\nset @sql =\' (\'\n\nset @sqlValues = \'values (\'\'+\'\n\nselect @sqlValues = @sqlValues + cols + \' + \'\',\'\' + \' ,@sql = @sql + \'\' + name + \',\' \n\n  from \n\n      (select case \n\n                when xtype in (48,52,56,59,60,62,104,106,108,122,127)                                \n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \' + \'cast(\'+ name + \' as varchar)\'+\' end\'\n\n                when xtype in (58,61)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'cast(\'+ name +\' as varchar)\'+ \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n               when xtype in (167)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\')\' + \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (231)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'N\'\'\'\'\'\' + \' + \'replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\')\' + \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (175)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'cast(replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\') as Char(\' + cast(length as varchar)  + \'))+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (239)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'N\'\'\'\'\'\' + \' + \'cast(replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\') as Char(\' + cast(length as varchar)  + \'))+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                else \'\'\'NULL\'\'\'\n\n              end as Cols,name\n\n         from syscolumns  \n\n        where id = object_id(@tablename) \n\n      ) T \n\nset @sql =\'select \'\'INSERT INTO \'+ @tablename + \'  \'+ left(@sqlValues,len(@sqlValues)-4) + \')\'\' from \'+@tablename\n\n--print @sql\n\nexec (@sql)\n\nend\n\n\n;\nSET QUOTED_IDENTIFIER OFF \n;\nSET ANSI_NULLS ON \n;\n\n--==============================第二个存储过程\nif exists (select * from dbo.sysobjects where id = object_id(N\'dbo.spGenInsertSQLHan\') and OBJECTPROPERTY(id, N\'IsProcedure\') = 1)\ndrop procedure dbo.spGenInsertSQLHan\n;\n\nSET QUOTED_IDENTIFIER ON \n;\nSET ANSI_NULLS ON \n;\n\nCREATE   proc spGenInsertSQLHan (@tablename varchar(256))\n\nas\n\nbegin\n\ndeclare @sql varchar(8000)\n\ndeclare @sqlValues varchar(8000)\n\nset @sql =\' (\'\n\nset @sqlValues = \'values (\'\'+\'\n\nselect @sqlValues = @sqlValues + cols + \' + \'\',\'\' + \' ,@sql = @sql + \'\' + name + \',\' \n\n  from \n\n      (select case \n\n                when xtype in (48,52,56,59,60,62,104,106,108,122,127)                                \n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \' + \'cast(\'+ name + \' as varchar)\'+\' end\'\n\n                when xtype in (58,61)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'cast(\'+ name +\' as varchar)\'+ \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n               when xtype in (167)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\')\' + \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (231)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'N\'\'\'\'\'\' + \' + \'replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\')\' + \'+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (175)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'\'\'\'\'\'\' + \' + \'cast(replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\') as Char(\' + cast(length as varchar)  + \'))+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                when xtype in (239)\n\n                     then \'case when \'+ name +\' is null then \'\'NULL\'\' else \'+\'\'\'N\'\'\'\'\'\' + \' + \'cast(replace(\'+ name+\',\'\'\'\'\'\'\'\',\'\'\'\'\'\'\'\'\'\'\'\') as Char(\' + cast(length as varchar)  + \'))+\'\'\'\'\'\'\'\'\'+\' end\'\n\n                else \'\'\'NULL\'\'\'\n\n              end as Cols,name\n\n         from syscolumns  \n\n        where id = object_id(@tablename) \n\n      ) T \n\nset @sql =\'select \'\'INSERT INTO \'+ @tablename + \'\' + left(@sql,len(@sql)-1)+\') \' + left(@sqlValues,len(@sqlValues)-4) + \')\'\' from \'+@tablename\n\n--print @sql\n\nexec (@sql)\n\nend\n;\nSET QUOTED_IDENTIFIER OFF \n;\nSET ANSI_NULLS ON \n;\n</pre>\n  ',NULL,639,'0106','SQL',NULL,0),(814,'2009-10-21 15:52:31','通过SQL语句向自增字段的ID列插入ID','\n    通过一些方法生成的对某张表数据的insert语句时，往往会是：\n<br /><pre name=\"code\" class=\"sql\">\ninsert brand(id,name) values(1,\'技嘉\')\n</pre>\n<br />但是往往我们的数据表中id字段是自增的，这就导致在执行这一语句的时候会产生错误：\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />消息 8101，级别 16，状态 1，第 1 行\n<br />仅当使用了列列表并且 IDENTITY_INSERT 为 ON 时，才能为表\'cate;ry\'中的标识列指定显式值。\n<br /></div>\n<br />解决的方法在错误中已经提示给我们了，就是把那个东西设置为on后就能向ID列插入值了，所以正确的执行插入语句的做法应该是：\n<br /><pre name=\"code\" class=\"sql\">\nSET IDENTITY_INSERT brand ON\n\ninsert brand(id,name) values(1,\'技嘉\')\n\nSET IDENTITY_INSERT brand OFF\n</pre>\n<br />注意on了之后得off。\n  ',NULL,702,'0106','SQL',NULL,0),(798,'2009-10-21 15:52:30','本人的WIN7 RC+汉化安装步骤','&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 网上看了很多关于win7的贴子，弄得自己心痒痒的，正好前些前电信局的来安装宽带了，呵呵，初步用起来感觉蛮不错的，打开网页很快，于是正好试试上下载官网的WIN7来玩玩，根据雨林论坛中的 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; urlhttp://www.ylmf.net/read.php?tid=1245225 /url<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 贴子及其回复里的链接到官网上下载了WIN7的RC英文版和中文语言包，下载速度还真不错，稳定在120KB/S左右，以前用铁通的网下载还没有超过20KB/S以上的，嘿嘿，才一个晚上，就把3G多的WIN7RC和中文语言包下载下来了，在这里我下载的是WIN7 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RC 的64位版本，中文语言包也是下载了64位版本。<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下面开始安装，在此之前先说一下我的系统配置：AMD 5400+ 绿盒，KINGMAX 2G <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DDR800，迪兰恒进HD4670雷钻，西部数据320G/SATA/16M，技嘉MA770-US3 ，LG W1942SP ，先锋217CH 20X <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DVD刻录机， 先马1908机箱（空），航嘉冷静王VISTA版，这是今年3月份才买的电脑，我想应该是能够安装WIN7了吧，在安装之前我的系统是深度GHOST <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XP SP3 9.0版，应该是32位系统吧，怎么看自己的系统是多少位的都不知道，呵呵。在安装之前上网看相关的贴子，发现有人说是32位的系统安装64位 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 的WIN7有可能会产生问题，于是花了一下午的时间把电脑里的重要视频刻录光盘备份了起来，接下来就按照<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"http://www.ylmf.net/read.php?tid=1273473\" target=\"_blank\">http://www.ylmf.net/read.php?tid=1273473</a>这贴子里的方法进行WIN7的硬盘安装了<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注：下面的图片都来自自己的截图或者手机拍摄<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首先把需要准备的软件都准备了<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/01.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其中7100.0.090421-1700_x64fre_client_en-us_retail_ultimate-grc1culxfrer_en_dvd.iso是从官网上下载的64位WIN7 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RC版，验证如下：<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 文件:<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; F:\\win7rcsetup\\7100.0.090421-1700_x64fre_client_en-us_retail_ultimate-grc1culxfrer_en_dvd.iso<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 大小: 3270828032 字节修改时间: 2009年5月17日, 10:53:57<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MD5: 98341AF35655137966E382C4FEAA282D<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHA1: FC867FE1AB2E0A9796F9E4D155B44EA6998F4874<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRC32: 58FB2BE0<br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key.txt中是从官网上下载之前，他提供给我的一个key，Win6Ins_v1.2.0.62_XiaZaiBa.rar是从上面的贴子里下载的硬盘安装器，win7_x64_7100_lp_cab.cab也是从上面贴子中下载的WIN7的64位的中文语言包。<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 接下来，我在我的XP SP3系统上安装的虚拟光驱是winmount，用他打开WIN7的那个ISO，把如下文件解压到某一个盘符的根目录下。<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/02.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 上图中，GHOST文件夹是原深度系统的备份，不用管他，其他的文件boot,sources,bootmgr这三个文件都是从那个iso中解压出来的，放在G盘的根目录下。<br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后运行Win6Ins_v1.2.0.62中的exe文件，即那个硬盘安装器，如图：<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/03.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 点击安装按钮，然后他就会出现下图：<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/04.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 期间没叫我选择解压出的文件路径，估计他是会自动搜索出来的，出现上面的界面后然后重新启动计算机，以下的图片为手机截图，可能有点不清楚。不过我会尽量解释清楚的，重启系统后不停的按键盘上的F8，然后出现如下界面，选择最后一个“返回到操作系统的选择菜单”<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/05.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后选择 Window Vista/2008/7 Setup from Hard Disk<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/06.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 接下来就到了万众瞩目的WIN7安装的实质性阶段，下面是安装的启动界面，因为有点激动拍照的时候手有点抖，不过应该大概基本能看到样子。<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/07.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后就是选择语言，因为我们下的只有E文版，所以第一个安装语言也只能选English，第二个第三个应该是设置系统默认语言的，我们在这里设置为Chinese，其实不用设置到后面进到系统后设置也是可以的。<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/09.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下一步点击Install Now后就开始下式安装了<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/10.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/11.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Install Now后就是用户协议界面了，打勾再Next，<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/12.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 接下来有二个选项，Upgrade是升级安装，Custome(advanced)是高级安装，相当于是全新安装吧，我们可以在里面格式化磁盘等，理所当然的先第二项，Next<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/13.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下面就是安装中最重要的一点，稍有不慎的就把硬盘中的原有数据都格式化了。如下图，上一步选择了全新安装后在该界面则列出了当前硬盘中的所有磁盘，我的硬盘分区分为5个盘，其中如图C盘即为我的 <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WIN XP 的安装磁盘，我们可以从第二张图看出，该磁盘的类型为System，即系统盘，我们不需要安装双系统，只是安装一个WIN7即可<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/14.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/15.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 选择第一个C盘，点击右下角的Drive Options (Advanced)，注意不是点那个Next哦<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/16.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后磁盘列表下面就出现如下图，我们只是要格式化C盘，直接点击Format即可，注意此时列表中我们应该是已经选择了C盘的<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/17.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 点击Format操作后，因为格式化基本是不可逆的，所以这里windows还是会弹出一个提示框，内容意思大概是：格式化会磁盘内所有文件，是否确认删除。点击OK后，我们的C盘就会被格式化了，整个格式化的操作都是可以用鼠标进行操作的，不像以前我们在安装XP的时候只能键盘操作：光标键选C盘，按Enter后按F确认。<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/18.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 格式化后我们的C盘数据就没有了，大家可以看下图，磁盘总大小和可用空间大小基本相同<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/19.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 随后我们点击Next按钮，随即进入到了WIN7的正式安装阶段，如下图，<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/20.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; <br />\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在上面这张图中大概停留了8~9分钟，嗯，至少在我这台机子上我用手机的秒表计时是8分46秒钟，其中重启了一次，重启后就进到下面的界面了，开始一些系统安装完后的设置工作<br />\n&nbsp;&nbsp;&nbsp; <br />\n<img src=\"http://niunan.net/win7/images/21.jpg\" /><br />\n&nbsp;&nbsp;&nbsp; 下面就是一些设置工作了，在这里我手机照得不是很清楚，大家如果想看清楚图片的可以看之前我发的那个硬盘安装WIN7的贴子，下面是设置用户名和计算机名，设置完后点击Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/22.jpg\" /><br />\n下面是设置登陆密码的，开头二个文本框分别是输入密码和输入确认密码，第三个文本框是输入密码提示之类的，然后点击Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/23.jpg\" /><br />\n接下来就是输入序列号，我之前上官网下载WIN7 RC之前，官网提供了一个KEY，不过在这里我们可以直接把下面的复选框 打上勾，等到安装完后进入界面 再激活，不激活的话只能使用30天，打勾后Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/24.jpg\" /><br />\n接下来好像是设置更新的吧，选择第一项后继续Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/25.jpg\" /><br />\n下图就是设置时间的，可以直接Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/26.jpg\" /><br />\n设置网络的，在这里任选一个即可，我选择第一个，Home network家庭网络, Next<br />\n<br />\n<img src=\"http://niunan.net/win7/images/27.jpg\" /><br />\n经过一番设置，终于进入到了令人激动人心的WIN7主界面了，如下图，看起来很舒服，不知道是不会心理作用，WINDOWS的每一款系统的默认主题都是非常耐看的<br />\n<img src=\"http://niunan.net/win7/images/28.jpg\" /><br />\n当然，我们安装的英文版，理所当然的点击左下角的那个开始图标后展现在我们眼前的都是一片e文，当务之前当然就是先把WIN7汉化过来，还记得我们开始下载的那个win7_x64_7100_lp_cab.cab中文汉化包吗？现在我们就用这个汉化包来进行汉化，点击左下角的图标，选择Control Panel（控制面板）<br />\n<img src=\"http://niunan.net/win7/images/29.jpg\" /><br />\n在跳出来的界面中选择如下图所示，Change display language(改变显示语言)<br />\n<img src=\"http://niunan.net/win7/images/30.jpg\" /><br />\n紧接着在弹出的窗口中点击Install/uninstall languages（安装/卸载 语言），如下图<br />\n<img src=\"http://niunan.net/win7/images/31.jpg\" /><br />\n选择第一项，Install display languages（安装显示语言）<br />\n<img src=\"http://niunan.net/win7/images/32.jpg\" /><br />\n在弹出的窗口中选择第二项，Browse computer or network（浏览计算机或者网络）<br />\n<img src=\"http://niunan.net/win7/images/33.jpg\" /><br />\n在弹出的又一窗口中点击Browse...按钮选择你硬盘上的那个汉化包，如下图，然后点击Next<br />\n<img src=\"http://niunan.net/win7/images/34.jpg\" /><br />\n经过一段时间的等待后重启，就看到了我们熟悉的中文界面了<br />\n<img src=\"http://niunan.net/win7/images/35.jpg\" /><br />\n因为我安装的是64位版本，以前在32位XP下安装的一些软件估计会使用不了，现总结如下（只以本人经常使用的软件为主）：<br />\n1、QQ：以前在XP下QQ只要安装一次即可，即使重装XP后只要到原QQ目录中双击QQ主程序图标即可使用，但现在是在64位的WIN7下，经测试直接双击原目录中的程序不可用，必须重新安装QQ程序后即可使用，注：本人使用的都是从官方下载的QQ2009<br />\n2、UC：和QQ一样，也是重新后即可使用，但是不知道不我的RP问题还是WIN的问题还是UC的问题，我安装UC2008Beta后可进聊天室，但是安装从官网上下载的UC2009正式版，在进聊天室时程序会出错，强制退出<br />\n3、Ispeak：也是和QQ一样，重新安装即可<br />\n4、winmount虚拟光驱：该软件官网上有64位版本下载，本人比较喜欢用的一款虚拟光驱软件<br />\n5、FlashFXP：FTP上传工具，网上下的破解版，在WIN7中双击即可使用<br />\n6、Dreamweaver,Photoshop,Flsh绿色版：在XP下可用的绿色版 ，在WIN7下都不可以使用了，我去安装以前下载的Photoshop翻茄花园版后可以使用，Dreamweaver和Flash在电脑上因没有安装版，固无法测试，不过估计应该用安装版的安装过后也可以正常使用的<br />\n7、Office 2007：重新安装即可使用<br />\n8、Visual Studio 2008：安装即可使用<br />\n9、SQL 2008 Express：官网上有64位版本下载，安装后即可使用<br />\n<div id=\"digg_bottom\" class=\"clearfix\"><a onclick=\"&#039;digg(&quot;blogs&quot;,\" href=\"http://niunan.net/admin/&#039;#&#039;\" false;&#039; 393229, true);return><div>&nbsp;</div>\n</a></div>\n',NULL,648,'0103','随笔',NULL,0),(799,'2009-10-21 15:52:30','SQL数据库中查询某一字段以汉字开头的记录','\n    <pre name=\"code\" class=\"sql\">\nselect * from tb_product where proname like N\'啊-座%\'\n</pre>\n  ',NULL,912,'0106','SQL',NULL,0),(800,'2009-10-21 15:52:30','delphi连接SQL2005做的数据库管理系统的一些部署问题','\n    &nbsp;&nbsp;&nbsp; 公司委托某公司做一个进销存系统，对方称不称得上公司还不知道，至少我知道的那进销存系统就一个人在做，用delphi来做的，连接MSSQL2005，仿“易图进销存”软件，前几天做好半成品了传我试用，我在我自己的电脑（已安装.net framework和mssql2008）上运行软件一切正常，换到别人的机子（没有安装.net framework和msql2008）上测试的时候，连接数据库的时候弹出“未找到提供程序”的错误提示框。\n<br />\n<br />&nbsp;&nbsp;&nbsp; 与那边联系后对方说你必须得安装mssql 2005才能运行软件的，不管你这个软件的数据库是加载在哪台电脑上，运行这个软件的电脑得安装mssql 2005，我一听就晕了，就算是安装mssql express版本的那也得好几十M啊。。。\n<br />\n<br />&nbsp;&nbsp;&nbsp; 经多方查证，上论坛发贴问，在CSDN论坛发的贴子中的回复中的一句话提醒了我\n<br /><a href=\"http://topic.csdn.net/u/20090514/12/918e2a68-d974-4596-939a-15dc86e7b920.html\" target=\"_blank\">http://topic.csdn.net/u/20090514/12/918e2a68-d974-4596-939a-15dc86e7b920.html</a>\n<br />看来就是没有安装SQL Native Client导致的问题了。\n<br />\n<br />&nbsp;&nbsp;&nbsp; 经过本人多方上网查找资料，SQL Native Client的单独安装程序在MSSQL2005安装光盘中的Setup文件夹中，有二个文件，sqlncli_x64.msi和sqlncli.msi，理所当前前者用于64位机器的。呵呵，等我回去了在我家里的WIN7 64位机上安装了再试试。。这回应该行了。 \n<br />然后我又找了一台没有安装.net framework的机器试 \n<br />① 先安装sqlncli.msi \n<br />② 然后运行软件，欧耶，又成功运行了。。呵呵。。\n<br />\n<br />特此记录！\n<br />\n  ',NULL,652,'0103','随笔',NULL,0),(801,'2009-10-21 15:52:30','ASP.NET利用正则表达式提取字符串中的数字','\n    一言不足以毕之，请LOOK代码：\n<br /><pre name=\"code\" class=\"c#\">\n            string text = \" 订单5|本次付款：4783|本单结清,\";\n            string pat = @\"(&#92;d+)\";\n            Regex r = new Regex(pat, RegexOptions.IgnoreCase);\n            Match m = r.Match(text);\n            int matchCount = 0;\n            while (m.Success)\n            {\n                ++matchCount;\n                Group g = m.Groups1;\n                Response.Write(\"Match\" + matchCount +\"：\"+ g + \"&lt;br /&gt;\");\n\n                m = m.NextMatch();\n            }\n</pre>\n  ',NULL,839,'0101','ASP.NET',NULL,0),(802,'2009-10-21 15:52:30','鼠标移到某一元素则在元素旁边出现弹出框','\n    &nbsp;&nbsp; 类似于当当网的发货以后的那个发货反馈，鼠标移上去后自动会弹出一个框，位置随位置的改变而改变，代码如下：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;title&gt;框框随着鼠标点击的元素的位置改变而改变&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n	a{\n	border: 1px solid #0f0;\n	margin: 20px;\n	width: 60px;\n	height: 30px;\n	line-height: 30px;\n	float: left;\n	display: block;\n	text-align: center;\n	}\n	.pop{\n		width: 350px;\n		height: 200px;\n		border: 1px solid #00f;\n		background-color: #ffffee;\n		display: none;\n		position:absolute;  /* 注：弹出框必须为绝对定位 */\n	}\n	&lt;/style&gt;\n    &lt;script type=\"text/javascript\" src=\"jquery.js\"&gt;&lt;/script&gt;\n	&lt;script type=\"text/javascript\"&gt;\n		function hidedetails(){\n			$(\"#details\").hide();\n		}\n		function showdetails(thisObj,orderid){\n			var d = $(thisObj);\n			var pos = d.offset();\n            var t = pos.top + d.height() + 5; // 弹出框的上边位置\n            var l = pos.left + d.width() + 5;  // 弹出框的左边位置\n            $(\"#details\").css({ \"top\": t, \"left\": l }).show();\n			$(\"#details\").html(\"订单 \"+orderid+\" 的内容！\");\n		}\n	&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=\"showdetails(this,1)\" onmouseout=\"hidedetails()\"&gt;订单1&lt;/a&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=\"showdetails(this,2)\" onmouseout=\"hidedetails()\"&gt;订单2&lt;/a&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=\"showdetails(this,3)\" onmouseout=\"hidedetails()\"&gt;订单3&lt;/a&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=\"showdetails(this,4)\" onmouseout=\"hidedetails()\"&gt;订单4&lt;/a&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=\"showdetails(this,5)\" onmouseout=\"hidedetails()\"&gt;订单5&lt;/a&gt;\n&lt;div id=\"details\" class=\"pop\"&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n  ',NULL,880,'0110','jQuery',NULL,0),(803,'2009-10-21 15:52:30','ASP.NET中按一定的分隔符输出数组','\n    <p>刚刚项目中要用到，自己上网搜索了一下，得如下代码：</p>\n<pre name=\"code\" class=\"c#\"> string ss = {\"aaa\",\"bbb\",\"ccc\" };\n Response.Write(string.Join(\",\",ss));</pre>\n<p> </p>\n  ',NULL,697,'0101','ASP.NET',NULL,0),(804,'2009-10-21 15:52:30','JQuery控制图片无缝滚动','\n    <p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>经常有人问怎么在</span><span lang=\"EN-US\"><span>HTML</span></span><span>上制作图片的无缝滚动，我自己在一些项目中也会经常用到的，今天花了些时间，上网搜索了一下，下了些源码回来看了一下，发现都是只能在</span><span lang=\"EN-US\"><span>IE</span></span><span>下能够滚动的，而且都是光</span><span lang=\"EN-US\"><span>&lt;html&gt;&lt;/html&gt;</span></span><span>这样子的，没有加上</span><span lang=\"EN-US\"><span>documentType</span></span><span>标签，不符合“标准”。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>于是自己套上了标准之后再改了一下，发现在</span><span lang=\"EN-US\"><span>firefox</span></span><span>中还是滚动不起来，知道肯定是某些地方的</span><span lang=\"EN-US\"><span>js</span></span><span>只适用于</span><span lang=\"EN-US\"><span>IE</span></span><span>吧，也懒得慢慢找了，直接用</span><span lang=\"EN-US\"><span>jquery</span></span><span>来制作。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>图片无缝向左滚动的代码如下：</span></p>\n<p><span>\n<pre name=\"code\" class=\"html\">&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;title&gt;JS图片向左滚动&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n    img{\n    border: none;\n    }\n    &lt;/style&gt;\n    &lt;!-- 这句话不能少，记得把jquery.js文件放在当前页面的同一目录中 --&gt;\n    &lt;script type=\"text/javascript\" src=\"jquery.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"demo\" style=\"overflow:hidden;width:500px;\"&gt;\n  &lt;table border=0 align=center cellpadding=1 cellspacing=1 cellspace=0 &gt;\n    &lt;tr&gt;\n      &lt;td id=\"demo1\" valign=\"top\" bgcolor=\"ffffff\"&gt;\n      &lt;!-- 特别注意，下面的图片总宽度必须大于上面定义的demo的宽度，如上面demo的宽度为500px,则下面图片总宽度必须大于500,否则会出现些问题！ --&gt;\n          &lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n          &lt;tr align=\"center\"&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"01.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"02.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"03.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"04.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"05.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n        &lt;/table&gt;\n      &lt;/td&gt;\n      &lt;td id=\"demo2\" valign=\"top\"&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt; \nvar speed=30;\nvar demo = $(\"#demo\");\nvar demo1 = $(\"#demo1\");\nvar demo2 = $(\"#demo2\");\ndemo2.html(demo1.html());\nfunction Marquee(){ \n    if(demo.scrollLeft()&gt;=demo1.width())\n        demo.scrollLeft(0); \n    else{\n        demo.scrollLeft(demo.scrollLeft()+1);\n    }\n} \nvar MyMar=setInterval(Marquee,speed) \ndemo.mouseover(function() {\n    clearInterval(MyMar);\n} )\ndemo.mouseout(function() {\n    MyMar=setInterval(Marquee,speed);\n} )\n\nfunction fun1(){\n    alert(demo.scrollLeft());\n}\nfunction fun2(){\n    alert(demo1.width());\n}\n&lt;/script&gt;\n&lt;input type=\"button\"  value=\"显示demo.scrollLeft()\" onclick=\"fun1();\"/&gt;\n&lt;input type=\"button\"  value=\"显示demo1.width())\" onclick=\"fun2();\"/&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</pre>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\">  </p>\n</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p><span><span>那二个按钮主要是为了自己观察值的变化之用，正式使用中可以去掉。</span></span></p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><span>向右无缝滚动的</span><span lang=\"EN-US\"><span>HTML</span></span><span>同上，只是</span><span lang=\"EN-US\"><span>js</span></span><span>脚本中的</span><span lang=\"EN-US\"><span>Marquee</span></span><span>函数不同，代码如下：</span></p>\n<div class=\"cnblogs_code\"><span style=\"color: #000000;\">\n<pre name=\"code\" class=\"js\">function Marquee(){ \n    if(demo.scrollLeft()==0){\n        demo.scrollLeft(demo1.width());\n    }else{\n        demo.scrollLeft(demo.scrollLeft()-1);\n    }\n}</pre>\n <br></span></div>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><span>向上无缝滚动的</span><span lang=\"EN-US\"><span>HTML</span></span><span>代码如下：</span></p>\n<p> </p>\n<div class=\"cnblogs_code\"><span style=\"color: #000000;\">\n<pre name=\"code\" class=\"html\">&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;title&gt;JS图片向上滚动&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n    img{\n    border: none;\n    }\n    &lt;/style&gt;\n    &lt;!-- 这句话不能少，记得把jquery.js文件放在当前页面的同一目录中 --&gt;\n    &lt;script type=\"text/javascript\" src=\"jquery.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"demo\" style=\"overflow:hidden;height:300px;\"&gt;\n  &lt;table border=0 align=center cellpadding=1 cellspacing=1 cellspace=0 &gt;\n    &lt;tr id=\"demo1\"&gt;\n      &lt;td valign=\"top\" bgcolor=\"ffffff\"&gt;\n      &lt;!-- 特别注意，下面的图片总高度必须大于上面定义的demo的宽度，如上面demo的高度为300px,则下面所有图片的高的和值必须大于300,否则会出现些问题！ --&gt;\n          &lt;table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n          &lt;tr align=\"center\"&gt;\n            &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"01.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;            \n          &lt;/tr&gt;\n          &lt;tr align=\"center\"&gt;\n              &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"02.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n          &lt;tr align=\"center\"&gt;\n              &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"03.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n          &lt;tr align=\"center\"&gt;\n              &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"04.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n          &lt;tr align=\"center\"&gt;\n              &lt;td&gt;&lt;a href=\"#\" target=\"_blank\"&gt;&lt;img src=\"05.jpg\" width=\"150\" height=\"100\"&gt;&lt;/a&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n        &lt;/table&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr id=\"demo2\"&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt; \nvar speed=30;\nvar demo = $(\"#demo\");\nvar demo1 = $(\"#demo1\");\nvar demo2 = $(\"#demo2\");\ndemo2.html(demo1.html());\nfunction Marquee(){ \n    if(demo.scrollTop()&gt;=demo1.height())\n        demo.scrollTop(0); \n    else{\n        demo.scrollTop(demo.scrollTop()+1);\n    }\n} \nvar MyMar=setInterval(Marquee,speed) \ndemo.mouseover(function() {\n    clearInterval(MyMar);\n} )\ndemo.mouseout(function() {\n    MyMar=setInterval(Marquee,speed);\n} )\n\nfunction fun1(){\n    alert(demo.scrollTop());\n}\nfunction fun2(){\n    alert(demo1.height());\n}\n&lt;/script&gt;\n&lt;input type=\"button\"  value=\"显示demo.scrollTop()\" onclick=\"fun1();\"/&gt;\n&lt;input type=\"button\"  value=\"显示demo1.height())\" onclick=\"fun2();\"/&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n </span></div>\n<p> </p>\n<p><span>向下无缝滚动的</span><span lang=\"EN-US\">HTML</span><span>代码同上，只是</span><span lang=\"EN-US\">js</span><span>脚本中的</span><span lang=\"EN-US\">Marquee</span><span>函数不同，如下：</span></p>\n<p> </p>\n<div class=\"cnblogs_code\"><span style=\"color: #000000;\">\n<pre name=\"code\" class=\"js\">function Marquee(){ \n    if(demo.scrollTop()==0)\n        demo.scrollTop(demo1.height()); \n    else{\n        demo.scrollTop(demo.scrollTop()-1);\n    }\n}</pre>\n <br></span></div>\n<p>源码下载：<a href=\"http://files.cnblogs.com/niunan/scrollpic.rar\">/Files/niunan/scrollpic.rar</a></p>\n  ',NULL,782,'0110','jQuery',NULL,0),(805,'2009-10-21 15:52:30','.NET3.5 GDI+ 图形操作6(完)','\n    <p>    前言: 本文章抄袭自本人刚刚买的《ASP.NET 3.5从入门到精通》这本书，此书介绍在 <a href=\"http://www.china-pub.com/44991\">http://www.china-pub.com/44991</a> ，本文章95%与此书的内容完全一样，另5%是我改正一些失误以后加上去的，该书原示例代码只能运行在IE核心的浏览器上，非IE核心浏览器上运行会出现些显示问题，本人更改了其中的一些代码。本文章经历昨晚本人五个小时的手打而成（且还未打完，下班回去继续打，想不到我的打字速度退化得这么快，郁闷！！！），俗话说：好记性不如烂笔头，把书的内容手打出来，对手，对脑，都有好处！！！</p>\n<p><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330832.gif\" alt=\"\"><img src=\"http://www.cnblogs.com/Emoticons/tusiji/203330716.gif\" alt=\"\"></p>\n<hr>\n<h2 style=\"margin: 13pt 0cm;\">\n<strong><span style=\"line-height: 173%; font-family: \'Cambria\',\'serif\';\">10.4 </span></strong><strong><span>应用实例</span></strong><strong></strong> </h2>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span style=\"font-size: 14pt;\" lang=\"EN-US\"><span style=\"font-family: Calibri;\">10.4.1 </span></span></strong><strong><span>饼图</span></strong><strong></strong></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>统计图是信息管理系统常用的功能，常用的有饼图、柱形图、拆线图等。饼图用来表示各部分比例，柱形图用来表示各部分的比较，拆线图用来表示发展趋势，另外还有其他一些具有特殊功能的图示。本小节将以二维饼图为例说明通过</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">.NET GDI+</span></span><span>来绘制统计图的原理。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>本例实现效果很简单，即根据给予的一组数据计算出各个数据项的比例，并分别用不同颜色表示，组成一个圆饼，如下图所示：</span></p>\n<p> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/22.jpg\" border=\"0\" alt=\"\" width=\"537\" height=\"390\"></p>\n<p><span>用户可以使用</span><span lang=\"EN-US\">FillPie</span><span>来绘制饼块，多个饼块拼接在一起就形成了圆饼效果。其基本算法就是每个部分角度的计算，在总共</span><span lang=\"EN-US\">360</span><span>°的条件下，每个部分会占多少度。为了方便起见，本例的数据源采用数组，在实例应用过程中，数组数据可以来自数据库，具体代码如下：</span></p>\n<p> </p>\n<pre name=\"code\" class=\"c#\">int arr = {100,35,115,125,75,120 };\n// 原书中没有这句，表示不同的颜色\nColor colors = { Color.BlueViolet,Color.Yellow,Color.Green,Color.Gray,Color.Blue,Color.Purple};\nBitmap bmp = new Bitmap(400,400); // 创建一个图像\nGraphics g = Graphics.FromImage(bmp); // 创建Graphics 对象\ng.Clear(Color.White);  // 白色背景\ng.DrawString(\"本书上半年销售情况\", new Font(\"黑体\",16), Brushes.Black, new PointF(5,5)); // 标题\n\nfloat length = 200;\nfloat currentAngle = 0; // 当前饼块的角度\nfloat totalAngle = 0;  // 已画完的饼块的角度和\nfloat totalValues = 0;  // 所有值总和\n// 所有值求和\nforeach (int i in arr)\n{\n    totalValues += i;\n}\n// 开始画饼块\nfor (int i = 0; i &lt; arr.Length;i++ )\n{\n    currentAngle = arri / totalValues * 360; // 计算当前饼块角度\n    g.FillPie(new SolidBrush(colorsi), 100, 50, length, length, totalAngle, currentAngle); // 填充饼块\n    // 画饼块边界\n    g.DrawPie(Pens.Black, 100, 50, length, length, totalAngle, currentAngle);\n    totalAngle += currentAngle;\n}\n// 原书示例代码中没有,没有这句则在非IE浏览器会出错\nResponse.ContentType = \"image/GIF\";\n// 将图形加载到Response中\nbmp.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Gif);\ng.Dispose();\n</pre>\n<p> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>上面代码粘贴到</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Page_Load</span></span><span>中，运行页面就可以看到效果中的样子。如果想在饼块的各个部分添加说明文字，可以使用</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">DrawString</span></span><span>绘制文字，或者在图的空白处显示图例说明，图例可以使用</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">FillRectangle</span></span><span>绘制矩形区域。</span></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span style=\"font-size: 12pt;\" lang=\"EN-US\"><span style=\"font-family: Calibri;\">10.4.2 </span></span></strong><strong><span>水印</span></strong><strong></strong></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>在网络中发布资源时，比如图片，很多时候需要保护版权，即在图片上显示版权信息。要实现这样的效果，最简单有效的办法就是给图片添加水印（</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">WaterMark</span></span><span>），它和人民币中的水印原理一样，不容易涂改。通过制图软件一张一张地添加水印在技术上固然可行，但是工作量庞大，有时无法适应快速反应的要求，在实际操作中很少采用。在</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">ASP.NET</span></span><span>网站中，用户可以利用本小节的知识来实现自动添加水印。这里讲述两种水印：图像水印和文字水印。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>图像水印就是在要保护的图片中加入另一个作为水印的图片，即两个图片合二为一，基基本原理就是将一个图片绘制到另一个图片当中，形成一个图片。比如有个风景图片，为了表示版权信息，用户希望在图片的右下角添加说明，如图：</span></p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/23.jpg\" border=\"0\" alt=\"\"></p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>在实现代码以前，用户需要先准备好一个作为水印的图片</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">tg029.jpg</span></span><span>，一张</span><span><span style=\"font-family: Calibri;\"> </span></span><span>需要添加水印的图片</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Element.jpg</span></span><span>。下面的代码利用了</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Graphics</span></span><span>的</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">DrawImage</span></span><span>方法将</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">tg029.jpg</span></span><span>绘制到</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Element.jpg</span></span><span>中去。</span></p>\n<pre name=\"code\" class=\"c#\">string file = Server.MapPath(\"~/Element.jpg\");\nstring mark = Server.MapPath(\"~/tg029.jpg\");\n// 需要添加水印的图像\nSystem.Drawing.Image img = System.Drawing.Image.FromFile(file);\n// 水印图像\nSystem.Drawing.Image imgMark = System.Drawing.Image.FromFile(mark);\n// 创建Graphics对象\nGraphics g = Graphics.FromImage(img);\n// 将水印图像绘制到目标图像中去\ng.DrawImage(imgMark,img.Width-imgMark.Width,img.Height-imgMark.Height);\n// 原书示例代码中没有,没有这句则在非IE浏览器会出错\nResponse.ContentType = \"image/JPEG\";\n//将图像加载到Response中\nimg.Save(Response.OutputStream,System.Drawing.Imaging.ImageFormat.Jpeg);\ng.Dispose();\n</pre>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\">  </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>其实，添加水印并没有破坏</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Element.jpg</span></span><span>原图，只是在内存中形成新的图像对象，然后存入响应流中，并发送到客户端显示。这样做即保护了版权，又不损坏原图。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>有些时候人们喜欢用图片上加文字的方式来保护版权，参考如下图：</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/niunan/dotnet35/24.jpg\" border=\"0\" alt=\"\" width=\"771\" height=\"586\"> </p>\n<p> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>这里可以用</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">DrawString</span></span><span>方法来向图片绘制文本。为了使文字不至于影响图片效果，可以将其颜色设置为谈灰色，并适当调整透明度，参考代码如下：</span></p>\n<pre name=\"code\" class=\"c#\">string file = Server.MapPath(\"~/Element.jpg\");\nSystem.Drawing.Image img = System.Drawing.Image.FromFile(file);\n// 写文字的笔刷，透明度为100,淡灰色\nBrush b = new SolidBrush(Color.FromArgb(100,Color.LightGray));\n// 字体设置\nFontFamily ff = new FontFamily(\"华文琥珀\");\nFont f = new Font(ff, 100, FontStyle.Bold);\n// 文字区域左上角坐标\nfloat x = 50;\nfloat y = 50;\nGraphics g = Graphics.FromImage(img);\n//设置Graphics对象\ng.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;\ng.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;\ng.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;\n// 文字\ng.DrawString(\"牛腩制作\",f,b,new PointF(x,y));\n// 原书示例代码中没有,没有这句则在非IE浏览器会出错\nResponse.ContentType = \"image/JPEG\";\n//将图像加载到Response中\nimg.Save(Response.OutputStream, System.Drawing.Imaging.ImageFormat.Jpeg);\ng.Dispose();\n</pre>\n<p>  </p>\n<p> </p>\n<p><span>    如果是批量处理图片水印，则反复调用上述代码即可。当然，用户也可以设计出更美观的水印效果，并使用上述方法添加到图片中去。</span></p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><span lang=\"EN-US\"><span style=\"font-family: Calibri;\"> </span></span></p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><strong><span style=\"font-size: 12pt;\" lang=\"EN-US\"><span style=\"font-family: Calibri;\">10.4.3 </span></span></strong><strong><span>缩略图</span></strong><strong></strong></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Web</span></span><span>应用中最薄弱的环节就是传输，即速度问题。图片格式的数据往往比较大，所以网络中并不适合传输较大的图片。除了采用压缩格式（比如</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">GIF,JPEG</span></span><span>等）传输外，还可以使用缩略图的方式加快浏览速度，也可以节省页面空间。使用</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Image</span></span><span>类中的</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">GetThumbnailImage</span></span><span>方法可以很方便地生成缩略图，如下面的代码示例：</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span lang=\"EN-US\"> </span> </p>\n<pre name=\"code\" class=\"c#\"> // 取消操作回调\n    private bool ThumbnailCallback()\n    {\n        return false;\n    }\n\n    // 产生缩略图\n    private void Thumb(string imgPath, string thumbPath)\n    {\n        System.Drawing.Image.GetThumbnailImageAbort myCallback = new System.Drawing.Image.GetThumbnailImageAbort(ThumbnailCallback);\n        System.Drawing.Image img = System.Drawing.Image.FromFile(imgPath); // 通过文件构造\n       //生成缩略图\n       System.Drawing.Image myThumbnail = img.GetThumbnailImage(100,50,myCallback, IntPtr.Zero);\n       myThumbnail.Save(thumbPath); // 保存缩略图\n    }\n</pre>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\">  </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>用户可以简单地写一个测试脚本：</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n<pre name=\"code\" class=\"c#\">Thumb(Server.MapPath(\"~/Element.jpg\"), Server.MapPath(\"~/Element_small.jpg\")); </pre>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\">  </p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>程序运行后，即生成了</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">100*100</span></span><span>规格的缩略图。如果要批量生成缩略图，多次调用</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Thumb</span></span><span>方法即可。</span></p>\n<p class=\"MsoNormal\" style=\"margin: 0cm 0cm 0pt;\"><span lang=\"EN-US\"><span style=\"font-family: Calibri;\"> </span></span></p>\n<h2 style=\"margin: 13pt 0cm;\">\n<span lang=\"EN-US\"><span style=\"font-family: Cambria;\">10.5 </span></span><span>本章小结</span> </h2>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>本章学习了</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">ASP.NET</span></span><span>网站中图形绘制的知识，重点在于</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Graphics</span></span><span>对象的使用，由基本图形进而扩展到复杂图形的绘制，最后通过几个实际应用来加深理解。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"><span>当然，图形操作最适合于</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Windows</span></span><span>应用程序，由于</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">System.Drawing</span></span><span>是</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">.NET</span></span><span>基类库的一部分，所以本章内容在</span><span lang=\"EN-US\"><span style=\"font-family: Calibri;\">Windows</span></span><span>应用程序中仍可以适用。</span></p>\n<p class=\"MsoNormal\" style=\"text-indent: 21pt; margin: 0cm 0cm 0pt;\"> </p>\n  ',NULL,660,'0101','ASP.NET',NULL,0),(791,'2009-10-21 15:52:29','QQ在线服务代码','\n    经常看到有些商城在商品详细页处都有QQ图标，点进去后如果电脑上开着QQ时即可与对方进行陌生人联系，代码如下：\n<br /><pre name=\"code\" class=\"htm\">\n咨询QQ：&lt;span&gt;&lt;a target=\"_blank\" href=\"http://wpa.qq.com/msgrd?V=1&amp;amp;Uin=164423073\"&gt;\n            &lt;img alt=\"点击这里给我发消息\" src=\"http://wpa.qq.com/pa?p=1:164423073:4\" /&gt;&lt;/a&gt;&lt;/span&gt;\n        &lt;span&gt;&lt;a target=\"_blank\" href=\"http://wpa.qq.com/msgrd?V=1&amp;amp;Uin=417223100\"&gt;\n            &lt;img alt=\"点击这里给我发消息\" src=\"http://wpa.qq.com/pa?p=1:417223100:4\" /&gt;&lt;/a&gt;&lt;/span&gt;\n        &lt;span&gt;&lt;a target=\"_blank\" href=\"http://wpa.qq.com/msgrd?V=1&amp;amp;Uin=345952323\"&gt;\n            &lt;img alt=\"点击这里给我发消息\" src=\"http://wpa.qq.com/pa?p=1:345952323:4\" /&gt;&lt;/a&gt;&lt;/span&gt;\n</pre>\n<br />以上的代码都是从QQ官网生成的，其中最后后面的“4”表示的是图标的风格，详细的风格参照<a href=\"http://imis.qq.com/webpresence/code.shtml\" target=\"_blank\">http://imis.qq.com/webpresence/code.shtml</a>\n<br />如我想要风格1的，则把4改为1即可\n  ',NULL,801,'0103','随笔',NULL,0);
INSERT INTO `blog` VALUES (792,'2009-10-21 15:52:29','中关村网站产品参数页的参数纠错的制作','\n    今天突然想在正在做的网站中加上个像中关村一样的参数纠错的功能，效果如下图：\n<br /><img src=\"http://taotao.wsyren.com/bbspic/jiucuo.jpg\" />\n<br />虽然看起来好像蛮简单，但是自己还是想了一下午加上晚上的2个小时，不过等到自己做出来的时候好像也感觉到蛮简单的，其实这种web页面的小特效只要把思路想通了就很简单了，呵呵，只是思路，不能说是算法，算法太高深，ME也不懂。\n<br />看到这个效果很容易想到，无非也就是给那个td单元格加上一个mouseover事件，当鼠标移上出的时候就出现那个“参数纠错”的HTML标签。\n<br />用firebug查看中关村的页面，可以那到那个参数纠错无非也就是一个span标签中包含一个img和一段文字，然后给他一个向右浮动，这样自然会靠在td的右边。\n<br />需要注意的是当鼠标移开td单元格了以后，那个参数纠错的标签还是显示的，只有当鼠标移到另一个td单元格时，原来的那个参数纠错的标签才会消失，这样的话td的mouseout事件就不可用了。\n<br />我的想法就是利用jquery中的remove方法，每回进到mouseover事件时，首先先把当前页面中的参数纠错的标签移除，然后再在当前的td单元格内加上参数纠错的HTML标签。\n<br />废话讲多了，看如下正确的代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;产品纠错&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        .param_td\n        {\n            line-height: 25px;\n        }\n        .param_td a\n        {\n            font-size: 12px;\n        }\n        .param_td a:link, .param_td a:visited\n        {\n            text-decoration: none;\n            color: #0368A8;\n        }\n        .param_td a:hover\n        {\n            text-decoration: underline;\n            color: #FF6600;\n        }\n    &lt;/style&gt;\n\n    &lt;script src=\"js/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        function show(obj_td) {\n            /*\n            鼠标移到td单元格中，首先先把当前页面中纠错的HTML标签去掉，\n            再把纠错的HTML标签加到当前单元格中\n            */\n            $(\"#param_jiucuo\").remove();\n            var td = $(obj_td);\n            var tmp = td.text().replace(\"参数纠错\", \"\");\n            var html_jiucuo = \"&lt;span bgcolor=\'#ffffff\' style=\'float: right;\' id=\'param_jiucuo\'&gt;\" +\n                                        \"&lt;img src=\'http://icon.zol.com.cn/detail0802/e2.gif\'/&gt;\" +\n                                        \"&lt;a href=\'javascript:alert(&#92;\"\" + tmp + \"&#92;\")\'&gt;参数纠错&lt;/a&gt;\" +\n                                        \"&lt;/span&gt;\";\n            td.html(html_jiucuo + tmp);\n        }\n    &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;table width=\"770\" cellspacing=\"1\" cellpadding=\"0\" border=\"0\" bgcolor=\"#c5d7ed\"&gt;\n        &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;手机类型&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\" onmousemove=\"show(this)\"&gt;\n                    智能手机,3G手机\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;手机制式&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\" onmousemove=\"show(this)\"&gt;\n                    GSM、WCDMA\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;支持频段&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\" onmousemove=\"show(this)\"&gt;\n                    GSM 900/1800/1900MHz\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/tbody&gt;\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />以上代码是我测试成功的代码，起初我是不想在td标签上加onmousemove参数的，想利用jquery直接在$(function(){})中给第个td标签加上mousemove方法，但是最后测试不成功，如下是错误的代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;产品纠错-有问题的页面&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        .param_td\n        {\n            line-height: 25px;\n        }\n        .param_td a\n        {\n            font-size: 12px;\n        }\n        .param_td a:link, .param_td a:visited\n        {\n            text-decoration: none;\n            color: #0368A8;\n        }\n        .param_td a:hover\n        {\n            text-decoration: underline;\n            color: #FF6600;\n        }\n    &lt;/style&gt;\n\n    &lt;script src=\"js/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        $(function() {\n        /*\n            由于JS的冒泡事件机制，给td加个mouseover事件后也会自动给td内的a标签加上\n            该事件，所以就会有问题\n        */\n            $(\".param_td\").mouseover(function() {\n                var td = $(this);\n                $(\"#param_jiucuo\").remove();\n                var tmp = $.trim(td.text().replace(\"参数纠错\", \"\"));\n                var html_jiucuo = \"&lt;span bgcolor=\'#ffffff\' style=\'float: right;\' id=\'param_jiucuo\'&gt;\" +\n                                        \"&lt;img src=\'http://icon.zol.com.cn/detail0802/e2.gif\'/&gt;\" +\n                                        \"&lt;a href=\'javascript:alert(&#92;\"\" + tmp + \"&#92;\")\'&gt;参数纠错&lt;/a&gt;\" +\n                                        \"&lt;/span&gt;\";\n                td.html(html_jiucuo + tmp);\n            });\n        })\n    &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;table width=\"770\" cellspacing=\"1\" cellpadding=\"0\" border=\"0\" bgcolor=\"#c5d7ed\"&gt;\n        &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;手机类型&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\"&gt;\n                    智能手机,3G手机\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;手机制式&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\"&gt;\n                    GSM、WCDMA\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td width=\"100\" bgcolor=\"#ffffff\" valign=\"middle\" align=\"left\"&gt;\n                    &lt;strong&gt;支持频段&lt;/strong&gt;\n                &lt;/td&gt;\n                &lt;td width=\"450\" bgcolor=\"#ffffff\" class=\"param_td\"&gt;\n                    GSM 900/1800/1900MHz\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/tbody&gt;\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n<br />以上代码的错误出在哪里让自己想了N久，最后基本理解，由于JS的事件触发是一个冒泡机制的，大概就是因为我在JS代码中给td标签加了mouseover事件，这样在显示出来的时候当我移到td内的a标签上时也触发了td的mouseover事件，所以会出错，而之前的那个直接把mouseover事件加上HTML标签上的就不会有这个问题吧。\n<br />源码下载：http://taotao.wsyren.com/download/jiucuo.rar\n  ',NULL,660,'0101','ASP.NET',NULL,0),(793,'2009-10-21 15:52:29','求一整数的所有拆分方式','\n    <img src=\"http://taotao.wsyren.com/bbspic/intsplit.jpg\" />\n<br />题目要求如图，思路是把每次生成的数的组合放到一数组中，然后再把数组放到List中，每次生成符合的数组的时候，先判断List中是否已有该数组，无则输出。\n<br />\n<br />源码下载：<a href=\"http://taotao.wsyren.com/download/intsplit.rar\" target=\"_blank\">http://taotao.wsyren.com/download/intsplit.rar</a>\n  ',NULL,635,'0103','随笔',NULL,0),(794,'2009-10-21 15:52:29','ASP.NET运行程序（WIN+R）','\n    <pre name=\"code\" class=\"c#\">\nSystem.Diagnostics.Process.Start(\"notepad\");\n</pre>\n<br />如上代码则是运行记事本，相当于按下WIN+R后输入notepad运行！\n  ',NULL,695,'0101','ASP.NET',NULL,0),(795,'2009-10-21 15:52:29','牛腩自制TXT文本分割工具','    以前在博客园中看到某位朋友也发过一个分割工具的，不过那时自己不需要，也就没有收藏，今天自己需要把一个大的TXT文本文件分割成多份了，可又找不着那篇文章了，只好自己做了个简单的，效果如图：<br />\n<img src=\"http://niunan.net/bbspic/txt/txtsplit.jpg\" /><br />\n<br />\n以下为下载地址：<br />\n单文件下载：<a href=\"http://niunan.net/download/txt_singlefile.rar\" target=\"_blank\">http://niunan.net/download/txt_singlefile.rar</a><br />\n源码下载：<a href=\"http://niunan.net/download/txt_source.rar\" target=\"_blank\">http://niunan.net/download/txt_source.rar</a>  	                          	                          ',NULL,764,'0104','下载',NULL,0),(796,'2009-10-21 15:52:29','一道题','\n    论坛里某朋友提出一首题，如下：\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />輸入同學人數(最多15人): 10\n<br />輸入第1位同學小考成績: 80, 70, 60\n<br />輸入第2位同學小考成績: 60, 70, 60\n<br />輸入第3位同學小考成績: 80, 70, 90\n<br />...\n<br />輸入第10位同學小考成績: 80, 75, 90\n<br />====================================\n<br />第1位同學平均: 73\n<br />第2位同學平均: 63\n<br />第3位同學平均: 80\n<br />...\n<br />第10位同學平均: 82\n<br />====================================\n<br />第1高分為第10位同學\n<br />第2高分為第3位同學\n<br />第3高分為第1位同學 \n<br /></div>\n<br />这应该是一个控制台的应用程序了，自己初看起来觉得蛮简单的，但是做起来才知道郁闷，本以为十分钟搞掂的，结果弄了一晚上，下面是我自己写的程序，基本功能是应该实现了\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace TestApplication\n{\n\n    class Program\n    {\n        static List&lt;Student&gt; stus = new List&lt;Student&gt;(); // 存储学生的索引及其平均分\n        /// &lt;summary&gt;\n        /// 程序入口\n        /// &lt;/summary&gt;\n        static void Main(string args)\n        {\n            Console.Write(\"输入同学人数（最多15人）：\");\n            string num = Console.ReadLine();\n            int count;\n            if (int.TryParse(num, out count))\n            {\n                if (count &lt; 1 || count &gt; 15)\n                {\n                    Console.WriteLine(\"请输入1~15之间的数字，程序退出！\");\n                    Console.ReadLine();\n                    return;\n                }\n                string scours = new stringcount;  // 存储每位同学的成绩字符串，如:80, 70, 60\n                // 循环输入成绩\n                for (int i = 0; i &lt; count; i++)\n                {\n                    Console.Write(\"输入第\" + (i + 1) + \"位同学小考成绩：\");\n                    scoursi = Console.ReadLine();\n                }\n                Console.WriteLine(\"===============================================\");\n                // 循环输出平均成绩\n                for (int i = 0; i &lt; count; i++)\n                {\n                    Console.WriteLine(\"第\" + (i + 1) + \"位同学平均：\" + CalcAvg(scoursi, i + 1));\n                }\n                Console.WriteLine(\"===============================================\");\n                // 输出分数排名\n                StudentComparer sc = new StudentComparer();\n                stus.Sort(sc);\n                for (int i = 0; i &lt; stus.Count; i++)\n                {\n                    Console.WriteLine(\"第\" + (i + 1) + \"高分为第\" + stusi.Index + \"位同学：\" + stusi.Avg);\n                }\n            }\n            else\n            {\n                Console.WriteLine(\"格式输入错误，请输入数字，程序退出！\");\n            }\n            Console.Read();\n        }\n\n        /// &lt;summary&gt;计算成绩字符串的平均值\n        /// \n        /// &lt;/summary&gt;\n        /// &lt;param name=\"p\"&gt;成绩字符串，如：80,70,50&lt;/param&gt;\n        /// &lt;param name=\"index\"&gt;该同学的索引&lt;/param&gt;\n        /// &lt;returns&gt;&lt;/returns&gt;\n        private static string CalcAvg(string p, int index)\n        {\n            string ss = p.Split(new char { \',\' });\n\n            if (ss.Length == 0)\n            {\n                return \"成绩输入错误，请按“80,70,50”的格式输入！\";\n            }\n            else\n            {\n                int i = 0;\n                float total = 0f;\n                foreach (string str in ss)\n                {\n                    float f;\n                    if (float.TryParse(str, out f))\n                    {\n                        i++;\n                        total += f;\n                    }\n                    else\n                    {\n                        return \"成绩输入错误，请按“80,70,50”的格式输入！\";\n                    }\n                }\n                float avg = total / i; // 平均分\n                stus.Add(new Student(index, avg));  // 把当前同学的平均分及其索引加到List中        \n                return avg.ToString();\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// 学生实体类\n    /// &lt;/summary&gt;\n    public class Student\n    {\n        private int _index;\n        /// &lt;summary&gt;\n        /// 索引\n        /// &lt;/summary&gt;\n        public int Index\n        {\n            get { return _index; }\n            set { _index = value; }\n        }\n        private float _avg;\n        /// &lt;summary&gt;\n        ///  平均分\n        /// &lt;/summary&gt;\n        public float Avg\n        {\n            get { return _avg; }\n            set { _avg = value; }\n        }\n\n        public Student(int index, float avg)\n        {\n            this._index = index;\n            this._avg = avg;\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// 学生实体类的比较，按学生的平均分从高到低排列\n    /// &lt;/summary&gt;\n    public class StudentComparer : IComparer&lt;Student&gt;\n    {\n        public int Compare(Student x, Student y)\n        {\n            if (x == null)\n            {\n                if (y == null)\n                {\n                    // 如果二者都为空，那么他们则是相等的. \n                    return 0;\n                }\n                else\n                {\n                    // 如果X为空而Y不为空，则Y大\n                    return -1;\n                }\n            }\n            else\n            {\n                if (y == null)\n                // 如果X不为空而Y为空，则X大\n                {\n                    return 1;\n                }\n                else\n                {\n                    // 二者都不为空，则比较其中的avg属性\n                    float x_avg = x.Avg;\n                    float y_avg = y.Avg;\n                    return y_avg.CompareTo(x_avg);  //此为从大到小，若是 x_avg.CompareTo(y_avg)则是从小到大\n                }\n            }\n        }\n    }\n}\n</pre>\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/8193b3c4-8e11-38f9-a730-061f9ca76f51\">TestApplication.rar</a> (26.1 KB)</li>\n          \n          <li>下载次数: 1</li>\n        </ul>\n      \n    \n    \n  ',NULL,704,'0103','随笔',NULL,0),(797,'2009-10-21 15:52:29','查找表中的重复行','\n    <pre name=\"code\" class=\"sql\">\nselect * from tb_producttype where protname in(\nselect protname from tb_producttype group by protname having count(*)&gt;1\n)\n</pre>\n  ',NULL,654,'0106','SQL',NULL,0),(782,'2009-10-21 15:52:28','Excel中一次性删除所有图片','\n    &nbsp;&nbsp; 好久都不用Excel了，今天一下子突然用起来，真的有点生蔬了，想一次性的把一个Excel文档中的图片都删除掉，网上搜索了一下，得如下方法：\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />&nbsp;&nbsp; 快捷键Ctrl+G，选择定位的标识为“对象”，这样即可把文档中所有的图片都选中了，接下来按下DEL键就好了。\n<br /></div>\n  ',NULL,595,'0103','随笔',NULL,0),(783,'2009-10-21 15:52:28','FusionChartsFree及其教程','    &nbsp;&nbsp; 今天在群里有人发了这个东西，主是FLASH图表控件，看到标题说是支持多种语言的，就下下来试了下，呵呵。。发现还真的很有用。。。<br />\n&nbsp;&nbsp;&nbsp; 先记下来。。以后可用于自己做的项目中。。<br />\n&nbsp;&nbsp;&nbsp; 同时也上网找到一本《FusionCharts Free中文开发指南.pdf》，同时也上传上来吧。。。      <br />\n&nbsp;&nbsp;&nbsp; 下载地址：<a target=\"_blank\" href=\"http://niunan.net/download/FusionChartsFree.rar\">http://niunan.net/download/FusionChartsFree.rar</a><br />\n',NULL,1046,'0104','下载',NULL,0),(784,'2009-10-21 15:52:28','在VS中建立类库了以后生成的DLL文件带有注释的方法','\n    &nbsp;&nbsp; 刚刚在做项目的时候自己建立一个\"类库\",写了几个方法,都加上了///注释,但是生成DLL后在另一个WEB项目中应用,发现写的注释都没有了,上网查了下具体的原因,原来在生成DLL的同时没有生成相应的XML文件,而注释是放在XML文件中的,生成XML的方法如下:\n<br />&nbsp;&nbsp; \n<br />&nbsp;&nbsp; 在类库项目上右键→属性→生成,在\"输出\"那里,把XML文档打上勾,记得不要改名,DLL文件名和XML的文件名必须相同才能找到注释!!!\n  ',NULL,638,'0101','ASP.NET',NULL,0),(785,'2009-10-21 15:52:28','.NET简易修改XML文件','\n    &nbsp;&nbsp; 做项目的时候需要用到，对一些小数据量的数据就存储在XML文件中就行，比如说现在要制作的进销存系统的公司信息。\n<br />&nbsp;&nbsp;&nbsp; 花了些时间，上网找了些资料，得如下代码，可简单的修改XML文件后再保存：\n<br /><pre name=\"code\" class=\"c#\">\n            // 读取XML文件\n            DataSet ds = new DataSet();\n            ds.ReadXml(Server.MapPath(\"CompanyInfo.xml\"));\n\n            gv.DataSource = ds.Tables0.DefaultView;\n            gv.DataBind();\n\n            // 修改XML文件\n            ds.Tables0.Rows0\"Name\" = \"牛腩有限责任公司\";\n            ds.WriteXml(Server.MapPath(\"CompanyInfo.xml\"));\n\n            DataSet ds2 = new DataSet();\n            ds2.ReadXml(Server.MapPath(\"CompanyInfo.xml\"));\n            gv2.DataSource = ds2.Tables0.DefaultView;\n            gv2.DataBind();\n</pre>\n<br />XML文件的代码如下：\n<br /><pre name=\"code\" class=\"xml\">\n&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;CompayInfo&gt;\n  &lt;Name&gt;众志科技有限责任公司&lt;/Name&gt;\n  &lt;Code&gt;100010&lt;/Code&gt;\n  &lt;Address&gt;北京天安门街110号&lt;/Address&gt;\n  &lt;Phone&gt;1101101&lt;/Phone&gt;\n  &lt;Email&gt;tg029@126.com&lt;/Email&gt;\n  &lt;Remark&gt;众志网www.tg029.com母公司&lt;/Remark&gt;\n&lt;/CompayInfo&gt;\n</pre>\n  ',NULL,726,'0101','ASP.NET',NULL,0),(786,'2009-10-21 15:52:28','对int数组进行从大到小的排序,并去除重复项','\n    <pre name=\"code\" class=\"c#\">\n        static void Main(string args)\n        {\n            int xx = { 1, 4, 4, 4, 6, 6, 8, 76, 7, 4 };\n            List&lt;int&gt; l = xx.ToList&lt;int&gt;();\n            l.Sort();\n\n            var query = (from q in l\n                         select q).Distinct();\n\n            for (int i = query.Count() - 1; i &gt; 0; i--)\n            {\n                Console.Write(query.ElementAt(i) + \" , \");\n            }\n\n            Console.Read();\n        }\n</pre>\n  ',NULL,734,'0101','ASP.NET',NULL,0),(787,'2009-10-21 15:52:28','数字金额转为大写金额(C#)','\n    &nbsp; 看视频的时候看到视频里有讲怎么把数字金额转成大写的,对着视频的代码打了一遍,测试成功,先记下来,以备后用!\n<br /><pre name=\"code\" class=\"c#\">\n   /// &lt;summary&gt;金额转大写\n    /// \n    /// &lt;/summary&gt;\n    public class MoneyConvertChinese\n    {\n        /// &lt;summary&gt;金额转大写\n        /// \n        /// &lt;/summary&gt;\n        /// &lt;param name=\"LowerMoney\"&gt;&lt;/param&gt;\n        /// &lt;returns&gt;&lt;/returns&gt;\n        public string MoneyToChinese(string LowerMoney)\n        {\n            string functionReturnValue = null;\n            bool IsNegative = false; // 是否是负数\n            if (LowerMoney.Trim().Substring(0, 1) == \"-\")\n            {\n                // 是负数则先转为正数\n                LowerMoney = LowerMoney.Trim().Remove(0, 1);\n                IsNegative = true;\n            }\n            string strLower = null;\n            string strUpart = null;\n            string strUpper = null;\n            int iTemp = 0;\n            // 保留两位小数 123.489→123.49　　123.4→123.4\n            LowerMoney = Math.Round(double.Parse(LowerMoney), 2).ToString();\n            if (LowerMoney.IndexOf(\".\") &gt; 0)\n            {\n                if (LowerMoney.IndexOf(\".\") == LowerMoney.Length - 2)\n                {\n                    LowerMoney = LowerMoney + \"0\";\n                }\n            }\n            else\n            {\n                LowerMoney = LowerMoney + \".00\";\n            }\n            strLower = LowerMoney;\n            iTemp = 1;\n            strUpper = \"\";\n            while (iTemp &lt;= strLower.Length)\n            {\n                switch (strLower.Substring(strLower.Length - iTemp, 1))\n                {\n                    case \".\":\n                        strUpart = \"圆\";\n                        break;\n                    case \"0\":\n                        strUpart = \"零\";\n                        break;\n                    case \"1\":\n                        strUpart = \"壹\";\n                        break;\n                    case \"2\":\n                        strUpart = \"贰\";\n                        break;\n                    case \"3\":\n                        strUpart = \"叁\";\n                        break;\n                    case \"4\":\n                        strUpart = \"肆\";\n                        break;\n                    case \"5\":\n                        strUpart = \"伍\";\n                        break;\n                    case \"6\":\n                        strUpart = \"陆\";\n                        break;\n                    case \"7\":\n                        strUpart = \"柒\";\n                        break;\n                    case \"8\":\n                        strUpart = \"捌\";\n                        break;\n                    case \"9\":\n                        strUpart = \"玖\";\n                        break;\n                }\n\n                switch (iTemp)\n                {\n                    case 1:\n                        strUpart = strUpart + \"分\";\n                        break;\n                    case 2:\n                        strUpart = strUpart + \"角\";\n                        break;\n                    case 3:\n                        strUpart = strUpart + \"\";\n                        break;\n                    case 4:\n                        strUpart = strUpart + \"\";\n                        break;\n                    case 5:\n                        strUpart = strUpart + \"拾\";\n                        break;\n                    case 6:\n                        strUpart = strUpart + \"佰\";\n                        break;\n                    case 7:\n                        strUpart = strUpart + \"仟\";\n                        break;\n                    case 8:\n                        strUpart = strUpart + \"万\";\n                        break;\n                    case 9:\n                        strUpart = strUpart + \"拾\";\n                        break;\n                    case 10:\n                        strUpart = strUpart + \"佰\";\n                        break;\n                    case 11:\n                        strUpart = strUpart + \"仟\";\n                        break;\n                    case 12:\n                        strUpart = strUpart + \"亿\";\n                        break;\n                    case 13:\n                        strUpart = strUpart + \"拾\";\n                        break;\n                    case 14:\n                        strUpart = strUpart + \"佰\";\n                        break;\n                    case 15:\n                        strUpart = strUpart + \"仟\";\n                        break;\n                    case 16:\n                        strUpart = strUpart + \"万\";\n                        break;\n                    default:\n                        strUpart = strUpart + \"\";\n                        break;\n                }\n\n                strUpper = strUpart + strUpper;\n                iTemp = iTemp + 1;\n            }\n\n            strUpper = strUpper.Replace(\"零拾\", \"零\");\n            strUpper = strUpper.Replace(\"零佰\", \"零\");\n            strUpper = strUpper.Replace(\"零仟\", \"零\");\n            strUpper = strUpper.Replace(\"零零零\", \"零\");\n            strUpper = strUpper.Replace(\"零零\", \"零\");\n            strUpper = strUpper.Replace(\"零角零分\", \"整\");\n            strUpper = strUpper.Replace(\"零分\", \"整\");\n            strUpper = strUpper.Replace(\"零角\", \"零\");\n            strUpper = strUpper.Replace(\"零亿零万零圆\", \"亿圆\");\n            strUpper = strUpper.Replace(\"亿零万零圆\", \"亿圆\");\n            strUpper = strUpper.Replace(\"零亿零万\", \"亿\");\n            strUpper = strUpper.Replace(\"零万零圆\", \"万圆\");\n            strUpper = strUpper.Replace(\"零亿\", \"亿\");\n            strUpper = strUpper.Replace(\"零万\", \"万\");\n            strUpper = strUpper.Replace(\"零圆\", \"圆\");\n            strUpper = strUpper.Replace(\"零零\", \"零\");\n\n            // 对壹圆以下的金额的处理\n            if (strUpper.Substring(0, 1) == \"圆\")\n            {\n                strUpper = strUpper.Substring(1, strUpper.Length - 1);\n            }\n            if (strUpper.Substring(0, 1) == \"零\")\n            {\n                strUpper = strUpper.Substring(1, strUpper.Length - 1);\n            }\n            if (strUpper.Substring(0, 1) == \"角\")\n            {\n                strUpper = strUpper.Substring(1, strUpper.Length - 1);\n            }\n            if (strUpper.Substring(0, 1) == \"分\")\n            {\n                strUpper = strUpper.Substring(1, strUpper.Length - 1);\n            }\n            if (strUpper.Substring(0, 1) == \"整\")\n            {\n                strUpper = \"零圆整\";\n            }\n            functionReturnValue = strUpper;\n\n            if (IsNegative == true)\n            {\n                return \"负\" + functionReturnValue;\n            }\n            else\n            {\n                return functionReturnValue;\n            }\n        }\n    }\n</pre>\n<br />测试代码:\n<br /><pre name=\"code\" class=\"c#\">\n        static void Main(string args)\n        {\n            Console.Write(\"请输入要转成大写的数字：\");\n            string str = Console.ReadLine();\n            Console.WriteLine(\"大写：\" + new MoneyConvertChinese().MoneyToChinese(str));\n            Console.ReadLine();\n        }\n</pre>\n<br />测试结果:\n<br />\n<br /><img src=\"/upload/attachment/122614/22be2cfb-e893-3ae6-8752-0db6c5a7b5e6.jpg\" />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/122614/22be2cfb-e893-3ae6-8752-0db6c5a7b5e6.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/122614/22be2cfb-e893-3ae6-8752-0db6c5a7b5e6-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 19.8 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,685,'0101','ASP.NET',NULL,0),(788,'2009-10-21 15:52:28','全角字符与半角字符的相互转换(C#)','\n     看到视频里有做这个例子,对着视频把代码打了一遍,测试成功,先记下来,以备后用!!!\n<br /><pre name=\"code\" class=\"c#\">\n/// &lt;summary&gt;全角半角的相互转换\n/// \n/// &lt;/summary&gt;\npublic class ConvertDBCAndSBC\n{\n \n    /// &lt;summary&gt;半角转成全角\n    /// 半角空格32,全角空格12288\n    /// 其他字符半角33~126,其他字符全角65281~65374,相差65248\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"input\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public string DBCToSBC(string input)\n    {\n        char cc = input.ToCharArray();\n        for(int i=0;i&lt;cc.Length;i++)\n        {\n            if(cci == 32)\n            {\n                // 表示空格\n                cci=(char)12288;\n                continue;\n            }\n            if(cci &lt; 127 &amp;&amp; cci &gt; 32)\n            {\n                cci=(char)(cci+65248);                \n            }\n        }\n        return new string(cc);\n    }\n\n    /// &lt;summary&gt;全角转半角\n    /// 半角空格32,全角空格12288\n    /// 其他字符半角33~126,其他字符全角65281~65374,相差65248\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"input\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public string SBCToDBC(string input)\n    {\n        char cc = input.ToCharArray();\n        for (int i = 0; i &lt; cc.Length; i++)\n        {\n            if(cci == 12288)\n            {\n                // 表示空格\n                cci = (char)32;\n                continue;\n            }\n            if (cci &gt; 65280 &amp;&amp; cci &lt; 65375)\n            {\n                cci = (char)(cci - 65248);                \n            }\n\n        }\n        return new string(cc);\n    }\n}\n</pre>\n<br />测试代码：\n<br /><pre name=\"code\" class=\"c#\">\n        static void Main(string args)\n        {\n            Console.Write(\"请输入要转为半角的字符：\");\n            string str = Console.ReadLine();\n            Console.WriteLine(\"半角：\" + new ConvertDBCAndSBC().SBCToDBC(str));\n            Console.ReadLine();\n\n            Console.Write(\"请输入要转为全角的字符：\");\n            string str2 = Console.ReadLine();\n            Console.WriteLine(\"全角：\" + new ConvertDBCAndSBC().DBCToSBC(str2));\n            Console.ReadLine();\n        }\n</pre>\n<br />测试效果：\n<br /><img src=\"/upload/attachment/122612/575937ba-201b-39f4-917d-2b6b021b1741.jpg\" />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/122612/575937ba-201b-39f4-917d-2b6b021b1741.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/122612/575937ba-201b-39f4-917d-2b6b021b1741-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 23.1 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,645,'0101','ASP.NET',NULL,0),(789,'2009-10-21 15:52:28','通过密钥对字符串进行加解密（C#）','\n    　　视频上看到的例子，对着视频打了一遍代码，测试失败，上网搜索后改了一下测试成功，不知道为什么跟视频上打的一样的代码视频上测试的正确而我的测试出错的，先不管了，先记下来，以备后用！\n<br /><pre name=\"code\" class=\"c#\">\n  /// &lt;summary&gt;字符串加解密\n    /// \n    /// &lt;/summary&gt;\n    public class Encrypt\n    {\n        private SymmetricAl;rithm mCSP;\n        private const string CIV = \"oo*/^fsA\";  //密钥, 只能是8位\n        private const string CKEY = \"f123$dew\"; //初始化向量， 只能是8位\n\n        public Encrypt()\n        {\n            mCSP = new DESCryptoServiceProvider();\n        }\n\n        /// &lt;summary&gt;加密字符串\n        /// \n        /// &lt;/summary&gt;\n        /// &lt;param name=\"Value\"&gt;&lt;/param&gt;\n        /// &lt;returns&gt;&lt;/returns&gt;\n        public string EncryptString(string Value)\n        {\n            ICryptoTransform ct;\n            MemoryStream ms;\n            CryptoStream cs;\n            byte byt;\n            // 这里视频上用的是Convert.FromBase64String(CKEY/CIV),但是我用的话总是出现错误，什么大小不对\n            ct = mCSP.CreateEncryptor(Encoding.ASCII.GetBytes(CKEY), Encoding.ASCII.GetBytes(CIV));\n            byt = Encoding.UTF8.GetBytes(Value);\n            ms = new MemoryStream();\n            cs = new CryptoStream(ms, ct, CryptoStreamMode.Write);\n            cs.Write(byt, 0, byt.Length);\n            cs.FlushFinalBlock();\n            cs.Close();\n            return Convert.ToBase64String(ms.ToArray());\n        }\n\n        /// &lt;summary&gt;解密字符串\n        /// \n        /// &lt;/summary&gt;\n        /// &lt;param name=\"Value\"&gt;&lt;/param&gt;\n        /// &lt;returns&gt;&lt;/returns&gt;\n        public string DecryptString(string Value)\n        {\n            ICryptoTransform ct;\n            MemoryStream ms;\n            CryptoStream cs;\n            byte byt;\n            ct = mCSP.CreateDecryptor(Encoding.ASCII.GetBytes(CKEY), Encoding.ASCII.GetBytes(CIV));\n            byt = Convert.FromBase64String(Value);\n\n            ms = new MemoryStream();\n            cs = new CryptoStream(ms, ct, CryptoStreamMode.Write);\n            cs.Write(byt, 0, byt.Length);\n            cs.FlushFinalBlock();\n            cs.Close();\n\n            return Encoding.UTF8.GetString(ms.ToArray());\n        }\n    }\n</pre>\n<br />测试代码：\n<br /><pre name=\"code\" class=\"c#\">\n        static void Main(string args)\n        {\n            Console.Write(\"请输入要加密的字符串：\");\n            string str = Console.ReadLine();\n            Console.WriteLine(\"加密后：\" + new Encrypt().EncryptString(str));\n            Console.ReadLine();\n\n            Console.Write(\"请输入要解密的字符串：\");\n            string str2 = Console.ReadLine();\n            Console.WriteLine(\"解密后：\" + new Encrypt().DecryptString(str2));\n            Console.ReadLine();\n        }\n</pre>\n<br /> 测试效果：\n<br /><img src=\"/upload/attachment/122607/16725e74-fdff-3e43-89a8-6a57eb9e9499.jpg\" />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/122607/16725e74-fdff-3e43-89a8-6a57eb9e9499.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/122607/16725e74-fdff-3e43-89a8-6a57eb9e9499-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 27.7 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,698,'0101','ASP.NET',NULL,0),(790,'2009-10-21 15:52:28','小病毒，大麻烦！（www.13523.com）','\n    今天下某视频，解压出来后提示要安装附带下载下来的一个名叫“360播放器.exe”的文件，直觉告诉我说这玩意是病毒，但是视频又很吸引人，又仗着自己用的系统是WIN7 RC 64位版本，安装以来一直都没装杀软，也感觉不出中毒，于是双击那个EXE文件，果不出所料，双击后EXE变成为bb.bat文件，刚刚想打开他看看里面写什么，马上那个bb.bat文件就消失了，然后我再双击那个视频文件，果然还是播放不出来。。。\n<br />看来刚刚那个EXE肯定是病毒了，不知道对我这个WIN7 RC 64位的系统有啥子影响，按下WIN + R，输入msconfig，打开后切换到启动选项，发现没有什么新增的启动项，再按下WIN + D，切换到桌面上，发现桌面上多出了一个IE浏览器的快捷方式，右键属性查看，发现加了个参数“http://www.13523.com”, 于是把该快捷方式删除掉，奇怪的是过了一会后桌面上又自动出现了个IE快捷方式，属性里还是多了那个参数，奇怪了，不懂是怎么回事！！！\n<br />打开浏览器，输入g.cn，正常跳转到;ogle页面，但是输入baidu.com，却跳转到了http://www.13523.com的页面，看来应该是被劫持了吧，上网下最新版的360修改IE，重启系统后不行，下载顽固木马专杀大全，结果运行不了，估计是只能在32位系统下运行吧。呵呵。\n<br />用FF上;OGLE查询13523.com关键字，发现这只是一个更改IE首页的“小玩意”，网上都说用360清都能清理了，可我的机子就清理不了，然后发现有篇贴子说是该玩意会向注册表里写入某些东西，于是打开注册表，搜索“13523.com”关键字，终于找到，在HKEY_CLASSES_ROOT&#92;lanren下，右边的好多值都是http://www.13523.com，一不做二不休，我把整个lanren项全删除了以后，再删除桌面上的IE快捷方式，重启系统后发现已经不会再自动生成那IE快捷方式了。\n<br />本以为事情就此结束，但是当我打开IE的时候，却弹出一个对话框“找不到lanren项”之类的，晕，肯定是删除了那个注册表中的项了，又回到注册表中建立那lanren项，运行IE后又弹出说找不到url1,上网找了一下，有人说是lanren项中有11个字符串值，分别是url1~5,tihuan1~5,homepage，于是我分别建立了这11个字符串值，值全都设置为空，这回打开IE应该没问题了吧，结果打开IE后立即就程序无响应了，重启系统后再打开IE还是一样无响应。。完蛋了。。。难道要重装系统？\n<br />想了一下，记得网上说过WIN7下可以在控制面板中卸载IE8了，那我能不能先卸载了IE8再重新装上呢？于是到控制面板中把IE8那项前面的勾勾选上，卸载，然后重启系统，再进控制面板把那勾勾勾上，安装，再重启系统，桌面上并没有IE的图标，进到C：&#92;PRO....&#92;INTER EXPLORER、文件夹下双击那个IE图标，成功弹出IE8的界面，并且已经没有了那个提示了，成功！！！\n<br />但是打开注册表再看，那11个键值都还在，值也都是空的，跟以前的一样，不知道啥回事！！！\n  ',NULL,798,'0101','ASP.NET',NULL,0),(772,'2009-10-21 15:52:27','中关村商城广告切换纯净代码','\n    效果如图：\n<br />\n<br /><img src=\"/upload/attachment/133593/e1c0c9d8-c419-3897-8a7e-52e43444d869.jpg\" />\n<br />\n<br />原以为用firebug把页面主要代码搞下来后或许会产生些错误，结果没想到弄下来后啥错误都没有。。呵呵。。。只要把样式也搞下来就行了。。\n<br />\n<br />效果网址：http://www.5mdn.com/adtest.htm\n<br />\n<br />HTML页面代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        /* 全局CSS定义 */\n        body\n        {\n            font: 12px/20px simsun;\n            color: #333;\n            margin: 0;\n        }\n        div, form, img, ul, ol, li, dl, dt, dd, h1, h2\n        {\n            margin: 0;\n            padding: 0;\n            border: 0;\n        }\n        div, img, input, select, ul, dl, dt, dd\n        {\n            float: left;\n        }\n        h2\n        {\n            display: inline;\n        }\n        ul\n        {\n            list-style-type: none;\n        }\n        a\n        {\n            text-decoration: none;\n            color: #333;\n        }\n        a:hover, div a:hover, .Alc dt a:hover\n        {\n            text-decoration: underline;\n            color: #f60;\n        }\n        /* 颜色属性 */\n        .bai12\n        {\n            color: #fff;\n        }\n        .hui6\n        {\n            color: #666;\n        }\n        .hui9\n        {\n            color: #999;\n        }\n        .hoc\n        {\n            color: #c00;\n        }\n        .lan12, .fa a, fia a\n        {\n            color: #36c;\n        }\n        .fal\n        {\n            font-family: arial;\n        }\n        .hoc12, .ho14b, .ho12b\n        {\n            color: #c00;\n        }\n        .lan12, .lan12i, .fa a, .lan14b, .lan14, .fia a, .A_back, .lan14bi\n        {\n            color: #36c;\n        }\n        .fi, .lan12i, .fia a, .A_back, .lan14bi\n        {\n            text-decoration: underline;\n        }\n        .b\n        {\n            font-weight: bold;\n        }\n        /* 滚动广告样式 */\n        .Am_1\n        {\n            width: 540px;\n            position: relative;\n        }\n        .Am_1 img\n        {\n            padding: 1px;\n            border: 1px solid #D0E1F0;\n        }\n        .Am_1 ul\n        {\n            position: absolute;\n            width: 135px;\n            top: 0;\n            right: 0;\n            border-top: 1px solid #BED5EC;\n            line-height: 16px;\n        }\n        .Am_1 li\n        {\n            width: 115px;\n            padding: 11px 10px;\n            height: 33px;\n            float: left;\n            background: url(http://icon.zol-img.com.cn/zol_mall/index/0905/a1.gif);\n        }\n        .Am_1 li.act\n        {\n            padding-left: 18px;\n            height: 34px;\n            background-position: 0 -60px;\n            margin: -1px 0 -1px -8px;\n            position: relative;\n            color: #c00;\n        }\n        .Am_1 li.act a\n        {\n            color: #c00;\n        }\n        .Am_1 li.act a:hover\n        {\n            color: #f60;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"Am_1\"&gt;\n        &lt;div style=\"width: 406px; height: 220px;\" id=\"fc\"&gt;\n            &lt;div style=\"display: none;\"&gt;\n                &lt;a title=\"佳能500D 1510万像素 超值套装低价抢购\" target=\"_blank\" href=\"http://www.zol.com/detail/1/;ods_6b6de6c8b15a34fbf9bf7bf0861f9c1f.html\"&gt;\n                    &lt;img border=\"0\" src=\"http://admin.zol.com/article/picture/module/6_module_images/389.jpg\"\n                        onmouseout=\"setAuto()\" onmouseover=\"clearAuto();\" /&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;div style=\"display: block;\"&gt;\n                &lt;a title=\"技嘉M1022中关村商城首发\" target=\"_blank\" href=\"http://www.zol.com/detail/6/;ods_711e9a9bacc7e0fa529d6901052af061.html\"&gt;\n                    &lt;img border=\"0\" src=\"http://admin.zol.com/article/picture/module/6_module_images/386.gif\"\n                        onmouseout=\"setAuto()\" onmouseover=\"clearAuto();\" /&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;div style=\"display: none;\"&gt;\n                &lt;a title=\"GARMIN 610 中关村商城 超低价促销\" target=\"_blank\" href=\"http://www.zol.com/detail/1/;ods_6a7fc17474ae6786eb1525c8b0f90169.html\"&gt;\n                    &lt;img border=\"0\" src=\"http://admin.zol.com/article/picture/module/6_module_images/388.gif\"\n                        onmouseout=\"setAuto()\" onmouseover=\"clearAuto();\" /&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;div style=\"display: none;\"&gt;\n                &lt;a title=\"卡巴斯基 全功能安全软件2010（三年版）\" target=\"_blank\" href=\"http://www.zol.com/detail/6/;ods_f64fb5bd61088b47e5fa2e23d5a0bdf7.html\"&gt;\n                    &lt;img border=\"0\" src=\"http://admin.zol.com/article/picture/module/6_module_images/378.jpg\"\n                        onmouseout=\"setAuto()\" onmouseover=\"clearAuto();\" /&gt;&lt;/a&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;ul id=\"show_text\"&gt;\n            &lt;li class=\"\"&gt;&lt;span onmouseout=\"setAuto()\" onmouseover=\"clearAuto();Mea(0);\"&gt;&lt;a title=\"佳能500D 1510万像素 超值套装低价抢购\"\n                target=\"_blank\" href=\"http://www.zol.com/detail/1/;ods_6b6de6c8b15a34fbf9bf7bf0861f9c1f.html\"&gt;\n                佳能500D 1510万像素 超值套装低价抢购&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=\"act\"&gt;&lt;span onmouseout=\"setAuto()\"\n                    onmouseover=\"clearAuto();Mea(1);\"&gt;&lt;a title=\"技嘉M1022中关村商城首发\" target=\"_blank\" href=\"http://www.zol.com/detail/6/;ods_711e9a9bacc7e0fa529d6901052af061.html\"&gt;\n                        技嘉M1022中关村商城首发&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=\"\"&gt;&lt;span onmouseout=\"setAuto()\" onmouseover=\"clearAuto();Mea(2);\"&gt;\n                            &lt;a title=\"GARMIN 610 中关村商城 超低价促销\" target=\"_blank\" href=\"http://www.zol.com/detail/1/;ods_6a7fc17474ae6786eb1525c8b0f90169.html\"&gt;\n                                GARMIN 610 中关村商城 超低价促销&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li class=\"\" style=\"margin-top: 0px;\"&gt;&lt;span\n                                    onmouseout=\"setAuto()\" onmouseover=\"clearAuto();Mea(3);\"&gt;&lt;a title=\"卡巴斯基 全功能安全软件2010（三年版）\"\n                                        target=\"_blank\" href=\"http://www.zol.com/detail/6/;ods_f64fb5bd61088b47e5fa2e23d5a0bdf7.html\"&gt;\n                                        卡巴斯基 全功能安全软件2010（三年版）&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;\n    &lt;/div&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        var n = 0;\n        var obj = document.getElementById(\"show_text\");\n        var fc = document.getElementById(\"fc\");\n        function Mea(v) {\n            n = v;\n            setBg(v);\n            plays(v);\n        }\n        function setBg(v) {\n            for (var i = 0; i &lt; 4; i++) {\n                if (v == i) {\n                    obj.getElementsByTagName(\"li\")i.className = \"act\";\n                    if (v == 3) {\n                        obj.getElementsByTagName(\"li\")3.style.marginTop = \"-2px\";\n                    } else {\n                        var p = obj.getElementsByTagName(\"li\")3.style.marginTop;\n                        if (p == \"-2px\") {\n                            obj.getElementsByTagName(\"li\")3.style.marginTop = \"0px\";\n                        }\n                    }\n                } else {\n                    obj.getElementsByTagName(\"li\")i.className = \"\";\n                }\n            }\n        }\n        function plays(v) {\n            try {\n                with (fc) {\n                    filters0.Apply();\n                    for (var i = 0; i &lt; 4; i++) {\n                        (i == v) ? childreni.style.display = \"block\" : childreni.style.display = \"none\";\n                    }\n                    filters0.play();\n                }\n            } catch (e) {\n                var d = document.getElementById(\"fc\").getElementsByTagName(\"div\");\n                for (var j = 0; j &lt; 4; j++) {\n                    (j == v) ? dj.style.display = \"block\" : dj.style.display = \"none\";\n                }\n            }\n        }\n        function clearAuto() {\n            clearInterval(autoStart);\n        }\n        function setAuto() {\n            autoStart = setInterval(\"auto()\", 2000);\n        }\n        function auto() {\n            n++;\n            if (n &gt;= 4) n = 0;\n            Mea(n);\n        }\n        setAuto(); \n	&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</pre>\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/133593/e1c0c9d8-c419-3897-8a7e-52e43444d869.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/133593/e1c0c9d8-c419-3897-8a7e-52e43444d869-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 55.4 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,752,'0105','javascript',NULL,0),(773,'2009-10-21 15:52:27','jquery访中关村商城排行榜特效','\n    &nbsp;&nbsp; 目前公司的网站上要用到的效果，其实也算不上什么特效，无非也就是鼠标移上某些元素后某些元素消失某些元素显示而已，中关村商城的效果页面如下：\n<br />\n<br /><img src=\"/upload/attachment/133558/330a20df-597b-320c-8ed6-ec51625bb924.jpg\" />\n<br />\n<br />我自己用jquery做的页面示例在以下网址中：\n<br />http://www.5mdn.com/niunantest.htm\n<br />\n<br />页面代码：\n<br /><pre name=\"code\" class=\"html\">\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;JS特效测试&lt;/title&gt;\n\n    &lt;script src=\"js/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n        $(function() {\n            // 第一次加载页面后，隐藏“第一名的小区域”，隐藏“除第一名以外其他名的大区域”\n            $(\".ph\").each(function() {\n                var thisObj = $(this);\n                thisObj.find(\".ph0\").eq(0).hide();\n                thisObj.find(\".ph1:gt(0)\").hide();\n            });\n\n            // 鼠标移到小区域上\n            // 该范围内的所有小区域显示，然后显示当前小区域\n            // 该范围内所有的大区域隐藏，然后显示与该小区域对应的大区域\n            $(\".ph0\").mouseover(function() {\n                var thisObj = $(this);\n                thisObj.parent(\".ph\").find(\".ph0\").show();\n                thisObj.hide();\n                thisObj.parent(\".ph\").find(\".ph1\").hide();\n                thisObj.next(\".ph1\").show();\n            });\n        });\n    &lt;/script&gt;\n\n    &lt;style type=\"text/css\"&gt;\n        .ph\n        {\n            border: 1px solid #f00;\n            width: 180px;\n            float: left;\n            margin-right: 50px;\n        }\n        .ph0\n        {\n            margin-left: 5px;\n            margin-right: 5px;\n            height: 30px;\n            line-height: 30px;\n            border-bottom: 1px dashed #00f;\n        }\n        .ph1\n        {\n            height: 60px;\n            border-bottom: 1px dashed #00f;\n            margin-left: 5px;\n            margin-right: 5px;\n            padding: 5px;\n            background-color: #ffccff;\n        }\n        .block\n        {\n            width: 20px;\n            height: 20px;\n            line-height: 20px;\n            background-color: #ff0000;\n            color: #ffffff;\n            font-weight: bold;\n            float: left;\n            margin: 5px;\n            text-align: center;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"ph\"&gt;\n        &lt;div class=\"ph0\"&gt;\n            1. 排行榜第一名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                1\n            &lt;/div&gt;\n            排行榜第一名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            2. 排行榜第二名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                2\n            &lt;/div&gt;\n            排行榜第二名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            3. 排行榜第三名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                3\n            &lt;/div&gt;\n            排行榜第三名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            4. 排行榜第四名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                4\n            &lt;/div&gt;\n            排行榜第四名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            5. 排行榜第五名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                5\n            &lt;/div&gt;\n            排行榜第五名.....\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ph\"&gt;\n        &lt;div class=\"ph0\"&gt;\n            1. 论坛热贴第一名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                1\n            &lt;/div&gt;\n            论坛热贴第一名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            2. 论坛热贴第二名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                2\n            &lt;/div&gt;\n            论坛热贴第二名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            3. 论坛热贴第三名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                3\n            &lt;/div&gt;\n            论坛热贴第三名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            4. 论坛热贴第四名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                4\n            &lt;/div&gt;\n            论坛热贴第四名.....\n        &lt;/div&gt;\n        &lt;div class=\"ph0\"&gt;\n            5. 论坛热贴第五名\n        &lt;/div&gt;\n        &lt;div class=\"ph1\"&gt;\n            &lt;div class=\"block\"&gt;\n                5\n            &lt;/div&gt;\n            论坛热贴第五名.....\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n</pre>\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/133558/330a20df-597b-320c-8ed6-ec51625bb924.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/133558/330a20df-597b-320c-8ed6-ec51625bb924-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 30.5 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,704,'0110','jQuery',NULL,0),(774,'2009-10-21 15:52:27','通过文件名检测文件是否存在于某文件夹中','\n    &nbsp;&nbsp;&nbsp; 从太平洋采集了7万多条商品数据,但是采集到的商品小图才7千多张,但是商品的图片路径又都写到数据库中了,所以在显示数据的时候从数据库中取出图片路径出来的时候要判断该图片是否存在于采集下来的图片文件夹中.\n<br />&nbsp;&nbsp;&nbsp; 要通过文件名判断文件是否存在于文件夹中,最容易想到的方法就是通过Directory.GetFiles(Server.MapPath(\"~/niunantest/images\"))取出图片文件夹下的所有文件的全路径的名称,如:\n<br />\"D:&#92;&#92;太平洋商品数据查看&#92;&#92;pcdata&#92;&#92;images&#92;&#92;005814.jpg\"\n<br />然后就可以通过foreach循环一个一个判断了,在循环中可通过字符串的Contains方法判断全路径中是否包含该文件名.\n<br />&nbsp;&nbsp;&nbsp; 在用智能提示的时候发现string字符串数组也有Contains方法,判断某个字符是否在某字符数组中,但是我要比较的是<span style=\"color: red\">某个字符是否包含中数组中的某个元素中</span>, 根据代码智能示,Contains的第二个重载方法接收两个参数,第二个参数是实现了<span style=\"color: blue\">IEqualityComparer</span>接口的一个类,到MSDN查了一下资料,得如下代码:\n<br /><pre name=\"code\" class=\"C#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.IO;\n\npublic partial class test : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        string files = Directory.GetFiles(Server.MapPath(\"~/images\"));\n        string str = \"061077.jpg\";\n        bool b = files.Contains(str, new Compare());\n        Response.Write(\"要比较的值:\" + str + \"&lt;br &gt;比较结果:\" + b);\n    }\n}\n\npublic class Compare : IEqualityComparer&lt;string&gt;\n{\n    #region IEqualityComparer&lt;string&gt; 成员\n\n    /// &lt;summary&gt;\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"x\"&gt;类似于:\"D:&#92;&#92;太平洋商品数据查看&#92;&#92;pcdata&#92;&#92;images&#92;&#92;005814.jpg\"&lt;/param&gt;\n    /// &lt;param name=\"y\"&gt;类似于:\"009018.jpg\"&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public bool Equals(string x, string y)\n    {\n        FileInfo fi = new FileInfo(x);\n        string tmp = fi.Name;\n        if (y == tmp)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    public int GetHashCode(string obj)\n    {\n        return obj.ToString().ToLower().GetHashCode();\n    }\n\n    #endregion\n}\n</pre>\n<br />\n<br />&nbsp;&nbsp;&nbsp; 这样只需要用数组的Contains方法即可得到我想要的结果!\n  ',NULL,651,'0101','ASP.NET',NULL,0),(775,'2009-10-21 15:52:27','ACCESS数据库放于APP_DATA后在.NET中的连接字符串','\n    <pre name=\"code\" class=\"c#\">\nProvider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|charge.mdb\n</pre>\n<br />\n<br />App_Data文件夹在代码中用|DataDirectory|来表示\n  ',NULL,776,'0101','ASP.NET',NULL,0),(776,'2009-10-21 15:52:27','获取最新的IP数据库及如何查询','<img src=\"http://niunan.net/bbspic/ip.jpg\" alt=\"\" border=\"0\" />\n<br />\n.NET中把IP地址转为长整型的方法： <br />\n<pre name=\"code\" class=\"c#\">\n    /// 把IP地址转成长数字，\n    /// 算法：128.125.1.24 → (128*256*256*256) + (125*256*256) + (1*256) +24\n    /// \n    /// \n    /// \n    public static ulong IpToLong(string ip)\n    {\n        try\n        {\n            string cip = ip.Trim().Split(&#039;.&#039;);\n            string aip = new string4;\n            cip.CopyTo(aip, 0);\n            if (cip.Length &lt; 3)\n            {\n                for (int i = 3; i &gt; cip.Length; i--)\n                {\n                    aipi = \"0\";\n                }\n            }\n            uint iip = new uint4;\n            Regex reg = new Regex(@\"\\d+\");\n            for (int x = 0; x &lt; aip.Length; x++)\n            {\n                if (reg.IsMatch(aipx))\n                    iipx = Convert.ToUInt32(aipx);\n                else\n                    iipx = 0;\n            }\n            ulong uip = Convert.ToUInt64(256 * 256 * 256 * iip0 + 256 * 256 * iip1 + 256 * iip2 + iip3);\n            return uip;\n        }\n        catch (Exception ess)\n        {\n            throw ess;\n        }\n    }\n</pre>\n我用自己的机器试，一开始就一下更新所有，结果搞到网页超时，后来就通过SQL语句的TOP先把一部分取出来更新好后再更新另一部分，SQL语句如下： <br />\n<pre name=\"code\" class=\"sql\">\nselect top 100 * from ipdata where  CHARINDEX(&#039;.&#039;,starip,0)&gt;0\n</pre>\nCHARINDEX函数是MSSQL的内置函数，类似于IndexOf。 \n<br />\n更新好后询查就可以把要查询的IP转成长整形，然后通过SQL中的BETWEEN..AND..来查询了。 <br />\n<pre name=\"code\" class=\"sql\">\nselect * from ipdata where @ip between starip and endip\n</pre>\n如果不把IP转成长整型的话则查询出来的会有问题的！！！ ',NULL,723,'0103','随笔',NULL,0),(777,'2009-10-21 15:52:27','Profile购物车代码片段','\n    web.config配置profile:\n<br /><pre name=\"code\" class=\"xml\">\n......\n&lt;connectionStrings&gt;\n	&lt;add name=\"profileConnStr\" connectionString=\"server=.&#92;sqlexpress;database=test;uid=sa;pwd=123456\"/&gt;\n&lt;/connectionStrings&gt;\n&lt;system.web&gt;\n	&lt;!-- 匿名用户也可访问profile --&gt;\n	&lt;anonymousIdentification enabled=\"true\"/&gt;\n	&lt;profile enabled=\"true\" automaticSaveEnabled=\"true\" defaultProvider=\"SqlProvide\"&gt;\n	  &lt;providers&gt;\n		&lt;add name=\"SqlProvide\" connectionStringName=\"profileConnStr\" type=\"System.Web.Profile.SqlProfileProvider\"/&gt;\n	  &lt;/providers&gt;\n	  &lt;properties&gt;\n		&lt;add name=\"ShoppingCart\" type=\"Cart\" allowAnonymous=\"true\" serializeAs=\"Binary\"/&gt;\n	  &lt;/properties&gt;\n	&lt;/profile&gt;\n	......\n	 &lt;!--\n			通过 &lt;authentication&gt; 节可以配置 ASP.NET 用来 \n			识别进入用户的\n			安全身份验证模式。 \n		--&gt;\n	&lt;authentication mode=\"Forms\" /&gt;\n&lt;/system.web&gt;\n......\n</pre>\n<br />\n<br />采用硬编码方式进行用户认证：\n<br /><pre name=\"code\" class=\"c#\">\n        string name = txtName.Text.Trim();\n        string pwd = txtPassword.Text.Trim();\n\n        if (name == \"niunan\" &amp;&amp; pwd == \"123456\")\n        {\n            FormsAuthentication.SetAuthCookie(name, false);\n            Response.Redirect(\"~/product.aspx\");\n        }\n</pre>\n<br />\n<br />匿名用户的购物车数据向实名用户的购物车数据迁移\n<br />Global.asax文件中加入如下内容：\n<br /><pre name=\"code\" class=\"c#\">\n    protected void Profile_MigrateAnonymous(object s, ProfileMigrateEventArgs e)\n    {\n        ProfileCommon anonProfile = Profile.GetProfile(e.AnonymousID);\n        foreach (CartItem ci in anonProfile.ShoppingCart.GetItems())\n        {\n            Profile.ShoppingCart.AddItem(ci);\n        }\n\n        ProfileManager.DeleteProfile(e.AnonymousID);  // 删除匿名用户的profile\n        AnonymousIdentificationModule.ClearAnonymousIdentifier();  // 清除匿名用户标识\n        Profile.Save();\n    }\n</pre>\n  ',NULL,854,'0101','ASP.NET',NULL,0),(778,'2009-10-21 15:52:27','重装系统后VS2008安装失败','\n    &nbsp;&nbsp;&nbsp; 安装的WIN7 RC出问题了，而且在WIN7下对camtasia视频录制软件有点不兼容，为了录视频一狠心换回XP了，这回用的是YLMF的YN5.0安装版，花了“39分钟”安装了回了XP，安装好之后就先把日常必备的软件都安装上了，PHOTOSHOP CS4,NERO 8,OFFICE 2007,FTP,CHROME,FIREFOX,电驴，发现个问题，平时我用迅雷下HTTP资源最高能达到120KB/S左右，然后我换用电驴下载相同的HTTP资源，速度达到了150KB/S左右，嘿嘿，喜欢用上电驴了。。。\n<br />\n<br />&nbsp;&nbsp;&nbsp; 然后开始安装VS2008,可是不管怎么安装都会出现如下错误提示\n<br /><img src=\"http://niunan.javaeye.com/upload/picture/pic/41516/b5062d69-e6ad-30dc-86a1-37a324ab40e9.jpg\" />\n<br />看提示应该是.NET FRAMWORK3.5安装失败而导致整个VS安装失败，上网查了一下，发现说是安装3.5之前得先把以前的版本全都卸载掉，而我看到在我安装YLMF的YN5.0安装版的时候系统自动帮我安装了.NET 2.0 SP2，于是到控制面板中卸载了.NET 2.0,再次安装VS，结果还是出那个错误，又上网查，下载了专门的.NET FRAMEWORK清理工具cleanup_tool.exe和UninstallFxVSUpdate.exe，清理后重启电脑，结果还是不行。。。\n<br />&nbsp;&nbsp; \n<br />&nbsp;&nbsp; 只好先把这个软件放一边了，先用鲁大师（Z武器）把系统漏洞补丁补上再说，结果在那软件里下载好补丁后又安装补丁失败，郁闷，后来终于查到了解决方法（在我的博客另一篇贴子里），把补丁都安装成功后，再次重启电脑，再试试安装VS2008,结果，这回成功安装VS2008了，呵呵，估计之前的.NET 3.5总是安装失败是因为我的系统没有安装某个补丁而导致出错的吧！！！\n  ',NULL,891,'0101','ASP.NET',NULL,0),(779,'2009-10-21 15:52:27','重装系统后运行“鲁大师（Z武器）”的漏洞修复功能下载的补丁安装失败 ','\n    重装系统后运行“鲁大师（Z武器）”的漏洞修复功能下载的补丁安装失败,上网搜索了一下，得如下解决方法：\n<br />①打开记事本，输入以下内容，保存为：<span style=\"color: red\">清除微软无效升级注册表项.bat</span>\n<br /><pre name=\"code\" class=\"bat\">\n@echo off\nrem 修改升级中的错误注册表键值\nset Update=HKLM&#92;SOFTWARE&#92;MicroSoft&#92;Update\nset Updates=HKLM&#92;SOFTWARE&#92;MicroSoft&#92;Updates\necho 正在清除 \"%Update%\"\nfor /f \"tokens=1 delims=\" %%a in (\'reg query %Update%^|Findstr /i \"UpdateExeVolatile\"\') do (\nreg delete %%a /f\n)\necho %Update% 清除完毕!\n\necho 正在清除 \"%Updates%\"\nfor /f \"tokens=1 delims=\" %%a in (\'reg query %Updates%^|Findstr /i \"UpdateExeVolatile\"\') do (\nreg delete %%a /f\n)\necho %Updates% 清除完毕!\n\necho 按任意键结束...\npause&gt;nul\n</pre>\n<br />\n<br />②双击运行后再重装运行鲁大师（Z武器）的漏洞修复，即可安装补丁。\n  ',NULL,612,'0103','随笔',NULL,0),(780,'2009-10-21 15:52:27','框架frame自适应内容高度','\n    让框架frame自动适应内容的高度\n<br />在每个框架子页面中加入如下代码\n<br /><pre name=\"code\" class=\"js\">\n&lt;script src=\"../js/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        $(function() {\n            setFrmHeight();\n        });\n        function setFrmHeight() {\n            var frm = $(window.parent.document).find(\"#frm\");\n            var height = $(document).height();\n            frm.height(height);\n        }\n    &lt;/script&gt;\n</pre>\n  ',NULL,755,'0105','javascript',NULL,0),(781,'2009-10-21 15:52:27','查询SQL语句的执行速度','\n    在各个select语句前加：\n<br />declare @d datetime\n<br />set @d=getdate()\n<br />\n<br />并在select语句后加：\n<br />\n<br />select 语句执行花费时间(毫秒)=datediff(ms,@d,getdate())\n<br />\n<br />另一方法：\n<br />在SQL语句前加上\n<br />set statistics time on\n  ',NULL,603,'0106','SQL',NULL,0),(763,'2009-10-21 15:52:26','用IHttpModule做自己的URL重写','<span class=\"Apple-style-span\" style=\"font-family:arial, sans-serif, helvetica, tahoma;\">&nbsp;&nbsp; &nbsp;用网上下载的UrlRewriteModule URL重写组件发现有时在打开页面的时候会出错（错误一时没有记下来·！！），但是再刷新页面的时候又好了，于是想自己写一个URL重写的，以得以前看视频的时候说是要URL重写的话可在Module中写，上网查了一下相关的资料，写了一个简单的Module来进行URL重写，记录如下，以备后用：&nbsp;<br />\nweb.config的配置：&nbsp;<br />\nxml&lt;httpModules&gt;<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- 测试 --&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;add name=\"ModuleTest\" type=\"ModouleTest\"/&gt;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- 测试结束 --&gt;</div>\n<div>&lt;/httpModules&gt;</div>\n/xml<br />\nModouleTest.cs&nbsp;：<br />\nc#/*<div>&nbsp;* 作者: 牛腩</div>\n<div>&nbsp;* 创建时间: 2009-9-2 9:59:30</div>\n<div>&nbsp;* Email: 164423073@qq.com</div>\n<div>&nbsp;* 说明: URL重写Module</div>\n<div>&nbsp;*/</div>\n<div><br />\n</div>\n<div>using System;</div>\n<div>using System.Collections.Generic;</div>\n<div>using System.Linq;</div>\n<div>using System.Web;</div>\n<div>using System.Text.RegularExpressions;</div>\n<div><br />\n</div>\n<div>/// &lt;summary&gt;</div>\n<div>///URL重写Module</div>\n<div>/// &lt;/summary&gt;</div>\n<div>public class ModouleTest : IHttpModule</div>\n<div>{</div>\n<div>&nbsp;&nbsp; &nbsp;public ModouleTest()</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;#region IHttpModule 成员</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;void IHttpModule.Dispose()</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;throw new NotImplementedException();</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;void IHttpModule.Init(HttpApplication context)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;context.BeginRequest += new EventHandler(Application_BeginRequest);</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;#endregion</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp;private void Application_BeginRequest(object sender, EventArgs e)</div>\n<div>&nbsp;&nbsp; &nbsp;{</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpApplication application = (HttpApplication)sender;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpRequest request = application.Request;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpResponse response = application.Response;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpServerUtility server = application.Server;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string url = request.Url.ToString();</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;/*</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * 只要输入的地址中有niunantest/的都会跳转并把/后头的字符传过去，如：</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * http://localhost:3212/ModuleTest/niunantest/43242</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * http://localhost:3212/ModuleTest/niunantest/abd3345</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * http://localhost:3212/ModuleTest/niunantest/牛腩</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;Regex reg = new Regex(@\"niunantest/(\\w+)\"); &nbsp;</div>\n<div><br />\n</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (reg.IsMatch(url))</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Match m = reg.Match(url);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string value = m.Groups1.Value;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//response.Write(\"匹配的值：\" + value + \"&lt;br&gt;\");</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;server.Transfer(\"~/default.aspx?str=\" + value); // 使用response.Redirect会让地址栏中的地址改变 &nbsp; &nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>}</div>\n/c#<br />\n&nbsp;&nbsp; &nbsp;个人理解，其实module就相当于jsp中的过滤器（如果有的话），每个页面在呈现之前必须得先经过module，那么我们就可以在module中判断当前的URL地址，如果符合某个格式的就可以跳转到对应的页面，在这里用到了server.Transfer跳转是为了不让地址栏中的地址改变。<br />\n<br />\n源码下载：<a href=\"http://niunan.net/download/Module_UrlRewrite.rar\" target=\"_blank\">http://niunan.net/download/Module_UrlRewrite.rar</a><br />\n<br />\n<br />\n<br />\n<br />\n<br />\n</span><div class=\"attachments\"><ul>        </ul>\n                	                          </div>\n',NULL,833,'0101','ASP.NET',NULL,0),(764,'2009-10-21 15:52:26','把“~/niunantest.aspx”转成&quot;http://localhost:4532/test/niunantest.aspx&quot;的方法','\n    .NET中有个mappath方法是转成物理路径的，但是我却找不到现成的方法转成虚拟路径，自己写了一个，以做备用！\n<br /><pre name=\"code\" class=\"c#\">\n    /// &lt;summary&gt;把~/niunantest.aspx转化成http://localhost:3212/ModuleTest/niunantest.aspx\n    /// \n    /// &lt;/summary&gt;\n    /// &lt;param name=\"path\"&gt;如：~/niunantest.aspx&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public static string GetVirsualURL(string path)\n    {\n        path = path.Replace(\"~\",\"\");\n        HttpRequest request = HttpContext.Current.Request;\n        string port = request.Url.Port == 80 ? \"\" : \":\" + request.Url.Port.ToString();\n        if (request.ApplicationPath == \"/\")\n        {\n            return @\"http://\" + request.Url.Host + port+path;\n        }\n        else\n        {\n            return @\"http://\" + request.Url.Host + port + request.ApplicationPath+path;\n        }\n    }\n</pre>\n  ',NULL,742,'0101','ASP.NET',NULL,0),(765,'2009-10-21 15:52:26','强力重置ASP.NET　membership加密后的密码！','\n    公司网站的用户管理采用的是ASP.NET内置的membership管理，在web.config文件中的密码格式配置是加密了的，passwordFormat=\"Hashed\"，这样在用户注册的时候存到数据库中的密码都是加密了的，如果你忘记密码了要找回密码的时候必须要记得注册时写的密码问题答案，可是如果密码问题答案也忘记的话。。。因为密码是加了密的，所以也不知道他的密码的生成规律，直接改数据库也不懂怎么改。。。 \n<br />这个问题在以前的时候碰到过，当时特意上网搜索了一下，竟然没有发现，不知道是不是我的关键字输入错误还是怎么的，今天上台湾的论坛逛成人版块的时候发现论坛中的编辑版块有篇文章是教你怎么样在不记得密码，利用了membership其中的一个存储过程，废话少说，亮code:\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Web.Configuration;\nusing System.Data.SqlClient;\nusing System.Web.Security;\nusing System.Data;\n\npublic partial class ResetPassword : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    // 重置\n    protected void btnReset_Click(object sender, EventArgs e)\n    {\n        string connStr = WebConfigurationManager.ConnectionStrings\"conn\".ToString();\n        string username = txtUserName.Text.Trim();\n        if (username.Length==0)\n        {\n            Response.Write(\"请输入用户名！\");\n            return;\n        }\n\n        //=== 产生加密用的密码密钥 ===  \n        string salt = GenerateSalt();\n\n        //=== 将明码密码加密(此时密码为\"P@ssw0rd\" 当然也可随机数生成) ===  \n        string password = EncryptToHashString(\"123456\", salt, \"SHA1\");\n\n        SqlConnection conn = new SqlConnection(connStr);\n        conn.Open();\n\n        //=== 在此我们呼叫 Membership 提供者 数据库里的预存程序来重置密码 ===  \n        SqlCommand cmd = new SqlCommand(\"aspnet_Membership_SetPassword\", conn);\n        cmd.CommandType = CommandType.StoredProcedure;\n\n        //=== 目前使用 Membership 提供者的 web 应用程序名称 ===  \n        cmd.Parameters.Add(new SqlParameter(\"@ApplicationName\", Membership.ApplicationName));\n\n        //=== 要重置密码的用户账号 ===  \n        cmd.Parameters.Add(new SqlParameter(\"@UserName\", username));\n\n        //=== 加密过的密码 ===  \n        cmd.Parameters.Add(new SqlParameter(\"@NewPassword\", password));\n\n        //=== 密码加密密钥(一定和使用加密密码的密钥一样，不要再重新产生) ===  \n        cmd.Parameters.Add(new SqlParameter(\"@PasswordSalt\", salt));\n\n        //=== 重置密码的时间 ===  \n        cmd.Parameters.Add(new SqlParameter(\"@CurrentTimeUtc\", DateTime.Now));\n\n        //=== 密码加密的格式(此时是Hash1，注意传入参数是int型态。) ===  \n        cmd.Parameters.Add(new SqlParameter(\"@PasswordFormat\", Membership.Provider.PasswordFormat.GetHashCode()));\n\n        //=== 宣告一个可以接收回传值得参数 ===  \n        SqlParameter returnValue = new SqlParameter();\n        returnValue.ParameterName = \"returnValue\";\n        returnValue.Direction = ParameterDirection.ReturnValue;\n        cmd.Parameters.Add(returnValue);\n\n        //=== 执行预存程序 ===  \n        cmd.ExecuteNonQuery();\n\n        conn.Close();\n\n        //=== 检查重置密码是否成功 ===  \n        if (returnValue.Value.ToString() == \"0\")\n            Response.Write(\"重置密码成功!!\");\n        else\n            Response.Write(\"重置密码失败!!\");\n\n    }\n\n    /// &lt;summary&gt;  \n    /// 密码加密钥  \n    /// &lt;/summary&gt;  \n    /// &lt;returns&gt;&lt;/returns&gt;  \n    public string GenerateSalt()\n    {\n        byte data = new byte0x10;\n        new System.Security.Cryptography.RNGCryptoServiceProvider().GetBytes(data);\n        return Convert.ToBase64String(data);\n    }\n\n\n    /// &lt;summary&gt;  \n    /// 哈希密码加密(不可还原)  \n    /// &lt;/summary&gt;  \n    /// &lt;param name=\"s\"&gt;原始字符串&lt;/param&gt;  \n    /// &lt;param name=\"saltKey\"&gt;Salt加密字符串&lt;/param&gt;  \n    /// &lt;param name=\"hashName\"&gt;加密格式(MD5, SHA1, SHA256, SHA384, SHA512.)&lt;/param&gt;  \n    /// &lt;returns&gt;加密过的密码&lt;/returns&gt;  \n    public string EncryptToHashString(string s, string saltKey, string hashName)\n    {\n        byte src = System.Text.Encoding.Unicode.GetBytes(s);\n        byte saltbuf = Convert.FromBase64String(saltKey);\n        byte dst = new bytesaltbuf.Length + src.Length;\n        byte inArray = null;\n        System.Buffer.BlockCopy(saltbuf, 0, dst, 0, saltbuf.Length);\n        System.Buffer.BlockCopy(src, 0, dst, saltbuf.Length, src.Length);\n\n        System.Security.Cryptography.HashAl;rithm al;rithm = System.Security.Cryptography.HashAl;rithm.Create(hashName);\n        inArray = al;rithm.ComputeHash(dst);\n\n        return Convert.ToBase64String(inArray);\n    }\n\n}\n</pre>\n<br />\n<br />这样就把密码重置为123456了\n<br />刚刚在做membership的测试的时修实然想到，数据表aspnet_Membership中的Password字段是存储密码的，FormatPassword字段是表示密码的存储格式的，０是明码，１是加密过的，假如我在数据库中把已经加密了的密码的FormatPassword改为０,然后Password改成123456,　测试，哈哈，竟然也能登陆了！！！\n<br />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/e5d170df-958d-3b7e-88e0-53e0851941ed\">membership测试.zip</a> (581.2 KB)</li>\n          <li>描述: 源文件下载</li>\n          <li>下载次数: 6</li>\n        </ul>\n      \n    \n    \n  ',NULL,916,'0101','ASP.NET',NULL,0),(766,'2009-10-21 15:52:26','ASP.NET membership的XML配置','    做了一个MEMBERSHIP的测试，先记下来，以备后用！<br />\nxml &lt;connectionStrings&gt;<br />\n    &lt;add name=\"conn\" connectionString=\"server=.\\sqlexpress;uid=sa;pwd=123456;database=test\"/&gt;<br />\n  &lt;/connectionStrings&gt;<br />\n &lt;system.web&gt;<br />\n &lt;!-- 开启角色管理 --&gt;<br />\n    &lt;roleManager enabled=\"true\" /&gt;<br />\n    &lt;!-- membership配置 --&gt;<br />\n    &lt;membership userIsOnlineTimeWindow=\"20\"&gt;<br />\n      &lt;providers&gt;<br />\n        &lt;remove name=\"AspNetSqlMembershipProvider\" /&gt;<br />\n        &lt;add connectionStringName=\"conn\" enablePasswordRetrieval=\"false\"<br />\n         enablePasswordReset=\"true\" requiresQuestionAndAnswer=\"true\" applicationName=\"/\"<br />\n         requiresUniqueEmail=\"false\" passwordFormat=\"Clear\" maxInvalidPasswordAttempts=\"5\"<br />\n         minRequiredPasswordLength=\"6\" minRequiredNonalphanumericCharacters=\"0\"<br />\n         passwordAttemptWindow=\"10\" passwordStrengthRegularExpression=\"\"<br />\n         name=\"AspNetSqlMembershipProvider\" type=\"System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /&gt;<br />\n      &lt;/providers&gt;<br />\n    &lt;/membership&gt;<br />\n    &lt;!--　启用匿名用户--&gt;<br />\n    &lt;anonymousIdentification<br />\n  enabled=\"true\"<br />\n  cookieName=\".AnonymousUser\"<br />\n  cookieTimeout=\"60\"<br />\n  cookiePath=\"/\"<br />\n  cookieRequireSSL=\"false\"<br />\n  cookieSlidingExpiration=\"true\"<br />\n  cookieProtection=\"Validation\"<br />\n  cookieless=\"UseCookies\"<br />\n     /&gt;<br />\n<br />\n    &lt;!--  第一个Profile设置，可用中文，推荐英文 --&gt;<br />\n    &lt;profile automaticSaveEnabled=\"true\" enabled=\"true\" defaultProvider=\"MembershipTest\"&gt;<br />\n      &lt;providers&gt;<br />\n        &lt;add name=\"MembershipTest\" connectionStringName=\"conn\" type=\"System.Web.Profile.SqlProfileProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /&gt;<br />\n      &lt;/providers&gt;<br />\n      &lt;properties&gt;<br />\n        &lt;add name=\"性别\" type=\"System.String\" allowAnonymous=\"true\" /&gt;<br />\n        &lt;add name=\"生日\" type=\"System.DateTime\" allowAnonymous=\"true\" /&gt;<br />\n        &lt;add name=\"星座\" type=\"System.String\" allowAnonymous=\"true\" /&gt;<br />\n        &lt;group name=\"地址\"&gt;<br />\n          &lt;add name=\"国家\" defaultValue=\"中国\" type=\"System.String\" allowAnonymous=\"true\" /&gt;<br />\n          &lt;add name=\"城市\" type=\"System.String\" allowAnonymous=\"true\" /&gt;<br />\n          &lt;add name=\"邮编\" type=\"System.Int32\" allowAnonymous=\"true\" /&gt;<br />\n        &lt;/group&gt;<br />\n      &lt;/properties&gt;<br />\n    &lt;/profile&gt;<br />\n    &lt;!--<br />\n            通过 &lt;authentication&gt; 节可以配置 ASP.NET 用来 <br />\n            识别进入用户的<br />\n            安全身份验证模式。 <br />\n        --&gt;<br />\n    &lt;authentication mode=\"Forms\"&gt;<br />\n      &lt;forms name=\"myAuthentication\" loginUrl=\"Login.aspx\" timeout=\"60\" /&gt;<br />\n    &lt;/authentication&gt;<br />\n    &lt;!--<br />\n            如果在执行请求的过程中出现未处理的错误，<br />\n            则通过 &lt;customErrors&gt; 节可以配置相应的处理步骤。具体说来，<br />\n            开发人员通过该节可以配置<br />\n            要显示的 html 错误页<br />\n            以代替错误堆栈跟踪。<br />\n<br />\n        &lt;customErrors mode=\"RemoteOnly\" defaultRedirect=\"GenericErrorPage.htm\"&gt;<br />\n            &lt;error statusCode=\"403\" redirect=\"NoAccess.htm\" /&gt;<br />\n            &lt;error statusCode=\"404\" redirect=\"FileNotFound.htm\" /&gt;<br />\n        &lt;/customErrors&gt;<br />\n        --&gt;<br />\n  &lt;/system.web&gt;<br />\n/xml<br />\n源码下载：<a href=\"http://niunan.net/download/membershiptest.zip\" target=\"_blank\">http://niunan.net/download/membershiptest.zip</a><br />\n<br />\n',NULL,722,'0101','ASP.NET',NULL,0),(767,'2009-10-21 15:52:26','两个整形变量，不用中间变量进行替换！','\n    刚刚在看评论的时候发现的，好像觉得有点用吧，先记下来了~ \n<br />\n<br />两个整型变量，不用中间变量进行替换。\n<br />\n<br />嚴格的講，這個題目是無解的。\n<br />有很多人會有這樣的答案：\n<br />int a = ?;\n<br />int b = ?;\n<br />\n<br />a=a+b;\n<br />b=a-b;\n<br />a=a-b;\n<br />\n<br />貌似這樣的代碼沒有什么問題，結果也正確，但如果a+b&gt;Int.MaxValue呢？這一行就會溢出。\n<br />\n<br />\n<br />嚴格的講，如果不使用第三個變量，是沒辦法完成這個題目的。如果你使用if，則違反了命題，if實際上也使用了第三個變量。\n<br />\n<br />还有些针对上面的评论：\n<br />第一种方法：\n<br />a^=b;\n<br />b^=a;\n<br />a^=b;\n<br />\n<br />第二种方法：\n<br />b=a+(a=b)*0;\n<br />\n<br />第一种方法我还不知道是什么意思，位运算的不太懂\n<br />第二种方法倒是蛮有趣的。呵呵。。又学到一点东西。。。\n  ',NULL,781,'0103','随笔',NULL,0),(768,'2009-10-21 15:52:26','ASP.NET根据日期获取星座方法！','\n    <pre name=\"code\" class=\"c#\">\n /// &lt;summary&gt;返回星座\n    /// \n    /// &lt;/summary&gt;\n    /// &lt;param name=\"date\"&gt;日期&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public static string GetXinZuo(string date)\n    {\n        DateTime d;\n        if (DateTime.TryParse(date, out d))\n        {\n            d = DateTime.Parse(d.Month + \"-\" + d.Day);\n            if (d &gt;= DateTime.Parse(\"03-21\") &amp;&amp; d &lt;= DateTime.Parse(\"04-19\"))\n            {\n                return \"白羊座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"04-20\") &amp;&amp; d &lt;= DateTime.Parse(\"05-20\"))\n            {\n                return \"金牛座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"05-21\") &amp;&amp; d &lt;= DateTime.Parse(\"06-21\"))\n            {\n                return \"双子座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"06-22\") &amp;&amp; d &lt;= DateTime.Parse(\"07-22\"))\n            {\n                return \"巨蟹座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"07-23\") &amp;&amp; d &lt;= DateTime.Parse(\"08-22\"))\n            {\n                return \"狮子座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"08-23\") &amp;&amp; d &lt;= DateTime.Parse(\"09-22\"))\n            {\n                return \"处女座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"09-23\") &amp;&amp; d &lt;= DateTime.Parse(\"10-23\"))\n            {\n                return \"天秤座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"10-24\") &amp;&amp; d &lt;= DateTime.Parse(\"11-22\"))\n            {\n                return \"天蝎座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"11-23\") &amp;&amp; d &lt;= DateTime.Parse(\"12-21\"))\n            {\n                return \"射手座\";\n            }\n            else if ((d &gt;= DateTime.Parse(\"12-22\") &amp;&amp; d &lt;= DateTime.Parse(\"12-31\")) ||\n                (d &gt;= DateTime.Parse(\"01-01\") &amp;&amp; d &lt;= DateTime.Parse(\"01-19\")))\n            {\n                return \"摩羯座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"01-20\") &amp;&amp; d &lt;= DateTime.Parse(\"02-18\"))\n            {\n                return \"水瓶座\";\n            }\n            else if (d &gt;= DateTime.Parse(\"02-19\") &amp;&amp; d &lt;= DateTime.Parse(\"03-20\"))\n            {\n                return \"双鱼座\";\n            }\n            else\n            {\n                return \"未知日期\";\n            }\n        }\n        else\n        {\n            return \"日期格式错误\";\n        }\n    }\n</pre>\n  ',NULL,623,'0101','ASP.NET',NULL,0),(769,'2009-10-21 15:52:26','ASP.NET生成HTML静态页的一个类','\n    &nbsp;&nbsp;&nbsp; 某网友刚刚传给我的，稍微看了一下，好像不错吧，先记下来，备用！\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Net;\nusing System.IO;\nusing System.Text;\nusing System.Web.UI.HtmlControls;\nusing System.Text.RegularExpressions;\n\n/// &lt;summary&gt;\n///CreateHtml 的摘要说明\n/// &lt;/summary&gt;\npublic class CreateHtml:System.Web.UI.Page\n{\n	public CreateHtml()\n	{\n		//\n		//TODO: 在此处添加构造函数逻辑\n		//\n	}\n    /// &lt;summary&gt;\n    /// 生成静态页面,生成位置是本项目下\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"strURL\"&gt;请求的URL&lt;/param&gt;\n    /// &lt;param name=\"strRelPath\"&gt;创建的路径及文件名,路径为相对路径&lt;/param&gt;\n    public bool Nei_Create(string strURL, string strRelPath)\n    {\n        string  strFilePage;\n      \n        strFilePage = HttpContext.Current.Server.MapPath(strRelPath);\n        StreamWriter sw = null;\n        //获得aspx的静态html\n        try\n        {\n            \n            if (File.Exists(strFilePage))\n            {\n                File.Delete(strFilePage);\n            }\n            sw = new StreamWriter(strFilePage, false, System.Text.Encoding.GetEncoding(\"gb2312\"));\n            System.Net.WebRequest wReq = System.Net.WebRequest.Create(strURL);\n            System.Net.WebResponse wResp = wReq.GetResponse();\n            System.IO.Stream respStream = wResp.GetResponseStream();\n            System.IO.StreamReader reader = new System.IO.StreamReader(respStream, System.Text.Encoding.GetEncoding(\"gb2312\"));\n            string strTemp = reader.ReadToEnd();\n\n            Regex r1 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTTARGET&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            Regex r2 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTARGUMENT&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            Regex r3 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__VIEWSTATE&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n\n            Regex r4 = new Regex(\"&lt;form .*id=&#92;\"form1&#92;\"&gt;\", RegexOptions.IgnoreCase);\n            Regex r5 = new Regex(\"&lt;/form&gt;\");\n\n            Regex r6 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTVALIDATION&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            strTemp = r1.Replace(strTemp, \"\");\n            strTemp = r2.Replace(strTemp, \"\");\n            strTemp = r3.Replace(strTemp, \"\");\n            strTemp = r4.Replace(strTemp, \"\");\n            strTemp = r5.Replace(strTemp, \"\");\n            strTemp = r6.Replace(strTemp, \"\");\n\n            sw.Write(strTemp);\n        }\n        catch (Exception ex)\n        {\n            HttpContext.Current.Response.Write(ex.Message);\n            HttpContext.Current.Response.End();\n            return false;//生成到出错\n        }\n        finally\n        {\n            sw.Flush();\n            sw.Close();\n            sw = null;\n        }\n\n        return true;\n    }\n    /// &lt;summary&gt;\n    /// 生成静态页面,生成位置不在本项目下\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"strURL\"&gt;请求的URL&lt;/param&gt;\n    /// &lt;param name=\"strRelPath\"&gt;创建的路径及文件名，路径为绝对路径&lt;/param&gt;\n    public bool Wai_Create(string strURL, string strRelPath,string filename)\n    {\n        string strFilePage;\n        strFilePage = strRelPath + \"&#92;&#92;\" + filename;\n        StreamWriter sw = null;\n        //获得aspx的静态html\n        try\n        {\n            if (!Directory.Exists(strRelPath))\n            {\n                Directory.CreateDirectory(strRelPath);\n            }\n            if (File.Exists(strFilePage))\n            {\n                File.Delete(strFilePage);\n            }\n            sw = new StreamWriter(strFilePage, false, System.Text.Encoding.GetEncoding(\"gb2312\"));\n            System.Net.WebRequest wReq = System.Net.WebRequest.Create(strURL);\n            System.Net.WebResponse wResp = wReq.GetResponse();\n            System.IO.Stream respStream = wResp.GetResponseStream();\n            System.IO.StreamReader reader = new System.IO.StreamReader(respStream, System.Text.Encoding.GetEncoding(\"gb2312\"));\n            string strTemp = reader.ReadToEnd();\n\n            Regex r1 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTTARGET&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            Regex r2 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTARGUMENT&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            Regex r3 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__VIEWSTATE&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n\n            Regex r4 = new Regex(\"&lt;form .*id=&#92;\"form1&#92;\"&gt;\", RegexOptions.IgnoreCase);\n            Regex r5 = new Regex(\"&lt;/form&gt;\");\n\n            Regex r6 = new Regex(\"&lt;input type=&#92;\"hidden&#92;\" name=&#92;\"__EVENTVALIDATION&#92;\".*/&gt;\", RegexOptions.IgnoreCase);\n            strTemp = r1.Replace(strTemp, \"\");\n            strTemp = r2.Replace(strTemp, \"\");\n            strTemp = r3.Replace(strTemp, \"\");\n            strTemp = r4.Replace(strTemp, \"\");\n            strTemp = r5.Replace(strTemp, \"\");\n            strTemp = r6.Replace(strTemp, \"\");\n\n            sw.Write(strTemp);\n        }\n        catch (Exception ex)\n        {\n            HttpContext.Current.Response.Write(ex.Message);\n            HttpContext.Current.Response.End();\n            return false;//生成到出错\n        }\n        finally\n        {\n            sw.Flush();\n            sw.Close();\n            sw = null;\n        }\n\n        return true;\n\n    }\n    public void FilePicDelete(string path)\n    {\n        System.IO.FileInfo file = new System.IO.FileInfo(path);\n        if (file.Exists)\n            file.Delete();\n    }\n}\n\n</pre>\n  ',NULL,882,'0101','ASP.NET',NULL,0),(770,'2009-10-21 15:52:26','服务器用户xxx不是数据库bbb的有效用户','    &nbsp;&nbsp; 网上买了一空间，支持MSSQL，可用MSSQL的“连接到服务器”远程连接上去，连接上去后直接点“新建查询”即可直接输入SQL语句查我自己的数据库，但是在“对象资源管理器”中刷新“数据库”，弹出“服务器用户xxx不是数据库bbb的有效用户”的对话框，如图：<br />\n<br />\n<img src=\"http://niunan.net/bbspic/mssqlerr/01.jpg\" /><br />\n&nbsp;&nbsp; 因为该MSSQL中不仅仅有我买的数据库，还有其他人买的数据库，而我的登陆用户只能操纵我的数据库，所以就会出来“。。。。不是有效用户”的提示，这样子的话我想在图形界面下查询、更新、备份数据库的时候就不行了。<br />\n&nbsp;&nbsp; <br />\n&nbsp;&nbsp; 要让“对象资源管理”器中的“数据库”显示我登陆的数据库，则按照如下方法进行：<br />\n“视图”→“对象资源管理器详细信息”，如图：<br />\n<br />\n<img src=\"http://niunan.net/bbspic/mssqlerr/02.jpg\" /><br />\n<br />\n&nbsp;&nbsp; 在打开的界面上，双击“数据库”进入下一级目录，在“名称”列上右键，把“排序规则”前的小勾勾取消掉，如图：<br />\n<br />\n<img src=\"http://niunan.net/bbspic/mssqlerr/03.jpg\" /><br />\n<br />\n&nbsp;&nbsp; 然后再在“对象资源管理器”的“数据库”上右键刷新，即可看到当前服务器上的所有数据库都列出来了。<br />\n<br />\n<img src=\"http://niunan.net/bbspic/mssqlerr/04.jpg\" /><br />\n&nbsp;&nbsp; <br />\n&nbsp;&nbsp; 这样我们即可对我们自己的数据库进行图形化的操作了，如果想看别人的数据库中的内容，则会弹出对话框提示“无法访问数据库XXX”，因为我们当前登陆的用户是没有对该数据库访问的权限的。<br />\n<br />\n<img src=\"http://niunan.net/bbspic/mssqlerr/05.jpg\" />	                          ',NULL,939,'0106','SQL',NULL,0),(771,'2009-10-21 15:52:26','javascript倒计时 ','\n    以前做的JSP青鸟论坛里的一个JS功能，用于网页倒计时，在BODY的ONLOAD中启动那个函数即可。\n<br /><pre name=\"code\" class=\"js\">\n&lt;script language=\"javascript\"&gt;\nvar i=5;\n&lt;!--\nfunction clock(){	\n	//document.title=\"本窗口将在\"+i+\"秒后自动关闭!\";\n	document.getElementById(\"s\").innerHTML = i;\n	if(i&gt;0)\n		setTimeout(\"clock();\",1000);\n	else \n		//self.close();\n		window.history.back(-1);  // 跳转到其他页面\n		\n	i--;\n}\n//--&gt;\n&lt;/script&gt;\n</pre>\n  ',NULL,758,'0105','javascript',NULL,0),(755,'2009-10-21 15:52:25','用tree命令查看某一目录下的文件结构','\n    在CMD命令窗口下输入以下命令,可查看当前目录的文件结构并保存到c:&#92;a.txt文件中\n<br />\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />tree /f &gt; c:&#92;a.txt\n<br /></div>\n<br />\n<br />如果只是输入tree /f , 则只是在命令行下显示目录文件结构,如图:\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/145707/7c9b24cc-d370-3114-a714-0ffeacf0182c.jpg\" />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/145707/7c9b24cc-d370-3114-a714-0ffeacf0182c.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/145707/7c9b24cc-d370-3114-a714-0ffeacf0182c-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 39.3 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,619,'0103','随笔',NULL,0),(756,'2009-10-21 15:52:25','Web开发必备资料(牛腩整理)','反正自己在WEB开发中必备的资料整理了一下,包含如下东西:<br />\n<br />\n<img border=\"0\" alt=\"\" src=\"http://blog.niunan.net/upload/20110627112624.png\" /><br />\n<br />\n以上工具都是本人在WEB开发中常用的,那个截图工具有个获取屏幕上任何一个地方的颜色值,很好用,而且用它来计算DIV的宽度高度也很好用.<br />\n<br />\n<span style=\"color:#fe2419;\">更新于2010年12月3日 增加了dotnet中对excel导入导出的示例源码</span><br />\n<span style=\"color:#f10b00;\">更新于2011年4月4日 在线编辑器，jquery, my97日历控件，动软生成器都升级为最新版本<br />\n</span><span style=\"color:#f10b00;\">更新于2011年6月27日 部分软件升级为最新版本</span><br />\n<br />\n下载地址: <a href=\"http://yunpan.cn/QXiv3pvhXZA5G\">http://yunpan.cn/QXiv3pvhXZA5G</a>',NULL,3980,'0104','下载',NULL,0),(757,'2009-10-21 15:52:25','SQL备忘录','\n    记录一些不常用的SQL语句．\n<br /><pre name=\"code\" class=\"sql\">\n-- 创建一个名为\"book\"的用户数据库,其主文件大小为120MB,初始大小为55MB\n-- 文件大小增长率为10%,日志文件大小为30MB,初始大小为12MB,文件增长增量为3MB\n-- 文件均存储在 \"D:&#92;数据库&#92;\" 下\ncreate database book\non primary\n(\n	name=book,\n	filename=\'d:&#92;数据库&#92;book.mdf\',\n	size=55,\n	maxsize=120,\n	filegrowth=10%\n)\nlog on\n(\n	name=book_log,\n	filename=\'d:&#92;数据库&#92;book.ldf\',\n	size=12,\n	maxsize=30,\n	filegrowth=3\n)\n\n-- 查看数据库\'book\'的信息\nsp_helpdb \'book\'\n\n-- 扩充数据库,必须大于原数据库的大小\nuse book\n;\nalter database book\nmodify file\n(\n	name=book,\n	size=50\n)\n\n-- 缩减数据库\nuse book\n;\ndbcc shrinkdatabase (\'book\')\n\n-- 更改数据库为\"只读\",取消\"只读\"则是false\nexec sp_dboption \'book\',\'read only\',true\n\n-- 改成单用户模式\nexec sp_dboption \'book\',\'single user\',true\n\n-- 数据库更名,得先把数据库改为单用户模式\nexec sp_dboption \'book\',\'single user\',true\nexec sp_renamedb \'book\',\'shu\'\nexec sp_dboption \'shu\',\'single user\',false\n\n-- 删除数据库,得先停止对该数据库的使用\nuse master\n;\ndrop database shu\n\n-- 创建表\nuse book\ncreate table author\n(\n	id int primary key identity(1,1),  -- 主键,自增\n	name nvarchar(20) not null,  -- 非空\n	sex nvarchar(1) default(\'男\') check(sex=\'男\' or sex=\'女\') -- 默认\'男\',约束该字段只能是\'男\'或\'女\'\n)\n\n-- 查看表信息\nexec sp_help author\n\n-- 显示SQL语句的查询计划\nuse northwind\n;\nset showplan_all on\n;\nselect * from customers where customerid=\'BLONP\'\n;\nset showplan_all off\n\n-- 显示SQL语句的所花费磁盘活动量\nuse northwind\n;\nset statistics io on\n;\nselect * from customers where customerid=\'BLONP\'\n;\nset statistics io off\n\n</pre>\n  ',NULL,650,'0106','SQL',NULL,0),(758,'2009-10-21 15:52:25','泛域名解析设置','\n    上月刚刚发工资，屁颠屁颠的去买了个可以泛解析的域名和一个60人合租的服务器，本以为可以用该域名泛解析到买的空间的，这样就可以自己试下做个.NET版的javaeye了，刚刚买域名的时候拿自己公司的网站做了下域名的泛解析，成功了，然后等到空间也买了之后再做相应的泛解析，发现我在域名管理平台上做好对应了，可是我去没办法到合租的服务器空间上的IIS给他加上那一条空标识，再问空间商，原来泛解析必须是要双方设置的，域名这边设置后，服务器上的IIS也得设置，而买的合租空间或者虚拟空间在服务器上是不能设置的，所以无法对虚拟空间进行泛解析，郁闷。。。<img src=\"/images/smiles/icon_cry.gif\"/>&nbsp;<img src=\"/images/smiles/icon_cry.gif\"/>&nbsp;<img src=\"/images/smiles/icon_cry.gif\"/> \n<br />下面先记一下怎么样双方设置泛解析：\n<br />\n<br />① 打开服务器上的IIS上的网站的属性，在“网站”→“高级”那里添加一条网站标识，主机头保持为空。\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/144870/5b17c2fb-0463-31fa-af54-45b0cdcee9b8.jpg\" />\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/144875/e0aedbf0-77cf-3bfd-97fb-f2ed85d5ccf4.jpg\" />\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/144871/dfa33d7c-fce0-36bc-8958-55ba98388cf8.jpg\" />\n<br />\n<br />\n<br />② IIS设置好后再来进到域名管理平台那设置泛解析的IP地址，如下图：\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/144874/5123162d-65f6-384e-a53c-421fc77e69ce.jpg\" />\n<br />\n<br />大功告成，打开IE，输入：\n<br /><a href=\"http://陈冠希.niunan.net\" target=\"_blank\">http://陈冠希.niunan.net</a>\n<br />测试，成功转向！！！\n<br />\n<br />\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/144870/5b17c2fb-0463-31fa-af54-45b0cdcee9b8.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/144870/5b17c2fb-0463-31fa-af54-45b0cdcee9b8-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 44.1 KB</li>\n        </ul>\n      \n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/144871/dfa33d7c-fce0-36bc-8958-55ba98388cf8.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/144871/dfa33d7c-fce0-36bc-8958-55ba98388cf8-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 34.7 KB</li>\n        </ul>\n      \n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/144874/5123162d-65f6-384e-a53c-421fc77e69ce.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/144874/5123162d-65f6-384e-a53c-421fc77e69ce-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 49.5 KB</li>\n        </ul>\n      \n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/144875/e0aedbf0-77cf-3bfd-97fb-f2ed85d5ccf4.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/144875/e0aedbf0-77cf-3bfd-97fb-f2ed85d5ccf4-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 59.6 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,735,'0103','随笔',NULL,0),(759,'2009-10-21 15:52:25','查找数据库中的某表某字段中是否有注入脚本','\n    今天早上起来上网发现公司网站又被注入了，郁闷死了，赶快还原！！！\n<br />不过也多亏这注入，让我知道怎么简单的分析IIS日志了，呵呵，原来只要ctrl+f查找20%字符串就行，查到到如下东西：\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />/forum/show.aspx titleid=318&amp;caid=20%20And%20Cast(IS_SRVROLEMEMBER(0x730079007300610064006D0069006E00)%20as%20varchar(1))%2Bchar(124)=1 80 - 117.32.250.106 Mozilla/4.0 302 0 0\n<br /></div>\n<br />呵呵，原来show.aspx这个页面没有经过验证，赶快补上。。。\n<br />然后自己用.NET做了个检测数据库中的表中的字段中的内容有没有注入脚本的页面，看来以后每天都得要运行这个页面检测一次哦！！！\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.IO;\nusing System.Data;\n\npublic partial class niunantest : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        string sql_tbName =\n            \"SELECT name FROM sysobjects \" +\n            \"WHERE xtype = \'U\' AND OBJECTPROPERTY (id, \'IsMSShipped\') = 0 \" +\n            \"order by name\";\n        // 获取数据库中所有的用户表\n        DataTable dt_tbName = myClass.myDataGet.getTable(sql_tbName);\n        foreach (DataRow row in dt_tbName.Rows)\n        {\n            string tbName = row\"name\".ToString();\n            string sql_tbColName =\n                \"select column_name,data_type from information_schema.columns \" +\n                \"where table_name =\'\" + tbName + \"\'  \";\n            // 获取表中所有的字段\n            DataTable dt_tbColName = myClass.myDataGet.getTable(sql_tbColName);\n            foreach (DataRow row2 in dt_tbColName.Rows)\n            {\n                string tbColName = row2\"column_name\".ToString();\n                string tbColType = row2\"data_type\".ToString();\n\n                if (tbColType == \"char\" || tbColType == \"nchar\" || tbColType == \"varchar\"\n                    || tbColType == \"nvarchar\" || tbColType == \"text\")\n                {\n                    string sql_count =\n                        \"select COUNT(*) from \" + tbName + \" where \" + tbColName + \" like \'%&lt;script%\' \";\n                    // 判断该表该字段中是否含有script脚本\n                    int count = int.Parse(myClass.myDataGet.getDataScalar(sql_count).ToString());\n                    if (count &gt; 0)\n                    {\n                        Response.Write(tbName + \" 表中的 \" + tbColName +\n                            \" 字段含有脚本！&lt;br&gt;SQL语句：&lt;span style=\'color:blue;\'&gt;\" + HttpUtility.HtmlEncode(sql_count) + \"&lt;/span&gt;&lt;br&gt;&lt;br&gt;\");\n                    }\n                }\n\n            }\n        }\n    }\n}\n</pre>\n<br />把代码记录下来，以备后用！\n<br />前几天申请了制作电子书的，上回发短消息给我说是已经做好了，但是我下载下来的大小却是0KB，不知道是怎么回事哦！！！\n  ',NULL,692,'0106','SQL',NULL,0),(760,'2009-10-21 15:52:25','ASP.NET上传文件对文件类型的高级判断','\n    以前发过一个.NET上传文件的方法的，不过那个方法中对文件类型的判断只是对后缀名来进行判断的，这样假如我把一个txt文本文件的后缀名改为jpg了也可以上传，这样无意中就造成了安全问题。\n<br />刚刚从网上找了个方法，试验了一下，是能够辨认出正确的文件类型的，如下：\n<br /><pre name=\"code\" class=\"c#\">\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.IO;\n\npublic partial class niunantest : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        string str = FileUpload1.PostedFile.ContentType;\n        Response.Write(\"文件类型：\"+str);\n\n        string filename = \"\";\n\n        FileExtension fe = { FileExtension.GIF, FileExtension.JPG, FileExtension.PNG };\n        if (FileValidation.IsAllowedExtension(FileUpload1, fe))\n        {\n            string fileExt = System.IO.Path.GetExtension(FileUpload1.FileName).ToLower();\n            Response.Write(\"&lt;br&gt;验证通过！\");\n            //filename = \"/Images/\" + DateTime.Now.ToString(\"yyyyMMddHHmmss\") + fileExt;\n            //FileUpload1.PostedFile.SaveAs(Server.MapPath(filename));\n        }\n        else\n        {\n            Response.Write( \"&lt;br&gt;验证不通过，只支持以下格式的图片：JPG,GIF,PNG\");\n            return;\n        }\n\n    }\n\n    public enum FileExtension\n    {\n        JPG = 255216,\n        GIF = 7173,\n        PNG = 13780,\n        SWF = 6787,\n        RAR = 8297,\n        ZIP = 8075,\n        _7Z = 55122\n\n        // 255216 jpg;\n\n        // 7173 gif;\n\n        // 6677 bmp,\n\n        // 13780 png;\n\n        // 6787 swf\n\n        // 7790 exe dll,\n\n        // 8297 rar\n\n        // 8075 zip\n\n        // 55122 7z\n\n        // 6063 xml\n\n        // 6033 html\n\n        // 239187 aspx\n\n        // 117115 cs\n\n        // 119105 js\n\n        // 102100 txt\n\n        // 255254 sql \n\n    }\n\n    public class FileValidation\n    {\n        public static bool IsAllowedExtension(FileUpload fu, FileExtension fileEx)\n        {\n            int fileLen = fu.PostedFile.ContentLength;\n            byte imgArray = new bytefileLen;\n            fu.PostedFile.InputStream.Read(imgArray, 0, fileLen);\n            MemoryStream ms = new MemoryStream(imgArray);\n            System.IO.BinaryReader br = new System.IO.BinaryReader(ms);\n            string fileclass = \"\";\n            byte buffer;\n            try\n            {\n                buffer = br.ReadByte();\n                fileclass = buffer.ToString();\n                buffer = br.ReadByte();\n                fileclass += buffer.ToString();\n            }\n            catch\n            {\n            }\n            br.Close();\n            ms.Close();\n            foreach (FileExtension fe in fileEx)\n            {\n                if (Int32.Parse(fileclass) == (int)fe)\n                    return true;\n            }\n            return false;\n        }\n    }\n}\n</pre>\n<br />个人理解：上面的代码中判断文件类型的应该是把文件转成二进制的字节，然后取开头2个字节，这样看来的话开头2个字节就表示文件的类型...\n  ',NULL,721,'0101','ASP.NET',NULL,0),(761,'2009-10-21 15:52:25','数据库注入备忘！！！','\n    今天数据库又被注入了。。。我%……——#￥%……**）——￥%——*\n<br />搞了一上午，终于把数据库还原了过来。。。真不知道对方是怎么注入的，无意中听同事说了一句，以前另一个同事说插入数据也可以用十六进制插入的，加上之前我看过一篇文章也是在构造SQL注入语句的时候有一大堆乱78糟的字符的。。自己试了一下，果然是可以用十六进制来插入数据。。如下：\n<br />这是普通的插入数据的SQL语句：\n<br /><pre name=\"code\" class=\"sql\">\ndeclare @str varchar(100)\nset @str=\'&lt;script&gt;alert(123)&lt;/script&gt;\'\nupdate tb_product set proName=proName+@str where proID = 35\n</pre>\n<br />\n<br />这是采用十六进制插入数据的SQL语句：\n<br /><pre name=\"code\" class=\"sql\">\ndeclare @str varchar(100)\nset @str=0x3C7363726970743E616C65727428313233293C2F7363726970743E\nupdate tb_product set proName=proName+@str where proID = 54\n</pre>\n<br />\n<br />以上SQL语句都可以执行，执行过后都是在proname字段的后头加上&lt;script&gt;alert(123)&lt;/script&gt;\n<br />\n<br />0x3C7363726970743E616C65727428313233293C2F7363726970743E是怎么来的呢？0x是十六进制的开头前缀，后面一大乱字母才是&lt;script&gt;alert(123)&lt;/script&gt;，我们可用些可以查看十六进制的文本编辑器来转换，如UltraEdit等，如图：\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/142282/dbd0cb2b-3a9b-3a5d-a05d-8d3a0775b9e9.jpg\" />\n<br />\n<br />把中间的那些字母间的空格去掉就可以了！！！\n<br />\n<br />我在做该项目的时候插入数据时我没把相应的HTML代码去掉，只是在取出的时候把HTML代码去掉了。不过只限于论坛，唉，还得把页面所有的输出全都要把HTML代码去掉才行。\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/142282/dbd0cb2b-3a9b-3a5d-a05d-8d3a0775b9e9.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/142282/dbd0cb2b-3a9b-3a5d-a05d-8d3a0775b9e9-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 24.8 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,685,'0106','SQL',NULL,0),(762,'2009-10-21 15:52:25','数据库还原备忘录！！！','\n    今天公司数据库又被注入，我￥……——（……￥……——*%……（*%……——￥%……\n<br />还原的时候又出现了那个问题““数据库正在使用，所以无法获得对数据库的独占访问权”。”，忘记第一次被注入的时候还原是怎么被解决的话，又花了一个上午的时间搜索解决方法，现已解决，做下记录，以备后用。\n<br />\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />14.6.1&nbsp; 恢复中的单用户模式问题\n<br />1．故障现象\n<br />\n<br />在在线恢复数据库时，出现如图14-31所示界面，提示“数据库正在使用，所以无法获得对数据库的独占访问权”。\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/142243/571f5f78-5cf4-35b4-986f-06f2e13c7248.jpg\" />\n<br />\n<br />图14-31&nbsp; \n<br />\n<br />故障现象\n<br />2．原因分析\n<br />\n<br />这是因为在还原数据库时，有其他用户正在使用数据库。还原数据库要求数据库工作在单用户模式。\n<br />\n<br />通常就是DBA在操作时，不允许其他用户连接数据库。\n<br />3．解决方法\n<br />\n<br />配置数据库的属性，在如图14-32所示的【选项】选项卡中，设置【限制访问】参数为“Single”即可。\n<br />\n<br /><img src=\"http://dl.javaeye.com/upload/attachment/142245/c351260f-1ac5-3162-84f9-41b97406dd7d.jpg\" />\n<br />\n<br />图14-32 【选项】选项卡\n<br />\n<br />设置完毕查看数据库的状态如图14-33所示，表明成功将数据库设置为单用户模式。\n<br />\n<br />图14-33&nbsp; 成功设置数据库为单用户模式\n<br /></div>\n<br />\n<br />另也搜索出另一解决方案，好像记得我第一次被注入时还原数据库就是用这种方法的吧。\n<br /><div class=\"quote_title\">引用</div><div class=\"quote_div\">\n<br />在还原数据库时,有时会提示因为数据库正在使用，所以无法获得对数据库的独占访问权!!\n<br />这时需要在还原数据库前先杀死正在使用数据库得线程.\n<br />\n<br />如以下杀死正在使用\'Calendar3\'数据库的线程:\n<br />\n<br />declare @dbname varchar(20)\n<br />set @dbname=\'Calendar3\'\n<br />\n<br />declare @sql nvarchar(500)\n<br />declare @spid int--SPID 值是当用户进行连接时指派给该连接的一个唯一的整数\n<br />set @sql=\'declare getspid cursor for\n<br />select spid from sysprocesses where dbid=db_id(\'\'\'+@dbname+\'\'\')\'\n<br />exec (@sql)\n<br />open getspid\n<br />fetch next from getspid into @spid\n<br />while @@fetch_status&lt;&gt;-1--如果FETCH 语句没有执行失败或此行不在结果集中。\n<br />begin\n<br />exec(\'kill \'+@spid)--终止正常连接\n<br />fetch next from getspid into @spid\n<br />end\n<br />close getspid\n<br />deallocate getspid\n<br /></div>\n  </div>\n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/142243/571f5f78-5cf4-35b4-986f-06f2e13c7248.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/142243/571f5f78-5cf4-35b4-986f-06f2e13c7248-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 16.5 KB</li>\n        </ul>\n      \n    \n      \n        <ul style=\"display:none;\">\n          <li><a href=\"http://dl.javaeye.com/upload/attachment/142245/c351260f-1ac5-3162-84f9-41b97406dd7d.jpg\" target=\"_blank\"><img src=\'http://dl.javaeye.com/upload/attachment/142245/c351260f-1ac5-3162-84f9-41b97406dd7d-thumb.jpg\' class=\'magplus\' title=\'点击查看原始大小图片\' /></a></li>\n          \n          <li>大小: 10.3 KB</li>\n        </ul>\n      \n    \n    \n      <ul>\n        <li><a href=\"#\" onclick=\"$$(\'div.attachments ul\').invoke(\'show\');$(this).up(1).hide();return false;\">查看图片附件</a></li>\n      </ul>\n    \n  ',NULL,719,'0106','SQL',NULL,0),(751,'2009-10-21 15:51:21','JAVAEYE网站的代码高亮功能','	      &nbsp;&nbsp; 花了一上午的时候,终于把JAVAEYE这个网站的发贴中的代码高亮功能提取出来啦..呵呵..蛮爽的..<br />\n&nbsp;&nbsp; 有点不爽的就是核心的JS代码JAVAEYE竟然给我玩加密(虽说只是把空格去掉而已),但还是让人看着费劲,一点都不秉承JAVA开源的优良传统...<br />\n&nbsp;&nbsp; 废话少说,附上我提取的文件的说明图:<br />\n<img src=\"http://niunan.net/bbspic/codeligth.jpg\" /><br />\n<br />\n源码下载:<a href=\"http://niunan.net/download/jscodelight.zip\" target=\"_blank\">http://niunan.net/download/jscodelight.zip</a>  	  		  	                          	                          	                          ',NULL,916,'0105','javascript',NULL,0),(752,'2009-10-21 15:51:21','我真他X的是个S13.。。','\n       昨天被亲戚叫去修电脑，说电脑启动不了，去到那里了看了下也还真的是启动不了，于是在那不停的试，拨了内存再插进去还是不行，显示器总是显示无信号输入，初步怀疑是集成显卡的问题，主板是磐正的C61板子，家里的磐正KT600的板子我用了4年了都没事，怎么黑装亲戚用就出这事了。。。郁闷\n   于是呼今天抱着个电脑机箱跑了大半个南宁市的来到公司返修，结果在公司自己再试一回的时候，突然想到，如果我把内存换根内存插糟会怎么样，结果一换，开机启动的时候显示器有信号了，可以启动了。。。晕。。。真的是内存插不稳啊。。关机再把内存换回原来的插糟，OK，开机成功启动！！！\n   我真他X的是个S13，怎么在亲戚家里弄的时候就没想过换根内存插糟试试呢。。。\n  ',NULL,692,'0103','随笔',NULL,0),(753,'2009-10-21 15:51:21','ASP.NET通过HTML的上传文件标签来上传文件','<div>开始以为会很麻烦，需要什么读二进制流写二进制流的，结果自己试了一下，还真简单。。直接一个saveAs就行了。。。&nbsp;</div>\n<div>下面是HTML代码：<br />\n<div></div>\nhtml<div>&lt;form name=\"uploadForm\" method=\"post\" enctype=\"multipart/form-data\" action=\"handler/upload.ashx\"&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;input type=\"file\" id=\"imgFile\" name=\"imgFile\" style=\"width:220px;\" /&gt;</div>\n<div>&nbsp;&nbsp; &nbsp;&lt;input type=\"submit\" value=\"上传\" /&gt;</div>\n<div>&lt;/form&gt;</div>\n<div></div>\n/html<div>在这里我是用了一般处理程序来进行文件的上传，代码如下：&nbsp;<br />\n<div></div>\nc#<div>&lt;%@ WebHandler Language=\"C#\" Class=\"upload\" %&gt;</div>\n<div><br />\n</div>\n<div>/*</div>\n<div>&nbsp;* 作者: 牛腩</div>\n<div>&nbsp;* 创建时间: 2009-10-28 15:40:39</div>\n<div>&nbsp;* Email: 164423073@qq.com</div>\n<div>&nbsp;* 说明: 上传</div>\n<div>&nbsp;*/</div>\n<div><br />\n</div>\n<div>using System;</div>\n<div>using System.Web;</div>\n<div><br />\n</div>\n<div>public class upload : IHttpHandler {</div>\n<div>&nbsp;&nbsp; &nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;public void ProcessRequest (HttpContext context) {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;context.Response.ContentType = \"text/plain\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;// 下面这句是最重要的，取得HttpPostedFile对象后就可以调用他的SaveAs方法了</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;HttpPostedFile imgFile = HttpContext.Current.Request.Files\"imgFile\";</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;string savePath = context.Server.MapPath(\"~/upload/\"+imgFile.FileName);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;imgFile.SaveAs(savePath);</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;context.Response.Write(\"&lt;br&gt;保存成功！文件名：\"+imgFile.FileName);</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div>&nbsp;</div>\n<div>&nbsp;&nbsp; &nbsp;public bool IsReusable {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;get {</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return false;</div>\n<div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div>\n<div>&nbsp;&nbsp; &nbsp;}</div>\n<div><br />\n</div>\n<div>}</div>\n<div></div>\n/c#<div><a href=\"http://niunan.net/download/upload_dotnet.rar\" target=\"_blank\">示例下载</a></div>\n</div>\n</div>\n',NULL,777,'0101','ASP.NET',NULL,0),(754,'2009-10-21 15:51:21','PHP上传文件简单示例','	  \n    &nbsp; 现在家里的电脑不能上网，又是256M内存，想玩VS也玩不了，无聊之余学学PHP~~~\n  \n\n  \n  <div class=\"attachments\">\n    \n      \n        <ul>\n          <li><a href=\"http://dl.javaeye.com/topics/download/fe254a8e-22b1-3e6a-ae26-ab5852896e5a\">PHP上传文件demo.rar</a> (1.4 KB)</li>\n        </ul>\n      \n    \n    \n  	  \n	  </div>',NULL,948,'0102','PHP',NULL,0),(749,'2009-10-21 15:51:20','嘿嘿。。。本人的藏书阁又多出了几本书。。。真是钱多得没处花呀。。。。','\n    嘿嘿。。。本人的藏书阁又多出了几本书。。。真是钱多得没处花呀。。。。\n<br />\n<br />① javascript征途\n<br /><img src=\"http://dl.javaeye.com/upload/picture/pic/47147/40cb2982-da4a-377c-b15b-71b87334ec2b-thumb.jpg\" />\n<br />\n<br />② c#和.net2.0实战 平台、语言与框架\n<br /><img src=\"http://dl.javaeye.com/upload/picture/pic/47145/5eac23d8-4e36-36b3-8c12-c1c9b63476bb-thumb.jpg\" />\n<br />\n<br />③ 黑客攻防技术宝典web实战篇\n<br /><img src=\"http://dl.javaeye.com/upload/picture/pic/47143/138e8e0d-ca58-35a1-a5ee-59dde15a2072-thumb.jpg\" />\n<br />\n<br />④ JAVA ME基础教程\n<br /><img src=\"http://dl.javaeye.com/upload/picture/pic/47141/41d577bc-bb43-3acc-82ad-0b04e44261f1-thumb.jpg\" />\n<br />\n<br />更多高清无码图请看：\n<br /><a href=\"http://niunan.javaeye.com/blog/album_by_tag?tag=%E6%88%91%E4%B9%B0%E7%9A%84%E4%B9%A6\" target=\"_blank\">http://niunan.javaeye.com/blog/album_by_tag?tag=%E6%88%91%E4%B9%B0%E7%9A%84%E4%B9%A6</a>\n<br />\n<br />\n  ',NULL,728,'0103','随笔',NULL,0),(750,'2009-10-21 15:51:20','JS征途备忘－JS中十进制数输出N进制数','\n    &nbsp;&nbsp; 我想知道十进制数100的二进制数是多少怎么办？\n<br />其中一个办法，开始→运行→calc，打开计算器，输入100，切换到科学型，点那个二进制，然后就出来了，也可以点击计算器中的八进制、十六进制，也可以显示出相应的进制数，但是如果我要显示三进制，或者七进制怎么办呢？\n<br />\n<br />打开记事本，输入如下内容：\n<br /><pre name=\"code\" class=\"js\">\n  &lt;script&gt;\n    var n = 100;\n	document.write(n.toString(3)); // 输出100的三进制数\n  &lt;/script&gt;\n</pre>\n<br />保存文件名为test.html，用浏览器打开，看到一串数字，这就是十进制数100的三进制数的表示。同理，输出十进制数100的七进制数代码如下：\n<br /><pre name=\"code\" class=\"js\">\n  &lt;script&gt;\n    var n = 100;\n	document.write(n.toString(7)); // 输出100的七进制数\n  &lt;/script&gt;\n</pre>\n<br />\n<br />以上代码有些要注意的地方，最好要定义变量n，然后采用\n<br /><pre name=\"code\" class=\"js\">\nn.toString(进制); // 输出数字n的某进制数\n</pre>\n<br />的方式输出进制数，如果不定义变量的话，像下面的代码则会出错\n<br /><pre name=\"code\" class=\"js\">\n100.toString(3); // 出错\n</pre>\n<br />但是如果是下面的代码不会出错，照样能输入100的三进制数\n<br /><pre name=\"code\" class=\"js\">\n(100).toString(3); // 输出100的三进制数\n</pre>\n<br />经检验，用这种方法可以输出任意十进制数的2 ~ 36 种进制数，没有1进制，也没有37进制，\n<br />因为只有10个数字和26个字母可拼起来，所以最高也就只能到36进制。。。\n<br />\n  ',NULL,779,'0105','javascript',NULL,0),(748,'2009-10-16 12:31:42','给留言和评论加了是否为空的判断！','在工具类Tools中加了一个方法：<br /><div style=\"border:1px solid #000000;margin:5px;padding:5px;\">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; // 判断字符串是否为空，把所有的HTML代码去掉，再把空格转码过来再判断<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// 如：&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;,这个字符串判断出来就是空的<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;public function IsEmpty($str)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$str = $this-&gt;GetNoHTMLString($str);<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$str = str_replace(\"&amp;nbsp;\",\"\",$str);<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$str = trim($str);<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if(strlen($str)==0)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return true;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return false;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}</div>用于判断留言和评论中的内容是否为空的。。<br />	  	  	\n	  ',NULL,687,'0103','随笔',NULL,0),(747,'2009-10-12 10:24:29','修正了左边评论的错误!','	  <span style=\"font-family:arial;font-size:13px;\">修正了左边评论的错误,原来在我转为com方式的时候没有通过com方式获取出titleid,已经改了,</span><div><font face=\"Arial\" size=\"3\"><span style=\"font-size:13px;\">也删除了几条大评论...竟然把我页面HTML源码全塞到评论中..晕..呵呵...</span></font></div><div><font face=\"Arial\" size=\"3\"><span style=\"font-size:13px;\">已经做了限制,评论时连同HTML代码不能超过5000个字符...虽然感觉好像还是有点多了..不过也就算了吧.呵呵..</span></font></div><div><font face=\"Arial\" size=\"3\"><span style=\"font-size:13px;\">源码也同步更新了..</span></font></div>	  	\n	  ',NULL,758,'0103','随笔',NULL,0),(746,'2009-10-10 12:25:49','更改了一下本博客代码!','之前的留言本和评论那里的\"删除\"按钮忘记加上session验证了,呵呵..<br />现在改过来了...同时也改了一下后台的登陆密码.源码也已更新!!!<br />	  	  	\n	  ',NULL,742,'0103','随笔',NULL,0),(745,'2009-10-07 13:02:57','Http错误代码含义','	  <span style=\"font-family:verdana, geneva, arial, helvetica, sans-serif;font-size:13px;\"><h2 style=\"font-size:1em;\">Http错误代码含义</h2><div class=\"postText\" style=\"font-size:10pt;\"><p style=\"text-indent:0px;\"><span style=\"color:red;\">概要</span><br />&nbsp;&nbsp;&nbsp;&nbsp; 当用户试图通过 HTTP 或文件传输协议 (FTP) 访问一台正在运行 Internet 信息服务 (IIS) 的服务器上的内容时，IIS 返回一个表示该请求的状态的数字代码。该状态代码记录在 IIS 日志中，同时也可能在 Web 浏览器或 FTP 客户端显示。状态代码可以指明具体请求是否已成功，还可以揭示请求失败的确切原因。<br /><span style=\"color:red;\">更多信息</span><br />&nbsp;&nbsp;&nbsp; 日志文件的位置。在默认状态下，IIS 把它的日志文件放在 %WINDIR\\System32\\Logfiles 文件夹中。每个万维网 (WWW) 站点和 FTP 站点在该目录下都有一个单独的目录。在默认状态下，每天都会在这些目录下创建日志文件，并用日期给日志文件命名（例如，exYYMMDD.log）。</p><p style=\"text-indent:0px;\"><br /><span style=\"color:red;\">1xx - 信息提示</span><br />这些状态代码表示临时的响应。客户端在收到常规响应之前，应准备接收一个或多个 1xx 响应。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp;&nbsp;100 - 继续。&nbsp;<br />&nbsp;&nbsp;&nbsp; 101 - 切换协议。</p><p style=\"text-indent:0px;\"><br /><span style=\"color:red;\">2xx - 成功</span><br />这类状态代码表明服务器成功地接受了客户端请求。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 200 - 确定。客户端请求已成功。&nbsp;<br />&nbsp;&nbsp;&nbsp; 201 - 已创建。&nbsp;<br />&nbsp;&nbsp;&nbsp; 202 - 已接受。&nbsp;<br />&nbsp;&nbsp;&nbsp; 203 - 非权威性信息。&nbsp;<br />&nbsp;&nbsp;&nbsp; 204 - 无内容。&nbsp;<br />&nbsp;&nbsp;&nbsp; 205 - 重置内容。&nbsp;<br />&nbsp;&nbsp;&nbsp; 206 - 部分内容。</p><p style=\"text-indent:0px;\"><br /><span style=\"color:red;\">3xx - 重定向</span><br />客户端浏览器必须采取更多操作来实现请求。例如，浏览器可能不得不请求服务器上的不同的页面，或通过代理服务器重复该请求。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 301 - Moved Permanently 客户请求的文档在其他地方，新的URL在Location头中给出，浏览器应该自动地访问新的URL。&nbsp;<br />&nbsp;&nbsp;&nbsp; 302 - Found 类似于301，但新的URL应该被视为临时性的替代，而不是永久性的。注意，在HTTP1.0中对应的状态信息是“Moved Temporatily”，出现该状态代码时，浏览器能够自动访问新的URL，因此它是一个很有用的状态代码。注意这个状态代码有时候可以和301替换使 用。例如，如果浏览器错误地请求<a href=\"http://host/~user\">http://host/~user</a>（缺少了后面的斜杠），有的服务器返回301，有的则返回302。严格地说，我们只能假定只有当原来的请求是GET时浏览器才会自动重定向。请参见307。&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 303 - See Other 类似于301/302，不同之处在于，如果原来的请求是POST，Location头指定的重定向目标文档应该通过GET提取（HTTP 1.1新）。&nbsp;<br />&nbsp;&nbsp;&nbsp; 304 - Not Modified 客户端有缓冲的文档并发出了一个条件性的请求（一般是提供If-Modified-Since头表示客户只想比指定日期更新的文档）。服务器告诉客户，原来缓冲的文档还可以继续使用。<br />&nbsp;&nbsp;&nbsp; 305 - Use Proxy 客户请求的文档应该通过Location头所指明的代理服务器提取（HTTP 1.1新）。<br />&nbsp;&nbsp;&nbsp; 307 - Temporary Redirect 和302（Found）相同。许多浏览器会错误地响应302应答进行重定向，即使原来的请求是POST，即使它实际上只能在POST请求的应答是303时 才能重定向。由于这个原因，HTTP 1.1新增了307，以便更加清除地区分几个状态代码：当出现303应答时，浏览器可以跟随重定向的GET和POST请求；如果是307应答，则浏览器只 能跟随对GET请求的重定向。（HTTP 1.1新）<br /><br /><span style=\"color:red;\">4xx - 客户端错误</span><br />发生错误，客户端似乎有问题。例如，客户端请求不存在的页面，客户端未提供有效的身份验证信息。&nbsp;<br />&nbsp;&nbsp;&nbsp; 400 - 错误的请求。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401 - 访问被拒绝。IIS 定义了许多不同的401 错误，它们指明更为具体的错误原因。这些具体的错误代码在浏览器中显示，但不在 IIS 日志中显示：&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 401.1 - 登录失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401.2 - 服务器配置导致登录失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401.3 - 由于 ACL 对资源的限制而未获得授权。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401.4 - 筛选器授权失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401.5 - ISAPI/CGI 应用程序授权失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 401.7 – 访问被 Web 服务器上的 URL 授权策略拒绝。这个错误代码为 IIS 6.0 所专用。&nbsp;<br /><br />&nbsp;&nbsp;&nbsp; 403 - 禁止访问：IIS 定义了许多不同的 403 错误，它们指明更为具体的错误原因：&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp;&nbsp;403.1 - 执行访问被禁止。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.2 - 读访问被禁止。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.3 - 写访问被禁止。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.4 - 要求 SSL。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.5 - 要求 SSL 128。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.6 - IP 地址被拒绝。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.7 - 要求客户端证书。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.8 - 站点访问被拒绝。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.9 - 用户数过多。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.10 - 配置无效。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.11 - 密码更改。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.12 - 拒绝访问映射表。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.13 - 客户端证书被吊销。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.14 - 拒绝目录列表。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.15 - 超出客户端访问许可。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.16 - 客户端证书不受信任或无效。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.17 - 客户端证书已过期或尚未生效。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.18 - 在当前的应用程序池中不能执行所请求的 URL。这个错误代码为 IIS 6.0 所专用。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.19 - 不能为这个应用程序池中的客户端执行 CGI。这个错误代码为 IIS 6.0 所专用。&nbsp;<br />&nbsp;&nbsp;&nbsp; 403.20 - Passport 登录失败。这个错误代码为 IIS 6.0 所专用。&nbsp;<br /><br />&nbsp;&nbsp;&nbsp; 404 - 未找到。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp;&nbsp;404.0 -（无） – 没有找到文件或目录。&nbsp;<br />&nbsp;&nbsp;&nbsp; 404.1 - 无法在所请求的端口上访问 Web 站点。&nbsp;<br />&nbsp;&nbsp;&nbsp; 404.2 - Web 服务扩展锁定策略阻止本请求。&nbsp;<br />&nbsp;&nbsp;&nbsp; 404.3 - MIME 映射策略阻止本请求。&nbsp;<br /><br />&nbsp;&nbsp;&nbsp; 405 - 用来访问本页面的 HTTP 谓词不被允许（方法不被允许）&nbsp;<br />&nbsp;&nbsp;&nbsp; 406 - 客户端浏览器不接受所请求页面的 MIME 类型。&nbsp;<br />&nbsp;&nbsp;&nbsp; 407 - 要求进行代理身份验证。&nbsp;<br />&nbsp;&nbsp;&nbsp; 412 - 前提条件失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 413 – 请求实体太大。&nbsp;<br />&nbsp;&nbsp;&nbsp; 414 - 请求 URI 太长。&nbsp;<br />&nbsp;&nbsp;&nbsp; 415 – 不支持的媒体类型。&nbsp;<br />&nbsp;&nbsp;&nbsp; 416 – 所请求的范围无法满足。&nbsp;<br />&nbsp;&nbsp;&nbsp; 417 – 执行失败。&nbsp;<br />&nbsp;&nbsp;&nbsp; 423 – 锁定的错误。</p><p style=\"text-indent:0px;\"><br /><span style=\"color:red;\">5xx - 服务器错误</span><br />服务器由于遇到错误而不能完成该请求。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 500 - 内部服务器错误。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp;&nbsp; 500.12 - 应用程序正忙于在 Web 服务器上重新启动。&nbsp;<br />&nbsp;&nbsp;&nbsp; 500.13 - Web 服务器太忙。&nbsp;<br />&nbsp;&nbsp;&nbsp; 500.15 - 不允许直接请求 Global.asa。&nbsp;<br />&nbsp;&nbsp;&nbsp; 500.16 – UNC 授权凭据不正确。这个错误代码为 IIS 6.0 所专用。&nbsp;<br />&nbsp;&nbsp;&nbsp; 500.18 – URL 授权存储不能打开。这个错误代码为 IIS 6.0 所专用。&nbsp;<br />&nbsp;&nbsp;&nbsp; 500.100 - 内部 ASP 错误。&nbsp;<br /><br />&nbsp;&nbsp;&nbsp; 501 - 页眉值指定了未实现的配置。&nbsp;<br />&nbsp;&nbsp;&nbsp; 502 - Web 服务器用作网关或代理服务器时收到了无效响应。&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"text-indent:0px;\">&nbsp;&nbsp; &nbsp;502.1 - CGI 应用程序超时。&nbsp;<br />&nbsp;&nbsp;&nbsp; 502.2 - CGI 应用程序出错。application.&nbsp;<br /><br />&nbsp;&nbsp;&nbsp; 503 - 服务不可用。这个错误代码为 IIS 6.0 所专用。&nbsp;<br />&nbsp;&nbsp;&nbsp; 504 - 网关超时。&nbsp;<br />&nbsp;&nbsp;&nbsp; 505 - HTTP 版本不受支持。&nbsp;</p></div></span>	  	  	\n	  	  	\n	  ',NULL,671,'0103','随笔',NULL,0),(744,'2009-10-07 11:20:19','ASP.NET版的kindeditor','在做这个博客的时候用到的编辑器是kindeditor,用它是觉得界面蛮清爽的,发现上传图片用的是PHP的,自己稍微改了一下,换成用.NET的handler一般处理程序来上传,同时自己也做了一下在ASPX页面中使用kindeditor,本项目中有两个测试页面,一个是<span style=\"color:#9b014f;\">demo.html和demo.aspx</span>,另一个是<span style=\"color:#0021b0;\">default.aspx.</span><div><font color=\"#0021B0\"><br /></font><div><font color=\"#0021B0\"><span style=\"color:#000000;\">demo.html只是把kidneditor的默认的示例搬了过来,但是表单提交是提交到了demo.aspx页面,在demo.aspx页面把demo.html页面中填写的内容获取出来.</span></font></div><div><br /></div><div><span style=\"color:#000000;\">default.aspx页面上有一个ASP.NET的文本框控件,一个kindeditor,一个ASP.NET的BUTTON按钮,点击BUTTON按钮后就直接在当前页面显示填写的内容</span></div><div><br /></div><div><span style=\"font-family:arial;font-size:13px;\">ASP.NET版的kindeditor测试项目下载: <a href=\"http://niunan.net/download/kindeditor_dotnet.7z\" target=\"_blank\">http://niunan.net/download/kindeditor_dotnet.7z</a></span></div><div><br /></div></div>',NULL,2661,'0101','ASP.NET',NULL,0),(743,'2009-10-07 10:57:45','后台管理的登陆密码已经修改!','如有朋友还想参观本博客后台的可以直接与我联系....<br />email: 164423073@qq.com<br />	  	  	\n	  ',NULL,750,'0103','随笔',NULL,0),(742,'2009-10-06 14:30:39','公司服务器被挂马!!!','被挂马了...数据库也被注入了,最后得重装服务器系统,郁闷啊...',NULL,692,'0103','随笔',NULL,0),(741,'2009-10-04 15:26:19','插入网上的access数据库中一些特殊字符会有\\','插入数据的时候,在本地测试插入,数据库中单引号<span>显示&amp;#39;</span><span><br />\n&nbsp;&nbsp; 但是在网上插入数据时,数据库中单引号却显示 \\</span><span>&amp;#39;</span><span></span><span><br />\n&nbsp;&nbsp; 前面多了一个\\ ,在获取数据的时候我也使用了</span>htmlspecialchars_decode(),结果转义出来的还是有\\<br /><span style=\"color:#d6006d;\">(√ 已解决, 因为服务器开了magic_quotes_gpc,解决方法一:在PHP.ini中设置:magic_quotes_gpc = Off, 方法二: $str=stripcslashes($str),因为是自己买的空间,所以用了方法二)</span>	  	  	\n	  ',NULL,1114,'0102','PHP',NULL,0),(739,'2009-10-04 15:20:50','解决不能把·符号插入ACCESS数据库的问题','	  ACCESS数据库是GB编码的，但我的页面是UTF-8编码的，要在页面上插入数据库ACCESS数据库中而又让数据库中显示的是正确的字符时，必须把UTF-8转为GB编码，在先前的代码我用了如下代码进行转换：<div><span style=\"color:#d40a00;\">$content = iconv(\"utf-8\", \"gb2312\", $content);</span>	  	\n	  	  	\n	  </div><div><font color=\"#d40a00\"><span style=\"color:#000000;\">但是·符号在gb2312中不存在，所以当你的文章中有·符号的时候，他会把连同·符号在内的后面的内容全都截取掉</span></font></div><div>要插入·符号可更改一下以上代码，改为</div><div><span style=\"color:#0021b0;\">$content = iconv(\"utf-8\", \"gb18030\", $content);</span></div><div><font color=\"#0021b0\"><span style=\"color:#000000;\">这样即可插入·符号等一些特殊的符号</span></font></div>	  	\n	  ',NULL,944,'0102','PHP',NULL,0),(738,'2009-10-04 15:17:46','我真他X的是个S13。。','	  <span style=\"font-family:arial,sans-serif,helvetica,tahoma;font-size:12px;\">昨天被亲戚叫去修电脑，说电脑启动不了，去到那里了看了下也还真的是启动不了，于是在那不停的试，拨了内存再插进去还是不行，显示器总是显示无信号输入，初步怀疑是集成显卡的问题，主板是磐正的C61板子，家里的磐正KT600的板子我用了4年了都没事，怎么黑装亲戚用就出这事了。。。郁闷&nbsp;</span><div><font size=\"3\" face=\"Arial, sans-serif, Helvetica, Tahoma\"><span style=\"font-size:12px;\"><br /></span></font><div><span style=\"font-family:arial,sans-serif,helvetica,tahoma;font-size:12px;\">于是呼今天抱着个电脑机箱跑了大半个南宁市的来到公司返修，结果在公司自己再试一回的时候，突然想到，如果我把内存换根内存插糟会怎么样，结果一换，开机启动的时候显示器有信号了，可以启动了。。。晕。。。真的是内存插不稳啊。。关机再把内存换回原来的插糟，OK，开机成功启动！！！&nbsp;</span></div><div><font size=\"3\" face=\"Arial, sans-serif, Helvetica, Tahoma\"><span style=\"font-size:12px;\"><br /></span></font></div><div><span style=\"font-family:arial,sans-serif,helvetica,tahoma;font-size:12px;\">我真他X的是个S13，怎么在亲戚家里弄的时候就没想过换根内存插糟试试呢。。。</span>	  	  	\n	  </div></div>	  	\n	  ',NULL,798,'0103','随笔',NULL,0),(740,'2009-10-03 16:52:35','更新了一下数据库的操作类!','以前我是用PHP手册中的那个odbc_connect来连接的,核心代码如下:<br /><br /><span style=\"color:#8f0197;\">// 对ACCESS的操作</span><br /><span style=\"color:#8f0197;\">$connStr = \"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=\". realpath(\"db.mdb\");</span><br /><span style=\"color:#8f0197;\">$conn = odbc_connect($connStr,\"\",\"\");</span><br /><span style=\"color:#8f0197;\">if($conn)</span><br /><span style=\"color:#8f0197;\">{</span><br /><span style=\"color:#8f0197;\">echo &#039;连接成功!&lt;br&gt;&#039;;</span><br /><br /><span style=\"color:#8f0197;\">$sql_sel = \"select id,stuname,age,createdate from student\";</span><br /><span style=\"color:#8f0197;\">$rs = odbc_exec($conn,$sql_sel);</span><br /><span style=\"color:#8f0197;\">echo &#039;&lt;br&gt;&lt;strong&gt;原数据库中的数据:(&#039;.$sql_sel.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">while($row = odbc_fetch_array($rs))</span><br /><span style=\"color:#8f0197;\">{</span><br /><span style=\"color:#8f0197;\">print_r($row);</span><br /><span style=\"color:#8f0197;\">echo &#039;&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">}</span><br /><br /><span style=\"color:#8f0197;\">$sql_ins = \"insert into student(stuName,age) values(&#039;小林&#039;,24)\";</span><br /><span style=\"color:#8f0197;\">echo &#039;&lt;br&gt;&lt;strong&gt;插入语句:(&#039;.$sql_ins.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">$rs = odbc_exec($conn,$sql_ins);</span><br /><span style=\"color:#8f0197;\">echo &#039;成功更新的行数: &#039;.odbc_num_rows($rs).&#039;&lt;br&gt;&#039;;</span><br /><br /><span style=\"color:#8f0197;\">$rs = odbc_exec($conn,$sql_sel);</span><br /><span style=\"color:#8f0197;\">echo &#039;&lt;br&gt;&lt;strong&gt;现数据库中的数据:(&#039;.$sql_sel.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">while($row = odbc_fetch_array($rs))</span><br /><span style=\"color:#8f0197;\">{</span><br /><span style=\"color:#8f0197;\">print_r($row);</span><br /><span style=\"color:#8f0197;\">echo &#039;&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">}</span><br /><span style=\"color:#8f0197;\">}</span><br /><span style=\"color:#8f0197;\">else</span><br /><span style=\"color:#8f0197;\">{</span><br /><span style=\"color:#8f0197;\">echo &#039;数据库连接失败!&lt;br&gt;&#039;;</span><br /><span style=\"color:#8f0197;\">}</span><br /><br />后面自己测试发现用上面的odbc来进行查询的时候,当数据库中某字段的内容过多的时候,select content from blog_title where id =29 这样的语句取出的内容中会截取掉一部分,不知道怎么回事,相同的SQL语句放到ACCESS中执行的话是能够全部内容取出来的,但是在PHP中执行就是取不全,有位网友说是PHP中的odbc好像有些问题,而且access数据库又有很多不同的版本,后来他给了我一个用com的方法来对access数据库进行操作的,如下:<br /><br /><span style=\"color:#9b014f;\">$conn = new com( \"ADODB.Connection\",null, CP_UTF8);</span><br /><span style=\"color:#9b014f;\">$connstr = \"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=\" . realpath(\"db\\\\aaa.mdb\");</span><br /><br /><span style=\"color:#9b014f;\">$conn -&gt; Open( $connstr );</span><br /><span style=\"color:#9b014f;\">$sql = \"select content from bbb where id=21\";</span><br /><span style=\"color:#9b014f;\">//$sql2 = \"insert into bbb(title,content) values(&#039;11&#039;,&#039;aaaaa&#039;)\";</span><br /><span style=\"color:#9b014f;\">$rs = $conn-&gt;E xecute( $sql );&nbsp; <span style=\"color:#f10b00;\">// 这里多加个空格,国庆期间,竟然留言内容中不能有那个单词,晕! 还有b l o g也不能有</span></span><br /><br /><span style=\"color:#9b014f;\">$content = $rs-&gt;Fields(\"content\")-&gt;value;</span><br /><span style=\"color:#9b014f;\">echo $content;</span><br /><br /><span style=\"color:#9b014f;\">$arr = array( );</span><br /><span style=\"color:#9b014f;\">for( $i=0; $i&lt;$rs-&gt;Fields-&gt;Count; $i++ ){</span><br /><span style=\"color:#9b014f;\">&nbsp; //&nbsp; $arr$rs-&gt;Fields($i)-&gt;name = iconv( \"GB18030\", \"UTF-8\", $rs-&gt;Fields($i)-&gt;value );</span><br /><span style=\"color:#9b014f;\">&nbsp; $title = iconv( \"GB18030\", \"UTF-8\", $rs-&gt;Fields($i)-&gt;value );</span><br /><span style=\"color:#9b014f;\">}</span><br /><br /><span style=\"color:#9b014f;\">print_r( $arr );</span><br /><br /><span style=\"color:#9b014f;\">$conn -&gt; Close( );</span><br /><br />另要循环的话也可放在while中<br /><br /><span style=\"color:#8f0197;\">while(!$rs-&gt;EOF)</span><br /><span style=\"color:#8f0197;\">{</span><br /><span style=\"color:#8f0197;\">&nbsp;&nbsp; $title = $rs-&gt;Field(\"title\")-&gt;value;</span><br /><span style=\"color:#8f0197;\">&nbsp;&nbsp; echo $title.\"&lt;br&gt;\";</span><br /><span style=\"color:#8f0197;\">&nbsp;&nbsp; $rs-&gt;MoveNext();</span><br /><span style=\"color:#8f0197;\">}</span><br /><br />看了一下,其实那些方法什么的根本就是ASP中的...因为ASP中也是创建了com对象的...<br />自己试了一下,是能够把access数据库中的内容全都获取出来,于是今天把本博客的数据库操作类换成了com方式的,换了之后还费了蛮多精力改错误,现在应该基本已经应该得了吧...<br />更新了一下页面底部的源码链接,呵呵....<br /><br />接下来要解决的一个问题就是在网上插入access数据会在编码的字符前加上个\\ , 但是在本地测试的时候就没有那个\\<br /><br />如:我现在插入数据库时把单引号&#039;转成 &amp; #039; ,在本地测试时插入数据库就是直接插入&amp; #039 , 但是在网上的时候插入单引号数据库中存储的是 \\ &amp; #39; 搞不懂是怎么回事!!!',NULL,942,'0102','PHP',NULL,0),(737,'2009-09-29 14:28:38','博客错误记录','	  ① 插入数据的时候,在本地测试插入,数据库中单引号<span>显示&amp;#39;</span><span><br />\n&nbsp;&nbsp; 但是在网上插入数据时,数据库中单引号却显示 \\</span><span>&amp;#39;</span><span></span><span><br />\n&nbsp;&nbsp; 前面多了一个\\ ,在获取数据的时候我也使用了</span>htmlspecialchars_decode(),结果转义出来的还是有\\<br /><span style=\"color:#d6006d;\">(√ 已解决, 因为服务器开了magic_quotes_gpc,解决方法一:在PHP.ini中设置:magic_quotes_gpc = Off, 方法二: $str=stripcslashes($str),因为是自己买的空间,所以用了方法二)</span><br />\n<br />\n② 插入数据的时候如果碰上全角的@ ,也就是那个小圆圈的时候字符串会被截取掉...插入不了数据库...初步怀疑是<span>$content = iconv(\"utf-8\", \"gb2312\", $content);</span>这句话的问题<br /><span style=\"color:#d6006d;\">(√ 已解决,不用odbc链接了,采用com方式连接,在建立com对象的时候采用$conn = new com( \"ADODB.Connection\",null, CP_UTF8);)</span><br />\n<br />\n③ 中文字符的截取,网上找了好些方法都会有时候截取出乱码的!!!<br />\n<br />\n<br /><span style=\"color:#0162f4;\">2009-10-04</span><br />\n',NULL,687,'0103','随笔',NULL,0),(736,'2009-09-29 12:07:49','PHP备忘','<br />// 获取根目录的物理路径<br />$str = $_SERVER&#039;DOCUMENT_ROOT&#039;;<br />echo $str;<br /><br />// 对ACCESS的操作<br />$connStr = \"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=\". realpath(\"db.mdb\");<br />$conn = odbc_connect($connStr,\"\",\"\");<br />if($conn)<br />{<br />echo &#039;连接成功!&lt;br&gt;&#039;;<br /><br />$sql_sel = \"select id,stuname,age,createdate from student\";<br />$rs = odbc_exec($conn,$sql_sel);<br />echo &#039;&lt;br&gt;&lt;strong&gt;原数据库中的数据:(&#039;.$sql_sel.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;<br />while($row = odbc_fetch_array($rs))<br />{<br />print_r($row);<br />echo &#039;&lt;br&gt;&#039;;<br />}<br /><br />$sql_ins = \"insert into student(stuName,age) values(&#039;小林&#039;,24)\";<br />echo &#039;&lt;br&gt;&lt;strong&gt;插入语句:(&#039;.$sql_ins.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;<br />$rs = odbc_exec($conn,$sql_ins);<br />echo &#039;成功更新的行数: &#039;.odbc_num_rows($rs).&#039;&lt;br&gt;&#039;;<br /><br />$rs = odbc_exec($conn,$sql_sel);<br />echo &#039;&lt;br&gt;&lt;strong&gt;现数据库中的数据:(&#039;.$sql_sel.&#039;)&lt;/strong&gt;&lt;br&gt;&#039;;<br />while($row = odbc_fetch_array($rs))<br />{<br />print_r($row);<br />echo &#039;&lt;br&gt;&#039;;<br />}<br />}<br />else<br />{<br />echo &#039;数据库连接失败!&lt;br&gt;&#039;;<br />}<br /><br />// ACCESS数据库乱码问题<br />$title = iconv(&#039;gb2312&#039;,&#039;utf-8&#039;,$rowtitle);&nbsp; // 从access读取数据<br />$url = iconv(\"utf-8\", \"gb2312\", $url);&nbsp; // 插入到access数据库<br /><br />// 读取XML和保存成XML文件,注意乱码<br />XML文件内容test.xml:<br />&lt;?xml version=\"1.0\" encoding=\"utf8\"?&gt;<br />&lt;userinfo&gt;<br />&lt;sex&gt;1&lt;/sex&gt;<br />&lt;address&gt;广西,南宁&lt;/address&gt;<br />&lt;/userinfo&gt;<br /><br />PHP代码:<br />&lt;?php<br />header(\"Content-Type: text/html; charset=gb2312\");<br /><br />if (file_exists(&#039;test.xml&#039;)) {<br />$xml = simplexml_load_file(&#039;test.xml&#039;);<br />echo &#039;性别: &#039;.(1==$xml-&gt;sex ? \"男\" : \"女\");<br />$xml-&gt;sex=0;<br /><br />$doc_root = $_SERVER&#039;DOCUMENT_ROOT&#039;;<br />$fp = fopen($doc_root.&#039;text2.xml&#039;,\"w+b\");<br />fwrite($fp,$xml-&gt;asXML());<br />echo &#039;&lt;br&gt;写入text2.xml成功!&#039;.date(&#039;Y-m-d H:i:s&#039;);<br /><br />} else {<br />exit(&#039;Failed to open test.xml.&#039;);<br />}<br />?&gt;<br /><br />// 过滤危险的HTML字符<br />if($_GET&#039;txt&#039;)<br />{<br />$str = $_GET&#039;txt&#039;;<br />// 需要替换的危险HTML字符<br />$farr = array<br />(<br />&#039;%&lt;applet^&gt;*?&gt;.*?&lt;/applet&gt;%&#039;,<br />&#039;%&lt;body^&gt;*?&gt;.*?&lt;/body&gt;%&#039;,<br />&#039;%&lt;embed^&gt;*?&gt;.*?&lt;/embed&gt;%&#039;,<br />&#039;%&lt;frame^&gt;*?&gt;.*?&lt;/frame&gt;%&#039;,<br />&#039;%&lt;frameset^&gt;*?&gt;.*?&lt;/frameset&gt;%&#039;,<br />&#039;%&lt;html^&gt;*?&gt;.*?&lt;/html&gt;%&#039;,<br />&#039;%&lt;iframe^&gt;*?&gt;.*?&lt;/iframe&gt;%&#039;,<br />&#039;%&lt;ilayer^&gt;*?&gt;.*?&lt;/ilayer&gt;%&#039;,<br />&#039;%&lt;layer^&gt;*?&gt;.*?&lt;/layer&gt;%&#039;,<br />&#039;/&lt;link^&gt;*?&gt;/&#039;,<br />&#039;%&lt;meta^&gt;*?&gt;.*?&lt;/meta&gt;%&#039;,<br />&#039;%&lt;object^&gt;*?&gt;.*?&lt;/object&gt;%&#039;,<br />&#039;%&lt;script^&gt;*?&gt;.*?&lt;/script&gt;%&#039;,<br />&#039;%&lt;style^&gt;*?&gt;.*?&lt;/style&gt;%&#039;<br />);<br />// 替换成的字符<br />$strReplace = \"&lt;span style=&#039;color:#ff0000;&#039;&gt;危险代码&lt;/span&gt;\"; <br /><br />$str = preg_replace( $farr,$strReplace,$str);<br />echo $str;<br />}<br /><br />// 获取当前浏览者IP<br />echo &#039;当前浏览者IP: &#039;.$_SERVER&#039;REMOTE_ADDR&#039;;<br /><br />// 跳转<br />header(&#039;Location:www.sohu.com&#039;);<br /><br />// 输出为UTF-8编码<br />header(&#039;content-Type=text/html;charset=utf-8&#039;);<br /><br />// 获取当前时间<br />date_default_timezone_set(&#039;prc&#039;);&nbsp; // 不加上这句则否出格林威治时间<br />$str = date(\"YmdHis\");<br /><br />// ACCESS获取数据中，写在字段是大写，则写在$row中括号里面的也必须是大写<br />如SQL语句为\"select createdate from bk_title\",即使ACCESS数据库中字段名称是createDate，该语句也能获取出来，<br />但是在外面的PHP文件中，不能通过$rowcreateDate获取出来，因为sql语句中的是小写，一切以sql语句为准，所以应该是<br />$rowcreatedate<br /><br />// ACCESSk中的模糊查询<br />在ACCESS中使用模糊查询需要注意，在ACCESS软件中使用select * from bk_title where title like &#039;%f%&#039;是查询不出结果的<br />应该使用select * from bk_title where title like &#039;*f*&#039;，这样才能查询出结果，<br />但是，通过PHP向ACCESS查询的时候，如果是传入select * from bk_title where title like &#039;*f*&#039;这条SQL语句是返回不了任何结果的，必须传入select * from bk_title where title like &#039;%f%&#039;才能返回结果。。。<br />如： $rs = odbc_exec($this-&gt;conn,\"select * from bk_title where title like &#039;%f%&#039;\");<br /><br />// 插入ACCESS数据库时，如果外面的网页采用的是UTF-8编码，但是ACCESS数据库默认是GB2312的编码，这时从PHP文件插入ACCESS数据库之前得先把UTF-8的汉字等转成GB2312的汉字，这样在ACCESS数据库中才能显示出正确的汉字，否则只会显示乱码，代码如下：<br />$content = iconv(\"utf-8\", \"gb2312\", $content);<br />在从数据库中取出时同样也需要把数据库中存储的GB2312的汉字转成UTF-8的汉字，代码如下：<br />$content = iconv(&#039;gb2312&#039;,&#039;utf-8&#039;,$rowcontent);<br />以上代码有个重要的问题，插入数据的时候，如果字符串中有·这样的符号，则插入的时候会把连同·符号后的字符串都截取掉的，因为·符号在GB2312编码中没有，所以会自动截取掉，如要插入·符号，则上面的代码则改成如下，用GB18030<br />$content = iconv(\"utf-8\", \"gb18030\", $content);<br /><br />// 用com的方式对access数据库进行操作, 目前为止没发现像odbc那样的有时候会取数据取不全<br />&nbsp;&nbsp;&nbsp; $content = $_POST&#039;content&#039;;<br />&nbsp;&nbsp;&nbsp; $content = str_replace(\"&#039;\", \"&amp;#039;\", $content); // 把单引号转成html识别的字符<br /><br />&nbsp;&nbsp;&nbsp; $conn = new com( \"ADODB.Connection\",null, CP_UTF8); <br />&nbsp;&nbsp;&nbsp; $connstr = \"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=\" . $_SERVER&#039;DOCUMENT_ROOT&#039;.\"/bk/db/test.mdb\";&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; $conn -&gt; Open( $connstr );<br />&nbsp;&nbsp;&nbsp; $sql_ins = \"insert into tb(content) values(&#039;$content&#039;)\";<br />&nbsp;&nbsp;&nbsp; $conn-&gt;E xecute($sql_ins); // 这里多了一个空格<br /><br />&nbsp;&nbsp;&nbsp; echo &#039;插入成功，当前数据库的内容是：&lt;hr&gt;&#039;;<br /><br />&nbsp;&nbsp;&nbsp; $sql_sel = \"select content from tb\";<br />&nbsp;&nbsp;&nbsp; $rs = $conn-&gt;E xecute( $sql_sel );&nbsp; // 这里多了一个空格<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; while(!$rs-&gt;EOF)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $tmp = $rs-&gt;Fields(\"content\")-&gt;value;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo $tmp.\"&lt;br&gt;\";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $rs-&gt;MoveNext();<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; $conn -&gt; Close( );<br /><br />// 在网上插入access数据库中会自动给特殊字符加上\\<br />服务器开了magic_quotes_gpc,解决方法一:在PHP.ini中设置:magic_quotes_gpc = Off, 方法二: $str=stripcslashes($str)<br /><br /><br /><br /><br /><br /><br />',NULL,1199,'0102','PHP',NULL,0),(735,'2009-09-29 12:06:39','牛博－牛腩的博客 设计说明书','牛博－牛腩的博客 设计说明书<br /><br />设计说明：<br />&nbsp;&nbsp;&nbsp; 检验自己对PHP的掌握程度，整个项目核心：数据库增删查改，主要侧重于代码，所以界面方法不予美化<br /><br />功能说明：<br />&nbsp;&nbsp;&nbsp; 一般浏览用户：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 按分类查看文章列表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查看文章内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 对文章进行评论<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在留言簿进行留言<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; 管理员：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 写博客<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 博客分类管理<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 博客评论管理（在文章内容页面上也可对评论进行删除操作）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 博客留言管理（直接在留言簿页面上进行删除操作）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 文章管理（按类别分类）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 友情链接管理<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 个人资料修改<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; 其他功能：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 每篇文章统计浏览量和评论数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用户进入博客首页时，记录IP地址和时间，同一IP，一天只记录一次<br /><br />文件结构（文件名）:<br />&nbsp;&nbsp;&nbsp; 前台：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 头部（top）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 尾部（foot）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首页（index）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 列表页（与首页同一文件）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 搜索页（与首页同一文件）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 详细页（show）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 留言簿（guestbook）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 前台左边栏（left）<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; 后台：（admin目录下）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 管理员登陆页（login）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 后台左边栏（admin_left）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 后台首页（index，内容和博客统计页一样）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 发表文章页面（write_blog）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 分类管理页面（ca_admin）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 评论管理（pinlun_admin）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 留言管理（打开新页面直接跳转到留言簿）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 文章管理（title_admin）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 链接管理（link_admin）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 个人资料（userinfo）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 博客统计（tongji）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />数据库设计:<br />友情链接表(blog_link): id,title,url,createDate<br />访问记录表(blog_visit): id,ip,createDate,同一IP一天只记录一次<br />留言簿表(blog_guestbook): id,ip,content,createDate<br />博客分类表(blog_cate;ry): id,caName,createDate<br />博客文章表(blog_title): id,title,content,caid,createDate,visitNum<br />文章评论表(blog_pinlun): id,content,titleid,create,ip<br />个人信息: 头像/性别/地址&nbsp; 字段比较少,所以打算存储于XML中<br /><br />类的设计:<br />LinkDAO<br />&nbsp;&nbsp;&nbsp; Insert($title,$url)<br />&nbsp;&nbsp;&nbsp; Delete($id)<br />&nbsp;&nbsp;&nbsp; Select()<br />&nbsp;&nbsp;&nbsp; <br />VisitDAO<br />&nbsp;&nbsp;&nbsp; Insert($ip)<br />&nbsp;&nbsp;&nbsp; IsExist($ip): 判断访IP在当天是否已经记录<br />&nbsp;&nbsp;&nbsp; <br />GuestBookDAO<br />&nbsp;&nbsp;&nbsp; Insert($ip,$content)<br />&nbsp;&nbsp;&nbsp; Delete($id)<br />&nbsp;&nbsp;&nbsp; Select($pageSize,$pageIndex): pageSize每页显示的记录数, pageIndex页索引<br />&nbsp;&nbsp;&nbsp; TotalCount(): 留言总数<br /><br />Cate;ryDAO<br />&nbsp;&nbsp;&nbsp; Insert($caname)<br />&nbsp;&nbsp;&nbsp; Update($id,$caname)<br />&nbsp;&nbsp;&nbsp; Delete($id)<br />&nbsp;&nbsp;&nbsp; IsExist($caname)<br />&nbsp;&nbsp;&nbsp; SelectIdByName($caname)<br />&nbsp;&nbsp;&nbsp; Select()<br /><br />TitleDAO<br />&nbsp;&nbsp;&nbsp; Insert($title,$content,$caid)<br />&nbsp;&nbsp;&nbsp; Update($id,$title,$content,$caid)<br />&nbsp;&nbsp;&nbsp; Delete($id)<br />&nbsp;&nbsp;&nbsp; IncreaseVisit($id): 文章浏览量+1<br />&nbsp;&nbsp;&nbsp; TotalCount($caid): 计算文章总数,如果caid为0则是计算所有文章总数<br />&nbsp;&nbsp;&nbsp; Select($pageSize,$pageIndex,$caid): pageSize每页显示的记录数, pageIndex页索引<br />&nbsp;&nbsp;&nbsp; SelectByDate($date): 搜索某一天的文章，不分页<br />&nbsp;&nbsp;&nbsp; SelectByKey($key)：按文章标题的关键字搜索，不分页<br /><br />PinLunDAO<br />&nbsp;&nbsp;&nbsp; Insert($content,$titleid,$ip)<br />&nbsp;&nbsp;&nbsp; Delete($id)<br />&nbsp;&nbsp;&nbsp; TotalCount($title)<br />&nbsp;&nbsp;&nbsp; Select($pageSize,$pageIndex,$titleid): pageSize每页显示的记录数, pageIndex页索引<br /><br />UserInfoDAO<br />&nbsp; UpdateFace($face): 修改头像，相当于重新生成XML文件<br />&nbsp; Update($sex,$address): 修改性别和地址，<br />&nbsp; <br />tools\\Tools<br />&nbsp;&nbsp;&nbsp; GetSafeHTMLString($str): 获取安全的HTML字符串，把危险的如script等HTML去掉<br />&nbsp;&nbsp;&nbsp; GetNoHTMLString($str): 获取无HTML的字符串，如&lt;h1&gt;abc&lt;/h1&gt;最后获取出来的值是abc<br />&nbsp;&nbsp;&nbsp; GenPageHTML($totalCount,$pageSize,$pageIndex): 生成分页导航处的HTML，传入参数依次是：总记录数，每页显示记录数，显示页索引<br /><br />制作思路备忘:<br />&nbsp;&nbsp;&nbsp; 前台页面的动态内容通过调用bll文件夹中的各种类生成HTML显示出来,bll又调用dal文件夹中的文件获取数据集后进行HTML的动态生成<br />&nbsp; 链接模块：<br />&nbsp; 前台左边栏显示的链接通过调用bll\\link_show.php中的show_front()方法来进行HTML的显示，<br />&nbsp;&nbsp;&nbsp;&nbsp; 该方法调用dal\\LinkDAO.php中的Select方法<br />&nbsp; 后台链接管理页面显示通过调用bll\\link_show.php中的show_back()方法来进行HTML的显示<br />&nbsp; 删除链接通过JS进行AJAX调用bll\\link_delete.php文件来进行删除<br />&nbsp; 添加链接则跳到bll\\link_insert.php页面进行处理后再转回原页面<br /><br />&nbsp; 分类模块：<br />&nbsp; 后台添加类别是调用bll\\cate;ry_add.php文件，添加前判断是否有重名<br />&nbsp; 后台删除类别通过AJAX调用bll\\cate;ry_delete.php文件<br />&nbsp; 后台显示类别列表调用bll\\cate;ry_show.php中的show_back()来显示<br />&nbsp; 前台左边栏显示类别列表调用bll\\cate;ry_show.php中的show_front()来显示<br />&nbsp; 后台修改通过bll\\cate;ry_modify.php文件来进行修改，修改前要先判断是否有重名<br /><br />&nbsp; 个人资料修改模块:<br />&nbsp; 上传头像按钮调用bll\\upload_face.php文件,文件中调用UserInfoDAO的UpdateFace()<br />&nbsp; 保存修改按钮调用bll\\userinfo_save.php文件，文件中调用UserInfoDAO的Update()<br />&nbsp; 前台左边显示直接在left.php中写<br /><br />&nbsp; 用户访问记录模块<br />&nbsp; 在index.php中调用dal/VisitDAO.php记录用户IP，如果该IP在今日已经记录则不记录<br />&nbsp; <br />&nbsp; 博客统计<br />&nbsp; 调用dal/VisitDAO.php中的VisitNum()方法<br /><br />',NULL,1085,'0103','随笔',NULL,0),(734,'2009-09-29 11:30:26','热烈庆祝牛腩学习PHP巨作－牛博正式开放！！！','	  最近闲来无事，晚上不能上网，用着一台C1.7+256M+MX440的旧电脑，.NET是玩不了了，只能找点东西来学学，正好看到PHP100的网站，下了前十集的视频下来开始学习PHP，看完后试着做了一个自己的博客，比较简单，数据库增删查改而已，开始计划是一个星期左右应该能搞掂的，结果做下来将近搞了一个月，昨天晚上基本才把大的功能完成，经过了简单的测试今天早上就开始放到空间上了，因为想要赶在十一前上线的，非常欢迎大家前来帮俺测试，注入，完善程序。<br />&nbsp;&nbsp; <span><br />&nbsp;&nbsp; 最后附上源码下载：</span><a target=\"\\&quot;_blank\\&quot;\" href=\"%5C%22http://www.niunan.net/download/blog.rar%5C%22\">http://www.niunan.net/download/blog.rar</a><br /><br />&nbsp;&nbsp; 该博客是以自己所掌握的分层及面向对象思想而作的，结果做出来后个人感觉四不像，代码结构有点乱。。。<br /><br /><span>&nbsp;&nbsp; 后台管理地址：</span><a target=\"\\&quot;_blank\\&quot;\" href=\"%5C%22/blog/admin%5C%22\"><span> http://niunan.net/blog/admin/</span></a><span>&nbsp; </span><br /><span>&nbsp;&nbsp; 用户名：niunan</span><br /><span>&nbsp;&nbsp; 密码：123456</span><br />	  	  	\n	  	  	\n	  ',NULL,1008,'0103','随笔',NULL,0),(1187,'2017-03-14 20:23:17','LAYUI中的编程器中的上传图片的ASP.NET CORE后台代码','<p>&nbsp; &nbsp; &nbsp; &nbsp;代码如下，之间在视频里复制粘贴的代码用起来有些问题，主要是之前没用平台无关目录分隔符，导致在win10开发机上测试上传图片是成功的，可是部署到centos7上上传图片就失败了，因为win是以来分隔，但linux是以/来分隔，之前的代码把符号固化了，用Path.xxxxxx替换一下即可</p><p><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// layui编辑器里的上传图片功能&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; //{</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;\"code\": 0 //0表示成功，其它失败</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;,\"msg\": \"\" //提示信息 //一般上传失败后返回</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;,\"data\": {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp;\"src\": \"图片路径\"</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp;,\"title\": \"图片名称\" //可选</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; //}</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;returns&gt;&lt;/returns&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; HttpPost</p><p>&nbsp; &nbsp; &nbsp; &nbsp; public IActionResult ImgUpload()</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var imgFile = Request.Form.Files0;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (imgFile != null &amp;&amp; !string.IsNullOrEmpty(imgFile.FileName))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long size = 0;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string tempname = \"\";</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var filename = ContentDispositionHeaderValue</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Parse(imgFile.ContentDisposition)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .FileName</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Trim(\'\"\');</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var extname = filename.Substring(filename.LastIndexOf(\".\"), filename.Length - filename.LastIndexOf(\".\")); //扩展名，如.jpg</p><p><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #region 判断后缀</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!extname.ToLower().Contains(\"jpg\") &amp;&amp; !extname.ToLower().Contains(\"png\") &amp;&amp; !extname.ToLower().Contains(\"gif\"))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Json(new { code = 1, msg = \"只允许上传jpg,png,gif格式的图片.\", });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #endregion</p><p><br></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #region 判断大小</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long mb = imgFile.Length / 1024 / 1024; // MB</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (mb &gt; 5)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Json(new { code = 1, msg = \"只允许上传小于 5MB 的图片.\", });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #endregion</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var filename1 = System.Guid.NewGuid().ToString().Substring(0, 6) + extname;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tempname = filename1;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var path = hostingEnv.WebRootPath; //网站静态文件目录 &nbsp;wwwroot 要把IHostingEnvironment注入进来</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string dir = DateTime.Now.ToString(\"yyyyMMdd\");</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //完整物理路径，注意要用平台无关目录分隔符</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string wuli_path = hostingEnv.WebRootPath + $\"{Path.DirectorySeparatorChar}upload{Path.DirectorySeparatorChar}{dir}{Path.DirectorySeparatorChar}\";</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!System.IO.Directory.Exists(wuli_path))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.IO.Directory.CreateDirectory(wuli_path);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; filename = wuli_path + filename1 ;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size += imgFile.Length;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (FileStream fs = System.IO.File.Create(filename))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imgFile.CopyTo(fs);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fs.Flush();</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Json(new { code = 0, msg = \"上传成功\", data = new { src = $\"/upload/{dir}/{filename1}\", title = filename1 } });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Json(new { code = 1, msg = \"上传失败\", });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>',NULL,0,'0101','ASP.NET',NULL,0),(1188,'2017-04-04 20:41:52','js for循环内调用异步方法问题','<p>for循环中用ajax异步取数据，再加载到界面上， 网上搞到的代码：</p><p><img src=\"/upload/20170404/60f21b.png\" alt=\"60f21b.png\"><br></p><p>自己项目中的代码：</p><p><img src=\"/upload/20170404/30aaa4.png\" alt=\"30aaa4.png\"><br></p>',NULL,0,'0105','javascript',NULL,0),(1186,'2017-03-12 22:41:01','牛腩博客改版成功！！！','<h4>牛腩学习ASP.NET CORE做的项目，边学边做。</h4><p>目录：</p><ul><li>01-dotnetcore网站部署到centos7系统上（时长 2:03:16）</li><li>02-前期准备及项目搭建 （时长：0:23:35）</li><li>03-数据库设计及Dapper使用（时长：0:50:47）</li><li>04-后台博客文章增删改（时长：1:16:43）</li><li>05-LayUI分页的使用（时长：1:07:07）</li><li>06-博客查询功能和LayUI编辑器的使用（时长：1:16:11）</li><li>07-后台登录及前台整合（时长：1:00:37）</li><li>08-前台整合2（时长：0:54:10）</li><li>09-LayUI树形菜单的使用（时长：1:47:48）</li><li>10-代码重构（时长：1：05：33）</li><li>11-切换到MYSQL数据库（时长：2：32：58）</li></ul><p>优酷观看地址：<a href=\"http://list.youku.com/albumlist/show?id=49039302&amp;ascending=1&amp;page=1\" target=\"_blank\"><u><font color=\"#0066cc\">http://list.youku.com/albumlist/show?id=49039302&amp;ascending=1&amp;page=1</font></u></a></p><p><br></p><p>该视频录的就是本博客的制作 过程 ，同时左边分类滑到最下面点那个github的图标会跳到我的coding.net主页，本博客的源码也已经上传上去，本来早就已经大概做好的，只是最近几天在弄日志功能，记录每个访客的IP地址的，按网上搜索的方法，结果总是取出错误的，具体问题在：</p><p>https://q.cnblogs.com/q/91341/</p><p>刚刚才解决了，能取到访客IP了。</p><p>接下来要弄的也就是后台的欢迎页了，打算弄点图表上去，用百度Echart。。。</p>',NULL,0,'0103','随笔',NULL,-1);
/*!40000 ALTER TABLE `blog` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2017-07-08 22:33:08
